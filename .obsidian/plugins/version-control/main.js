/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
If you want to view the source, please visit the github repository of this plugin
*/

var h9=Object.create;var uh=Object.defineProperty;var g9=Object.getOwnPropertyDescriptor;var y9=Object.getOwnPropertyNames;var v9=Object.getPrototypeOf,b9=Object.prototype.hasOwnProperty;var G_=e=>{throw TypeError(e)};var S9=(e,t,n)=>t in e?uh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var w9=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ae=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ua=(e,t)=>{for(var n in t)uh(e,n,{get:t[n],enumerable:!0})},K_=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of y9(t))!b9.call(e,i)&&i!==n&&uh(e,i,{get:()=>t[i],enumerable:!(r=g9(t,i))||r.enumerable});return e};var D=(e,t,n)=>(n=e!=null?h9(v9(e)):{},K_(t||!e||!e.__esModule?uh(n,"default",{value:e,enumerable:!0}):n,e)),x9=e=>K_(uh({},"__esModule",{value:!0}),e);var P=(e,t,n)=>S9(e,typeof t!="symbol"?t+"":t,n),zA=(e,t,n)=>t.has(e)||G_("Cannot "+n);var G=(e,t,n)=>(zA(e,t,"read from private field"),n?n.call(e):t.get(e)),Kt=(e,t,n)=>t.has(e)?G_("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),It=(e,t,n,r)=>(zA(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),He=(e,t,n)=>(zA(e,t,"access private method"),n);var Tu=(e,t,n,r)=>({set _(i){It(e,t,i,n)},get _(){return G(e,t,r)}});function Tr(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}function si(e){return e?rV(e)||wh(e)||!!e[ph]||!!e[mh]?.[ph]||xh(e)||Eh(e):!1}function rV(e){if(!e||!bp(e))return!1;let t=Mu(e);if(t===null||t===Ji[bh])return!0;let n=Ji.hasOwnProperty.call(t,mh)&&t[mh];if(n===Object)return!0;if(!Au(n))return!1;let r=Q_.get(n);return r===void 0&&(r=Function.toString.call(n),Q_.set(n,r)),r===A9}function iV(e){return zr(e)||Tr(15,e),e[dr].base_}function Sh(e,t,n=!0){Ru(e)===0?(n?Reflect.ownKeys(e):Ji.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((r,i)=>t(i,r,e))}function Ru(e){let t=e[dr];return t?t.type_:wh(e)?1:xh(e)?2:Eh(e)?3:0}function M9(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function R9(e){let t=+e;return Number.isInteger(t)&&String(t)===e}function GA(e,t){if(xh(e))return new Map(e);if(Eh(e))return new Set(e);if(wh(e))return Array[bh].slice.call(e);let n=rV(e);if(t===!0||t==="class_only"&&!n){let r=Ji.getOwnPropertyDescriptors(e);delete r[dr];let i=Reflect.ownKeys(r);for(let o=0;o<i.length;o++){let s=i[o],a=r[s];a[Yb]===!1&&(a[Yb]=!0,a[qA]=!0),(a.get||a.set)&&(r[s]={[qA]:!0,[Yb]:!0,[Xb]:a[Xb],[hh]:e[s]})}return Ji.create(Mu(e),r)}else{let r=Mu(e);if(r!==null&&n)return{...e};let i=Ji.create(r);return Ji.assign(i,e)}}function To(e,t=!1){return iS(e)||zr(e)||!si(e)||(Ru(e)>1&&Ji.defineProperties(e,{set:Wb,add:Wb,clear:Wb,delete:Wb}),Ji.freeze(e),t&&Sh(e,(n,r)=>{To(r,!0)},!1)),e}function D9(){Tr(2)}function iS(e){return e===null||!bp(e)?!0:Ji.isFrozen(e)}function Nu(e){let t=tS[e];return t||Tr(0,e),t}function I9(e,t){tS[e]||(tS[e]=t)}function J_(e,t){t&&(e.patchPlugin_=Nu(eS),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function KA(e){WA(e),e.drafts_.forEach(P9),e.drafts_=null}function WA(e){e===gh&&(gh=e.parent_)}function P9(e){let t=e[dr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function tV(e,t){t.unfinalizedDrafts_=t.drafts_.length;let n=t.drafts_[0];if(e!==void 0&&e!==n){n[dr].modified_&&(KA(t),Tr(4)),si(e)&&(e=nV(t,e));let{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(n[dr].base_,e,t)}else e=nV(t,n);return k9(t,e,!0),KA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==XA?e:void 0}function nV(e,t){if(iS(t))return t;let n=t[dr];if(!n)return nS(t,e.handledSet_,e);if(!oS(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){let{callbacks_:r}=n;if(r)for(;r.length>0;)r.pop()(e);lV(n,e)}return n.copy_}function k9(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&To(t,n)}function sV(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}function aV(e,t,n,r){let i=ja(e),o=e.type_;if(r!==void 0&&$a(i,r,o)===t){Zb(i,r,n,o);return}if(!e.draftLocations_){let a=e.draftLocations_=new Map;Sh(i,(l,c)=>{if(zr(c)){let u=a.get(c)||[];u.push(l),a.set(c,u)}})}let s=e.draftLocations_.get(t)??_9;for(let a of s)Zb(i,a,n,o)}function V9(e,t,n){e.callbacks_.push(function(i){let o=t;if(!o||!oS(o,i))return;i.mapSetPlugin_?.fixSetContents(o);let s=ZA(o);aV(e,o.draft_??o,s,n),lV(o,i)})}function lV(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){let{patchPlugin_:r}=t;if(r){let i=r.getPath(e);i&&r.generatePatches_(e,i,t)}sV(e)}}function L9(e,t,n){let{scope_:r}=e;if(zr(n)){let i=n[dr];oS(i,r)&&i.callbacks_.push(function(){Qb(e);let s=ZA(i);aV(e,n,s,t)})}else si(n)&&e.callbacks_.push(function(){let o=ja(e);e.type_===3?o.has(n)&&nS(n,r.handledSet_,r):$a(o,t,e.type_)===n&&r.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&nS($a(e.copy_,t,e.type_),r.handledSet_,r)})}function nS(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||zr(e)||t.has(e)||!si(e)||iS(e)||(t.add(e),Sh(e,(r,i)=>{if(zr(i)){let o=i[dr];if(oS(o,n)){let s=ZA(o);Zb(e,r,s,e.type_),sV(o)}}else si(i)&&nS(i,t,n)})),e}function F9(e,t){let n=wh(e),r={type_:n?1:0,scope_:t?t.scope_:oV(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0},i=r,o=rS;n&&(i=[r],o=yh);let{revoke:s,proxy:a}=Proxy.revocable(i,o);return r.draft_=a,r.revoke_=s,[a,r]}function jA(e,t){let n=e[dr];return(n?ja(n):e)[t]}function B9(e,t,n){let r=cV(t,n);return r?hh in r?r[hh]:r.get?.call(e.draft_):void 0}function cV(e,t){if(!(t in e))return;let n=Mu(e);for(;n;){let r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Mu(n)}}function YA(e){e.modified_||(e.modified_=!0,e.parent_&&YA(e.parent_))}function Qb(e){e.copy_||(e.assigned_=new Map,e.copy_=GA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function QA(e,t,n,r){let[i,o]=xh(t)?Nu(Jb).proxyMap_(t,n):Eh(t)?Nu(Jb).proxySet_(t,n):F9(t,n);return(n?.scope_??oV()).drafts_.push(i),o.callbacks_=n?.callbacks_??[],o.key_=r,n&&r!==void 0?V9(n,o,r):o.callbacks_.push(function(l){l.mapSetPlugin_?.fixSetContents(o);let{patchPlugin_:c}=l;o.modified_&&c&&c.generatePatches_(o,[],l)}),i}function Ch(e){return zr(e)||Tr(10,e),uV(e)}function uV(e){if(!si(e)||iS(e))return e;let t=e[dr],n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=GA(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=GA(e,!0);return Sh(n,(i,o)=>{Zb(n,i,uV(o))},r),t&&(t.finalized_=!1),n}function fV(){function t(h,m=[]){if(h.key_!==void 0){let v=h.parent_.copy_??h.parent_.base_,g=N9($a(v,h.key_)),y=$a(v,h.key_);if(y===void 0||y!==h.draft_&&y!==h.base_&&y!==h.copy_||g!=null&&g.base_!==h.base_)return null;let b=h.parent_.type_===3,w;if(b){let S=h.parent_;w=Array.from(S.drafts_.keys()).indexOf(h.key_)}else w=h.key_;if(!(b&&v.size>w||dh(v,w)))return null;m.push(w)}if(h.parent_)return t(h.parent_,m);m.reverse();try{n(h.copy_,m)}catch{return null}return m}function n(h,m){let v=h;for(let g=0;g<m.length-1;g++){let y=m[g];if(v=$a(v,y),!bp(v)||v===null)throw new Error(`Cannot resolve path at '${m.join("/")}'`)}return v}let r="replace",i="add",o="remove";function s(h,m,v){if(h.scope_.processedForPatches_.has(h))return;h.scope_.processedForPatches_.add(h);let{patches_:g,inversePatches_:y}=v;switch(h.type_){case 0:case 2:return l(h,m,g,y);case 1:return a(h,m,g,y);case 3:return c(h,m,g,y)}}function a(h,m,v,g){let{base_:y,assigned_:b}=h,w=h.copy_;w.length<y.length&&([y,w]=[w,y],[v,g]=[g,v]);let S=h.allIndicesReassigned_===!0;for(let C=0;C<y.length;C++){let x=w[C],E=y[C];if((S||b?.get(C.toString()))&&x!==E){let A=x?.[dr];if(A&&A.modified_)continue;let M=m.concat([C]);v.push({op:r,path:M,value:d(x)}),g.push({op:r,path:M,value:d(E)})}}for(let C=y.length;C<w.length;C++){let x=m.concat([C]);v.push({op:i,path:x,value:d(w[C])})}for(let C=w.length-1;y.length<=C;--C){let x=m.concat([C]);g.push({op:o,path:x})}}function l(h,m,v,g){let{base_:y,copy_:b,type_:w}=h;Sh(h.assigned_,(S,C)=>{let x=$a(y,S,w),E=$a(b,S,w),T=C?dh(y,S)?r:i:o;if(x===E&&T===r)return;let A=m.concat(S);v.push(T===o?{op:T,path:A}:{op:T,path:A,value:d(E)}),g.push(T===i?{op:o,path:A}:T===o?{op:i,path:A,value:d(x)}:{op:r,path:A,value:d(x)})})}function c(h,m,v,g){let{base_:y,copy_:b}=h,w=0;y.forEach(S=>{if(!b.has(S)){let C=m.concat([w]);v.push({op:o,path:C,value:S}),g.unshift({op:i,path:C,value:S})}w++}),w=0,b.forEach(S=>{if(!y.has(S)){let C=m.concat([w]);v.push({op:i,path:C,value:S}),g.unshift({op:o,path:C,value:S})}w++})}function u(h,m,v){let{patches_:g,inversePatches_:y}=v;g.push({op:r,path:[],value:m===XA?void 0:m}),y.push({op:r,path:[],value:h})}function f(h,m){return m.forEach(v=>{let{path:g,op:y}=v,b=h;for(let x=0;x<g.length-1;x++){let E=Ru(b),T=g[x];typeof T!="string"&&typeof T!="number"&&(T=""+T),(E===0||E===1)&&(T==="__proto__"||T===mh)&&Tr(19),Au(b)&&T===bh&&Tr(19),b=$a(b,T),bp(b)||Tr(18,g.join("/"))}let w=Ru(b),S=p(v.value),C=g[g.length-1];switch(y){case r:switch(w){case 2:return b.set(C,S);case 3:Tr(16);default:return b[C]=S}case i:switch(w){case 1:return C==="-"?b.push(S):b.splice(C,0,S);case 2:return b.set(C,S);case 3:return b.add(S);default:return b[C]=S}case o:switch(w){case 1:return b.splice(C,1);case 2:return b.delete(C);case 3:return b.delete(v.value);default:return delete b[C]}default:Tr(17,y)}}),h}function p(h){if(!si(h))return h;if(wh(h))return h.map(p);if(xh(h))return new Map(Array.from(h.entries()).map(([v,g])=>[v,p(g)]));if(Eh(h))return new Set(Array.from(h).map(p));let m=Object.create(Mu(h));for(let v in h)m[v]=p(h[v]);return dh(h,ph)&&(m[ph]=h[ph]),m}function d(h){return zr(h)?p(h):h}I9(eS,{applyPatches_:f,generatePatches_:s,generateReplacementPatches_:u,getPath:t})}var XA,ph,dr,Ji,Mu,mh,bh,qA,Xb,Yb,hh,zr,A9,Q_,dh,$a,Zb,wh,xh,Eh,bp,Au,$A,N9,ja,ZA,Wb,Jb,eS,X_,tS,Z_,gh,oV,O9,eV,oS,_9,rS,yh,z9,vh,Wt,JA,eM,Ti=w9(()=>{XA=Symbol.for("immer-nothing"),ph=Symbol.for("immer-draftable"),dr=Symbol.for("immer-state");Ji=Object,Mu=Ji.getPrototypeOf,mh="constructor",bh="prototype",qA="configurable",Xb="enumerable",Yb="writable",hh="value",zr=e=>!!e&&!!e[dr];A9=Ji[bh][mh].toString(),Q_=new WeakMap;dh=(e,t,n=Ru(e))=>n===2?e.has(t):Ji[bh].hasOwnProperty.call(e,t),$a=(e,t,n=Ru(e))=>n===2?e.get(t):e[t],Zb=(e,t,n,r=Ru(e))=>{r===2?e.set(t,n):r===3?e.add(n):e[t]=n};wh=Array.isArray,xh=e=>e instanceof Map,Eh=e=>e instanceof Set,bp=e=>typeof e=="object",Au=e=>typeof e=="function",$A=e=>typeof e=="boolean";N9=e=>bp(e)?e?.[dr]:null,ja=e=>e.copy_||e.base_,ZA=e=>e.modified_?e.copy_:e.base_;Wb={[hh]:D9};Jb="MapSet",eS="Patches",X_="ArrayMethods",tS={};Z_=e=>!!tS[e];oV=()=>gh,O9=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:Z_(Jb)?Nu(Jb):void 0,arrayMethodsPlugin_:Z_(X_)?Nu(X_):void 0});eV=e=>gh=O9(gh,e);oS=(e,t)=>e.scope_===t,_9=[];rS={get(e,t){if(t===dr)return e;let n=e.scope_.arrayMethodsPlugin_,r=e.type_===1&&typeof t=="string";if(r&&n?.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);let i=ja(e);if(!dh(i,t,e.type_))return B9(e,i,t);let o=i[t];if(e.finalized_||!si(o)||r&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&R9(t))return o;if(o===jA(e.base_,t)){Qb(e);let s=e.type_===1?+t:t,a=QA(e.scope_,o,e,s);return e.copy_[s]=a}return o},has(e,t){return t in ja(e)},ownKeys(e){return Reflect.ownKeys(ja(e))},set(e,t,n){let r=cV(ja(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){let i=jA(ja(e),t),o=i?.[dr];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(M9(n,i)&&(n!==void 0||dh(e.base_,t,e.type_)))return!0;Qb(e),YA(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),L9(e,t,n)),!0},deleteProperty(e,t){return Qb(e),jA(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),YA(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let n=ja(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{[Yb]:!0,[qA]:e.type_!==1||t!=="length",[Xb]:r[Xb],[hh]:n[t]}},defineProperty(){Tr(11)},getPrototypeOf(e){return Mu(e.base_)},setPrototypeOf(){Tr(12)}},yh={};for(let e in rS){let t=rS[e];yh[e]=function(){let n=arguments;return n[0]=n[0][0],t.apply(this,n)}}yh.deleteProperty=function(e,t){return yh.set.call(this,e,t,void 0)};yh.set=function(e,t,n){return rS.set.call(this,e[0],t,n,e[0])};z9=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(t,n,r)=>{if(Au(t)&&!Au(n)){let o=n;n=t;let s=this;return function(l=o,...c){return s.produce(l,u=>n.call(this,u,...c))}}Au(n)||Tr(6),r!==void 0&&!Au(r)&&Tr(7);let i;if(si(t)){let o=eV(this),s=QA(o,t,void 0),a=!0;try{i=n(s),a=!1}finally{a?KA(o):WA(o)}return J_(o,r),tV(i,o)}else if(!t||!bp(t)){if(i=n(t),i===void 0&&(i=t),i===XA&&(i=void 0),this.autoFreeze_&&To(i,!0),r){let o=[],s=[];Nu(eS).generateReplacementPatches_(t,i,{patches_:o,inversePatches_:s}),r(o,s)}return i}else Tr(1,t)},this.produceWithPatches=(t,n)=>{if(Au(t))return(s,...a)=>this.produceWithPatches(s,l=>t(l,...a));let r,i;return[this.produce(t,n,(s,a)=>{r=s,i=a}),r,i]},$A(e?.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),$A(e?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),$A(e?.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){si(e)||Tr(8),zr(e)&&(e=Ch(e));let t=eV(this),n=QA(t,e,void 0);return n[dr].isManual_=!0,WA(t),n}finishDraft(e,t){let n=e&&e[dr];(!n||!n.isManual_)&&Tr(9);let{scope_:r}=n;return J_(r,t),tV(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){let i=t[n];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}n>-1&&(t=t.slice(n+1));let r=Nu(eS).applyPatches_;return zr(e)?r(e,t):this.produce(e,i=>r(i,t))}};vh=new z9,Wt=vh.produce,JA=vh.produceWithPatches.bind(vh),eM=vh.applyPatches.bind(vh)});var OL=Ae(Ge=>{"use strict";var IM=Symbol.for("react.transitional.element"),A7=Symbol.for("react.portal"),M7=Symbol.for("react.fragment"),R7=Symbol.for("react.strict_mode"),N7=Symbol.for("react.profiler"),D7=Symbol.for("react.consumer"),I7=Symbol.for("react.context"),O7=Symbol.for("react.forward_ref"),P7=Symbol.for("react.suspense"),k7=Symbol.for("react.memo"),AL=Symbol.for("react.lazy"),_7=Symbol.for("react.activity"),xL=Symbol.iterator;function V7(e){return e===null||typeof e!="object"?null:(e=xL&&e[xL]||e["@@iterator"],typeof e=="function"?e:null)}var ML={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},RL=Object.assign,NL={};function Pp(e,t,n){this.props=e,this.context=t,this.refs=NL,this.updater=n||ML}Pp.prototype.isReactComponent={};Pp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Pp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function DL(){}DL.prototype=Pp.prototype;function OM(e,t,n){this.props=e,this.context=t,this.refs=NL,this.updater=n||ML}var PM=OM.prototype=new DL;PM.constructor=OM;RL(PM,Pp.prototype);PM.isPureReactComponent=!0;var EL=Array.isArray;function DM(){}var Jt={H:null,A:null,T:null,S:null},IL=Object.prototype.hasOwnProperty;function kM(e,t,n){var r=n.ref;return{$$typeof:IM,type:e,key:t,ref:r!==void 0?r:null,props:n}}function L7(e,t){return kM(e.type,t,e.props)}function _M(e){return typeof e=="object"&&e!==null&&e.$$typeof===IM}function F7(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var CL=/\/+/g;function NM(e,t){return typeof e=="object"&&e!==null&&e.key!=null?F7(""+e.key):t.toString(36)}function B7(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch(typeof e.status=="string"?e.then(DM,DM):(e.status="pending",e.then(function(t){e.status==="pending"&&(e.status="fulfilled",e.value=t)},function(t){e.status==="pending"&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}function Op(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"bigint":case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case IM:case A7:s=!0;break;case AL:return s=e._init,Op(s(e._payload),t,n,r,i)}}if(s)return i=i(e),s=r===""?"."+NM(e,0):r,EL(i)?(n="",s!=null&&(n=s.replace(CL,"$&/")+"/"),Op(i,t,n,"",function(c){return c})):i!=null&&(_M(i)&&(i=L7(i,n+(i.key==null||e&&e.key===i.key?"":(""+i.key).replace(CL,"$&/")+"/")+s)),t.push(i)),1;s=0;var a=r===""?".":r+":";if(EL(e))for(var l=0;l<e.length;l++)r=e[l],o=a+NM(r,l),s+=Op(r,t,n,o,i);else if(l=V7(e),typeof l=="function")for(e=l.call(e),l=0;!(r=e.next()).done;)r=r.value,o=a+NM(r,l++),s+=Op(r,t,n,o,i);else if(o==="object"){if(typeof e.then=="function")return Op(B7(e),t,n,r,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return s}function QS(e,t,n){if(e==null)return e;var r=[],i=0;return Op(e,r,"","",function(o){return t.call(n,o,i++)}),r}function z7(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var TL=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}console.error(e)},H7={map:QS,forEach:function(e,t,n){QS(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return QS(e,function(){t++}),t},toArray:function(e){return QS(e,function(t){return t})||[]},only:function(e){if(!_M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ge.Activity=_7;Ge.Children=H7;Ge.Component=Pp;Ge.Fragment=M7;Ge.Profiler=N7;Ge.PureComponent=OM;Ge.StrictMode=R7;Ge.Suspense=P7;Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Jt;Ge.__COMPILER_RUNTIME={__proto__:null,c:function(e){return Jt.H.useMemoCache(e)}};Ge.cache=function(e){return function(){return e.apply(null,arguments)}};Ge.cacheSignal=function(){return null};Ge.cloneElement=function(e,t,n){if(e==null)throw Error("The argument must be a React element, but you passed "+e+".");var r=RL({},e.props),i=e.key;if(t!=null)for(o in t.key!==void 0&&(i=""+t.key),t)!IL.call(t,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&t.ref===void 0||(r[o]=t[o]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];r.children=s}return kM(e.type,i,r)};Ge.createContext=function(e){return e={$$typeof:I7,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:D7,_context:e},e};Ge.createElement=function(e,t,n){var r,i={},o=null;if(t!=null)for(r in t.key!==void 0&&(o=""+t.key),t)IL.call(t,r)&&r!=="key"&&r!=="__self"&&r!=="__source"&&(i[r]=t[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return kM(e,o,i)};Ge.createRef=function(){return{current:null}};Ge.forwardRef=function(e){return{$$typeof:O7,render:e}};Ge.isValidElement=_M;Ge.lazy=function(e){return{$$typeof:AL,_payload:{_status:-1,_result:e},_init:z7}};Ge.memo=function(e,t){return{$$typeof:k7,type:e,compare:t===void 0?null:t}};Ge.startTransition=function(e){var t=Jt.T,n={};Jt.T=n;try{var r=e(),i=Jt.S;i!==null&&i(n,r),typeof r=="object"&&r!==null&&typeof r.then=="function"&&r.then(DM,TL)}catch(o){TL(o)}finally{t!==null&&n.types!==null&&(t.types=n.types),Jt.T=t}};Ge.unstable_useCacheRefresh=function(){return Jt.H.useCacheRefresh()};Ge.use=function(e){return Jt.H.use(e)};Ge.useActionState=function(e,t,n){return Jt.H.useActionState(e,t,n)};Ge.useCallback=function(e,t){return Jt.H.useCallback(e,t)};Ge.useContext=function(e){return Jt.H.useContext(e)};Ge.useDebugValue=function(){};Ge.useDeferredValue=function(e,t){return Jt.H.useDeferredValue(e,t)};Ge.useEffect=function(e,t){return Jt.H.useEffect(e,t)};Ge.useEffectEvent=function(e){return Jt.H.useEffectEvent(e)};Ge.useId=function(){return Jt.H.useId()};Ge.useImperativeHandle=function(e,t,n){return Jt.H.useImperativeHandle(e,t,n)};Ge.useInsertionEffect=function(e,t){return Jt.H.useInsertionEffect(e,t)};Ge.useLayoutEffect=function(e,t){return Jt.H.useLayoutEffect(e,t)};Ge.useMemo=function(e,t){return Jt.H.useMemo(e,t)};Ge.useOptimistic=function(e,t){return Jt.H.useOptimistic(e,t)};Ge.useReducer=function(e,t,n){return Jt.H.useReducer(e,t,n)};Ge.useRef=function(e){return Jt.H.useRef(e)};Ge.useState=function(e){return Jt.H.useState(e)};Ge.useSyncExternalStore=function(e,t,n){return Jt.H.useSyncExternalStore(e,t,n)};Ge.useTransition=function(){return Jt.H.useTransition()};Ge.version="19.2.3"});var U=Ae((Wge,PL)=>{"use strict";PL.exports=OL()});var _L=Ae(kL=>{"use strict";var qh=U();function U7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $7=typeof Object.is=="function"?Object.is:U7,j7=qh.useSyncExternalStore,q7=qh.useRef,G7=qh.useEffect,K7=qh.useMemo,W7=qh.useDebugValue;kL.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var o=q7(null);if(o.current===null){var s={hasValue:!1,value:null};o.current=s}else s=o.current;o=K7(function(){function l(d){if(!c){if(c=!0,u=d,d=r(d),i!==void 0&&s.hasValue){var h=s.value;if(i(h,d))return f=h}return f=d}if(h=f,$7(u,d))return h;var m=r(d);return i!==void 0&&i(h,m)?(u=d,h):(u=d,f=m)}var c=!1,u,f,p=n===void 0?null:n;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,n,r,i]);var a=j7(e,o[0],o[1]);return G7(function(){s.hasValue=!0,s.value=a},[a]),W7(a),a}});var LL=Ae((Qge,VL)=>{"use strict";VL.exports=_L()});var QL=Ae((uye,jM)=>{"use strict";var RZ=Object.prototype.hasOwnProperty,ai="~";function Wh(){}Object.create&&(Wh.prototype=Object.create(null),new Wh().__proto__||(ai=!1));function NZ(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function YL(e,t,n,r,i){if(typeof n!="function")throw new TypeError("The listener must be a function");var o=new NZ(n,r||e,i),s=ai?ai+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],o]:e._events[s].push(o):(e._events[s]=o,e._eventsCount++),e}function nw(e,t){--e._eventsCount===0?e._events=new Wh:delete e._events[t]}function $r(){this._events=new Wh,this._eventsCount=0}$r.prototype.eventNames=function(){var t=[],n,r;if(this._eventsCount===0)return t;for(r in n=this._events)RZ.call(n,r)&&t.push(ai?r.slice(1):r);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(n)):t};$r.prototype.listeners=function(t){var n=ai?ai+t:t,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s};$r.prototype.listenerCount=function(t){var n=ai?ai+t:t,r=this._events[n];return r?r.fn?1:r.length:0};$r.prototype.emit=function(t,n,r,i,o,s){var a=ai?ai+t:t;if(!this._events[a])return!1;var l=this._events[a],c=arguments.length,u,f;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,n),!0;case 3:return l.fn.call(l.context,n,r),!0;case 4:return l.fn.call(l.context,n,r,i),!0;case 5:return l.fn.call(l.context,n,r,i,o),!0;case 6:return l.fn.call(l.context,n,r,i,o,s),!0}for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];l.fn.apply(l.context,u)}else{var p=l.length,d;for(f=0;f<p;f++)switch(l[f].once&&this.removeListener(t,l[f].fn,void 0,!0),c){case 1:l[f].fn.call(l[f].context);break;case 2:l[f].fn.call(l[f].context,n);break;case 3:l[f].fn.call(l[f].context,n,r);break;case 4:l[f].fn.call(l[f].context,n,r,i);break;default:if(!u)for(d=1,u=new Array(c-1);d<c;d++)u[d-1]=arguments[d];l[f].fn.apply(l[f].context,u)}}return!0};$r.prototype.on=function(t,n,r){return YL(this,t,n,r,!1)};$r.prototype.once=function(t,n,r){return YL(this,t,n,r,!0)};$r.prototype.removeListener=function(t,n,r,i){var o=ai?ai+t:t;if(!this._events[o])return this;if(!n)return nw(this,o),this;var s=this._events[o];if(s.fn)s.fn===n&&(!i||s.once)&&(!r||s.context===r)&&nw(this,o);else{for(var a=0,l=[],c=s.length;a<c;a++)(s[a].fn!==n||i&&!s[a].once||r&&s[a].context!==r)&&l.push(s[a]);l.length?this._events[o]=l.length===1?l[0]:l:nw(this,o)}return this};$r.prototype.removeAllListeners=function(t){var n;return t?(n=ai?ai+t:t,this._events[n]&&nw(this,n)):(this._events=new Wh,this._eventsCount=0),this};$r.prototype.off=$r.prototype.removeListener;$r.prototype.addListener=$r.prototype.on;$r.prefixed=ai;$r.EventEmitter=$r;typeof jM<"u"&&(jM.exports=$r)});var rH=Ae(pn=>{"use strict";function WN(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(0<Jx(i,t))e[r]=t,e[n]=i,n=r;else break e}}function va(e){return e.length===0?null:e[0]}function t0(e){if(e.length===0)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,a=e[s],l=s+1,c=e[l];if(0>Jx(a,n))l<i&&0>Jx(c,a)?(e[r]=c,e[l]=n,r=l):(e[r]=a,e[s]=n,r=s);else if(l<i&&0>Jx(c,n))e[r]=c,e[l]=n,r=l;else break e}}return t}function Jx(e,t){var n=e.sortIndex-t.sortIndex;return n!==0?n:e.id-t.id}pn.unstable_now=void 0;typeof performance=="object"&&typeof performance.now=="function"?(Wz=performance,pn.unstable_now=function(){return Wz.now()}):(qN=Date,Yz=qN.now(),pn.unstable_now=function(){return qN.now()-Yz});var Wz,qN,Yz,fl=[],wc=[],tte=1,_o=null,Kr=3,YN=!1,ey=!1,ty=!1,QN=!1,Zz=typeof setTimeout=="function"?setTimeout:null,Jz=typeof clearTimeout=="function"?clearTimeout:null,Qz=typeof setImmediate<"u"?setImmediate:null;function e0(e){for(var t=va(wc);t!==null;){if(t.callback===null)t0(wc);else if(t.startTime<=e)t0(wc),t.sortIndex=t.expirationTime,WN(fl,t);else break;t=va(wc)}}function XN(e){if(ty=!1,e0(e),!ey)if(va(fl)!==null)ey=!0,vd||(vd=!0,yd());else{var t=va(wc);t!==null&&ZN(XN,t.startTime-e)}}var vd=!1,ny=-1,eH=5,tH=-1;function nH(){return QN?!0:!(pn.unstable_now()-tH<eH)}function GN(){if(QN=!1,vd){var e=pn.unstable_now();tH=e;var t=!0;try{e:{ey=!1,ty&&(ty=!1,Jz(ny),ny=-1),YN=!0;var n=Kr;try{t:{for(e0(e),_o=va(fl);_o!==null&&!(_o.expirationTime>e&&nH());){var r=_o.callback;if(typeof r=="function"){_o.callback=null,Kr=_o.priorityLevel;var i=r(_o.expirationTime<=e);if(e=pn.unstable_now(),typeof i=="function"){_o.callback=i,e0(e),t=!0;break t}_o===va(fl)&&t0(fl),e0(e)}else t0(fl);_o=va(fl)}if(_o!==null)t=!0;else{var o=va(wc);o!==null&&ZN(XN,o.startTime-e),t=!1}}break e}finally{_o=null,Kr=n,YN=!1}t=void 0}}finally{t?yd():vd=!1}}}var yd;typeof Qz=="function"?yd=function(){Qz(GN)}:typeof MessageChannel<"u"?(KN=new MessageChannel,Xz=KN.port2,KN.port1.onmessage=GN,yd=function(){Xz.postMessage(null)}):yd=function(){Zz(GN,0)};var KN,Xz;function ZN(e,t){ny=Zz(function(){e(pn.unstable_now())},t)}pn.unstable_IdlePriority=5;pn.unstable_ImmediatePriority=1;pn.unstable_LowPriority=4;pn.unstable_NormalPriority=3;pn.unstable_Profiling=null;pn.unstable_UserBlockingPriority=2;pn.unstable_cancelCallback=function(e){e.callback=null};pn.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):eH=0<e?Math.floor(1e3/e):5};pn.unstable_getCurrentPriorityLevel=function(){return Kr};pn.unstable_next=function(e){switch(Kr){case 1:case 2:case 3:var t=3;break;default:t=Kr}var n=Kr;Kr=t;try{return e()}finally{Kr=n}};pn.unstable_requestPaint=function(){QN=!0};pn.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=Kr;Kr=e;try{return t()}finally{Kr=n}};pn.unstable_scheduleCallback=function(e,t,n){var r=pn.unstable_now();switch(typeof n=="object"&&n!==null?(n=n.delay,n=typeof n=="number"&&0<n?r+n:r):n=r,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=n+i,e={id:tte++,callback:t,priorityLevel:e,startTime:n,expirationTime:i,sortIndex:-1},n>r?(e.sortIndex=n,WN(wc,e),va(fl)===null&&e===va(wc)&&(ty?(Jz(ny),ny=-1):ty=!0,ZN(XN,n-r))):(e.sortIndex=i,WN(fl,e),ey||YN||(ey=!0,vd||(vd=!0,yd()))),e};pn.unstable_shouldYield=nH;pn.unstable_wrapCallback=function(e){var t=Kr;return function(){var n=Kr;Kr=t;try{return e.apply(this,arguments)}finally{Kr=n}}}});var oH=Ae((Gke,iH)=>{"use strict";iH.exports=rH()});var aH=Ae(fi=>{"use strict";var nte=U();function sH(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function xc(){}var ui={d:{f:xc,r:function(){throw Error(sH(522))},D:xc,C:xc,L:xc,m:xc,X:xc,S:xc,M:xc},p:0,findDOMNode:null},rte=Symbol.for("react.portal");function ite(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rte,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}var ry=nte.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function n0(e,t){if(e==="font")return"";if(typeof t=="string")return t==="use-credentials"?t:""}fi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ui;fi.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(sH(299));return ite(e,t,null,n)};fi.flushSync=function(e){var t=ry.T,n=ui.p;try{if(ry.T=null,ui.p=2,e)return e()}finally{ry.T=t,ui.p=n,ui.d.f()}};fi.preconnect=function(e,t){typeof e=="string"&&(t?(t=t.crossOrigin,t=typeof t=="string"?t==="use-credentials"?t:"":void 0):t=null,ui.d.C(e,t))};fi.prefetchDNS=function(e){typeof e=="string"&&ui.d.D(e)};fi.preinit=function(e,t){if(typeof e=="string"&&t&&typeof t.as=="string"){var n=t.as,r=n0(n,t.crossOrigin),i=typeof t.integrity=="string"?t.integrity:void 0,o=typeof t.fetchPriority=="string"?t.fetchPriority:void 0;n==="style"?ui.d.S(e,typeof t.precedence=="string"?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):n==="script"&&ui.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:typeof t.nonce=="string"?t.nonce:void 0})}};fi.preinitModule=function(e,t){if(typeof e=="string")if(typeof t=="object"&&t!==null){if(t.as==null||t.as==="script"){var n=n0(t.as,t.crossOrigin);ui.d.M(e,{crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0})}}else t==null&&ui.d.M(e)};fi.preload=function(e,t){if(typeof e=="string"&&typeof t=="object"&&t!==null&&typeof t.as=="string"){var n=t.as,r=n0(n,t.crossOrigin);ui.d.L(e,n,{crossOrigin:r,integrity:typeof t.integrity=="string"?t.integrity:void 0,nonce:typeof t.nonce=="string"?t.nonce:void 0,type:typeof t.type=="string"?t.type:void 0,fetchPriority:typeof t.fetchPriority=="string"?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy=="string"?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet=="string"?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes=="string"?t.imageSizes:void 0,media:typeof t.media=="string"?t.media:void 0})}};fi.preloadModule=function(e,t){if(typeof e=="string")if(t){var n=n0(t.as,t.crossOrigin);ui.d.m(e,{as:typeof t.as=="string"&&t.as!=="script"?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity=="string"?t.integrity:void 0})}else ui.d.m(e)};fi.requestFormReset=function(e){ui.d.r(e)};fi.unstable_batchedUpdates=function(e,t){return e(t)};fi.useFormState=function(e,t,n){return ry.H.useFormState(e,t,n)};fi.useFormStatus=function(){return ry.H.useHostTransitionStatus()};fi.version="19.2.3"});var ef=Ae((Wke,cH)=>{"use strict";function lH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lH)}catch(e){console.error(e)}}lH(),cH.exports=aH()});var wj=Ae(ME=>{"use strict";var ir=oH(),_2=U(),ote=ef();function W(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function V2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $y(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function L2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function F2(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function uH(e){if($y(e)!==e)throw Error(W(188))}function ste(e){var t=e.alternate;if(!t){if(t=$y(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return uH(i),e;if(o===r)return uH(i),t;o=o.sibling}throw Error(W(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function B2(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=B2(e),t!==null)return t;e=e.sibling}return null}var nn=Object.assign,ate=Symbol.for("react.element"),r0=Symbol.for("react.transitional.element"),fy=Symbol.for("react.portal"),Cd=Symbol.for("react.fragment"),z2=Symbol.for("react.strict_mode"),OD=Symbol.for("react.profiler"),H2=Symbol.for("react.consumer"),bl=Symbol.for("react.context"),MI=Symbol.for("react.forward_ref"),PD=Symbol.for("react.suspense"),kD=Symbol.for("react.suspense_list"),RI=Symbol.for("react.memo"),Ec=Symbol.for("react.lazy"),_D=Symbol.for("react.activity"),lte=Symbol.for("react.memo_cache_sentinel"),fH=Symbol.iterator;function iy(e){return e===null||typeof e!="object"?null:(e=fH&&e[fH]||e["@@iterator"],typeof e=="function"?e:null)}var cte=Symbol.for("react.client.reference");function VD(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===cte?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cd:return"Fragment";case OD:return"Profiler";case z2:return"StrictMode";case PD:return"Suspense";case kD:return"SuspenseList";case _D:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case fy:return"Portal";case bl:return e.displayName||"Context";case H2:return(e._context.displayName||"Context")+".Consumer";case MI:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case RI:return t=e.displayName||null,t!==null?t:VD(e.type)||"Memo";case Ec:t=e._payload,e=e._init;try{return VD(e(t))}catch{}}return null}var py=Array.isArray,Be=_2.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Nt=ote.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,af={pending:!1,data:null,method:null,action:null},LD=[],Td=-1;function Ea(e){return{current:e}}function br(e){0>Td||(e.current=LD[Td],LD[Td]=null,Td--)}function Xt(e,t){Td++,LD[Td]=e.current,e.current=t}var xa=Ea(null),Ny=Ea(null),kc=Ea(null),V0=Ea(null);function L0(e,t){switch(Xt(kc,t),Xt(Ny,e),Xt(xa,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?v2(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=v2(t),e=aj(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}br(xa),Xt(xa,e)}function $d(){br(xa),br(Ny),br(kc)}function FD(e){e.memoizedState!==null&&Xt(V0,e);var t=xa.current,n=aj(t,e.type);t!==n&&(Xt(Ny,e),Xt(xa,n))}function F0(e){Ny.current===e&&(br(xa),br(Ny)),V0.current===e&&(br(V0),zy._currentValue=af)}var JN,pH;function nf(e){if(JN===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);JN=t&&t[1]||"",pH=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+JN+e+pH}var eD=!1;function tD(e,t){if(!e||eD)return"";eD=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(d){var p=d}Reflect.construct(e,[],f)}else{try{f.call()}catch(d){p=d}e.call(f.prototype)}}else{try{throw Error()}catch(d){p=d}(f=e())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(d){if(d&&p&&typeof d.stack=="string")return[d.stack,p.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var l=s.split(`
`),c=a.split(`
`);for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(r!==1||i!==1)do if(r--,i--,0>i||l[r]!==c[i]){var u=`
`+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=r&&0<=i);break}}}finally{eD=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?nf(n):""}function ute(e,t){switch(e.tag){case 26:case 27:case 5:return nf(e.type);case 16:return nf("Lazy");case 13:return e.child!==t&&t!==null?nf("Suspense Fallback"):nf("Suspense");case 19:return nf("SuspenseList");case 0:case 15:return tD(e.type,!1);case 11:return tD(e.type.render,!1);case 1:return tD(e.type,!0);case 31:return nf("Activity");default:return""}}function dH(e){try{var t="",n=null;do t+=ute(e,n),n=e,e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var BD=Object.prototype.hasOwnProperty,NI=ir.unstable_scheduleCallback,nD=ir.unstable_cancelCallback,fte=ir.unstable_shouldYield,pte=ir.unstable_requestPaint,uo=ir.unstable_now,dte=ir.unstable_getCurrentPriorityLevel,U2=ir.unstable_ImmediatePriority,$2=ir.unstable_UserBlockingPriority,B0=ir.unstable_NormalPriority,mte=ir.unstable_LowPriority,j2=ir.unstable_IdlePriority,hte=ir.log,gte=ir.unstable_setDisableYieldValue,jy=null,fo=null;function Nc(e){if(typeof hte=="function"&&gte(e),fo&&typeof fo.setStrictMode=="function")try{fo.setStrictMode(jy,e)}catch{}}var po=Math.clz32?Math.clz32:bte,yte=Math.log,vte=Math.LN2;function bte(e){return e>>>=0,e===0?32:31-(yte(e)/vte|0)|0}var i0=256,o0=262144,s0=4194304;function rf(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function fE(e,t,n){var r=e.pendingLanes;if(r===0)return 0;var i=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var a=r&134217727;return a!==0?(r=a&~o,r!==0?i=rf(r):(s&=a,s!==0?i=rf(s):n||(n=a&~e,n!==0&&(i=rf(n))))):(a=r&~o,a!==0?i=rf(a):s!==0?i=rf(s):n||(n=r&~e,n!==0&&(i=rf(n)))),i===0?0:t!==0&&t!==i&&(t&o)===0&&(o=i&-i,n=t&-t,o>=n||o===32&&(n&4194048)!==0)?t:i}function qy(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ste(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q2(){var e=s0;return s0<<=1,(s0&62914560)===0&&(s0=4194304),e}function rD(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Gy(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function wte(e,t,n,r,i,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-po(n),f=1<<u;a[u]=0,l[u]=-1;var p=c[u];if(p!==null)for(c[u]=null,u=0;u<p.length;u++){var d=p[u];d!==null&&(d.lane&=-536870913)}n&=~f}r!==0&&G2(e,r,0),o!==0&&i===0&&e.tag!==0&&(e.suspendedLanes|=o&~(s&~t))}function G2(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-po(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|n&261930}function K2(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-po(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function W2(e,t){var n=t&-t;return n=(n&42)!==0?1:DI(n),(n&(e.suspendedLanes|t))!==0?0:n}function DI(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function II(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Y2(){var e=Nt.p;return e!==0?e:(e=window.event,e===void 0?32:vj(e.type))}function mH(e,t){var n=Nt.p;try{return Nt.p=e,t()}finally{Nt.p=n}}var Kc=Math.random().toString(36).slice(2),Ir="__reactFiber$"+Kc,Li="__reactProps$"+Kc,em="__reactContainer$"+Kc,zD="__reactEvents$"+Kc,xte="__reactListeners$"+Kc,Ete="__reactHandles$"+Kc,hH="__reactResources$"+Kc,Ky="__reactMarker$"+Kc;function OI(e){delete e[Ir],delete e[Li],delete e[zD],delete e[xte],delete e[Ete]}function Ad(e){var t=e[Ir];if(t)return t;for(var n=e.parentNode;n;){if(t=n[em]||n[Ir]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=E2(e);e!==null;){if(n=e[Ir])return n;e=E2(e)}return t}e=n,n=e.parentNode}return null}function tm(e){if(e=e[Ir]||e[em]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function dy(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(W(33))}function Vd(e){var t=e[hH];return t||(t=e[hH]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function vr(e){e[Ky]=!0}var Q2=new Set,X2={};function yf(e,t){jd(e,t),jd(e+"Capture",t)}function jd(e,t){for(X2[e]=t,e=0;e<t.length;e++)Q2.add(t[e])}var Cte=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gH={},yH={};function Tte(e){return BD.call(yH,e)?!0:BD.call(gH,e)?!1:Cte.test(e)?yH[e]=!0:(gH[e]=!0,!1)}function w0(e,t,n){if(Tte(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function a0(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function pl(e,t,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+r)}}function Lo(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Z2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ate(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function HD(e){if(!e._valueTracker){var t=Z2(e)?"checked":"value";e._valueTracker=Ate(e,t,""+e[t])}}function J2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Z2(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function z0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Mte=/[\n"\\]/g;function zo(e){return e.replace(Mte,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function UD(e,t,n,r,i,o,s,a){e.name="",s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"?e.type=s:e.removeAttribute("type"),t!=null?s==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Lo(t)):e.value!==""+Lo(t)&&(e.value=""+Lo(t)):s!=="submit"&&s!=="reset"||e.removeAttribute("value"),t!=null?$D(e,s,Lo(t)):n!=null?$D(e,s,Lo(n)):r!=null&&e.removeAttribute("value"),i==null&&o!=null&&(e.defaultChecked=!!o),i!=null&&(e.checked=i&&typeof i!="function"&&typeof i!="symbol"),a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?e.name=""+Lo(a):e.removeAttribute("name")}function eU(e,t,n,r,i,o,s,a){if(o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(e.type=o),t!=null||n!=null){if(!(o!=="submit"&&o!=="reset"||t!=null)){HD(e);return}n=n!=null?""+Lo(n):"",t=t!=null?""+Lo(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r=r??i,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(e.name=s),HD(e)}function $D(e,t,n){t==="number"&&z0(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ld(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Lo(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function tU(e,t,n){if(t!=null&&(t=""+Lo(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Lo(n):""}function nU(e,t,n,r){if(t==null){if(r!=null){if(n!=null)throw Error(W(92));if(py(r)){if(1<r.length)throw Error(W(93));r=r[0]}n=r}n==null&&(n=""),t=n}n=Lo(t),e.defaultValue=n,r=e.textContent,r===n&&r!==""&&r!==null&&(e.value=r),HD(e)}function qd(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Rte=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function vH(e,t,n){var r=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?r?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":r?e.setProperty(t,n):typeof n!="number"||n===0||Rte.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function rU(e,t,n){if(t!=null&&typeof t!="object")throw Error(W(62));if(e=e.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&vH(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&vH(e,o,t[o])}function PI(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nte=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Dte=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function x0(e){return Dte.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Sl(){}var jD=null;function kI(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Md=null,Fd=null;function bH(e){var t=tm(e);if(t&&(e=t.stateNode)){var n=e[Li]||null;e:switch(e=t.stateNode,t.type){case"input":if(UD(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+zo(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Li]||null;if(!i)throw Error(W(90));UD(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)r=n[t],r.form===e.form&&J2(r)}break e;case"textarea":tU(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Ld(e,!!n.multiple,t,!1)}}}var iD=!1;function iU(e,t,n){if(iD)return e(t,n);iD=!0;try{var r=e(t);return r}finally{if(iD=!1,(Md!==null||Fd!==null)&&(EE(),Md&&(t=Md,e=Fd,Fd=Md=null,bH(t),e)))for(t=0;t<e.length;t++)bH(e[t])}}function Dy(e,t){var n=e.stateNode;if(n===null)return null;var r=n[Li]||null;if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var Tl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qD=!1;if(Tl)try{bd={},Object.defineProperty(bd,"passive",{get:function(){qD=!0}}),window.addEventListener("test",bd,bd),window.removeEventListener("test",bd,bd)}catch{qD=!1}var bd,Dc=null,_I=null,E0=null;function oU(){if(E0)return E0;var e,t=_I,n=t.length,r,i="value"in Dc?Dc.value:Dc.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return E0=i.slice(e,1<r?1-r:void 0)}function C0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function l0(){return!0}function SH(){return!1}function Fi(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?l0:SH,this.isPropagationStopped=SH,this}return nn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=l0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=l0)},persist:function(){},isPersistent:l0}),t}var vf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pE=Fi(vf),Wy=nn({},vf,{view:0,detail:0}),Ite=Fi(Wy),oD,sD,oy,dE=nn({},Wy,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:VI,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oy&&(oy&&e.type==="mousemove"?(oD=e.screenX-oy.screenX,sD=e.screenY-oy.screenY):sD=oD=0,oy=e),oD)},movementY:function(e){return"movementY"in e?e.movementY:sD}}),wH=Fi(dE),Ote=nn({},dE,{dataTransfer:0}),Pte=Fi(Ote),kte=nn({},Wy,{relatedTarget:0}),aD=Fi(kte),_te=nn({},vf,{animationName:0,elapsedTime:0,pseudoElement:0}),Vte=Fi(_te),Lte=nn({},vf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Fte=Fi(Lte),Bte=nn({},vf,{data:0}),xH=Fi(Bte),zte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ute={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $te(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ute[e])?!!t[e]:!1}function VI(){return $te}var jte=nn({},Wy,{key:function(e){if(e.key){var t=zte[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=C0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Hte[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:VI,charCode:function(e){return e.type==="keypress"?C0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?C0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),qte=Fi(jte),Gte=nn({},dE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),EH=Fi(Gte),Kte=nn({},Wy,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:VI}),Wte=Fi(Kte),Yte=nn({},vf,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qte=Fi(Yte),Xte=nn({},dE,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zte=Fi(Xte),Jte=nn({},vf,{newState:0,oldState:0}),ene=Fi(Jte),tne=[9,13,27,32],LI=Tl&&"CompositionEvent"in window,gy=null;Tl&&"documentMode"in document&&(gy=document.documentMode);var nne=Tl&&"TextEvent"in window&&!gy,sU=Tl&&(!LI||gy&&8<gy&&11>=gy),CH=" ",TH=!1;function aU(e,t){switch(e){case"keyup":return tne.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lU(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rd=!1;function rne(e,t){switch(e){case"compositionend":return lU(t);case"keypress":return t.which!==32?null:(TH=!0,CH);case"textInput":return e=t.data,e===CH&&TH?null:e;default:return null}}function ine(e,t){if(Rd)return e==="compositionend"||!LI&&aU(e,t)?(e=oU(),E0=_I=Dc=null,Rd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sU&&t.locale!=="ko"?null:t.data;default:return null}}var one={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function AH(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!one[e.type]:t==="textarea"}function cU(e,t,n,r){Md?Fd?Fd.push(r):Fd=[r]:Md=r,t=iE(t,"onChange"),0<t.length&&(n=new pE("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var yy=null,Iy=null;function sne(e){ij(e,0)}function mE(e){var t=dy(e);if(J2(t))return e}function MH(e,t){if(e==="change")return t}var uU=!1;Tl&&(Tl?(u0="oninput"in document,u0||(lD=document.createElement("div"),lD.setAttribute("oninput","return;"),u0=typeof lD.oninput=="function"),c0=u0):c0=!1,uU=c0&&(!document.documentMode||9<document.documentMode));var c0,u0,lD;function RH(){yy&&(yy.detachEvent("onpropertychange",fU),Iy=yy=null)}function fU(e){if(e.propertyName==="value"&&mE(Iy)){var t=[];cU(t,Iy,e,kI(e)),iU(sne,t)}}function ane(e,t,n){e==="focusin"?(RH(),yy=t,Iy=n,yy.attachEvent("onpropertychange",fU)):e==="focusout"&&RH()}function lne(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return mE(Iy)}function cne(e,t){if(e==="click")return mE(t)}function une(e,t){if(e==="input"||e==="change")return mE(t)}function fne(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ho=typeof Object.is=="function"?Object.is:fne;function Oy(e,t){if(ho(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!BD.call(t,i)||!ho(e[i],t[i]))return!1}return!0}function NH(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function DH(e,t){var n=NH(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=NH(n)}}function pU(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?pU(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function dU(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=z0(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=z0(e.document)}return t}function FI(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var pne=Tl&&"documentMode"in document&&11>=document.documentMode,Nd=null,GD=null,vy=null,KD=!1;function IH(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;KD||Nd==null||Nd!==z0(r)||(r=Nd,"selectionStart"in r&&FI(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vy&&Oy(vy,r)||(vy=r,r=iE(GD,"onSelect"),0<r.length&&(t=new pE("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Nd)))}function tf(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Dd={animationend:tf("Animation","AnimationEnd"),animationiteration:tf("Animation","AnimationIteration"),animationstart:tf("Animation","AnimationStart"),transitionrun:tf("Transition","TransitionRun"),transitionstart:tf("Transition","TransitionStart"),transitioncancel:tf("Transition","TransitionCancel"),transitionend:tf("Transition","TransitionEnd")},cD={},mU={};Tl&&(mU=document.createElement("div").style,"AnimationEvent"in window||(delete Dd.animationend.animation,delete Dd.animationiteration.animation,delete Dd.animationstart.animation),"TransitionEvent"in window||delete Dd.transitionend.transition);function bf(e){if(cD[e])return cD[e];if(!Dd[e])return e;var t=Dd[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in mU)return cD[e]=t[n];return e}var hU=bf("animationend"),gU=bf("animationiteration"),yU=bf("animationstart"),dne=bf("transitionrun"),mne=bf("transitionstart"),hne=bf("transitioncancel"),vU=bf("transitionend"),bU=new Map,WD="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");WD.push("scrollEnd");function Ps(e,t){bU.set(e,t),yf(t,[e])}var H0=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}console.error(e)},Vo=[],Id=0,BI=0;function hE(){for(var e=Id,t=BI=Id=0;t<e;){var n=Vo[t];Vo[t++]=null;var r=Vo[t];Vo[t++]=null;var i=Vo[t];Vo[t++]=null;var o=Vo[t];if(Vo[t++]=null,r!==null&&i!==null){var s=r.pending;s===null?i.next=i:(i.next=s.next,s.next=i),r.pending=i}o!==0&&SU(n,i,o)}}function gE(e,t,n,r){Vo[Id++]=e,Vo[Id++]=t,Vo[Id++]=n,Vo[Id++]=r,BI|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function zI(e,t,n,r){return gE(e,t,n,r),U0(e)}function Sf(e,t){return gE(e,null,null,t),U0(e)}function SU(e,t,n){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n);for(var i=!1,o=e.return;o!==null;)o.childLanes|=n,r=o.alternate,r!==null&&(r.childLanes|=n),o.tag===22&&(e=o.stateNode,e===null||e._visibility&1||(i=!0)),e=o,o=o.return;return e.tag===3?(o=e.stateNode,i&&t!==null&&(i=31-po(n),e=o.hiddenUpdates,r=e[i],r===null?e[i]=[t]:r.push(t),t.lane=n|536870912),o):null}function U0(e){if(50<My)throw My=0,hI=null,Error(W(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Od={};function gne(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(e,t,n,r){return new gne(e,t,n,r)}function HI(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xl(e,t){var n=e.alternate;return n===null?(n=lo(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function wU(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function T0(e,t,n,r,i,o){var s=0;if(r=e,typeof e=="function")HI(e)&&(s=1);else if(typeof e=="string")s=bre(e,n,xa.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case _D:return e=lo(31,n,t,i),e.elementType=_D,e.lanes=o,e;case Cd:return lf(n.children,i,o,t);case z2:s=8,i|=24;break;case OD:return e=lo(12,n,t,i|2),e.elementType=OD,e.lanes=o,e;case PD:return e=lo(13,n,t,i),e.elementType=PD,e.lanes=o,e;case kD:return e=lo(19,n,t,i),e.elementType=kD,e.lanes=o,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case bl:s=10;break e;case H2:s=9;break e;case MI:s=11;break e;case RI:s=14;break e;case Ec:s=16,r=null;break e}s=29,n=Error(W(130,e===null?"null":typeof e,"")),r=null}return t=lo(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function lf(e,t,n,r){return e=lo(7,e,r,t),e.lanes=n,e}function uD(e,t,n){return e=lo(6,e,null,t),e.lanes=n,e}function xU(e){var t=lo(18,null,null,0);return t.stateNode=e,t}function fD(e,t,n){return t=lo(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var OH=new WeakMap;function Ho(e,t){if(typeof e=="object"&&e!==null){var n=OH.get(e);return n!==void 0?n:(t={value:e,source:t,stack:dH(t)},OH.set(e,t),t)}return{value:e,source:t,stack:dH(t)}}var Pd=[],kd=0,$0=null,Py=0,Fo=[],Bo=0,$c=null,ba=1,Sa="";function yl(e,t){Pd[kd++]=Py,Pd[kd++]=$0,$0=e,Py=t}function EU(e,t,n){Fo[Bo++]=ba,Fo[Bo++]=Sa,Fo[Bo++]=$c,$c=e;var r=ba;e=Sa;var i=32-po(r)-1;r&=~(1<<i),n+=1;var o=32-po(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ba=1<<32-po(t)+i|n<<i|r,Sa=o+e}else ba=1<<o|n<<i|r,Sa=e}function UI(e){e.return!==null&&(yl(e,1),EU(e,1,0))}function $I(e){for(;e===$0;)$0=Pd[--kd],Pd[kd]=null,Py=Pd[--kd],Pd[kd]=null;for(;e===$c;)$c=Fo[--Bo],Fo[Bo]=null,Sa=Fo[--Bo],Fo[Bo]=null,ba=Fo[--Bo],Fo[Bo]=null}function CU(e,t){Fo[Bo++]=ba,Fo[Bo++]=Sa,Fo[Bo++]=$c,ba=t.id,Sa=t.overflow,$c=e}var Or=null,tn=null,bt=!1,_c=null,Uo=!1,YD=Error(W(519));function jc(e){var t=Error(W(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ky(Ho(t,e)),YD}function PH(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ir]=e,t[Li]=r,n){case"dialog":lt("cancel",t),lt("close",t);break;case"iframe":case"object":case"embed":lt("load",t);break;case"video":case"audio":for(n=0;n<Fy.length;n++)lt(Fy[n],t);break;case"source":lt("error",t);break;case"img":case"image":case"link":lt("error",t),lt("load",t);break;case"details":lt("toggle",t);break;case"input":lt("invalid",t),eU(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":lt("invalid",t);break;case"textarea":lt("invalid",t),nU(t,r.value,r.defaultValue,r.children)}n=r.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||r.suppressHydrationWarning===!0||sj(t.textContent,n)?(r.popover!=null&&(lt("beforetoggle",t),lt("toggle",t)),r.onScroll!=null&&lt("scroll",t),r.onScrollEnd!=null&&lt("scrollend",t),r.onClick!=null&&(t.onclick=Sl),t=!0):t=!1,t||jc(e,!0)}function kH(e){for(Or=e.return;Or;)switch(Or.tag){case 5:case 31:case 13:Uo=!1;return;case 27:case 3:Uo=!0;return;default:Or=Or.return}}function Sd(e){if(e!==Or)return!1;if(!bt)return kH(e),bt=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||SI(e.type,e.memoizedProps)),n=!n),n&&tn&&jc(e),kH(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));tn=x2(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));tn=x2(e)}else t===27?(t=tn,Wc(e.type)?(e=CI,CI=null,tn=e):tn=t):tn=Or?jo(e.stateNode.nextSibling):null;return!0}function pf(){tn=Or=null,bt=!1}function pD(){var e=_c;return e!==null&&(_i===null?_i=e:_i.push.apply(_i,e),_c=null),e}function ky(e){_c===null?_c=[e]:_c.push(e)}var QD=Ea(null),wf=null,wl=null;function Tc(e,t,n){Xt(QD,t._currentValue),t._currentValue=n}function El(e){e._currentValue=QD.current,br(QD)}function XD(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ZD(e,t,n,r){var i=e.child;for(i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){var s=i.child;o=o.firstContext;e:for(;o!==null;){var a=o;o=i;for(var l=0;l<t.length;l++)if(a.context===t[l]){o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),XD(o.return,n,e),r||(s=null);break e}o=a.next}}else if(i.tag===18){if(s=i.return,s===null)throw Error(W(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),XD(s,n,e),s=null}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}}function nm(e,t,n,r){e=null;for(var i=t,o=!1;i!==null;){if(!o){if((i.flags&524288)!==0)o=!0;else if((i.flags&262144)!==0)break}if(i.tag===10){var s=i.alternate;if(s===null)throw Error(W(387));if(s=s.memoizedProps,s!==null){var a=i.type;ho(i.pendingProps.value,s.value)||(e!==null?e.push(a):e=[a])}}else if(i===V0.current){if(s=i.alternate,s===null)throw Error(W(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(e!==null?e.push(zy):e=[zy])}i=i.return}e!==null&&ZD(t,e,n,r),t.flags|=262144}function j0(e){for(e=e.firstContext;e!==null;){if(!ho(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function df(e){wf=e,wl=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Pr(e){return TU(wf,e)}function f0(e,t){return wf===null&&df(e),TU(e,t)}function TU(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},wl===null){if(e===null)throw Error(W(308));wl=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else wl=wl.next=t;return n}var yne=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},vne=ir.unstable_scheduleCallback,bne=ir.unstable_NormalPriority,qn={$$typeof:bl,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jI(){return{controller:new yne,data:new Map,refCount:0}}function Yy(e){e.refCount--,e.refCount===0&&vne(bne,function(){e.controller.abort()})}var by=null,JD=0,Gd=0,Bd=null;function Sne(e,t){if(by===null){var n=by=[];JD=0,Gd=hO(),Bd={status:"pending",value:void 0,then:function(r){n.push(r)}}}return JD++,t.then(_H,_H),t}function _H(){if(--JD===0&&by!==null){Bd!==null&&(Bd.status="fulfilled");var e=by;by=null,Gd=0,Bd=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function wne(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(i){n.push(i)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var i=0;i<n.length;i++)(0,n[i])(t)},function(i){for(r.status="rejected",r.reason=i,i=0;i<n.length;i++)(0,n[i])(void 0)}),r}var VH=Be.S;Be.S=function(e,t){B$=uo(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Sne(e,t),VH!==null&&VH(e,t)};var cf=Ea(null);function qI(){var e=cf.current;return e!==null?e:jt.pooledCache}function A0(e,t){t===null?Xt(cf,cf.current):Xt(cf,t.pool)}function AU(){var e=qI();return e===null?null:{parent:qn._currentValue,pool:e}}var rm=Error(W(460)),GI=Error(W(474)),yE=Error(W(542)),q0={then:function(){}};function LH(e){return e=e.status,e==="fulfilled"||e==="rejected"}function MU(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Sl,Sl),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,BH(e),e;default:if(typeof t.status=="string")t.then(Sl,Sl);else{if(e=jt,e!==null&&100<e.shellSuspendCounter)throw Error(W(482));e=t,e.status="pending",e.then(function(r){if(t.status==="pending"){var i=t;i.status="fulfilled",i.value=r}},function(r){if(t.status==="pending"){var i=t;i.status="rejected",i.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,BH(e),e}throw uf=t,rm}}function of(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(uf=n,rm):n}}var uf=null;function FH(){if(uf===null)throw Error(W(459));var e=uf;return uf=null,e}function BH(e){if(e===rm||e===yE)throw Error(W(483))}var zd=null,_y=0;function p0(e){var t=_y;return _y+=1,zd===null&&(zd=[]),MU(zd,e,t)}function sy(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function d0(e,t){throw t.$$typeof===ate?Error(W(525)):(e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function RU(e){function t(g,y){if(e){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function n(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function r(g){for(var y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function i(g,y){return g=xl(g,y),g.index=0,g.sibling=null,g}function o(g,y,b){return g.index=b,e?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=67108866,y):b):(g.flags|=67108866,y)):(g.flags|=1048576,y)}function s(g){return e&&g.alternate===null&&(g.flags|=67108866),g}function a(g,y,b,w){return y===null||y.tag!==6?(y=uD(b,g.mode,w),y.return=g,y):(y=i(y,b),y.return=g,y)}function l(g,y,b,w){var S=b.type;return S===Cd?u(g,y,b.props.children,w,b.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ec&&of(S)===y.type)?(y=i(y,b.props),sy(y,b),y.return=g,y):(y=T0(b.type,b.key,b.props,null,g.mode,w),sy(y,b),y.return=g,y)}function c(g,y,b,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=fD(b,g.mode,w),y.return=g,y):(y=i(y,b.children||[]),y.return=g,y)}function u(g,y,b,w,S){return y===null||y.tag!==7?(y=lf(b,g.mode,w,S),y.return=g,y):(y=i(y,b),y.return=g,y)}function f(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number"||typeof y=="bigint")return y=uD(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case r0:return b=T0(y.type,y.key,y.props,null,g.mode,b),sy(b,y),b.return=g,b;case fy:return y=fD(y,g.mode,b),y.return=g,y;case Ec:return y=of(y),f(g,y,b)}if(py(y)||iy(y))return y=lf(y,g.mode,b,null),y.return=g,y;if(typeof y.then=="function")return f(g,p0(y),b);if(y.$$typeof===bl)return f(g,f0(g,y),b);d0(g,y)}return null}function p(g,y,b,w){var S=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return S!==null?null:a(g,y,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case r0:return b.key===S?l(g,y,b,w):null;case fy:return b.key===S?c(g,y,b,w):null;case Ec:return b=of(b),p(g,y,b,w)}if(py(b)||iy(b))return S!==null?null:u(g,y,b,w,null);if(typeof b.then=="function")return p(g,y,p0(b),w);if(b.$$typeof===bl)return p(g,y,f0(g,b),w);d0(g,b)}return null}function d(g,y,b,w,S){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return g=g.get(b)||null,a(y,g,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case r0:return g=g.get(w.key===null?b:w.key)||null,l(y,g,w,S);case fy:return g=g.get(w.key===null?b:w.key)||null,c(y,g,w,S);case Ec:return w=of(w),d(g,y,b,w,S)}if(py(w)||iy(w))return g=g.get(b)||null,u(y,g,w,S,null);if(typeof w.then=="function")return d(g,y,b,p0(w),S);if(w.$$typeof===bl)return d(g,y,b,f0(y,w),S);d0(y,w)}return null}function h(g,y,b,w){for(var S=null,C=null,x=y,E=y=0,T=null;x!==null&&E<b.length;E++){x.index>E?(T=x,x=null):T=x.sibling;var A=p(g,x,b[E],w);if(A===null){x===null&&(x=T);break}e&&x&&A.alternate===null&&t(g,x),y=o(A,y,E),C===null?S=A:C.sibling=A,C=A,x=T}if(E===b.length)return n(g,x),bt&&yl(g,E),S;if(x===null){for(;E<b.length;E++)x=f(g,b[E],w),x!==null&&(y=o(x,y,E),C===null?S=x:C.sibling=x,C=x);return bt&&yl(g,E),S}for(x=r(x);E<b.length;E++)T=d(x,g,E,b[E],w),T!==null&&(e&&T.alternate!==null&&x.delete(T.key===null?E:T.key),y=o(T,y,E),C===null?S=T:C.sibling=T,C=T);return e&&x.forEach(function(M){return t(g,M)}),bt&&yl(g,E),S}function m(g,y,b,w){if(b==null)throw Error(W(151));for(var S=null,C=null,x=y,E=y=0,T=null,A=b.next();x!==null&&!A.done;E++,A=b.next()){x.index>E?(T=x,x=null):T=x.sibling;var M=p(g,x,A.value,w);if(M===null){x===null&&(x=T);break}e&&x&&M.alternate===null&&t(g,x),y=o(M,y,E),C===null?S=M:C.sibling=M,C=M,x=T}if(A.done)return n(g,x),bt&&yl(g,E),S;if(x===null){for(;!A.done;E++,A=b.next())A=f(g,A.value,w),A!==null&&(y=o(A,y,E),C===null?S=A:C.sibling=A,C=A);return bt&&yl(g,E),S}for(x=r(x);!A.done;E++,A=b.next())A=d(x,g,E,A.value,w),A!==null&&(e&&A.alternate!==null&&x.delete(A.key===null?E:A.key),y=o(A,y,E),C===null?S=A:C.sibling=A,C=A);return e&&x.forEach(function(R){return t(g,R)}),bt&&yl(g,E),S}function v(g,y,b,w){if(typeof b=="object"&&b!==null&&b.type===Cd&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case r0:e:{for(var S=b.key;y!==null;){if(y.key===S){if(S=b.type,S===Cd){if(y.tag===7){n(g,y.sibling),w=i(y,b.props.children),w.return=g,g=w;break e}}else if(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ec&&of(S)===y.type){n(g,y.sibling),w=i(y,b.props),sy(w,b),w.return=g,g=w;break e}n(g,y);break}else t(g,y);y=y.sibling}b.type===Cd?(w=lf(b.props.children,g.mode,w,b.key),w.return=g,g=w):(w=T0(b.type,b.key,b.props,null,g.mode,w),sy(w,b),w.return=g,g=w)}return s(g);case fy:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(g,y.sibling),w=i(y,b.children||[]),w.return=g,g=w;break e}else{n(g,y);break}else t(g,y);y=y.sibling}w=fD(b,g.mode,w),w.return=g,g=w}return s(g);case Ec:return b=of(b),v(g,y,b,w)}if(py(b))return h(g,y,b,w);if(iy(b)){if(S=iy(b),typeof S!="function")throw Error(W(150));return b=S.call(b),m(g,y,b,w)}if(typeof b.then=="function")return v(g,y,p0(b),w);if(b.$$typeof===bl)return v(g,y,f0(g,b),w);d0(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint"?(b=""+b,y!==null&&y.tag===6?(n(g,y.sibling),w=i(y,b),w.return=g,g=w):(n(g,y),w=uD(b,g.mode,w),w.return=g,g=w),s(g)):n(g,y)}return function(g,y,b,w){try{_y=0;var S=v(g,y,b,w);return zd=null,S}catch(x){if(x===rm||x===yE)throw x;var C=lo(29,x,null,g.mode);return C.lanes=w,C.return=g,C}}}var mf=RU(!0),NU=RU(!1),Cc=!1;function KI(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function eI(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Vc(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Lc(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(Rt&2)!==0){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=U0(e),SU(e,null,n),t}return gE(e,r,t,n),U0(e)}function Sy(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,K2(e,n)}}function dD(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var tI=!1;function wy(){if(tI){var e=Bd;if(e!==null)throw e}}function xy(e,t,n,r){tI=!1;var i=e.updateQueue;Cc=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var f=i.baseState;s=0,u=c=l=null,a=o;do{var p=a.lane&-536870913,d=p!==a.lane;if(d?(ht&p)===p:(r&p)===p){p!==0&&p===Gd&&(tI=!0),u!==null&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var h=e,m=a;p=t;var v=n;switch(m.tag){case 1:if(h=m.payload,typeof h=="function"){f=h.call(v,f,p);break e}f=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=m.payload,p=typeof h=="function"?h.call(v,f,p):h,p==null)break e;f=nn({},f,p);break e;case 2:Cc=!0}}p=a.callback,p!==null&&(e.flags|=64,d&&(e.flags|=8192),d=i.callbacks,d===null?i.callbacks=[p]:d.push(p))}else d={lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,s|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,o===null&&(i.shared.lanes=0),Gc|=s,e.lanes=s,e.memoizedState=f}}function DU(e,t){if(typeof e!="function")throw Error(W(191,e));e.call(t)}function IU(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)DU(n[e],t)}var Kd=Ea(null),G0=Ea(0);function zH(e,t){e=Nl,Xt(G0,e),Xt(Kd,t),Nl=e|t.baseLanes}function nI(){Xt(G0,Nl),Xt(Kd,Kd.current)}function WI(){Nl=G0.current,br(Kd),br(G0)}var go=Ea(null),$o=null;function Ac(e){var t=e.alternate;Xt(Ln,Ln.current&1),Xt(go,e),$o===null&&(t===null||Kd.current!==null||t.memoizedState!==null)&&($o=e)}function rI(e){Xt(Ln,Ln.current),Xt(go,e),$o===null&&($o=e)}function OU(e){e.tag===22?(Xt(Ln,Ln.current),Xt(go,e),$o===null&&($o=e)):Mc(e)}function Mc(){Xt(Ln,Ln.current),Xt(go,go.current)}function ao(e){br(go),$o===e&&($o=null),br(Ln)}var Ln=Ea(0);function K0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||xI(n)||EI(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Al=0,Ye=null,Bt=null,$n=null,W0=!1,Hd=!1,hf=!1,Y0=0,Vy=0,Ud=null,xne=0;function Pn(){throw Error(W(321))}function YI(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ho(e[n],t[n]))return!1;return!0}function QI(e,t,n,r,i,o){return Al=o,Ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Be.H=e===null||e.memoizedState===null?c$:aO,hf=!1,o=n(r,i),hf=!1,Hd&&(o=kU(t,n,r,i)),PU(e),o}function PU(e){Be.H=Ly;var t=Bt!==null&&Bt.next!==null;if(Al=0,$n=Bt=Ye=null,W0=!1,Vy=0,Ud=null,t)throw Error(W(300));e===null||Gn||(e=e.dependencies,e!==null&&j0(e)&&(Gn=!0))}function kU(e,t,n,r){Ye=e;var i=0;do{if(Hd&&(Ud=null),Vy=0,Hd=!1,25<=i)throw Error(W(301));if(i+=1,$n=Bt=null,e.updateQueue!=null){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}Be.H=u$,o=t(n,r)}while(Hd);return o}function Ene(){var e=Be.H,t=e.useState()[0];return t=typeof t.then=="function"?Qy(t):t,e=e.useState()[0],(Bt!==null?Bt.memoizedState:null)!==e&&(Ye.flags|=1024),t}function XI(){var e=Y0!==0;return Y0=0,e}function ZI(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function JI(e){if(W0){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}W0=!1}Al=0,$n=Bt=Ye=null,Hd=!1,Vy=Y0=0,Ud=null}function pi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $n===null?Ye.memoizedState=$n=e:$n=$n.next=e,$n}function Fn(){if(Bt===null){var e=Ye.alternate;e=e!==null?e.memoizedState:null}else e=Bt.next;var t=$n===null?Ye.memoizedState:$n.next;if(t!==null)$n=t,Bt=e;else{if(e===null)throw Ye.alternate===null?Error(W(467)):Error(W(310));Bt=e,e={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},$n===null?Ye.memoizedState=$n=e:$n=$n.next=e}return $n}function vE(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qy(e){var t=Vy;return Vy+=1,Ud===null&&(Ud=[]),e=MU(Ud,e,t),t=Ye,($n===null?t.memoizedState:$n.next)===null&&(t=t.alternate,Be.H=t===null||t.memoizedState===null?c$:aO),e}function bE(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Qy(e);if(e.$$typeof===bl)return Pr(e)}throw Error(W(438,String(e)))}function eO(e){var t=null,n=Ye.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var r=Ye.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(i){return i.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=vE(),Ye.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=lte;return t.index++,n}function Ml(e,t){return typeof t=="function"?t(e):t}function M0(e){var t=Fn();return tO(t,Bt,e)}function tO(e,t,n){var r=e.queue;if(r===null)throw Error(W(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,i===null)e.memoizedState=o;else{t=i.next;var a=s=null,l=null,c=t,u=!1;do{var f=c.lane&-536870913;if(f!==c.lane?(ht&f)===f:(Al&f)===f){var p=c.revertLane;if(p===0)l!==null&&(l=l.next={lane:0,revertLane:0,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),f===Gd&&(u=!0);else if((Al&p)===p){c=c.next,p===Gd&&(u=!0);continue}else f={lane:0,revertLane:c.revertLane,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=f,s=o):l=l.next=f,Ye.lanes|=p,Gc|=p;f=c.action,hf&&n(o,f),o=c.hasEagerState?c.eagerState:n(o,f)}else p={lane:f,revertLane:c.revertLane,gesture:c.gesture,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(a=l=p,s=o):l=l.next=p,Ye.lanes|=f,Gc|=f;c=c.next}while(c!==null&&c!==t);if(l===null?s=o:l.next=a,!ho(o,e.memoizedState)&&(Gn=!0,u&&(n=Bd,n!==null)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,r.lastRenderedState=o}return i===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function mD(e){var t=Fn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);ho(o,t.memoizedState)||(Gn=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function _U(e,t,n){var r=Ye,i=Fn(),o=bt;if(o){if(n===void 0)throw Error(W(407));n=n()}else n=t();var s=!ho((Bt||i).memoizedState,n);if(s&&(i.memoizedState=n,Gn=!0),i=i.queue,nO(FU.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||$n!==null&&$n.memoizedState.tag&1){if(r.flags|=2048,Wd(9,{destroy:void 0},LU.bind(null,r,i,n,t),null),jt===null)throw Error(W(349));o||(Al&127)!==0||VU(r,t,n)}return n}function VU(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ye.updateQueue,t===null?(t=vE(),Ye.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function LU(e,t,n,r){t.value=n,t.getSnapshot=r,BU(t)&&zU(e)}function FU(e,t,n){return n(function(){BU(t)&&zU(e)})}function BU(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ho(e,n)}catch{return!0}}function zU(e){var t=Sf(e,2);t!==null&&Vi(t,e,2)}function iI(e){var t=pi();if(typeof e=="function"){var n=e;if(e=n(),hf){Nc(!0);try{n()}finally{Nc(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ml,lastRenderedState:e},t}function HU(e,t,n,r){return e.baseState=n,tO(e,Bt,typeof r=="function"?r:Ml)}function Cne(e,t,n,r,i){if(wE(e))throw Error(W(485));if(e=t.action,e!==null){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(s){o.listeners.push(s)}};Be.T!==null?n(!0):o.isTransition=!1,r(o),n=t.pending,n===null?(o.next=t.pending=o,UU(t,o)):(o.next=n.next,t.pending=n.next=o)}}function UU(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=Be.T,s={};Be.T=s;try{var a=n(i,r),l=Be.S;l!==null&&l(s,a),HH(e,t,a)}catch(c){oI(e,t,c)}finally{o!==null&&s.types!==null&&(o.types=s.types),Be.T=o}}else try{o=n(i,r),HH(e,t,o)}catch(c){oI(e,t,c)}}function HH(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(r){UH(e,t,r)},function(r){return oI(e,t,r)}):UH(e,t,n)}function UH(e,t,n){t.status="fulfilled",t.value=n,$U(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,UU(e,n)))}function oI(e,t,n){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=n,$U(t),t=t.next;while(t!==r)}e.action=null}function $U(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function jU(e,t){return t}function $H(e,t){if(bt){var n=jt.formState;if(n!==null){e:{var r=Ye;if(bt){if(tn){t:{for(var i=tn,o=Uo;i.nodeType!==8;){if(!o){i=null;break t}if(i=jo(i.nextSibling),i===null){i=null;break t}}o=i.data,i=o==="F!"||o==="F"?i:null}if(i){tn=jo(i.nextSibling),r=i.data==="F!";break e}}jc(r)}r=!1}r&&(t=n[0])}}return n=pi(),n.memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jU,lastRenderedState:t},n.queue=r,n=s$.bind(null,Ye,r),r.dispatch=n,r=iI(!1),o=sO.bind(null,Ye,!1,r.queue),r=pi(),i={state:t,dispatch:null,action:e,pending:null},r.queue=i,n=Cne.bind(null,Ye,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function jH(e){var t=Fn();return qU(t,Bt,e)}function qU(e,t,n){if(t=tO(e,t,jU)[0],e=M0(Ml)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=Qy(t)}catch(s){throw s===rm?yE:s}else r=t;t=Fn();var i=t.queue,o=i.dispatch;return n!==t.memoizedState&&(Ye.flags|=2048,Wd(9,{destroy:void 0},Tne.bind(null,i,n),null)),[r,o,e]}function Tne(e,t){e.action=t}function qH(e){var t=Fn(),n=Bt;if(n!==null)return qU(t,n,e);Fn(),t=t.memoizedState,n=Fn();var r=n.queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Wd(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},t=Ye.updateQueue,t===null&&(t=vE(),Ye.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function GU(){return Fn().memoizedState}function R0(e,t,n,r){var i=pi();Ye.flags|=e,i.memoizedState=Wd(1|t,{destroy:void 0},n,r===void 0?null:r)}function SE(e,t,n,r){var i=Fn();r=r===void 0?null:r;var o=i.memoizedState.inst;Bt!==null&&r!==null&&YI(r,Bt.memoizedState.deps)?i.memoizedState=Wd(t,o,n,r):(Ye.flags|=e,i.memoizedState=Wd(1|t,o,n,r))}function GH(e,t){R0(8390656,8,e,t)}function nO(e,t){SE(2048,8,e,t)}function Ane(e){Ye.flags|=4;var t=Ye.updateQueue;if(t===null)t=vE(),Ye.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function KU(e){var t=Fn().memoizedState;return Ane({ref:t,nextImpl:e}),function(){if((Rt&2)!==0)throw Error(W(440));return t.impl.apply(void 0,arguments)}}function WU(e,t){return SE(4,2,e,t)}function YU(e,t){return SE(4,4,e,t)}function QU(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function XU(e,t,n){n=n!=null?n.concat([e]):null,SE(4,4,QU.bind(null,t,e),n)}function rO(){}function ZU(e,t){var n=Fn();t=t===void 0?null:t;var r=n.memoizedState;return t!==null&&YI(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function JU(e,t){var n=Fn();t=t===void 0?null:t;var r=n.memoizedState;if(t!==null&&YI(t,r[1]))return r[0];if(r=e(),hf){Nc(!0);try{e()}finally{Nc(!1)}}return n.memoizedState=[r,t],r}function iO(e,t,n){return n===void 0||(Al&1073741824)!==0&&(ht&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=H$(),Ye.lanes|=e,Gc|=e,n)}function e$(e,t,n,r){return ho(n,t)?n:Kd.current!==null?(e=iO(e,n,r),ho(e,t)||(Gn=!0),e):(Al&42)===0||(Al&1073741824)!==0&&(ht&261930)===0?(Gn=!0,e.memoizedState=n):(e=H$(),Ye.lanes|=e,Gc|=e,t)}function t$(e,t,n,r,i){var o=Nt.p;Nt.p=o!==0&&8>o?o:8;var s=Be.T,a={};Be.T=a,sO(e,!1,t,n);try{var l=i(),c=Be.S;if(c!==null&&c(a,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=wne(l,r);Ey(e,t,u,mo(e))}else Ey(e,t,r,mo(e))}catch(f){Ey(e,t,{then:function(){},status:"rejected",reason:f},mo())}finally{Nt.p=o,s!==null&&a.types!==null&&(s.types=a.types),Be.T=s}}function Mne(){}function sI(e,t,n,r){if(e.tag!==5)throw Error(W(476));var i=n$(e).queue;t$(e,i,t,af,n===null?Mne:function(){return r$(e),n(r)})}function n$(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:af,baseState:af,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ml,lastRenderedState:af},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ml,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function r$(e){var t=n$(e);t.next===null&&(t=e.alternate.memoizedState),Ey(e,t.next.queue,{},mo())}function oO(){return Pr(zy)}function i$(){return Fn().memoizedState}function o$(){return Fn().memoizedState}function Rne(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=mo();e=Vc(n);var r=Lc(t,e,n);r!==null&&(Vi(r,t,n),Sy(r,t,n)),t={cache:jI()},e.payload=t;return}t=t.return}}function Nne(e,t,n){var r=mo();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},wE(e)?a$(t,n):(n=zI(e,t,n,r),n!==null&&(Vi(n,e,r),l$(n,t,r)))}function s$(e,t,n){var r=mo();Ey(e,t,n,r)}function Ey(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(wE(e))a$(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,ho(a,s))return gE(e,t,i,0),jt===null&&hE(),!1}catch{}if(n=zI(e,t,i,r),n!==null)return Vi(n,e,r),l$(n,t,r),!0}return!1}function sO(e,t,n,r){if(r={lane:2,revertLane:hO(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},wE(e)){if(t)throw Error(W(479))}else t=zI(e,n,r,2),t!==null&&Vi(t,e,2)}function wE(e){var t=e.alternate;return e===Ye||t!==null&&t===Ye}function a$(e,t){Hd=W0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function l$(e,t,n){if((n&4194048)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,K2(e,n)}}var Ly={readContext:Pr,use:bE,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useLayoutEffect:Pn,useInsertionEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useSyncExternalStore:Pn,useId:Pn,useHostTransitionStatus:Pn,useFormState:Pn,useActionState:Pn,useOptimistic:Pn,useMemoCache:Pn,useCacheRefresh:Pn};Ly.useEffectEvent=Pn;var c$={readContext:Pr,use:bE,useCallback:function(e,t){return pi().memoizedState=[e,t===void 0?null:t],e},useContext:Pr,useEffect:GH,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,R0(4194308,4,QU.bind(null,t,e),n)},useLayoutEffect:function(e,t){return R0(4194308,4,e,t)},useInsertionEffect:function(e,t){R0(4,2,e,t)},useMemo:function(e,t){var n=pi();t=t===void 0?null:t;var r=e();if(hf){Nc(!0);try{e()}finally{Nc(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=pi();if(n!==void 0){var i=n(t);if(hf){Nc(!0);try{n(t)}finally{Nc(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=Nne.bind(null,Ye,e),[r.memoizedState,e]},useRef:function(e){var t=pi();return e={current:e},t.memoizedState=e},useState:function(e){e=iI(e);var t=e.queue,n=s$.bind(null,Ye,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:rO,useDeferredValue:function(e,t){var n=pi();return iO(n,e,t)},useTransition:function(){var e=iI(!1);return e=t$.bind(null,Ye,e.queue,!0,!1),pi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ye,i=pi();if(bt){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),jt===null)throw Error(W(349));(ht&127)!==0||VU(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,GH(FU.bind(null,r,o,e),[e]),r.flags|=2048,Wd(9,{destroy:void 0},LU.bind(null,r,o,n,t),null),n},useId:function(){var e=pi(),t=jt.identifierPrefix;if(bt){var n=Sa,r=ba;n=(r&~(1<<32-po(r)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Y0++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=xne++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:oO,useFormState:$H,useActionState:$H,useOptimistic:function(e){var t=pi();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=sO.bind(null,Ye,!0,n),n.dispatch=t,[e,t]},useMemoCache:eO,useCacheRefresh:function(){return pi().memoizedState=Rne.bind(null,Ye)},useEffectEvent:function(e){var t=pi(),n={impl:e};return t.memoizedState=n,function(){if((Rt&2)!==0)throw Error(W(440));return n.impl.apply(void 0,arguments)}}},aO={readContext:Pr,use:bE,useCallback:ZU,useContext:Pr,useEffect:nO,useImperativeHandle:XU,useInsertionEffect:WU,useLayoutEffect:YU,useMemo:JU,useReducer:M0,useRef:GU,useState:function(){return M0(Ml)},useDebugValue:rO,useDeferredValue:function(e,t){var n=Fn();return e$(n,Bt.memoizedState,e,t)},useTransition:function(){var e=M0(Ml)[0],t=Fn().memoizedState;return[typeof e=="boolean"?e:Qy(e),t]},useSyncExternalStore:_U,useId:i$,useHostTransitionStatus:oO,useFormState:jH,useActionState:jH,useOptimistic:function(e,t){var n=Fn();return HU(n,Bt,e,t)},useMemoCache:eO,useCacheRefresh:o$};aO.useEffectEvent=KU;var u$={readContext:Pr,use:bE,useCallback:ZU,useContext:Pr,useEffect:nO,useImperativeHandle:XU,useInsertionEffect:WU,useLayoutEffect:YU,useMemo:JU,useReducer:mD,useRef:GU,useState:function(){return mD(Ml)},useDebugValue:rO,useDeferredValue:function(e,t){var n=Fn();return Bt===null?iO(n,e,t):e$(n,Bt.memoizedState,e,t)},useTransition:function(){var e=mD(Ml)[0],t=Fn().memoizedState;return[typeof e=="boolean"?e:Qy(e),t]},useSyncExternalStore:_U,useId:i$,useHostTransitionStatus:oO,useFormState:qH,useActionState:qH,useOptimistic:function(e,t){var n=Fn();return Bt!==null?HU(n,Bt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:eO,useCacheRefresh:o$};u$.useEffectEvent=KU;function hD(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:nn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var aI={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=mo(),i=Vc(r);i.payload=t,n!=null&&(i.callback=n),t=Lc(e,i,r),t!==null&&(Vi(t,e,r),Sy(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=mo(),i=Vc(r);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Lc(e,i,r),t!==null&&(Vi(t,e,r),Sy(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=mo(),r=Vc(n);r.tag=2,t!=null&&(r.callback=t),t=Lc(e,r,n),t!==null&&(Vi(t,e,n),Sy(t,e,n))}};function KH(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Oy(n,r)||!Oy(i,o):!0}function WH(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&aI.enqueueReplaceState(t,t.state,null)}function gf(e,t){var n=t;if("ref"in t){n={};for(var r in t)r!=="ref"&&(n[r]=t[r])}if(e=e.defaultProps){n===t&&(n=nn({},n));for(var i in e)n[i]===void 0&&(n[i]=e[i])}return n}function f$(e){H0(e)}function p$(e){console.error(e)}function d$(e){H0(e)}function Q0(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function YH(e,t,n){try{var r=e.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function lI(e,t,n){return n=Vc(n),n.tag=3,n.payload={element:null},n.callback=function(){Q0(e,t)},n}function m$(e){return e=Vc(e),e.tag=3,e}function h$(e,t,n,r){var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){YH(t,n,r)}}var s=n.stateNode;s!==null&&typeof s.componentDidCatch=="function"&&(e.callback=function(){YH(t,n,r),typeof i!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var a=r.stack;this.componentDidCatch(r.value,{componentStack:a!==null?a:""})})}function Dne(e,t,n,r,i){if(n.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=n.alternate,t!==null&&nm(t,n,i,!0),n=go.current,n!==null){switch(n.tag){case 31:case 13:return $o===null?tE():n.alternate===null&&kn===0&&(kn=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===q0?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([r]):t.add(r),AD(e,r,i)),!1;case 22:return n.flags|=65536,r===q0?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([r]):n.add(r)),AD(e,r,i)),!1}throw Error(W(435,n.tag))}return AD(e,r,i),tE(),!1}if(bt)return t=go.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==YD&&(e=Error(W(422),{cause:r}),ky(Ho(e,n)))):(r!==YD&&(t=Error(W(423),{cause:r}),ky(Ho(t,n))),e=e.current.alternate,e.flags|=65536,i&=-i,e.lanes|=i,r=Ho(r,n),i=lI(e.stateNode,r,i),dD(e,i),kn!==4&&(kn=2)),!1;var o=Error(W(520),{cause:r});if(o=Ho(o,n),Ay===null?Ay=[o]:Ay.push(o),kn!==4&&(kn=2),t===null)return!0;r=Ho(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,e=lI(n.stateNode,r,e),dD(n,e),!1;case 1:if(t=n.type,o=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||o!==null&&typeof o.componentDidCatch=="function"&&(Fc===null||!Fc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,i=m$(i),h$(i,e,n,r),dD(n,i),!1}n=n.return}while(n!==null);return!1}var lO=Error(W(461)),Gn=!1;function Dr(e,t,n,r){t.child=e===null?NU(t,null,n,r):mf(t,e.child,n,r)}function QH(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var s={};for(var a in r)a!=="ref"&&(s[a]=r[a])}else s=r;return df(t),r=QI(e,t,n,s,o,i),a=XI(),e!==null&&!Gn?(ZI(e,t,i),Rl(e,t,i)):(bt&&a&&UI(t),t.flags|=1,Dr(e,t,r,i),t.child)}function XH(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!HI(o)&&o.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=o,g$(e,t,o,r,i)):(e=T0(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!cO(e,i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Oy,n(s,r)&&e.ref===t.ref)return Rl(e,t,i)}return t.flags|=1,e=xl(o,r),e.ref=t.ref,e.return=t,t.child=e}function g$(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Oy(o,r)&&e.ref===t.ref)if(Gn=!1,t.pendingProps=r=o,cO(e,i))(e.flags&131072)!==0&&(Gn=!0);else return t.lanes=e.lanes,Rl(e,t,i)}return cI(e,t,n,r,i)}function y$(e,t,n,r){var i=r.children,o=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(o=o!==null?o.baseLanes|n:n,e!==null){for(r=t.child=e.child,i=0;r!==null;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~o}else r=0,t.child=null;return ZH(e,t,o,n,r)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&A0(t,o!==null?o.cachePool:null),o!==null?zH(t,o):nI(),OU(t);else return r=t.lanes=536870912,ZH(e,t,o!==null?o.baseLanes|n:n,n,r)}else o!==null?(A0(t,o.cachePool),zH(t,o),Mc(t),t.memoizedState=null):(e!==null&&A0(t,null),nI(),Mc(t));return Dr(e,t,i,n),t.child}function my(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function ZH(e,t,n,r,i){var o=qI();return o=o===null?null:{parent:qn._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},e!==null&&A0(t,null),nI(),OU(t),e!==null&&nm(e,t,r,!0),t.childLanes=i,null}function N0(e,t){return t=X0({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function JH(e,t,n){return mf(t,e.child,null,n),e=N0(t,t.pendingProps),e.flags|=2,ao(t),t.memoizedState=null,e}function Ine(e,t,n){var r=t.pendingProps,i=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(bt){if(r.mode==="hidden")return e=N0(t,r),t.lanes=536870912,my(null,e);if(rI(t),(e=tn)?(e=cj(e,Uo),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:$c!==null?{id:ba,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},n=xU(e),n.return=t,t.child=n,Or=t,tn=null)):e=null,e===null)throw jc(t);return t.lanes=536870912,null}return N0(t,r)}var o=e.memoizedState;if(o!==null){var s=o.dehydrated;if(rI(t),i)if(t.flags&256)t.flags&=-257,t=JH(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(W(558));else if(Gn||nm(e,t,n,!1),i=(n&e.childLanes)!==0,Gn||i){if(r=jt,r!==null&&(s=W2(r,n),s!==0&&s!==o.retryLane))throw o.retryLane=s,Sf(e,s),Vi(r,e,s),lO;tE(),t=JH(e,t,n)}else e=o.treeContext,tn=jo(s.nextSibling),Or=t,bt=!0,_c=null,Uo=!1,e!==null&&CU(t,e),t=N0(t,r),t.flags|=4096;return t}return e=xl(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function D0(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(W(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function cI(e,t,n,r,i){return df(t),n=QI(e,t,n,r,void 0,i),r=XI(),e!==null&&!Gn?(ZI(e,t,i),Rl(e,t,i)):(bt&&r&&UI(t),t.flags|=1,Dr(e,t,n,i),t.child)}function e2(e,t,n,r,i,o){return df(t),t.updateQueue=null,n=kU(t,r,n,i),PU(e),r=XI(),e!==null&&!Gn?(ZI(e,t,o),Rl(e,t,o)):(bt&&r&&UI(t),t.flags|=1,Dr(e,t,n,o),t.child)}function t2(e,t,n,r,i){if(df(t),t.stateNode===null){var o=Od,s=n.contextType;typeof s=="object"&&s!==null&&(o=Pr(s)),o=new n(r,o),t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=aI,t.stateNode=o,o._reactInternals=t,o=t.stateNode,o.props=r,o.state=t.memoizedState,o.refs={},KI(t),s=n.contextType,o.context=typeof s=="object"&&s!==null?Pr(s):Od,o.state=t.memoizedState,s=n.getDerivedStateFromProps,typeof s=="function"&&(hD(t,n,s,r),o.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(s=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),s!==o.state&&aI.enqueueReplaceState(o,o.state,null),xy(t,r,o,i),wy(),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(e===null){o=t.stateNode;var a=t.memoizedProps,l=gf(n,a);o.props=l;var c=o.context,u=n.contextType;s=Od,typeof u=="object"&&u!==null&&(s=Pr(u));var f=n.getDerivedStateFromProps;u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function",a=t.pendingProps!==a,u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a||c!==s)&&WH(t,o,r,s),Cc=!1;var p=t.memoizedState;o.state=p,xy(t,r,o,i),wy(),c=t.memoizedState,a||p!==c||Cc?(typeof f=="function"&&(hD(t,n,f,r),c=t.memoizedState),(l=Cc||KH(t,n,l,r,p,c,s))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=s,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,eI(e,t),s=t.memoizedProps,u=gf(n,s),o.props=u,f=t.pendingProps,p=o.context,c=n.contextType,l=Od,typeof c=="object"&&c!==null&&(l=Pr(c)),a=n.getDerivedStateFromProps,(c=typeof a=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==f||p!==l)&&WH(t,o,r,l),Cc=!1,p=t.memoizedState,o.state=p,xy(t,r,o,i),wy();var d=t.memoizedState;s!==f||p!==d||Cc||e!==null&&e.dependencies!==null&&j0(e.dependencies)?(typeof a=="function"&&(hD(t,n,a,r),d=t.memoizedState),(u=Cc||KH(t,n,u,r,p,d,l)||e!==null&&e.dependencies!==null&&j0(e.dependencies))?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,d,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,d,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),o.props=r,o.state=d,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,D0(e,t),r=(t.flags&128)!==0,o||r?(o=t.stateNode,n=r&&typeof n.getDerivedStateFromError!="function"?null:o.render(),t.flags|=1,e!==null&&r?(t.child=mf(t,e.child,null,i),t.child=mf(t,null,n,i)):Dr(e,t,n,i),t.memoizedState=o.state,e=t.child):e=Rl(e,t,i),e}function n2(e,t,n,r){return pf(),t.flags|=256,Dr(e,t,n,r),t.child}var gD={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function yD(e){return{baseLanes:e,cachePool:AU()}}function vD(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=co),e}function v$(e,t,n){var r=t.pendingProps,i=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(Ln.current&2)!==0),s&&(i=!0,t.flags&=-129),s=(t.flags&32)!==0,t.flags&=-33,e===null){if(bt){if(i?Ac(t):Mc(t),(e=tn)?(e=cj(e,Uo),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:$c!==null?{id:ba,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},n=xU(e),n.return=t,t.child=n,Or=t,tn=null)):e=null,e===null)throw jc(t);return EI(e)?t.lanes=32:t.lanes=536870912,null}var a=r.children;return r=r.fallback,i?(Mc(t),i=t.mode,a=X0({mode:"hidden",children:a},i),r=lf(r,i,n,null),a.return=t,r.return=t,a.sibling=r,t.child=a,r=t.child,r.memoizedState=yD(n),r.childLanes=vD(e,s,n),t.memoizedState=gD,my(null,r)):(Ac(t),uI(t,a))}var l=e.memoizedState;if(l!==null&&(a=l.dehydrated,a!==null)){if(o)t.flags&256?(Ac(t),t.flags&=-257,t=bD(e,t,n)):t.memoizedState!==null?(Mc(t),t.child=e.child,t.flags|=128,t=null):(Mc(t),a=r.fallback,i=t.mode,r=X0({mode:"visible",children:r.children},i),a=lf(a,i,n,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,mf(t,e.child,null,n),r=t.child,r.memoizedState=yD(n),r.childLanes=vD(e,s,n),t.memoizedState=gD,t=my(null,r));else if(Ac(t),EI(a)){if(s=a.nextSibling&&a.nextSibling.dataset,s)var c=s.dgst;s=c,r=Error(W(419)),r.stack="",r.digest=s,ky({value:r,source:null,stack:null}),t=bD(e,t,n)}else if(Gn||nm(e,t,n,!1),s=(n&e.childLanes)!==0,Gn||s){if(s=jt,s!==null&&(r=W2(s,n),r!==0&&r!==l.retryLane))throw l.retryLane=r,Sf(e,r),Vi(s,e,r),lO;xI(a)||tE(),t=bD(e,t,n)}else xI(a)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,tn=jo(a.nextSibling),Or=t,bt=!0,_c=null,Uo=!1,e!==null&&CU(t,e),t=uI(t,r.children),t.flags|=4096);return t}return i?(Mc(t),a=r.fallback,i=t.mode,l=e.child,c=l.sibling,r=xl(l,{mode:"hidden",children:r.children}),r.subtreeFlags=l.subtreeFlags&65011712,c!==null?a=xl(c,a):(a=lf(a,i,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,my(null,r),r=t.child,a=e.child.memoizedState,a===null?a=yD(n):(i=a.cachePool,i!==null?(l=qn._currentValue,i=i.parent!==l?{parent:l,pool:l}:i):i=AU(),a={baseLanes:a.baseLanes|n,cachePool:i}),r.memoizedState=a,r.childLanes=vD(e,s,n),t.memoizedState=gD,my(e.child,r)):(Ac(t),n=e.child,e=n.sibling,n=xl(n,{mode:"visible",children:r.children}),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function uI(e,t){return t=X0({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function X0(e,t){return e=lo(22,e,null,t),e.lanes=0,e}function bD(e,t,n){return mf(t,e.child,null,n),e=uI(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function r2(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),XD(e.return,t,n)}function SD(e,t,n,r,i,o){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.treeForkCount=o)}function b$(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;r=r.children;var s=Ln.current,a=(s&2)!==0;if(a?(s=s&1|2,t.flags|=128):s&=1,Xt(Ln,s),Dr(e,t,r,n),r=bt?Py:0,!a&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&r2(e,n,t);else if(e.tag===19)r2(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&K0(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),SD(t,!1,i,n,o,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&K0(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}SD(t,!0,n,null,o,r);break;case"together":SD(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function Rl(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Gc|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(nm(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=xl(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=xl(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cO(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&j0(e)))}function One(e,t,n){switch(t.tag){case 3:L0(t,t.stateNode.containerInfo),Tc(t,qn,e.memoizedState.cache),pf();break;case 27:case 5:FD(t);break;case 4:L0(t,t.stateNode.containerInfo);break;case 10:Tc(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,rI(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(Ac(t),t.flags|=128,null):(n&t.child.childLanes)!==0?v$(e,t,n):(Ac(t),e=Rl(e,t,n),e!==null?e.sibling:null);Ac(t);break;case 19:var i=(e.flags&128)!==0;if(r=(n&t.childLanes)!==0,r||(nm(e,t,n,!1),r=(n&t.childLanes)!==0),i){if(r)return b$(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xt(Ln,Ln.current),r)break;return null;case 22:return t.lanes=0,y$(e,t,n,t.pendingProps);case 24:Tc(t,qn,e.memoizedState.cache)}return Rl(e,t,n)}function S$(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Gn=!0;else{if(!cO(e,n)&&(t.flags&128)===0)return Gn=!1,One(e,t,n);Gn=(e.flags&131072)!==0}else Gn=!1,bt&&(t.flags&1048576)!==0&&EU(t,Py,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=of(t.elementType),t.type=e,typeof e=="function")HI(e)?(r=gf(e,r),t.tag=1,t=t2(null,t,e,r,n)):(t.tag=0,t=cI(null,t,e,r,n));else{if(e!=null){var i=e.$$typeof;if(i===MI){t.tag=11,t=QH(null,t,e,r,n);break e}else if(i===RI){t.tag=14,t=XH(null,t,e,r,n);break e}}throw t=VD(e)||e,Error(W(306,t,""))}}return t;case 0:return cI(e,t,t.type,t.pendingProps,n);case 1:return r=t.type,i=gf(r,t.pendingProps),t2(e,t,r,i,n);case 3:e:{if(L0(t,t.stateNode.containerInfo),e===null)throw Error(W(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,eI(e,t),xy(t,r,null,n);var s=t.memoizedState;if(r=s.cache,Tc(t,qn,r),r!==o.cache&&ZD(t,[qn],n,!0),wy(),r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){t=n2(e,t,r,n);break e}else if(r!==i){i=Ho(Error(W(424)),t),ky(i),t=n2(e,t,r,n);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,tn=jo(e.firstChild),Or=t,bt=!0,_c=null,Uo=!0,n=NU(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(pf(),r===i){t=Rl(e,t,n);break e}Dr(e,t,r,n)}t=t.child}return t;case 26:return D0(e,t),e===null?(n=T2(t.type,null,t.pendingProps,null))?t.memoizedState=n:bt||(n=t.type,e=t.pendingProps,r=oE(kc.current).createElement(n),r[Ir]=t,r[Li]=e,kr(r,n,e),vr(r),t.stateNode=r):t.memoizedState=T2(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return FD(t),e===null&&bt&&(r=t.stateNode=uj(t.type,t.pendingProps,kc.current),Or=t,Uo=!0,i=tn,Wc(t.type)?(CI=i,tn=jo(r.firstChild)):tn=i),Dr(e,t,t.pendingProps.children,n),D0(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&bt&&((i=r=tn)&&(r=sre(r,t.type,t.pendingProps,Uo),r!==null?(t.stateNode=r,Or=t,tn=jo(r.firstChild),Uo=!1,i=!0):i=!1),i||jc(t)),FD(t),i=t.type,o=t.pendingProps,s=e!==null?e.memoizedProps:null,r=o.children,SI(i,o)?r=null:s!==null&&SI(i,s)&&(t.flags|=32),t.memoizedState!==null&&(i=QI(e,t,Ene,null,null,n),zy._currentValue=i),D0(e,t),Dr(e,t,r,n),t.child;case 6:return e===null&&bt&&((e=n=tn)&&(n=are(n,t.pendingProps,Uo),n!==null?(t.stateNode=n,Or=t,tn=null,e=!0):e=!1),e||jc(t)),null;case 13:return v$(e,t,n);case 4:return L0(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=mf(t,null,r,n):Dr(e,t,r,n),t.child;case 11:return QH(e,t,t.type,t.pendingProps,n);case 7:return Dr(e,t,t.pendingProps,n),t.child;case 8:return Dr(e,t,t.pendingProps.children,n),t.child;case 12:return Dr(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Tc(t,t.type,r.value),Dr(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,df(t),i=Pr(i),r=r(i),t.flags|=1,Dr(e,t,r,n),t.child;case 14:return XH(e,t,t.type,t.pendingProps,n);case 15:return g$(e,t,t.type,t.pendingProps,n);case 19:return b$(e,t,n);case 31:return Ine(e,t,n);case 22:return y$(e,t,n,t.pendingProps);case 24:return df(t),r=Pr(qn),e===null?(i=qI(),i===null&&(i=jt,o=jI(),i.pooledCache=o,o.refCount++,o!==null&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},KI(t),Tc(t,qn,i)):((e.lanes&n)!==0&&(eI(e,t),xy(t,null,null,n),wy()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=i),Tc(t,qn,r)):(r=o.cache,Tc(t,qn,r),r!==i.cache&&ZD(t,[qn],n,!0))),Dr(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(W(156,t.tag))}function dl(e){e.flags|=4}function wD(e,t,n,r,i){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(i&335544128)===i)if(e.stateNode.complete)e.flags|=8192;else if(j$())e.flags|=8192;else throw uf=q0,GI}else e.flags&=-16777217}function i2(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!dj(t))if(j$())e.flags|=8192;else throw uf=q0,GI}function m0(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?q2():536870912,e.lanes|=t,Yd|=t)}function ay(e,t){if(!bt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function en(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&65011712,r|=i.flags&65011712,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Pne(e,t,n){var r=t.pendingProps;switch($I(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(t),null;case 1:return en(t),null;case 3:return n=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),El(qn),$d(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Sd(t)?dl(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pD())),en(t),null;case 26:var i=t.type,o=t.memoizedState;return e===null?(dl(t),o!==null?(en(t),i2(t,o)):(en(t),wD(t,i,null,r,n))):o?o!==e.memoizedState?(dl(t),en(t),i2(t,o)):(en(t),t.flags&=-16777217):(e=e.memoizedProps,e!==r&&dl(t),en(t),wD(t,i,e,r,n)),null;case 27:if(F0(t),n=kc.current,i=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&dl(t);else{if(!r){if(t.stateNode===null)throw Error(W(166));return en(t),null}e=xa.current,Sd(t)?PH(t,e):(e=uj(i,r,n),t.stateNode=e,dl(t))}return en(t),null;case 5:if(F0(t),i=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&dl(t);else{if(!r){if(t.stateNode===null)throw Error(W(166));return en(t),null}if(o=xa.current,Sd(t))PH(t,o);else{var s=oE(kc.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":o=s.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof r.is=="string"?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o=typeof r.is=="string"?s.createElement(i,{is:r.is}):s.createElement(i)}}o[Ir]=t,o[Li]=r;e:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)o.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;s.sibling===null;){if(s.return===null||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(kr(o,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&dl(t)}}return en(t),wD(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&dl(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(e=kc.current,Sd(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,i=Or,i!==null)switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Ir]=t,e=!!(e.nodeValue===n||r!==null&&r.suppressHydrationWarning===!0||sj(e.nodeValue,n)),e||jc(t,!0)}else e=oE(e).createTextNode(r),e[Ir]=t,t.stateNode=e}return en(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(r=Sd(t),n!==null){if(e===null){if(!r)throw Error(W(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(557));e[Ir]=t}else pf(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;en(t),e=!1}else n=pD(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(ao(t),t):(ao(t),null);if((t.flags&128)!==0)throw Error(W(558))}return en(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(i=Sd(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Ir]=t}else pf(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;en(t),i=!1}else i=pD(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return t.flags&256?(ao(t),t):(ao(t),null)}return ao(t),(t.flags&128)!==0?(t.lanes=n,t):(n=r!==null,e=e!==null&&e.memoizedState!==null,n&&(r=t.child,i=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(i=r.alternate.memoizedState.cachePool.pool),o=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),m0(t,t.updateQueue),en(t),null);case 4:return $d(),e===null&&gO(t.stateNode.containerInfo),en(t),null;case 10:return El(t.type),en(t),null;case 19:if(br(Ln),r=t.memoizedState,r===null)return en(t),null;if(i=(t.flags&128)!==0,o=r.rendering,o===null)if(i)ay(r,!1);else{if(kn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(o=K0(e),o!==null){for(t.flags|=128,ay(r,!1),e=o.updateQueue,t.updateQueue=e,m0(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)wU(n,e),n=n.sibling;return Xt(Ln,Ln.current&1|2),bt&&yl(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&uo()>J0&&(t.flags|=128,i=!0,ay(r,!1),t.lanes=4194304)}else{if(!i)if(e=K0(o),e!==null){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,m0(t,e),ay(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!bt)return en(t),null}else 2*uo()-r.renderingStartTime>J0&&n!==536870912&&(t.flags|=128,i=!0,ay(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(e=r.last,e!==null?e.sibling=o:t.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=uo(),e.sibling=null,n=Ln.current,Xt(Ln,i?n&1|2:n&1),bt&&yl(t,r.treeForkCount),e):(en(t),null);case 22:case 23:return ao(t),WI(),r=t.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(n&536870912)!==0&&(t.flags&128)===0&&(en(t),t.subtreeFlags&6&&(t.flags|=8192)):en(t),n=t.updateQueue,n!==null&&m0(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),e!==null&&br(cf),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),El(qn),en(t),null;case 25:return null;case 30:return null}throw Error(W(156,t.tag))}function kne(e,t){switch($I(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return El(qn),$d(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return F0(t),null;case 31:if(t.memoizedState!==null){if(ao(t),t.alternate===null)throw Error(W(340));pf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(ao(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));pf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return br(Ln),null;case 4:return $d(),null;case 10:return El(t.type),null;case 22:case 23:return ao(t),WI(),e!==null&&br(cf),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return El(qn),null;case 25:return null;default:return null}}function w$(e,t){switch($I(t),t.tag){case 3:El(qn),$d();break;case 26:case 27:case 5:F0(t);break;case 4:$d();break;case 31:t.memoizedState!==null&&ao(t);break;case 13:ao(t);break;case 19:br(Ln);break;case 10:El(t.type);break;case 22:case 23:ao(t),WI(),e!==null&&br(cf);break;case 24:El(qn)}}function Xy(e,t){try{var n=t.updateQueue,r=n!==null?n.lastEffect:null;if(r!==null){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,s=n.inst;r=o(),s.destroy=r}n=n.next}while(n!==i)}}catch(a){Vt(t,t.return,a)}}function qc(e,t,n){try{var r=t.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var o=i.next;r=o;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(a!==void 0){s.destroy=void 0,i=t;var l=n,c=a;try{c()}catch(u){Vt(i,l,u)}}}r=r.next}while(r!==o)}}catch(u){Vt(t,t.return,u)}}function x$(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{IU(t,n)}catch(r){Vt(e,e.return,r)}}}function E$(e,t,n){n.props=gf(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Vt(e,t,r)}}function Cy(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof n=="function"?e.refCleanup=n(r):n.current=r}}catch(i){Vt(e,t,i)}}function wa(e,t){var n=e.ref,r=e.refCleanup;if(n!==null)if(typeof r=="function")try{r()}catch(i){Vt(e,t,i)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(i){Vt(e,t,i)}else n.current=null}function C$(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){Vt(e,e.return,i)}}function xD(e,t,n){try{var r=e.stateNode;ere(r,e.type,n,t),r[Li]=t}catch(i){Vt(e,e.return,i)}}function T$(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Wc(e.type)||e.tag===4}function ED(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||T$(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Wc(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fI(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Sl));else if(r!==4&&(r===27&&Wc(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(fI(e,t,n),e=e.sibling;e!==null;)fI(e,t,n),e=e.sibling}function Z0(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(r===27&&Wc(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Z0(e,t,n),e=e.sibling;e!==null;)Z0(e,t,n),e=e.sibling}function A$(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);kr(t,r,n),t[Ir]=e,t[Li]=n}catch(o){Vt(e,e.return,o)}}var vl=!1,jn=!1,CD=!1,o2=typeof WeakSet=="function"?WeakSet:Set,yr=null;function _ne(e,t){if(e=e.containerInfo,vI=cE,e=dU(e),FI(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,a=-1,l=-1,c=0,u=0,f=e,p=null;t:for(;;){for(var d;f!==n||i!==0&&f.nodeType!==3||(a=s+i),f!==o||r!==0&&f.nodeType!==3||(l=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(d=f.firstChild)!==null;)p=f,f=d;for(;;){if(f===e)break t;if(p===n&&++c===i&&(a=s),p===o&&++u===r&&(l=s),(d=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=d}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(bI={focusedElem:e,selectionRange:n},cE=!1,yr=t;yr!==null;)if(t=yr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,yr=e;else for(;yr!==null;){switch(t=yr,o=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)i=e[n],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&o!==null){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var h=gf(n.type,i);e=r.getSnapshotBeforeUpdate(h,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(m){Vt(n,n.return,m)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)wI(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":wI(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(W(163))}if(e=t.sibling,e!==null){e.return=t.return,yr=e;break}yr=t.return}}function M$(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:hl(e,n),r&4&&Xy(5,n);break;case 1:if(hl(e,n),r&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(s){Vt(n,n.return,s)}else{var i=gf(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Vt(n,n.return,s)}}r&64&&x$(n),r&512&&Cy(n,n.return);break;case 3:if(hl(e,n),r&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{IU(e,t)}catch(s){Vt(n,n.return,s)}}break;case 27:t===null&&r&4&&A$(n);case 26:case 5:hl(e,n),t===null&&r&4&&C$(n),r&512&&Cy(n,n.return);break;case 12:hl(e,n);break;case 31:hl(e,n),r&4&&D$(e,n);break;case 13:hl(e,n),r&4&&I$(e,n),r&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=jne.bind(null,n),lre(e,n))));break;case 22:if(r=n.memoizedState!==null||vl,!r){t=t!==null&&t.memoizedState!==null||jn,i=vl;var o=jn;vl=r,(jn=t)&&!o?gl(e,n,(n.subtreeFlags&8772)!==0):hl(e,n),vl=i,jn=o}break;case 30:break;default:hl(e,n)}}function R$(e){var t=e.alternate;t!==null&&(e.alternate=null,R$(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&OI(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var dn=null,ki=!1;function ml(e,t,n){for(n=n.child;n!==null;)N$(e,t,n),n=n.sibling}function N$(e,t,n){if(fo&&typeof fo.onCommitFiberUnmount=="function")try{fo.onCommitFiberUnmount(jy,n)}catch{}switch(n.tag){case 26:jn||wa(n,t),ml(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:jn||wa(n,t);var r=dn,i=ki;Wc(n.type)&&(dn=n.stateNode,ki=!1),ml(e,t,n),Ry(n.stateNode),dn=r,ki=i;break;case 5:jn||wa(n,t);case 6:if(r=dn,i=ki,dn=null,ml(e,t,n),dn=r,ki=i,dn!==null)if(ki)try{(dn.nodeType===9?dn.body:dn.nodeName==="HTML"?dn.ownerDocument.body:dn).removeChild(n.stateNode)}catch(o){Vt(n,t,o)}else try{dn.removeChild(n.stateNode)}catch(o){Vt(n,t,o)}break;case 18:dn!==null&&(ki?(e=dn,S2(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Jd(e)):S2(dn,n.stateNode));break;case 4:r=dn,i=ki,dn=n.stateNode.containerInfo,ki=!0,ml(e,t,n),dn=r,ki=i;break;case 0:case 11:case 14:case 15:qc(2,n,t),jn||qc(4,n,t),ml(e,t,n);break;case 1:jn||(wa(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"&&E$(n,t,r)),ml(e,t,n);break;case 21:ml(e,t,n);break;case 22:jn=(r=jn)||n.memoizedState!==null,ml(e,t,n),jn=r;break;default:ml(e,t,n)}}function D$(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Jd(e)}catch(n){Vt(t,t.return,n)}}}function I$(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Jd(e)}catch(n){Vt(t,t.return,n)}}function Vne(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new o2),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new o2),t;default:throw Error(W(435,e.tag))}}function h0(e,t){var n=Vne(e);t.forEach(function(r){if(!n.has(r)){n.add(r);var i=qne.bind(null,e,r);r.then(i,i)}})}function Oi(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r],o=e,s=t,a=s;e:for(;a!==null;){switch(a.tag){case 27:if(Wc(a.type)){dn=a.stateNode,ki=!1;break e}break;case 5:dn=a.stateNode,ki=!1;break e;case 3:case 4:dn=a.stateNode.containerInfo,ki=!0;break e}a=a.return}if(dn===null)throw Error(W(160));N$(o,s,i),dn=null,ki=!1,o=i.alternate,o!==null&&(o.return=null),i.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)O$(t,e),t=t.sibling}var Os=null;function O$(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Oi(t,e),Pi(e),r&4&&(qc(3,e,e.return),Xy(3,e),qc(5,e,e.return));break;case 1:Oi(t,e),Pi(e),r&512&&(jn||n===null||wa(n,n.return)),r&64&&vl&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var i=Os;if(Oi(t,e),Pi(e),r&512&&(jn||n===null||wa(n,n.return)),r&4){var o=n!==null?n.memoizedState:null;if(r=e.memoizedState,n===null)if(r===null)if(e.stateNode===null){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":o=i.getElementsByTagName("title")[0],(!o||o[Ky]||o[Ir]||o.namespaceURI==="http://www.w3.org/2000/svg"||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),kr(o,r,n),o[Ir]=e,vr(o),r=o;break e;case"link":var s=M2("link","href",i).get(r+(n.href||""));if(s){for(var a=0;a<s.length;a++)if(o=s[a],o.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&o.getAttribute("rel")===(n.rel==null?null:n.rel)&&o.getAttribute("title")===(n.title==null?null:n.title)&&o.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){s.splice(a,1);break t}}o=i.createElement(r),kr(o,r,n),i.head.appendChild(o);break;case"meta":if(s=M2("meta","content",i).get(r+(n.content||""))){for(a=0;a<s.length;a++)if(o=s[a],o.getAttribute("content")===(n.content==null?null:""+n.content)&&o.getAttribute("name")===(n.name==null?null:n.name)&&o.getAttribute("property")===(n.property==null?null:n.property)&&o.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&o.getAttribute("charset")===(n.charSet==null?null:n.charSet)){s.splice(a,1);break t}}o=i.createElement(r),kr(o,r,n),i.head.appendChild(o);break;default:throw Error(W(468,r))}o[Ir]=e,vr(o),r=o}e.stateNode=r}else R2(i,e.type,e.stateNode);else e.stateNode=A2(i,r,e.memoizedProps);else o!==r?(o===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):o.count--,r===null?R2(i,e.type,e.stateNode):A2(i,r,e.memoizedProps)):r===null&&e.stateNode!==null&&xD(e,e.memoizedProps,n.memoizedProps)}break;case 27:Oi(t,e),Pi(e),r&512&&(jn||n===null||wa(n,n.return)),n!==null&&r&4&&xD(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Oi(t,e),Pi(e),r&512&&(jn||n===null||wa(n,n.return)),e.flags&32){i=e.stateNode;try{qd(i,"")}catch(h){Vt(e,e.return,h)}}r&4&&e.stateNode!=null&&(i=e.memoizedProps,xD(e,i,n!==null?n.memoizedProps:i)),r&1024&&(CD=!0);break;case 6:if(Oi(t,e),Pi(e),r&4){if(e.stateNode===null)throw Error(W(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(h){Vt(e,e.return,h)}}break;case 3:if(P0=null,i=Os,Os=sE(t.containerInfo),Oi(t,e),Os=i,Pi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Jd(t.containerInfo)}catch(h){Vt(e,e.return,h)}CD&&(CD=!1,P$(e));break;case 4:r=Os,Os=sE(e.stateNode.containerInfo),Oi(t,e),Pi(e),Os=r;break;case 12:Oi(t,e),Pi(e);break;case 31:Oi(t,e),Pi(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,h0(e,r)));break;case 13:Oi(t,e),Pi(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(xE=uo()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,h0(e,r)));break;case 22:i=e.memoizedState!==null;var l=n!==null&&n.memoizedState!==null,c=vl,u=jn;if(vl=c||i,jn=u||l,Oi(t,e),jn=u,vl=c,Pi(e),r&8192)e:for(t=e.stateNode,t._visibility=i?t._visibility&-2:t._visibility|1,i&&(n===null||l||vl||jn||sf(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){l=n=t;try{if(o=l.stateNode,i)s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none";else{a=l.stateNode;var f=l.memoizedProps.style,p=f!=null&&f.hasOwnProperty("display")?f.display:null;a.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(h){Vt(l,l.return,h)}}}else if(t.tag===6){if(n===null){l=t;try{l.stateNode.nodeValue=i?"":l.memoizedProps}catch(h){Vt(l,l.return,h)}}}else if(t.tag===18){if(n===null){l=t;try{var d=l.stateNode;i?w2(d,!0):w2(l.stateNode,!1)}catch(h){Vt(l,l.return,h)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,h0(e,n))));break;case 19:Oi(t,e),Pi(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,h0(e,r)));break;case 30:break;case 21:break;default:Oi(t,e),Pi(e)}}function Pi(e){var t=e.flags;if(t&2){try{for(var n,r=e.return;r!==null;){if(T$(r)){n=r;break}r=r.return}if(n==null)throw Error(W(160));switch(n.tag){case 27:var i=n.stateNode,o=ED(e);Z0(e,o,i);break;case 5:var s=n.stateNode;n.flags&32&&(qd(s,""),n.flags&=-33);var a=ED(e);Z0(e,a,s);break;case 3:case 4:var l=n.stateNode.containerInfo,c=ED(e);fI(e,c,l);break;default:throw Error(W(161))}}catch(u){Vt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function P$(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;P$(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function hl(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)M$(e,t.alternate,t),t=t.sibling}function sf(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:qc(4,t,t.return),sf(t);break;case 1:wa(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&E$(t,t.return,n),sf(t);break;case 27:Ry(t.stateNode);case 26:case 5:wa(t,t.return),sf(t);break;case 22:t.memoizedState===null&&sf(t);break;case 30:sf(t);break;default:sf(t)}e=e.sibling}}function gl(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,i=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:gl(i,o,n),Xy(4,o);break;case 1:if(gl(i,o,n),r=o,i=r.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(c){Vt(r,r.return,c)}if(r=o,i=r.updateQueue,i!==null){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(l!==null)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)DU(l[i],a)}catch(c){Vt(r,r.return,c)}}n&&s&64&&x$(o),Cy(o,o.return);break;case 27:A$(o);case 26:case 5:gl(i,o,n),n&&r===null&&s&4&&C$(o),Cy(o,o.return);break;case 12:gl(i,o,n);break;case 31:gl(i,o,n),n&&s&4&&D$(i,o);break;case 13:gl(i,o,n),n&&s&4&&I$(i,o);break;case 22:o.memoizedState===null&&gl(i,o,n),Cy(o,o.return);break;case 30:break;default:gl(i,o,n)}t=t.sibling}}function uO(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Yy(n))}function fO(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Yy(e))}function Is(e,t,n,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)k$(e,t,n,r),t=t.sibling}function k$(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Is(e,t,n,r),i&2048&&Xy(9,t);break;case 1:Is(e,t,n,r);break;case 3:Is(e,t,n,r),i&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Yy(e)));break;case 12:if(i&2048){Is(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,a=o.onPostCommit;typeof a=="function"&&a(s,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Vt(t,t.return,l)}}else Is(e,t,n,r);break;case 31:Is(e,t,n,r);break;case 13:Is(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,t.memoizedState!==null?o._visibility&2?Is(e,t,n,r):Ty(e,t):o._visibility&2?Is(e,t,n,r):(o._visibility|=2,xd(e,t,n,r,(t.subtreeFlags&10256)!==0||!1)),i&2048&&uO(s,t);break;case 24:Is(e,t,n,r),i&2048&&fO(t.alternate,t);break;default:Is(e,t,n,r)}}function xd(e,t,n,r,i){for(i=i&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var o=e,s=t,a=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:xd(o,s,a,l,i),Xy(8,s);break;case 23:break;case 22:var u=s.stateNode;s.memoizedState!==null?u._visibility&2?xd(o,s,a,l,i):Ty(o,s):(u._visibility|=2,xd(o,s,a,l,i)),i&&c&2048&&uO(s.alternate,s);break;case 24:xd(o,s,a,l,i),i&&c&2048&&fO(s.alternate,s);break;default:xd(o,s,a,l,i)}t=t.sibling}}function Ty(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Ty(n,r),i&2048&&uO(r.alternate,r);break;case 24:Ty(n,r),i&2048&&fO(r.alternate,r);break;default:Ty(n,r)}t=t.sibling}}var hy=8192;function wd(e,t,n){if(e.subtreeFlags&hy)for(e=e.child;e!==null;)_$(e,t,n),e=e.sibling}function _$(e,t,n){switch(e.tag){case 26:wd(e,t,n),e.flags&hy&&e.memoizedState!==null&&Sre(n,Os,e.memoizedState,e.memoizedProps);break;case 5:wd(e,t,n);break;case 3:case 4:var r=Os;Os=sE(e.stateNode.containerInfo),wd(e,t,n),Os=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=hy,hy=16777216,wd(e,t,n),hy=r):wd(e,t,n));break;default:wd(e,t,n)}}function V$(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function ly(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];yr=r,F$(r,e)}V$(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)L$(e),e=e.sibling}function L$(e){switch(e.tag){case 0:case 11:case 15:ly(e),e.flags&2048&&qc(9,e,e.return);break;case 3:ly(e);break;case 12:ly(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,I0(e)):ly(e);break;default:ly(e)}}function I0(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];yr=r,F$(r,e)}V$(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:qc(8,t,t.return),I0(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,I0(t));break;default:I0(t)}e=e.sibling}}function F$(e,t){for(;yr!==null;){var n=yr;switch(n.tag){case 0:case 11:case 15:qc(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Yy(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,yr=r;else e:for(n=e;yr!==null;){r=yr;var i=r.sibling,o=r.return;if(R$(r),r===n){yr=null;break e}if(i!==null){i.return=o,yr=i;break e}yr=o}}}var Lne={getCacheForType:function(e){var t=Pr(qn),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Pr(qn).controller.signal}},Fne=typeof WeakMap=="function"?WeakMap:Map,Rt=0,jt=null,ct=null,ht=0,_t=0,so=null,Ic=!1,im=!1,pO=!1,Nl=0,kn=0,Gc=0,ff=0,dO=0,co=0,Yd=0,Ay=null,_i=null,pI=!1,xE=0,B$=0,J0=1/0,eE=null,Fc=null,rr=0,Bc=null,Qd=null,Cl=0,dI=0,mI=null,z$=null,My=0,hI=null;function mo(){return(Rt&2)!==0&&ht!==0?ht&-ht:Be.T!==null?hO():Y2()}function H$(){if(co===0)if((ht&536870912)===0||bt){var e=o0;o0<<=1,(o0&3932160)===0&&(o0=262144),co=e}else co=536870912;return e=go.current,e!==null&&(e.flags|=32),co}function Vi(e,t,n){(e===jt&&(_t===2||_t===9)||e.cancelPendingCommit!==null)&&(Xd(e,0),Oc(e,ht,co,!1)),Gy(e,n),((Rt&2)===0||e!==jt)&&(e===jt&&((Rt&2)===0&&(ff|=n),kn===4&&Oc(e,ht,co,!1)),Ca(e))}function U$(e,t,n){if((Rt&6)!==0)throw Error(W(327));var r=!n&&(t&127)===0&&(t&e.expiredLanes)===0||qy(e,t),i=r?Hne(e,t):TD(e,t,!0),o=r;do{if(i===0){im&&!r&&Oc(e,t,0,!1);break}else{if(n=e.current.alternate,o&&!Bne(n)){i=TD(e,t,!1),o=!1;continue}if(i===2){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=e.pendingLanes&-536870913,s=s!==0?s:s&536870912?536870912:0;if(s!==0){t=s;e:{var a=e;i=Ay;var l=a.current.memoizedState.isDehydrated;if(l&&(Xd(a,s).flags|=256),s=TD(a,s,!1),s!==2){if(pO&&!l){a.errorRecoveryDisabledLanes|=o,ff|=o,i=4;break e}o=_i,_i=i,o!==null&&(_i===null?_i=o:_i.push.apply(_i,o))}i=s}if(o=!1,i!==2)continue}}if(i===1){Xd(e,0),Oc(e,t,0,!0);break}e:{switch(r=e,o=i,o){case 0:case 1:throw Error(W(345));case 4:if((t&4194048)!==t)break;case 6:Oc(r,t,co,!Ic);break e;case 2:_i=null;break;case 3:case 5:break;default:throw Error(W(329))}if((t&62914560)===t&&(i=xE+300-uo(),10<i)){if(Oc(r,t,co,!Ic),fE(r,0,!0)!==0)break e;Cl=t,r.timeoutHandle=lj(s2.bind(null,r,n,_i,eE,pI,t,co,ff,Yd,Ic,o,"Throttled",-0,0),i);break e}s2(r,n,_i,eE,pI,t,co,ff,Yd,Ic,o,null,-0,0)}}break}while(!0);Ca(e)}function s2(e,t,n,r,i,o,s,a,l,c,u,f,p,d){if(e.timeoutHandle=-1,f=t.subtreeFlags,f&8192||(f&16785408)===16785408){f={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sl},_$(t,o,f);var h=(o&62914560)===o?xE-uo():(o&4194048)===o?B$-uo():0;if(h=wre(f,h),h!==null){Cl=o,e.cancelPendingCommit=h(l2.bind(null,e,t,o,n,r,i,s,a,l,u,f,null,p,d)),Oc(e,o,s,!c);return}}l2(e,t,o,n,r,i,s,a,l)}function Bne(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!ho(o(),i))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Oc(e,t,n,r){t&=~dO,t&=~ff,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-po(i),s=1<<o;r[o]=-1,i&=~s}n!==0&&G2(e,n,t)}function EE(){return(Rt&6)===0?(Zy(0,!1),!1):!0}function mO(){if(ct!==null){if(_t===0)var e=ct.return;else e=ct,wl=wf=null,JI(e),zd=null,_y=0,e=ct;for(;e!==null;)w$(e.alternate,e),e=e.return;ct=null}}function Xd(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,rre(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Cl=0,mO(),jt=e,ct=n=xl(e.current,null),ht=t,_t=0,so=null,Ic=!1,im=qy(e,t),pO=!1,Yd=co=dO=ff=Gc=kn=0,_i=Ay=null,pI=!1,(t&8)!==0&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var i=31-po(r),o=1<<i;t|=e[i],r&=~o}return Nl=t,hE(),n}function $$(e,t){Ye=null,Be.H=Ly,t===rm||t===yE?(t=FH(),_t=3):t===GI?(t=FH(),_t=4):_t=t===lO?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,so=t,ct===null&&(kn=1,Q0(e,Ho(t,e.current)))}function j$(){var e=go.current;return e===null?!0:(ht&4194048)===ht?$o===null:(ht&62914560)===ht||(ht&536870912)!==0?e===$o:!1}function q$(){var e=Be.H;return Be.H=Ly,e===null?Ly:e}function G$(){var e=Be.A;return Be.A=Lne,e}function tE(){kn=4,Ic||(ht&4194048)!==ht&&go.current!==null||(im=!0),(Gc&134217727)===0&&(ff&134217727)===0||jt===null||Oc(jt,ht,co,!1)}function TD(e,t,n){var r=Rt;Rt|=2;var i=q$(),o=G$();(jt!==e||ht!==t)&&(eE=null,Xd(e,t)),t=!1;var s=kn;e:do try{if(_t!==0&&ct!==null){var a=ct,l=so;switch(_t){case 8:mO(),s=6;break e;case 3:case 2:case 9:case 6:go.current===null&&(t=!0);var c=_t;if(_t=0,so=null,_d(e,a,l,c),n&&im){s=0;break e}break;default:c=_t,_t=0,so=null,_d(e,a,l,c)}}zne(),s=kn;break}catch(u){$$(e,u)}while(!0);return t&&e.shellSuspendCounter++,wl=wf=null,Rt=r,Be.H=i,Be.A=o,ct===null&&(jt=null,ht=0,hE()),s}function zne(){for(;ct!==null;)K$(ct)}function Hne(e,t){var n=Rt;Rt|=2;var r=q$(),i=G$();jt!==e||ht!==t?(eE=null,J0=uo()+500,Xd(e,t)):im=qy(e,t);e:do try{if(_t!==0&&ct!==null){t=ct;var o=so;t:switch(_t){case 1:_t=0,so=null,_d(e,t,o,1);break;case 2:case 9:if(LH(o)){_t=0,so=null,a2(t);break}t=function(){_t!==2&&_t!==9||jt!==e||(_t=7),Ca(e)},o.then(t,t);break e;case 3:_t=7;break e;case 4:_t=5;break e;case 7:LH(o)?(_t=0,so=null,a2(t)):(_t=0,so=null,_d(e,t,o,7));break;case 5:var s=null;switch(ct.tag){case 26:s=ct.memoizedState;case 5:case 27:var a=ct;if(s?dj(s):a.stateNode.complete){_t=0,so=null;var l=a.sibling;if(l!==null)ct=l;else{var c=a.return;c!==null?(ct=c,CE(c)):ct=null}break t}}_t=0,so=null,_d(e,t,o,5);break;case 6:_t=0,so=null,_d(e,t,o,6);break;case 8:mO(),kn=6;break e;default:throw Error(W(462))}}Une();break}catch(u){$$(e,u)}while(!0);return wl=wf=null,Be.H=r,Be.A=i,Rt=n,ct!==null?0:(jt=null,ht=0,hE(),kn)}function Une(){for(;ct!==null&&!fte();)K$(ct)}function K$(e){var t=S$(e.alternate,e,Nl);e.memoizedProps=e.pendingProps,t===null?CE(e):ct=t}function a2(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=e2(n,t,t.pendingProps,t.type,void 0,ht);break;case 11:t=e2(n,t,t.pendingProps,t.type.render,t.ref,ht);break;case 5:JI(t);default:w$(n,t),t=ct=wU(t,Nl),t=S$(n,t,Nl)}e.memoizedProps=e.pendingProps,t===null?CE(e):ct=t}function _d(e,t,n,r){wl=wf=null,JI(t),zd=null,_y=0;var i=t.return;try{if(Dne(e,i,t,n,ht)){kn=1,Q0(e,Ho(n,e.current)),ct=null;return}}catch(o){if(i!==null)throw ct=i,o;kn=1,Q0(e,Ho(n,e.current)),ct=null;return}t.flags&32768?(bt||r===1?e=!0:im||(ht&536870912)!==0?e=!1:(Ic=e=!0,(r===2||r===9||r===3||r===6)&&(r=go.current,r!==null&&r.tag===13&&(r.flags|=16384))),W$(t,e)):CE(t)}function CE(e){var t=e;do{if((t.flags&32768)!==0){W$(t,Ic);return}e=t.return;var n=Pne(t.alternate,t,Nl);if(n!==null){ct=n;return}if(t=t.sibling,t!==null){ct=t;return}ct=t=e}while(t!==null);kn===0&&(kn=5)}function W$(e,t){do{var n=kne(e.alternate,e);if(n!==null){n.flags&=32767,ct=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){ct=e;return}ct=e=n}while(e!==null);kn=6,ct=null}function l2(e,t,n,r,i,o,s,a,l){e.cancelPendingCommit=null;do TE();while(rr!==0);if((Rt&6)!==0)throw Error(W(327));if(t!==null){if(t===e.current)throw Error(W(177));if(o=t.lanes|t.childLanes,o|=BI,wte(e,n,o,s,a,l),e===jt&&(ct=jt=null,ht=0),Qd=t,Bc=e,Cl=n,dI=o,mI=i,z$=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Gne(B0,function(){return J$(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=Be.T,Be.T=null,i=Nt.p,Nt.p=2,s=Rt,Rt|=4;try{_ne(e,t,n)}finally{Rt=s,Nt.p=i,Be.T=r}}rr=1,Y$(),Q$(),X$()}}function Y$(){if(rr===1){rr=0;var e=Bc,t=Qd,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=Be.T,Be.T=null;var r=Nt.p;Nt.p=2;var i=Rt;Rt|=4;try{O$(t,e);var o=bI,s=dU(e.containerInfo),a=o.focusedElem,l=o.selectionRange;if(s!==a&&a&&a.ownerDocument&&pU(a.ownerDocument.documentElement,a)){if(l!==null&&FI(a)){var c=l.start,u=l.end;if(u===void 0&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var f=a.ownerDocument||document,p=f&&f.defaultView||window;if(p.getSelection){var d=p.getSelection(),h=a.textContent.length,m=Math.min(l.start,h),v=l.end===void 0?m:Math.min(l.end,h);!d.extend&&m>v&&(s=v,v=m,m=s);var g=DH(a,m),y=DH(a,v);if(g&&y&&(d.rangeCount!==1||d.anchorNode!==g.node||d.anchorOffset!==g.offset||d.focusNode!==y.node||d.focusOffset!==y.offset)){var b=f.createRange();b.setStart(g.node,g.offset),d.removeAllRanges(),m>v?(d.addRange(b),d.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),d.addRange(b))}}}}for(f=[],d=a;d=d.parentNode;)d.nodeType===1&&f.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<f.length;a++){var w=f[a];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}cE=!!vI,bI=vI=null}finally{Rt=i,Nt.p=r,Be.T=n}}e.current=t,rr=2}}function Q$(){if(rr===2){rr=0;var e=Bc,t=Qd,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=Be.T,Be.T=null;var r=Nt.p;Nt.p=2;var i=Rt;Rt|=4;try{M$(e,t.alternate,t)}finally{Rt=i,Nt.p=r,Be.T=n}}rr=3}}function X$(){if(rr===4||rr===3){rr=0,pte();var e=Bc,t=Qd,n=Cl,r=z$;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?rr=5:(rr=0,Qd=Bc=null,Z$(e,e.pendingLanes));var i=e.pendingLanes;if(i===0&&(Fc=null),II(n),t=t.stateNode,fo&&typeof fo.onCommitFiberRoot=="function")try{fo.onCommitFiberRoot(jy,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=Be.T,i=Nt.p,Nt.p=2,Be.T=null;try{for(var o=e.onRecoverableError,s=0;s<r.length;s++){var a=r[s];o(a.value,{componentStack:a.stack})}}finally{Be.T=t,Nt.p=i}}(Cl&3)!==0&&TE(),Ca(e),i=e.pendingLanes,(n&261930)!==0&&(i&42)!==0?e===hI?My++:(My=0,hI=e):My=0,Zy(0,!1)}}function Z$(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Yy(t)))}function TE(){return Y$(),Q$(),X$(),J$()}function J$(){if(rr!==5)return!1;var e=Bc,t=dI;dI=0;var n=II(Cl),r=Be.T,i=Nt.p;try{Nt.p=32>n?32:n,Be.T=null,n=mI,mI=null;var o=Bc,s=Cl;if(rr=0,Qd=Bc=null,Cl=0,(Rt&6)!==0)throw Error(W(331));var a=Rt;if(Rt|=4,L$(o.current),k$(o,o.current,s,n),Rt=a,Zy(0,!1),fo&&typeof fo.onPostCommitFiberRoot=="function")try{fo.onPostCommitFiberRoot(jy,o)}catch{}return!0}finally{Nt.p=i,Be.T=r,Z$(e,t)}}function c2(e,t,n){t=Ho(n,t),t=lI(e.stateNode,t,2),e=Lc(e,t,2),e!==null&&(Gy(e,2),Ca(e))}function Vt(e,t,n){if(e.tag===3)c2(e,e,n);else for(;t!==null;){if(t.tag===3){c2(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fc===null||!Fc.has(r))){e=Ho(n,e),n=m$(2),r=Lc(t,n,2),r!==null&&(h$(n,r,t,e),Gy(r,2),Ca(r));break}}t=t.return}}function AD(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Fne;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(pO=!0,i.add(n),e=$ne.bind(null,e,t,n),t.then(e,e))}function $ne(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,jt===e&&(ht&n)===n&&(kn===4||kn===3&&(ht&62914560)===ht&&300>uo()-xE?(Rt&2)===0&&Xd(e,0):dO|=n,Yd===ht&&(Yd=0)),Ca(e)}function ej(e,t){t===0&&(t=q2()),e=Sf(e,t),e!==null&&(Gy(e,t),Ca(e))}function jne(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),ej(e,n)}function qne(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(W(314))}r!==null&&r.delete(t),ej(e,n)}function Gne(e,t){return NI(e,t)}var nE=null,Ed=null,gI=!1,rE=!1,MD=!1,Pc=0;function Ca(e){e!==Ed&&e.next===null&&(Ed===null?nE=Ed=e:Ed=Ed.next=e),rE=!0,gI||(gI=!0,Wne())}function Zy(e,t){if(!MD&&rE){MD=!0;do for(var n=!1,r=nE;r!==null;){if(!t)if(e!==0){var i=r.pendingLanes;if(i===0)var o=0;else{var s=r.suspendedLanes,a=r.pingedLanes;o=(1<<31-po(42|e)+1)-1,o&=i&~(s&~a),o=o&201326741?o&201326741|1:o?o|2:0}o!==0&&(n=!0,u2(r,o))}else o=ht,o=fE(r,r===jt?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(o&3)===0||qy(r,o)||(n=!0,u2(r,o));r=r.next}while(n);MD=!1}}function Kne(){tj()}function tj(){rE=gI=!1;var e=0;Pc!==0&&nre()&&(e=Pc);for(var t=uo(),n=null,r=nE;r!==null;){var i=r.next,o=nj(r,t);o===0?(r.next=null,n===null?nE=i:n.next=i,i===null&&(Ed=n)):(n=r,(e!==0||(o&3)!==0)&&(rE=!0)),r=i}rr!==0&&rr!==5||Zy(e,!1),Pc!==0&&(Pc=0)}function nj(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes&-62914561;0<o;){var s=31-po(o),a=1<<s,l=i[s];l===-1?((a&n)===0||(a&r)!==0)&&(i[s]=Ste(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}if(t=jt,n=ht,n=fE(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,n===0||e===t&&(_t===2||_t===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&nD(r),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||qy(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(r!==null&&nD(r),II(n)){case 2:case 8:n=$2;break;case 32:n=B0;break;case 268435456:n=j2;break;default:n=B0}return r=rj.bind(null,e),n=NI(n,r),e.callbackPriority=t,e.callbackNode=n,t}return r!==null&&r!==null&&nD(r),e.callbackPriority=2,e.callbackNode=null,2}function rj(e,t){if(rr!==0&&rr!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(TE()&&e.callbackNode!==n)return null;var r=ht;return r=fE(e,e===jt?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(U$(e,r,t),nj(e,uo()),e.callbackNode!=null&&e.callbackNode===n?rj.bind(null,e):null)}function u2(e,t){if(TE())return null;U$(e,t,!0)}function Wne(){ire(function(){(Rt&6)!==0?NI(U2,Kne):tj()})}function hO(){if(Pc===0){var e=Gd;e===0&&(e=i0,i0<<=1,(i0&261888)===0&&(i0=256)),Pc=e}return Pc}function f2(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:x0(""+e)}function p2(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Yne(e,t,n,r,i){if(t==="submit"&&n&&n.stateNode===i){var o=f2((i[Li]||null).action),s=r.submitter;s&&(t=(t=s[Li]||null)?f2(t.formAction):s.getAttribute("formAction"),t!==null&&(o=t,s=null));var a=new pE("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(Pc!==0){var l=s?p2(i,s):new FormData(i);sI(n,{pending:!0,data:l,method:i.method,action:o},null,l)}}else typeof o=="function"&&(a.preventDefault(),l=s?p2(i,s):new FormData(i),sI(n,{pending:!0,data:l,method:i.method,action:o},o,l))},currentTarget:i}]})}}for(g0=0;g0<WD.length;g0++)y0=WD[g0],d2=y0.toLowerCase(),m2=y0[0].toUpperCase()+y0.slice(1),Ps(d2,"on"+m2);var y0,d2,m2,g0;Ps(hU,"onAnimationEnd");Ps(gU,"onAnimationIteration");Ps(yU,"onAnimationStart");Ps("dblclick","onDoubleClick");Ps("focusin","onFocus");Ps("focusout","onBlur");Ps(dne,"onTransitionRun");Ps(mne,"onTransitionStart");Ps(hne,"onTransitionCancel");Ps(vU,"onTransitionEnd");jd("onMouseEnter",["mouseout","mouseover"]);jd("onMouseLeave",["mouseout","mouseover"]);jd("onPointerEnter",["pointerout","pointerover"]);jd("onPointerLeave",["pointerout","pointerover"]);yf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yf("onBeforeInput",["compositionend","keypress","textInput","paste"]);yf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qne=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fy));function ij(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){H0(u)}i.currentTarget=null,o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){H0(u)}i.currentTarget=null,o=l}}}}function lt(e,t){var n=t[zD];n===void 0&&(n=t[zD]=new Set);var r=e+"__bubble";n.has(r)||(oj(t,e,2,!1),n.add(r))}function RD(e,t,n){var r=0;t&&(r|=4),oj(n,e,r,t)}var v0="_reactListening"+Math.random().toString(36).slice(2);function gO(e){if(!e[v0]){e[v0]=!0,Q2.forEach(function(n){n!=="selectionchange"&&(Qne.has(n)||RD(n,!1,e),RD(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[v0]||(t[v0]=!0,RD("selectionchange",!1,t))}}function oj(e,t,n,r){switch(vj(t)){case 2:var i=Cre;break;case 8:i=Tre;break;default:i=SO}n=i.bind(null,t,n,e),i=void 0,!qD||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function ND(e,t,n,r,i){var o=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&s.stateNode.containerInfo===i)return;s=s.return}for(;a!==null;){if(s=Ad(a),s===null)return;if(l=s.tag,l===5||l===6||l===26||l===27){r=o=s;continue e}a=a.parentNode}}r=r.return}iU(function(){var c=o,u=kI(n),f=[];e:{var p=bU.get(e);if(p!==void 0){var d=pE,h=e;switch(e){case"keypress":if(C0(n)===0)break e;case"keydown":case"keyup":d=qte;break;case"focusin":h="focus",d=aD;break;case"focusout":h="blur",d=aD;break;case"beforeblur":case"afterblur":d=aD;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=wH;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=Pte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=Wte;break;case hU:case gU:case yU:d=Vte;break;case vU:d=Qte;break;case"scroll":case"scrollend":d=Ite;break;case"wheel":d=Zte;break;case"copy":case"cut":case"paste":d=Fte;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=EH;break;case"toggle":case"beforetoggle":d=ene}var m=(t&4)!==0,v=!m&&(e==="scroll"||e==="scrollend"),g=m?p!==null?p+"Capture":null:p;m=[];for(var y=c,b;y!==null;){var w=y;if(b=w.stateNode,w=w.tag,w!==5&&w!==26&&w!==27||b===null||g===null||(w=Dy(y,g),w!=null&&m.push(By(y,w,b))),v)break;y=y.return}0<m.length&&(p=new d(p,h,null,n,u),f.push({event:p,listeners:m}))}}if((t&7)===0){e:{if(p=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",p&&n!==jD&&(h=n.relatedTarget||n.fromElement)&&(Ad(h)||h[em]))break e;if((d||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,d?(h=n.relatedTarget||n.toElement,d=c,h=h?Ad(h):null,h!==null&&(v=$y(h),m=h.tag,h!==v||m!==5&&m!==27&&m!==6)&&(h=null)):(d=null,h=c),d!==h)){if(m=wH,w="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=EH,w="onPointerLeave",g="onPointerEnter",y="pointer"),v=d==null?p:dy(d),b=h==null?p:dy(h),p=new m(w,y+"leave",d,n,u),p.target=v,p.relatedTarget=b,w=null,Ad(u)===c&&(m=new m(g,y+"enter",h,n,u),m.target=b,m.relatedTarget=v,w=m),v=w,d&&h)t:{for(m=Xne,g=d,y=h,b=0,w=g;w;w=m(w))b++;w=0;for(var S=y;S;S=m(S))w++;for(;0<b-w;)g=m(g),b--;for(;0<w-b;)y=m(y),w--;for(;b--;){if(g===y||y!==null&&g===y.alternate){m=g;break t}g=m(g),y=m(y)}m=null}else m=null;d!==null&&h2(f,p,d,m,!1),h!==null&&v!==null&&h2(f,v,h,m,!0)}}e:{if(p=c?dy(c):window,d=p.nodeName&&p.nodeName.toLowerCase(),d==="select"||d==="input"&&p.type==="file")var C=MH;else if(AH(p))if(uU)C=une;else{C=lne;var x=ane}else d=p.nodeName,!d||d.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?c&&PI(c.elementType)&&(C=MH):C=cne;if(C&&(C=C(e,c))){cU(f,C,n,u);break e}x&&x(e,p,c),e==="focusout"&&c&&p.type==="number"&&c.memoizedProps.value!=null&&$D(p,"number",p.value)}switch(x=c?dy(c):window,e){case"focusin":(AH(x)||x.contentEditable==="true")&&(Nd=x,GD=c,vy=null);break;case"focusout":vy=GD=Nd=null;break;case"mousedown":KD=!0;break;case"contextmenu":case"mouseup":case"dragend":KD=!1,IH(f,n,u);break;case"selectionchange":if(pne)break;case"keydown":case"keyup":IH(f,n,u)}var E;if(LI)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Rd?aU(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(sU&&n.locale!=="ko"&&(Rd||T!=="onCompositionStart"?T==="onCompositionEnd"&&Rd&&(E=oU()):(Dc=u,_I="value"in Dc?Dc.value:Dc.textContent,Rd=!0)),x=iE(c,T),0<x.length&&(T=new xH(T,e,null,n,u),f.push({event:T,listeners:x}),E?T.data=E:(E=lU(n),E!==null&&(T.data=E)))),(E=nne?rne(e,n):ine(e,n))&&(T=iE(c,"onBeforeInput"),0<T.length&&(x=new xH("onBeforeInput","beforeinput",null,n,u),f.push({event:x,listeners:T}),x.data=E)),Yne(f,e,c,n,u)}ij(f,t)})}function By(e,t,n){return{instance:e,listener:t,currentTarget:n}}function iE(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||o===null||(i=Dy(e,n),i!=null&&r.unshift(By(e,i,o)),i=Dy(e,t),i!=null&&r.push(By(e,i,o))),e.tag===3)return r;e=e.return}return[]}function Xne(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function h2(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,l!==null&&l===r)break;a!==5&&a!==26&&a!==27||c===null||(l=c,i?(c=Dy(n,o),c!=null&&s.unshift(By(n,c,l))):i||(c=Dy(n,o),c!=null&&s.push(By(n,c,l)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var Zne=/\r\n?/g,Jne=/\u0000|\uFFFD/g;function g2(e){return(typeof e=="string"?e:""+e).replace(Zne,`
`).replace(Jne,"")}function sj(e,t){return t=g2(t),g2(e)===t}function Ft(e,t,n,r,i,o){switch(n){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||qd(e,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&qd(e,""+r);break;case"className":a0(e,"class",r);break;case"tabIndex":a0(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":a0(e,n,r);break;case"style":rU(e,r,o);break;case"data":if(t!=="object"){a0(e,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=x0(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof o=="function"&&(n==="formAction"?(t!=="input"&&Ft(e,t,"name",i.name,i,null),Ft(e,t,"formEncType",i.formEncType,i,null),Ft(e,t,"formMethod",i.formMethod,i,null),Ft(e,t,"formTarget",i.formTarget,i,null)):(Ft(e,t,"encType",i.encType,i,null),Ft(e,t,"method",i.method,i,null),Ft(e,t,"target",i.target,i,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=x0(""+r),e.setAttribute(n,r);break;case"onClick":r!=null&&(e.onclick=Sl);break;case"onScroll":r!=null&&lt("scroll",e);break;case"onScrollEnd":r!=null&&lt("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(W(61));if(n=r.__html,n!=null){if(i.children!=null)throw Error(W(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}n=x0(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":r===!0?e.setAttribute(n,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":lt("beforetoggle",e),lt("toggle",e),w0(e,"popover",r);break;case"xlinkActuate":pl(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":pl(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":pl(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":pl(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":pl(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":pl(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":pl(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":pl(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":pl(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":w0(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Nte.get(n)||n,w0(e,n,r))}}function yI(e,t,n,r,i,o){switch(n){case"style":rU(e,r,o);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(W(61));if(n=r.__html,n!=null){if(i.children!=null)throw Error(W(60));e.innerHTML=n}}break;case"children":typeof r=="string"?qd(e,r):(typeof r=="number"||typeof r=="bigint")&&qd(e,""+r);break;case"onScroll":r!=null&&lt("scroll",e);break;case"onScrollEnd":r!=null&&lt("scrollend",e);break;case"onClick":r!=null&&(e.onclick=Sl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!X2.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),o=e[Li]||null,o=o!=null?o[n]:null,typeof o=="function"&&e.removeEventListener(t,o,i),typeof r=="function")){typeof o!="function"&&o!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i);break e}n in e?e[n]=r:r===!0?e.setAttribute(n,""):w0(e,n,r)}}}function kr(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lt("error",e),lt("load",e);var r=!1,i=!1,o;for(o in n)if(n.hasOwnProperty(o)){var s=n[o];if(s!=null)switch(o){case"src":r=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(W(137,t));default:Ft(e,t,o,s,n,null)}}i&&Ft(e,t,"srcSet",n.srcSet,n,null),r&&Ft(e,t,"src",n.src,n,null);return;case"input":lt("invalid",e);var a=o=s=i=null,l=null,c=null;for(r in n)if(n.hasOwnProperty(r)){var u=n[r];if(u!=null)switch(r){case"name":i=u;break;case"type":s=u;break;case"checked":l=u;break;case"defaultChecked":c=u;break;case"value":o=u;break;case"defaultValue":a=u;break;case"children":case"dangerouslySetInnerHTML":if(u!=null)throw Error(W(137,t));break;default:Ft(e,t,r,u,n,null)}}eU(e,o,a,l,c,s,i,!1);return;case"select":lt("invalid",e),r=s=o=null;for(i in n)if(n.hasOwnProperty(i)&&(a=n[i],a!=null))switch(i){case"value":o=a;break;case"defaultValue":s=a;break;case"multiple":r=a;default:Ft(e,t,i,a,n,null)}t=o,n=s,e.multiple=!!r,t!=null?Ld(e,!!r,t,!1):n!=null&&Ld(e,!!r,n,!0);return;case"textarea":lt("invalid",e),o=i=r=null;for(s in n)if(n.hasOwnProperty(s)&&(a=n[s],a!=null))switch(s){case"value":r=a;break;case"defaultValue":i=a;break;case"children":o=a;break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(W(91));break;default:Ft(e,t,s,a,n,null)}nU(e,r,i,o);return;case"option":for(l in n)n.hasOwnProperty(l)&&(r=n[l],r!=null)&&(l==="selected"?e.selected=r&&typeof r!="function"&&typeof r!="symbol":Ft(e,t,l,r,n,null));return;case"dialog":lt("beforetoggle",e),lt("toggle",e),lt("cancel",e),lt("close",e);break;case"iframe":case"object":lt("load",e);break;case"video":case"audio":for(r=0;r<Fy.length;r++)lt(Fy[r],e);break;case"image":lt("error",e),lt("load",e);break;case"details":lt("toggle",e);break;case"embed":case"source":case"link":lt("error",e),lt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&(r=n[c],r!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(W(137,t));default:Ft(e,t,c,r,n,null)}return;default:if(PI(t)){for(u in n)n.hasOwnProperty(u)&&(r=n[u],r!==void 0&&yI(e,t,u,r,n,void 0));return}}for(a in n)n.hasOwnProperty(a)&&(r=n[a],r!=null&&Ft(e,t,a,r,n,null))}function ere(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,s=null,a=null,l=null,c=null,u=null;for(d in n){var f=n[d];if(n.hasOwnProperty(d)&&f!=null)switch(d){case"checked":break;case"value":break;case"defaultValue":l=f;default:r.hasOwnProperty(d)||Ft(e,t,d,null,r,f)}}for(var p in r){var d=r[p];if(f=n[p],r.hasOwnProperty(p)&&(d!=null||f!=null))switch(p){case"type":o=d;break;case"name":i=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":s=d;break;case"defaultValue":a=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(W(137,t));break;default:d!==f&&Ft(e,t,p,d,r,f)}}UD(e,s,a,l,c,u,o,i);return;case"select":d=s=a=p=null;for(o in n)if(l=n[o],n.hasOwnProperty(o)&&l!=null)switch(o){case"value":break;case"multiple":d=l;default:r.hasOwnProperty(o)||Ft(e,t,o,null,r,l)}for(i in r)if(o=r[i],l=n[i],r.hasOwnProperty(i)&&(o!=null||l!=null))switch(i){case"value":p=o;break;case"defaultValue":a=o;break;case"multiple":s=o;default:o!==l&&Ft(e,t,i,o,r,l)}t=a,n=s,r=d,p!=null?Ld(e,!!n,p,!1):!!r!=!!n&&(t!=null?Ld(e,!!n,t,!0):Ld(e,!!n,n?[]:"",!1));return;case"textarea":d=p=null;for(a in n)if(i=n[a],n.hasOwnProperty(a)&&i!=null&&!r.hasOwnProperty(a))switch(a){case"value":break;case"children":break;default:Ft(e,t,a,null,r,i)}for(s in r)if(i=r[s],o=n[s],r.hasOwnProperty(s)&&(i!=null||o!=null))switch(s){case"value":p=i;break;case"defaultValue":d=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(W(91));break;default:i!==o&&Ft(e,t,s,i,r,o)}tU(e,p,d);return;case"option":for(var h in n)p=n[h],n.hasOwnProperty(h)&&p!=null&&!r.hasOwnProperty(h)&&(h==="selected"?e.selected=!1:Ft(e,t,h,null,r,p));for(l in r)p=r[l],d=n[l],r.hasOwnProperty(l)&&p!==d&&(p!=null||d!=null)&&(l==="selected"?e.selected=p&&typeof p!="function"&&typeof p!="symbol":Ft(e,t,l,p,r,d));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)p=n[m],n.hasOwnProperty(m)&&p!=null&&!r.hasOwnProperty(m)&&Ft(e,t,m,null,r,p);for(c in r)if(p=r[c],d=n[c],r.hasOwnProperty(c)&&p!==d&&(p!=null||d!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(W(137,t));break;default:Ft(e,t,c,p,r,d)}return;default:if(PI(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&p!==void 0&&!r.hasOwnProperty(v)&&yI(e,t,v,void 0,r,p);for(u in r)p=r[u],d=n[u],!r.hasOwnProperty(u)||p===d||p===void 0&&d===void 0||yI(e,t,u,p,r,d);return}}for(var g in n)p=n[g],n.hasOwnProperty(g)&&p!=null&&!r.hasOwnProperty(g)&&Ft(e,t,g,null,r,p);for(f in r)p=r[f],d=n[f],!r.hasOwnProperty(f)||p===d||p==null&&d==null||Ft(e,t,f,p,r,d)}function y2(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tre(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var i=n[r],o=i.transferSize,s=i.initiatorType,a=i.duration;if(o&&a&&y2(s)){for(s=0,a=i.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>a)break;var u=l.transferSize,f=l.initiatorType;u&&y2(f)&&(l=l.responseEnd,s+=u*(l<a?1:(a-c)/(l-c)))}if(--r,t+=8*(o+s)/(i.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var vI=null,bI=null;function oE(e){return e.nodeType===9?e:e.ownerDocument}function v2(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function aj(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function SI(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var DD=null;function nre(){var e=window.event;return e&&e.type==="popstate"?e===DD?!1:(DD=e,!0):(DD=null,!1)}var lj=typeof setTimeout=="function"?setTimeout:void 0,rre=typeof clearTimeout=="function"?clearTimeout:void 0,b2=typeof Promise=="function"?Promise:void 0,ire=typeof queueMicrotask=="function"?queueMicrotask:typeof b2<"u"?function(e){return b2.resolve(null).then(e).catch(ore)}:lj;function ore(e){setTimeout(function(){throw e})}function Wc(e){return e==="head"}function S2(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"||n==="/&"){if(r===0){e.removeChild(i),Jd(t);return}r--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")r++;else if(n==="html")Ry(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Ry(n);for(var o=n.firstChild;o;){var s=o.nextSibling,a=o.nodeName;o[Ky]||a==="SCRIPT"||a==="STYLE"||a==="LINK"&&o.rel.toLowerCase()==="stylesheet"||n.removeChild(o),o=s}}else n==="body"&&Ry(e.ownerDocument.body);n=i}while(n);Jd(t)}function w2(e,t){var n=e;e=0;do{var r=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=r}while(n)}function wI(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":wI(n),OI(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function sre(e,t,n,r){for(;e.nodeType===1;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[Ky])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(o=e.getAttribute("rel"),o==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||e.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||e.getAttribute("title")!==(i.title==null?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(o=e.getAttribute("src"),(o!==(i.src==null?null:i.src)||e.getAttribute("type")!==(i.type==null?null:i.type)||e.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var o=i.name==null?null:""+i.name;if(i.type==="hidden"&&e.getAttribute("name")===o)return e}else return e;if(e=jo(e.nextSibling),e===null)break}return null}function are(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=jo(e.nextSibling),e===null))return null;return e}function cj(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=jo(e.nextSibling),e===null))return null;return e}function xI(e){return e.data==="$?"||e.data==="$~"}function EI(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function lre(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function jo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var CI=null;function x2(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return jo(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function E2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function uj(e,t,n){switch(t=oE(n),e){case"html":if(e=t.documentElement,!e)throw Error(W(452));return e;case"head":if(e=t.head,!e)throw Error(W(453));return e;case"body":if(e=t.body,!e)throw Error(W(454));return e;default:throw Error(W(451))}}function Ry(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);OI(e)}var qo=new Map,C2=new Set;function sE(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Dl=Nt.d;Nt.d={f:cre,r:ure,D:fre,C:pre,L:dre,m:mre,X:gre,S:hre,M:yre};function cre(){var e=Dl.f(),t=EE();return e||t}function ure(e){var t=tm(e);t!==null&&t.tag===5&&t.type==="form"?r$(t):Dl.r(e)}var om=typeof document>"u"?null:document;function fj(e,t,n){var r=om;if(r&&typeof t=="string"&&t){var i=zo(t);i='link[rel="'+e+'"][href="'+i+'"]',typeof n=="string"&&(i+='[crossorigin="'+n+'"]'),C2.has(i)||(C2.add(i),e={rel:e,crossOrigin:n,href:t},r.querySelector(i)===null&&(t=r.createElement("link"),kr(t,"link",e),vr(t),r.head.appendChild(t)))}}function fre(e){Dl.D(e),fj("dns-prefetch",e,null)}function pre(e,t){Dl.C(e,t),fj("preconnect",e,t)}function dre(e,t,n){Dl.L(e,t,n);var r=om;if(r&&e&&t){var i='link[rel="preload"][as="'+zo(t)+'"]';t==="image"&&n&&n.imageSrcSet?(i+='[imagesrcset="'+zo(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(i+='[imagesizes="'+zo(n.imageSizes)+'"]')):i+='[href="'+zo(e)+'"]';var o=i;switch(t){case"style":o=Zd(e);break;case"script":o=sm(e)}qo.has(o)||(e=nn({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),qo.set(o,e),r.querySelector(i)!==null||t==="style"&&r.querySelector(Jy(o))||t==="script"&&r.querySelector(ev(o))||(t=r.createElement("link"),kr(t,"link",e),vr(t),r.head.appendChild(t)))}}function mre(e,t){Dl.m(e,t);var n=om;if(n&&e){var r=t&&typeof t.as=="string"?t.as:"script",i='link[rel="modulepreload"][as="'+zo(r)+'"][href="'+zo(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=sm(e)}if(!qo.has(o)&&(e=nn({rel:"modulepreload",href:e},t),qo.set(o,e),n.querySelector(i)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ev(o)))return}r=n.createElement("link"),kr(r,"link",e),vr(r),n.head.appendChild(r)}}}function hre(e,t,n){Dl.S(e,t,n);var r=om;if(r&&e){var i=Vd(r).hoistableStyles,o=Zd(e);t=t||"default";var s=i.get(o);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Jy(o)))a.loading=5;else{e=nn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=qo.get(o))&&yO(e,n);var l=s=r.createElement("link");vr(l),kr(l,"link",e),l._p=new Promise(function(c,u){l.onload=c,l.onerror=u}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,O0(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},i.set(o,s)}}}function gre(e,t){Dl.X(e,t);var n=om;if(n&&e){var r=Vd(n).hoistableScripts,i=sm(e),o=r.get(i);o||(o=n.querySelector(ev(i)),o||(e=nn({src:e,async:!0},t),(t=qo.get(i))&&vO(e,t),o=n.createElement("script"),vr(o),kr(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}function yre(e,t){Dl.M(e,t);var n=om;if(n&&e){var r=Vd(n).hoistableScripts,i=sm(e),o=r.get(i);o||(o=n.querySelector(ev(i)),o||(e=nn({src:e,async:!0,type:"module"},t),(t=qo.get(i))&&vO(e,t),o=n.createElement("script"),vr(o),kr(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}function T2(e,t,n,r){var i=(i=kc.current)?sE(i):null;if(!i)throw Error(W(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Zd(n.href),n=Vd(i).hoistableStyles,r=n.get(t),r||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Zd(n.href);var o=Vd(i).hoistableStyles,s=o.get(e);if(s||(i=i.ownerDocument||i,s={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},o.set(e,s),(o=i.querySelector(Jy(e)))&&!o._p&&(s.instance=o,s.state.loading=5),qo.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},qo.set(e,n),o||vre(i,e,n,s.state))),t&&r===null)throw Error(W(528,""));return s}if(t&&r!==null)throw Error(W(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=sm(n),n=Vd(i).hoistableScripts,r=n.get(t),r||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(W(444,e))}}function Zd(e){return'href="'+zo(e)+'"'}function Jy(e){return'link[rel="stylesheet"]['+e+"]"}function pj(e){return nn({},e,{"data-precedence":e.precedence,precedence:null})}function vre(e,t,n,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),kr(t,"link",n),vr(t),e.head.appendChild(t))}function sm(e){return'[src="'+zo(e)+'"]'}function ev(e){return"script[async]"+e}function A2(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+zo(n.href)+'"]');if(r)return t.instance=r,vr(r),r;var i=nn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),vr(r),kr(r,"style",i),O0(r,n.precedence,e),t.instance=r;case"stylesheet":i=Zd(n.href);var o=e.querySelector(Jy(i));if(o)return t.state.loading|=4,t.instance=o,vr(o),o;r=pj(n),(i=qo.get(i))&&yO(r,i),o=(e.ownerDocument||e).createElement("link"),vr(o);var s=o;return s._p=new Promise(function(a,l){s.onload=a,s.onerror=l}),kr(o,"link",r),t.state.loading|=4,O0(o,n.precedence,e),t.instance=o;case"script":return o=sm(n.src),(i=e.querySelector(ev(o)))?(t.instance=i,vr(i),i):(r=n,(i=qo.get(o))&&(r=nn({},n),vO(r,i)),e=e.ownerDocument||e,i=e.createElement("script"),vr(i),kr(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(W(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,O0(r,n.precedence,e));return t.instance}function O0(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)o=a;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function yO(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function vO(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var P0=null;function M2(e,t,n){if(P0===null){var r=new Map,i=P0=new Map;i.set(n,r)}else i=P0,r=i.get(n),r||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[Ky]||o[Ir]||e==="link"&&o.getAttribute("rel")==="stylesheet")&&o.namespaceURI!=="http://www.w3.org/2000/svg"){var s=o.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(o):r.set(s,[o])}}return r}function R2(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function bre(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function dj(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Sre(e,t,n,r){if(n.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var i=Zd(r.href),o=t.querySelector(Jy(i));if(o){t=o._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=aE.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,vr(o);return}o=t.ownerDocument||t,r=pj(r),(i=qo.get(i))&&yO(r,i),o=o.createElement("link"),vr(o);var s=o;s._p=new Promise(function(a,l){s.onload=a,s.onerror=l}),kr(o,"link",r),n.instance=o}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=aE.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var ID=0;function wre(e,t){return e.stylesheets&&e.count===0&&k0(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&k0(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4+t);0<e.imgBytes&&ID===0&&(ID=62500*tre());var i=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&k0(e,e.stylesheets),e.unsuspend)){var o=e.unsuspend;e.unsuspend=null,o()}},(e.imgBytes>ID?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}function aE(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)k0(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var lE=null;function k0(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,lE=new Map,t.forEach(xre,e),lE=null,aE.call(e))}function xre(e,t){if(!(t.state.loading&4)){var n=lE.get(e);if(n)var r=n.get(null);else{n=new Map,lE.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var s=i[o];(s.nodeName==="LINK"||s.getAttribute("media")!=="not all")&&(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}i=t.instance,s=i.getAttribute("data-precedence"),o=n.get(s)||r,o===r&&n.set(null,i),n.set(s,i),this.count++,r=aE.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(i,e.firstChild)),t.state.loading|=4}}var zy={$$typeof:bl,Provider:null,Consumer:null,_currentValue:af,_currentValue2:af,_threadCount:0};function Ere(e,t,n,r,i,o,s,a,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rD(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rD(0),this.hiddenUpdates=rD(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function mj(e,t,n,r,i,o,s,a,l,c,u,f){return e=new Ere(e,t,n,s,l,c,u,f,a),t=1,o===!0&&(t|=24),o=lo(3,null,null,t),e.current=o,o.stateNode=e,t=jI(),t.refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},KI(o),e}function hj(e){return e?(e=Od,e):Od}function gj(e,t,n,r,i,o){i=hj(i),r.context===null?r.context=i:r.pendingContext=i,r=Vc(t),r.payload={element:n},o=o===void 0?null:o,o!==null&&(r.callback=o),n=Lc(e,r,t),n!==null&&(Vi(n,e,t),Sy(n,e,t))}function N2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function bO(e,t){N2(e,t),(e=e.alternate)&&N2(e,t)}function yj(e){if(e.tag===13||e.tag===31){var t=Sf(e,67108864);t!==null&&Vi(t,e,67108864),bO(e,67108864)}}function D2(e){if(e.tag===13||e.tag===31){var t=mo();t=DI(t);var n=Sf(e,t);n!==null&&Vi(n,e,t),bO(e,t)}}var cE=!0;function Cre(e,t,n,r){var i=Be.T;Be.T=null;var o=Nt.p;try{Nt.p=2,SO(e,t,n,r)}finally{Nt.p=o,Be.T=i}}function Tre(e,t,n,r){var i=Be.T;Be.T=null;var o=Nt.p;try{Nt.p=8,SO(e,t,n,r)}finally{Nt.p=o,Be.T=i}}function SO(e,t,n,r){if(cE){var i=TI(r);if(i===null)ND(e,t,r,uE,n),I2(e,r);else if(Mre(i,e,t,n,r))r.stopPropagation();else if(I2(e,r),t&4&&-1<Are.indexOf(e)){for(;i!==null;){var o=tm(i);if(o!==null)switch(o.tag){case 3:if(o=o.stateNode,o.current.memoizedState.isDehydrated){var s=rf(o.pendingLanes);if(s!==0){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var l=1<<31-po(s);a.entanglements[1]|=l,s&=~l}Ca(o),(Rt&6)===0&&(J0=uo()+500,Zy(0,!1))}}break;case 31:case 13:a=Sf(o,2),a!==null&&Vi(a,o,2),EE(),bO(o,2)}if(o=TI(r),o===null&&ND(e,t,r,uE,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else ND(e,t,r,null,n)}}function TI(e){return e=kI(e),wO(e)}var uE=null;function wO(e){if(uE=null,e=Ad(e),e!==null){var t=$y(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=L2(t),e!==null)return e;e=null}else if(n===31){if(e=F2(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return uE=e,null}function vj(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(dte()){case U2:return 2;case $2:return 8;case B0:case mte:return 32;case j2:return 268435456;default:return 32}default:return 32}}var AI=!1,zc=null,Hc=null,Uc=null,Hy=new Map,Uy=new Map,Rc=[],Are="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function I2(e,t){switch(e){case"focusin":case"focusout":zc=null;break;case"dragenter":case"dragleave":Hc=null;break;case"mouseover":case"mouseout":Uc=null;break;case"pointerover":case"pointerout":Hy.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uy.delete(t.pointerId)}}function cy(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=tm(t),t!==null&&yj(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Mre(e,t,n,r,i){switch(t){case"focusin":return zc=cy(zc,e,t,n,r,i),!0;case"dragenter":return Hc=cy(Hc,e,t,n,r,i),!0;case"mouseover":return Uc=cy(Uc,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Hy.set(o,cy(Hy.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Uy.set(o,cy(Uy.get(o)||null,e,t,n,r,i)),!0}return!1}function bj(e){var t=Ad(e.target);if(t!==null){var n=$y(t);if(n!==null){if(t=n.tag,t===13){if(t=L2(n),t!==null){e.blockedOn=t,mH(e.priority,function(){D2(n)});return}}else if(t===31){if(t=F2(n),t!==null){e.blockedOn=t,mH(e.priority,function(){D2(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=TI(e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);jD=r,n.target.dispatchEvent(r),jD=null}else return t=tm(n),t!==null&&yj(t),e.blockedOn=n,!1;t.shift()}return!0}function O2(e,t,n){_0(e)&&n.delete(t)}function Rre(){AI=!1,zc!==null&&_0(zc)&&(zc=null),Hc!==null&&_0(Hc)&&(Hc=null),Uc!==null&&_0(Uc)&&(Uc=null),Hy.forEach(O2),Uy.forEach(O2)}function b0(e,t){e.blockedOn===t&&(e.blockedOn=null,AI||(AI=!0,ir.unstable_scheduleCallback(ir.unstable_NormalPriority,Rre)))}var S0=null;function P2(e){S0!==e&&(S0=e,ir.unstable_scheduleCallback(ir.unstable_NormalPriority,function(){S0===e&&(S0=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if(typeof r!="function"){if(wO(r||n)===null)continue;break}var o=tm(n);o!==null&&(e.splice(t,3),t-=3,sI(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Jd(e){function t(l){return b0(l,e)}zc!==null&&b0(zc,e),Hc!==null&&b0(Hc,e),Uc!==null&&b0(Uc,e),Hy.forEach(t),Uy.forEach(t);for(var n=0;n<Rc.length;n++){var r=Rc[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Rc.length&&(n=Rc[0],n.blockedOn===null);)bj(n),n.blockedOn===null&&Rc.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],s=i[Li]||null;if(typeof o=="function")s||P2(n);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(i=o,s=o[Li]||null)a=s.formAction;else if(wO(i)!==null)continue}else a=s.action;typeof a=="function"?n[r+1]=a:(n.splice(r,3),r-=3),P2(n)}}}function Sj(){function e(o){o.canIntercept&&o.info==="react-transition"&&o.intercept({handler:function(){return new Promise(function(s){return i=s})},focusReset:"manual",scroll:"manual"})}function t(){i!==null&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var o=navigation.currentEntry;o&&o.url!=null&&navigation.navigate(o.url,{state:o.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),i!==null&&(i(),i=null)}}}function xO(e){this._internalRoot=e}AE.prototype.render=xO.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));var n=t.current,r=mo();gj(n,r,e,t,null,null)};AE.prototype.unmount=xO.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;gj(e.current,2,null,e,null,null),EE(),t[em]=null}};function AE(e){this._internalRoot=e}AE.prototype.unstable_scheduleHydration=function(e){if(e){var t=Y2();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rc.length&&t!==0&&t<Rc[n].priority;n++);Rc.splice(n,0,e),n===0&&bj(e)}};var k2=_2.version;if(k2!=="19.2.3")throw Error(W(527,k2,"19.2.3"));Nt.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=ste(t),e=e!==null?B2(e):null,e=e===null?null:e.stateNode,e};var Nre={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Be,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(uy=__REACT_DEVTOOLS_GLOBAL_HOOK__,!uy.isDisabled&&uy.supportsFiber))try{jy=uy.inject(Nre),fo=uy}catch{}var uy;ME.createRoot=function(e,t){if(!V2(e))throw Error(W(299));var n=!1,r="",i=f$,o=p$,s=d$;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(i=t.onUncaughtError),t.onCaughtError!==void 0&&(o=t.onCaughtError),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=mj(e,1,!1,null,null,n,r,null,i,o,s,Sj),e[em]=t.current,gO(e),new xO(t)};ME.hydrateRoot=function(e,t,n){if(!V2(e))throw Error(W(299));var r=!1,i="",o=f$,s=p$,a=d$,l=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onUncaughtError!==void 0&&(o=n.onUncaughtError),n.onCaughtError!==void 0&&(s=n.onCaughtError),n.onRecoverableError!==void 0&&(a=n.onRecoverableError),n.formState!==void 0&&(l=n.formState)),t=mj(e,1,!0,t,n??null,r,i,l,o,s,a,Sj),t.context=hj(null),n=t.current,r=mo(),r=DI(r),i=Vc(r),i.callback=null,Lc(n,i,r),n=r,t.current.lanes=n,Gy(t,n),Ca(t),e[em]=t.current,gO(e),new AE(t)};ME.version="19.2.3"});var RE=Ae((Qke,Ej)=>{"use strict";function xj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xj)}catch(e){console.error(e)}}xj(),Ej.exports=wj()});var Pj=Ae(DE=>{"use strict";var Ire=Symbol.for("react.transitional.element"),Ore=Symbol.for("react.fragment");function Oj(e,t,n){var r=null;if(n!==void 0&&(r=""+n),t.key!==void 0&&(r=""+t.key),"key"in t){n={};for(var i in t)i!=="key"&&(n[i]=t[i])}else n=t;return t=n.ref,{$$typeof:Ire,type:e,key:r,ref:t!==void 0?t:null,props:n}}DE.Fragment=Ore;DE.jsx=Oj;DE.jsxs=Oj});var j=Ae((b1e,kj)=>{"use strict";kj.exports=Pj()});var Pb=Ae((NJe,vQ)=>{"use strict";var Ofe="2.0.0",Pfe=Number.MAX_SAFE_INTEGER||9007199254740991,kfe=16,_fe=250,Vfe=["major","premajor","minor","preminor","patch","prepatch","prerelease"];vQ.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:kfe,MAX_SAFE_BUILD_LENGTH:_fe,MAX_SAFE_INTEGER:Pfe,RELEASE_TYPES:Vfe,SEMVER_SPEC_VERSION:Ofe,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var kb=Ae((DJe,bQ)=>{"use strict";var Lfe=()=>{};bQ.exports=Lfe});var ch=Ae((Ha,SQ)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:T_,MAX_SAFE_BUILD_LENGTH:Ffe,MAX_LENGTH:Bfe}=Pb(),zfe=kb();Ha=SQ.exports={};var Hfe=Ha.re=[],Ufe=Ha.safeRe=[],ve=Ha.src=[],$fe=Ha.safeSrc=[],be=Ha.t={},jfe=0,A_="[a-zA-Z0-9-]",qfe=[["\\s",1],["\\d",Bfe],[A_,Ffe]],Gfe=e=>{for(let[t,n]of qfe)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e},We=(e,t,n)=>{let r=Gfe(t),i=jfe++;zfe(e,i,t),be[e]=i,ve[i]=t,$fe[i]=r,Hfe[i]=new RegExp(t,n?"g":void 0),Ufe[i]=new RegExp(r,n?"g":void 0)};We("NUMERICIDENTIFIER","0|[1-9]\\d*");We("NUMERICIDENTIFIERLOOSE","\\d+");We("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${A_}*`);We("MAINVERSION",`(${ve[be.NUMERICIDENTIFIER]})\\.(${ve[be.NUMERICIDENTIFIER]})\\.(${ve[be.NUMERICIDENTIFIER]})`);We("MAINVERSIONLOOSE",`(${ve[be.NUMERICIDENTIFIERLOOSE]})\\.(${ve[be.NUMERICIDENTIFIERLOOSE]})\\.(${ve[be.NUMERICIDENTIFIERLOOSE]})`);We("PRERELEASEIDENTIFIER",`(?:${ve[be.NONNUMERICIDENTIFIER]}|${ve[be.NUMERICIDENTIFIER]})`);We("PRERELEASEIDENTIFIERLOOSE",`(?:${ve[be.NONNUMERICIDENTIFIER]}|${ve[be.NUMERICIDENTIFIERLOOSE]})`);We("PRERELEASE",`(?:-(${ve[be.PRERELEASEIDENTIFIER]}(?:\\.${ve[be.PRERELEASEIDENTIFIER]})*))`);We("PRERELEASELOOSE",`(?:-?(${ve[be.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ve[be.PRERELEASEIDENTIFIERLOOSE]})*))`);We("BUILDIDENTIFIER",`${A_}+`);We("BUILD",`(?:\\+(${ve[be.BUILDIDENTIFIER]}(?:\\.${ve[be.BUILDIDENTIFIER]})*))`);We("FULLPLAIN",`v?${ve[be.MAINVERSION]}${ve[be.PRERELEASE]}?${ve[be.BUILD]}?`);We("FULL",`^${ve[be.FULLPLAIN]}$`);We("LOOSEPLAIN",`[v=\\s]*${ve[be.MAINVERSIONLOOSE]}${ve[be.PRERELEASELOOSE]}?${ve[be.BUILD]}?`);We("LOOSE",`^${ve[be.LOOSEPLAIN]}$`);We("GTLT","((?:<|>)?=?)");We("XRANGEIDENTIFIERLOOSE",`${ve[be.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);We("XRANGEIDENTIFIER",`${ve[be.NUMERICIDENTIFIER]}|x|X|\\*`);We("XRANGEPLAIN",`[v=\\s]*(${ve[be.XRANGEIDENTIFIER]})(?:\\.(${ve[be.XRANGEIDENTIFIER]})(?:\\.(${ve[be.XRANGEIDENTIFIER]})(?:${ve[be.PRERELEASE]})?${ve[be.BUILD]}?)?)?`);We("XRANGEPLAINLOOSE",`[v=\\s]*(${ve[be.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ve[be.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ve[be.XRANGEIDENTIFIERLOOSE]})(?:${ve[be.PRERELEASELOOSE]})?${ve[be.BUILD]}?)?)?`);We("XRANGE",`^${ve[be.GTLT]}\\s*${ve[be.XRANGEPLAIN]}$`);We("XRANGELOOSE",`^${ve[be.GTLT]}\\s*${ve[be.XRANGEPLAINLOOSE]}$`);We("COERCEPLAIN",`(^|[^\\d])(\\d{1,${T_}})(?:\\.(\\d{1,${T_}}))?(?:\\.(\\d{1,${T_}}))?`);We("COERCE",`${ve[be.COERCEPLAIN]}(?:$|[^\\d])`);We("COERCEFULL",ve[be.COERCEPLAIN]+`(?:${ve[be.PRERELEASE]})?(?:${ve[be.BUILD]})?(?:$|[^\\d])`);We("COERCERTL",ve[be.COERCE],!0);We("COERCERTLFULL",ve[be.COERCEFULL],!0);We("LONETILDE","(?:~>?)");We("TILDETRIM",`(\\s*)${ve[be.LONETILDE]}\\s+`,!0);Ha.tildeTrimReplace="$1~";We("TILDE",`^${ve[be.LONETILDE]}${ve[be.XRANGEPLAIN]}$`);We("TILDELOOSE",`^${ve[be.LONETILDE]}${ve[be.XRANGEPLAINLOOSE]}$`);We("LONECARET","(?:\\^)");We("CARETTRIM",`(\\s*)${ve[be.LONECARET]}\\s+`,!0);Ha.caretTrimReplace="$1^";We("CARET",`^${ve[be.LONECARET]}${ve[be.XRANGEPLAIN]}$`);We("CARETLOOSE",`^${ve[be.LONECARET]}${ve[be.XRANGEPLAINLOOSE]}$`);We("COMPARATORLOOSE",`^${ve[be.GTLT]}\\s*(${ve[be.LOOSEPLAIN]})$|^$`);We("COMPARATOR",`^${ve[be.GTLT]}\\s*(${ve[be.FULLPLAIN]})$|^$`);We("COMPARATORTRIM",`(\\s*)${ve[be.GTLT]}\\s*(${ve[be.LOOSEPLAIN]}|${ve[be.XRANGEPLAIN]})`,!0);Ha.comparatorTrimReplace="$1$2$3";We("HYPHENRANGE",`^\\s*(${ve[be.XRANGEPLAIN]})\\s+-\\s+(${ve[be.XRANGEPLAIN]})\\s*$`);We("HYPHENRANGELOOSE",`^\\s*(${ve[be.XRANGEPLAINLOOSE]})\\s+-\\s+(${ve[be.XRANGEPLAINLOOSE]})\\s*$`);We("STAR","(<|>)?=?\\s*\\*");We("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");We("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var AA=Ae((IJe,wQ)=>{"use strict";var Kfe=Object.freeze({loose:!0}),Wfe=Object.freeze({}),Yfe=e=>e?typeof e!="object"?Kfe:e:Wfe;wQ.exports=Yfe});var M_=Ae((OJe,CQ)=>{"use strict";var xQ=/^[0-9]+$/,EQ=(e,t)=>{if(typeof e=="number"&&typeof t=="number")return e===t?0:e<t?-1:1;let n=xQ.test(e),r=xQ.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},Qfe=(e,t)=>EQ(t,e);CQ.exports={compareIdentifiers:EQ,rcompareIdentifiers:Qfe}});var ri=Ae((PJe,AQ)=>{"use strict";var MA=kb(),{MAX_LENGTH:TQ,MAX_SAFE_INTEGER:RA}=Pb(),{safeRe:NA,t:DA}=ch(),Xfe=AA(),{compareIdentifiers:R_}=M_(),N_=class e{constructor(t,n){if(n=Xfe(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>TQ)throw new TypeError(`version is longer than ${TQ} characters`);MA("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;let r=t.trim().match(n.loose?NA[DA.LOOSE]:NA[DA.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>RA||this.major<0)throw new TypeError("Invalid major version");if(this.minor>RA||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>RA||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<RA)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(MA("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if(typeof t=="string"&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{let r=this.prerelease[n],i=t.prerelease[n];if(MA("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return R_(r,i)}while(++n)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let n=0;do{let r=this.build[n],i=t.build[n];if(MA("build compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return R_(r,i)}while(++n)}inc(t,n,r){if(t.startsWith("pre")){if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(n){let i=`-${n}`.match(this.options.loose?NA[DA.PRERELEASELOOSE]:NA[DA.PRERELEASE]);if(!i||i[1]!==n)throw new Error(`invalid identifier: ${n}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(n){let o=[n,i];r===!1&&(o=[n]),R_(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};AQ.exports=N_});var vp=Ae((kJe,RQ)=>{"use strict";var MQ=ri(),Zfe=(e,t,n=!1)=>{if(e instanceof MQ)return e;try{return new MQ(e,t)}catch(r){if(!n)return null;throw r}};RQ.exports=Zfe});var DQ=Ae((_Je,NQ)=>{"use strict";var Jfe=vp(),epe=(e,t)=>{let n=Jfe(e,t);return n?n.version:null};NQ.exports=epe});var OQ=Ae((VJe,IQ)=>{"use strict";var tpe=vp(),npe=(e,t)=>{let n=tpe(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};IQ.exports=npe});var _Q=Ae((LJe,kQ)=>{"use strict";var PQ=ri(),rpe=(e,t,n,r,i)=>{typeof n=="string"&&(i=r,r=n,n=void 0);try{return new PQ(e instanceof PQ?e.version:e,n).inc(t,r,i).version}catch{return null}};kQ.exports=rpe});var FQ=Ae((FJe,LQ)=>{"use strict";var VQ=vp(),ipe=(e,t)=>{let n=VQ(e,null,!0),r=VQ(t,null,!0),i=n.compare(r);if(i===0)return null;let o=i>0,s=o?n:r,a=o?r:n,l=!!s.prerelease.length;if(!!a.prerelease.length&&!l){if(!a.patch&&!a.minor)return"major";if(a.compareMain(s)===0)return a.minor&&!a.patch?"minor":"patch"}let u=l?"pre":"";return n.major!==r.major?u+"major":n.minor!==r.minor?u+"minor":n.patch!==r.patch?u+"patch":"prerelease"};LQ.exports=ipe});var zQ=Ae((BJe,BQ)=>{"use strict";var ope=ri(),spe=(e,t)=>new ope(e,t).major;BQ.exports=spe});var UQ=Ae((zJe,HQ)=>{"use strict";var ape=ri(),lpe=(e,t)=>new ape(e,t).minor;HQ.exports=lpe});var jQ=Ae((HJe,$Q)=>{"use strict";var cpe=ri(),upe=(e,t)=>new cpe(e,t).patch;$Q.exports=upe});var GQ=Ae((UJe,qQ)=>{"use strict";var fpe=vp(),ppe=(e,t)=>{let n=fpe(e,t);return n&&n.prerelease.length?n.prerelease:null};qQ.exports=ppe});var ps=Ae(($Je,WQ)=>{"use strict";var KQ=ri(),dpe=(e,t,n)=>new KQ(e,n).compare(new KQ(t,n));WQ.exports=dpe});var QQ=Ae((jJe,YQ)=>{"use strict";var mpe=ps(),hpe=(e,t,n)=>mpe(t,e,n);YQ.exports=hpe});var ZQ=Ae((qJe,XQ)=>{"use strict";var gpe=ps(),ype=(e,t)=>gpe(e,t,!0);XQ.exports=ype});var IA=Ae((GJe,e8)=>{"use strict";var JQ=ri(),vpe=(e,t,n)=>{let r=new JQ(e,n),i=new JQ(t,n);return r.compare(i)||r.compareBuild(i)};e8.exports=vpe});var n8=Ae((KJe,t8)=>{"use strict";var bpe=IA(),Spe=(e,t)=>e.sort((n,r)=>bpe(n,r,t));t8.exports=Spe});var i8=Ae((WJe,r8)=>{"use strict";var wpe=IA(),xpe=(e,t)=>e.sort((n,r)=>wpe(r,n,t));r8.exports=xpe});var _b=Ae((YJe,o8)=>{"use strict";var Epe=ps(),Cpe=(e,t,n)=>Epe(e,t,n)>0;o8.exports=Cpe});var OA=Ae((QJe,s8)=>{"use strict";var Tpe=ps(),Ape=(e,t,n)=>Tpe(e,t,n)<0;s8.exports=Ape});var D_=Ae((XJe,a8)=>{"use strict";var Mpe=ps(),Rpe=(e,t,n)=>Mpe(e,t,n)===0;a8.exports=Rpe});var I_=Ae((ZJe,l8)=>{"use strict";var Npe=ps(),Dpe=(e,t,n)=>Npe(e,t,n)!==0;l8.exports=Dpe});var PA=Ae((JJe,c8)=>{"use strict";var Ipe=ps(),Ope=(e,t,n)=>Ipe(e,t,n)>=0;c8.exports=Ope});var kA=Ae((eet,u8)=>{"use strict";var Ppe=ps(),kpe=(e,t,n)=>Ppe(e,t,n)<=0;u8.exports=kpe});var O_=Ae((tet,f8)=>{"use strict";var _pe=D_(),Vpe=I_(),Lpe=_b(),Fpe=PA(),Bpe=OA(),zpe=kA(),Hpe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return _pe(e,n,r);case"!=":return Vpe(e,n,r);case">":return Lpe(e,n,r);case">=":return Fpe(e,n,r);case"<":return Bpe(e,n,r);case"<=":return zpe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};f8.exports=Hpe});var d8=Ae((net,p8)=>{"use strict";var Upe=ri(),$pe=vp(),{safeRe:_A,t:VA}=ch(),jpe=(e,t)=>{if(e instanceof Upe)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(t.includePrerelease?_A[VA.COERCEFULL]:_A[VA.COERCE]);else{let l=t.includePrerelease?_A[VA.COERCERTLFULL]:_A[VA.COERCERTL],c;for(;(c=l.exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||c.index+c[0].length!==n.index+n[0].length)&&(n=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(n===null)return null;let r=n[2],i=n[3]||"0",o=n[4]||"0",s=t.includePrerelease&&n[5]?`-${n[5]}`:"",a=t.includePrerelease&&n[6]?`+${n[6]}`:"";return $pe(`${r}.${i}.${o}${s}${a}`,t)};p8.exports=jpe});var h8=Ae((ret,m8)=>{"use strict";var P_=class{constructor(){this.max=1e3,this.map=new Map}get(t){let n=this.map.get(t);if(n!==void 0)return this.map.delete(t),this.map.set(t,n),n}delete(t){return this.map.delete(t)}set(t,n){if(!this.delete(t)&&n!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(t,n)}return this}};m8.exports=P_});var ds=Ae((iet,b8)=>{"use strict";var qpe=/\s+/g,k_=class e{constructor(t,n){if(n=Kpe(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof __)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t.trim().replace(qpe," "),this.set=this.raw.split("||").map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!y8(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&ede(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");let n=this.set[t];for(let r=0;r<n.length;r++)r>0&&(this.formatted+=" "),this.formatted+=n[r].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(t){let r=((this.options.includePrerelease&&Zpe)|(this.options.loose&&Jpe))+":"+t,i=g8.get(r);if(i)return i;let o=this.options.loose,s=o?Ei[ii.HYPHENRANGELOOSE]:Ei[ii.HYPHENRANGE];t=t.replace(s,ude(this.options.includePrerelease)),cn("hyphen replace",t),t=t.replace(Ei[ii.COMPARATORTRIM],Ype),cn("comparator trim",t),t=t.replace(Ei[ii.TILDETRIM],Qpe),cn("tilde trim",t),t=t.replace(Ei[ii.CARETTRIM],Xpe),cn("caret trim",t);let a=t.split(" ").map(f=>tde(f,this.options)).join(" ").split(/\s+/).map(f=>cde(f,this.options));o&&(a=a.filter(f=>(cn("loose invalid filter",f,this.options),!!f.match(Ei[ii.COMPARATORLOOSE])))),cn("range list",a);let l=new Map,c=a.map(f=>new __(f,this.options));for(let f of c){if(y8(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");let u=[...l.values()];return g8.set(r,u),u}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(r=>v8(r,n)&&t.set.some(i=>v8(i,n)&&r.every(o=>i.every(s=>o.intersects(s,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new Wpe(t,this.options)}catch{return!1}for(let n=0;n<this.set.length;n++)if(fde(this.set[n],t,this.options))return!0;return!1}};b8.exports=k_;var Gpe=h8(),g8=new Gpe,Kpe=AA(),__=Vb(),cn=kb(),Wpe=ri(),{safeRe:Ei,t:ii,comparatorTrimReplace:Ype,tildeTrimReplace:Qpe,caretTrimReplace:Xpe}=ch(),{FLAG_INCLUDE_PRERELEASE:Zpe,FLAG_LOOSE:Jpe}=Pb(),y8=e=>e.value==="<0.0.0-0",ede=e=>e.value==="",v8=(e,t)=>{let n=!0,r=e.slice(),i=r.pop();for(;n&&r.length;)n=r.every(o=>i.intersects(o,t)),i=r.pop();return n},tde=(e,t)=>(e=e.replace(Ei[ii.BUILD],""),cn("comp",e,t),e=ide(e,t),cn("caret",e),e=nde(e,t),cn("tildes",e),e=sde(e,t),cn("xrange",e),e=lde(e,t),cn("stars",e),e),Ci=e=>!e||e.toLowerCase()==="x"||e==="*",nde=(e,t)=>e.trim().split(/\s+/).map(n=>rde(n,t)).join(" "),rde=(e,t)=>{let n=t.loose?Ei[ii.TILDELOOSE]:Ei[ii.TILDE];return e.replace(n,(r,i,o,s,a)=>{cn("tilde",e,r,i,o,s,a);let l;return Ci(i)?l="":Ci(o)?l=`>=${i}.0.0 <${+i+1}.0.0-0`:Ci(s)?l=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:a?(cn("replaceTilde pr",a),l=`>=${i}.${o}.${s}-${a} <${i}.${+o+1}.0-0`):l=`>=${i}.${o}.${s} <${i}.${+o+1}.0-0`,cn("tilde return",l),l})},ide=(e,t)=>e.trim().split(/\s+/).map(n=>ode(n,t)).join(" "),ode=(e,t)=>{cn("caret",e,t);let n=t.loose?Ei[ii.CARETLOOSE]:Ei[ii.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,o,s,a,l)=>{cn("caret",e,i,o,s,a,l);let c;return Ci(o)?c="":Ci(s)?c=`>=${o}.0.0${r} <${+o+1}.0.0-0`:Ci(a)?o==="0"?c=`>=${o}.${s}.0${r} <${o}.${+s+1}.0-0`:c=`>=${o}.${s}.0${r} <${+o+1}.0.0-0`:l?(cn("replaceCaret pr",l),o==="0"?s==="0"?c=`>=${o}.${s}.${a}-${l} <${o}.${s}.${+a+1}-0`:c=`>=${o}.${s}.${a}-${l} <${o}.${+s+1}.0-0`:c=`>=${o}.${s}.${a}-${l} <${+o+1}.0.0-0`):(cn("no pr"),o==="0"?s==="0"?c=`>=${o}.${s}.${a}${r} <${o}.${s}.${+a+1}-0`:c=`>=${o}.${s}.${a}${r} <${o}.${+s+1}.0-0`:c=`>=${o}.${s}.${a} <${+o+1}.0.0-0`),cn("caret return",c),c})},sde=(e,t)=>(cn("replaceXRanges",e,t),e.split(/\s+/).map(n=>ade(n,t)).join(" ")),ade=(e,t)=>{e=e.trim();let n=t.loose?Ei[ii.XRANGELOOSE]:Ei[ii.XRANGE];return e.replace(n,(r,i,o,s,a,l)=>{cn("xRange",e,r,i,o,s,a,l);let c=Ci(o),u=c||Ci(s),f=u||Ci(a),p=f;return i==="="&&p&&(i=""),l=t.includePrerelease?"-0":"",c?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&p?(u&&(s=0),a=0,i===">"?(i=">=",u?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",u?o=+o+1:s=+s+1),i==="<"&&(l="-0"),r=`${i+o}.${s}.${a}${l}`):u?r=`>=${o}.0.0${l} <${+o+1}.0.0-0`:f&&(r=`>=${o}.${s}.0${l} <${o}.${+s+1}.0-0`),cn("xRange return",r),r})},lde=(e,t)=>(cn("replaceStars",e,t),e.trim().replace(Ei[ii.STAR],"")),cde=(e,t)=>(cn("replaceGTE0",e,t),e.trim().replace(Ei[t.includePrerelease?ii.GTE0PRE:ii.GTE0],"")),ude=e=>(t,n,r,i,o,s,a,l,c,u,f,p)=>(Ci(r)?n="":Ci(i)?n=`>=${r}.0.0${e?"-0":""}`:Ci(o)?n=`>=${r}.${i}.0${e?"-0":""}`:s?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,Ci(c)?l="":Ci(u)?l=`<${+c+1}.0.0-0`:Ci(f)?l=`<${c}.${+u+1}.0-0`:p?l=`<=${c}.${u}.${f}-${p}`:e?l=`<${c}.${u}.${+f+1}-0`:l=`<=${l}`,`${n} ${l}`.trim()),fde=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if(cn(e[r].semver),e[r].semver!==__.ANY&&e[r].semver.prerelease.length>0){let i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}});var Vb=Ae((oet,T8)=>{"use strict";var Lb=Symbol("SemVer ANY"),F_=class e{static get ANY(){return Lb}constructor(t,n){if(n=S8(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),L_("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===Lb?this.value="":this.value=this.operator+this.semver.version,L_("comp",this)}parse(t){let n=this.options.loose?w8[x8.COMPARATORLOOSE]:w8[x8.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new E8(r[2],this.options.loose):this.semver=Lb}toString(){return this.value}test(t){if(L_("Comparator.test",t,this.options.loose),this.semver===Lb||t===Lb)return!0;if(typeof t=="string")try{t=new E8(t,this.options)}catch{return!1}return V_(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new C8(t.value,n).test(this.value):t.operator===""?t.value===""?!0:new C8(this.value,n).test(t.semver):(n=S8(n),n.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!n.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||V_(this.semver,"<",t.semver,n)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||V_(this.semver,">",t.semver,n)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};T8.exports=F_;var S8=AA(),{safeRe:w8,t:x8}=ch(),V_=O_(),L_=kb(),E8=ri(),C8=ds()});var Fb=Ae((set,A8)=>{"use strict";var pde=ds(),dde=(e,t,n)=>{try{t=new pde(t,n)}catch{return!1}return t.test(e)};A8.exports=dde});var R8=Ae((aet,M8)=>{"use strict";var mde=ds(),hde=(e,t)=>new mde(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));M8.exports=hde});var D8=Ae((cet,N8)=>{"use strict";var gde=ri(),yde=ds(),vde=(e,t,n)=>{let r=null,i=null,o=null;try{o=new yde(t,n)}catch{return null}return e.forEach(s=>{o.test(s)&&(!r||i.compare(s)===-1)&&(r=s,i=new gde(r,n))}),r};N8.exports=vde});var O8=Ae((uet,I8)=>{"use strict";var bde=ri(),Sde=ds(),wde=(e,t,n)=>{let r=null,i=null,o=null;try{o=new Sde(t,n)}catch{return null}return e.forEach(s=>{o.test(s)&&(!r||i.compare(s)===1)&&(r=s,i=new bde(r,n))}),r};I8.exports=wde});var _8=Ae((fet,k8)=>{"use strict";var B_=ri(),xde=ds(),P8=_b(),Ede=(e,t)=>{e=new xde(e,t);let n=new B_("0.0.0");if(e.test(n)||(n=new B_("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){let i=e.set[r],o=null;i.forEach(s=>{let a=new B_(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!o||P8(a,o))&&(o=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),o&&(!n||P8(n,o))&&(n=o)}return n&&e.test(n)?n:null};k8.exports=Ede});var L8=Ae((pet,V8)=>{"use strict";var Cde=ds(),Tde=(e,t)=>{try{return new Cde(e,t).range||"*"}catch{return null}};V8.exports=Tde});var LA=Ae((det,H8)=>{"use strict";var Ade=ri(),z8=Vb(),{ANY:Mde}=z8,Rde=ds(),Nde=Fb(),F8=_b(),B8=OA(),Dde=kA(),Ide=PA(),Ode=(e,t,n,r)=>{e=new Ade(e,r),t=new Rde(t,r);let i,o,s,a,l;switch(n){case">":i=F8,o=Dde,s=B8,a=">",l=">=";break;case"<":i=B8,o=Ide,s=F8,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Nde(e,t,r))return!1;for(let c=0;c<t.set.length;++c){let u=t.set[c],f=null,p=null;if(u.forEach(d=>{d.semver===Mde&&(d=new z8(">=0.0.0")),f=f||d,p=p||d,i(d.semver,f.semver,r)?f=d:s(d.semver,p.semver,r)&&(p=d)}),f.operator===a||f.operator===l||(!p.operator||p.operator===a)&&o(e,p.semver))return!1;if(p.operator===l&&s(e,p.semver))return!1}return!0};H8.exports=Ode});var $8=Ae((met,U8)=>{"use strict";var Pde=LA(),kde=(e,t,n)=>Pde(e,t,">",n);U8.exports=kde});var q8=Ae((het,j8)=>{"use strict";var _de=LA(),Vde=(e,t,n)=>_de(e,t,"<",n);j8.exports=Vde});var W8=Ae((get,K8)=>{"use strict";var G8=ds(),Lde=(e,t,n)=>(e=new G8(e,n),t=new G8(t,n),e.intersects(t,n));K8.exports=Lde});var Q8=Ae((yet,Y8)=>{"use strict";var Fde=Fb(),Bde=ps();Y8.exports=(e,t,n)=>{let r=[],i=null,o=null,s=e.sort((u,f)=>Bde(u,f,n));for(let u of s)Fde(u,t,n)?(o=u,i||(i=u)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);let a=[];for(let[u,f]of r)u===f?a.push(u):!f&&u===s[0]?a.push("*"):f?u===s[0]?a.push(`<=${f}`):a.push(`${u} - ${f}`):a.push(`>=${u}`);let l=a.join(" || "),c=typeof t.raw=="string"?t.raw:String(t);return l.length<c.length?l:t}});var n9=Ae((vet,t9)=>{"use strict";var X8=ds(),H_=Vb(),{ANY:z_}=H_,Bb=Fb(),U_=ps(),zde=(e,t,n={})=>{if(e===t)return!0;e=new X8(e,n),t=new X8(t,n);let r=!1;e:for(let i of e.set){for(let o of t.set){let s=Ude(i,o,n);if(r=r||s!==null,s)continue e}if(r)return!1}return!0},Hde=[new H_(">=0.0.0-0")],Z8=[new H_(">=0.0.0")],Ude=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===z_){if(t.length===1&&t[0].semver===z_)return!0;n.includePrerelease?e=Hde:e=Z8}if(t.length===1&&t[0].semver===z_){if(n.includePrerelease)return!0;t=Z8}let r=new Set,i,o;for(let d of e)d.operator===">"||d.operator===">="?i=J8(i,d,n):d.operator==="<"||d.operator==="<="?o=e9(o,d,n):r.add(d.semver);if(r.size>1)return null;let s;if(i&&o){if(s=U_(i.semver,o.semver,n),s>0)return null;if(s===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let d of r){if(i&&!Bb(d,String(i),n)||o&&!Bb(d,String(o),n))return null;for(let h of t)if(!Bb(d,String(h),n))return!1;return!0}let a,l,c,u,f=o&&!n.includePrerelease&&o.semver.prerelease.length?o.semver:!1,p=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&o.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(let d of t){if(u=u||d.operator===">"||d.operator===">=",c=c||d.operator==="<"||d.operator==="<=",i){if(p&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===p.major&&d.semver.minor===p.minor&&d.semver.patch===p.patch&&(p=!1),d.operator===">"||d.operator===">="){if(a=J8(i,d,n),a===d&&a!==i)return!1}else if(i.operator===">="&&!Bb(i.semver,String(d),n))return!1}if(o){if(f&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===f.major&&d.semver.minor===f.minor&&d.semver.patch===f.patch&&(f=!1),d.operator==="<"||d.operator==="<="){if(l=e9(o,d,n),l===d&&l!==o)return!1}else if(o.operator==="<="&&!Bb(o.semver,String(d),n))return!1}if(!d.operator&&(o||i)&&s!==0)return!1}return!(i&&c&&!o&&s!==0||o&&u&&!i&&s!==0||p||f)},J8=(e,t,n)=>{if(!e)return t;let r=U_(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},e9=(e,t,n)=>{if(!e)return t;let r=U_(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};t9.exports=zde});var s9=Ae((bet,o9)=>{"use strict";var $_=ch(),r9=Pb(),$de=ri(),i9=M_(),jde=vp(),qde=DQ(),Gde=OQ(),Kde=_Q(),Wde=FQ(),Yde=zQ(),Qde=UQ(),Xde=jQ(),Zde=GQ(),Jde=ps(),eme=QQ(),tme=ZQ(),nme=IA(),rme=n8(),ime=i8(),ome=_b(),sme=OA(),ame=D_(),lme=I_(),cme=PA(),ume=kA(),fme=O_(),pme=d8(),dme=Vb(),mme=ds(),hme=Fb(),gme=R8(),yme=D8(),vme=O8(),bme=_8(),Sme=L8(),wme=LA(),xme=$8(),Eme=q8(),Cme=W8(),Tme=Q8(),Ame=n9();o9.exports={parse:jde,valid:qde,clean:Gde,inc:Kde,diff:Wde,major:Yde,minor:Qde,patch:Xde,prerelease:Zde,compare:Jde,rcompare:eme,compareLoose:tme,compareBuild:nme,sort:rme,rsort:ime,gt:ome,lt:sme,eq:ame,neq:lme,gte:cme,lte:ume,cmp:fme,coerce:pme,Comparator:dme,Range:mme,satisfies:hme,toComparators:gme,maxSatisfying:yme,minSatisfying:vme,minVersion:bme,validRange:Sme,outside:wme,gtr:xme,ltr:Eme,intersects:Cme,simplifyRange:Tme,subset:Ame,SemVer:$de,re:$_.re,src:$_.src,tokens:$_.t,SEMVER_SPEC_VERSION:r9.SEMVER_SPEC_VERSION,RELEASE_TYPES:r9.RELEASE_TYPES,compareIdentifiers:i9.compareIdentifiers,rcompareIdentifiers:i9.rcompareIdentifiers}});var Rme={};Ua(Rme,{default:()=>Mme});module.exports=x9(Rme);var f9=require("obsidian");function Cr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var E9=typeof Symbol=="function"&&Symbol.observable||"@@observable",W_=E9,HA=()=>Math.random().toString(36).substring(7).split("").join("."),C9={INIT:`@@redux/INIT${HA()}`,REPLACE:`@@redux/REPLACE${HA()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${HA()}`},qb=C9;function ra(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function UA(e,t,n){if(typeof e!="function")throw new Error(Cr(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Cr(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Cr(1));return n(UA)(e,t)}let r=e,i=t,o=new Map,s=o,a=0,l=!1;function c(){s===o&&(s=new Map,o.forEach((v,g)=>{s.set(g,v)}))}function u(){if(l)throw new Error(Cr(3));return i}function f(v){if(typeof v!="function")throw new Error(Cr(4));if(l)throw new Error(Cr(5));let g=!0;c();let y=a++;return s.set(y,v),function(){if(g){if(l)throw new Error(Cr(6));g=!1,c(),s.delete(y),o=null}}}function p(v){if(!ra(v))throw new Error(Cr(7));if(typeof v.type>"u")throw new Error(Cr(8));if(typeof v.type!="string")throw new Error(Cr(17));if(l)throw new Error(Cr(9));try{l=!0,i=r(i,v)}finally{l=!1}return(o=s).forEach(y=>{y()}),v}function d(v){if(typeof v!="function")throw new Error(Cr(10));r=v,p({type:qb.REPLACE})}function h(){let v=f;return{subscribe(g){if(typeof g!="object"||g===null)throw new Error(Cr(11));function y(){let w=g;w.next&&w.next(u())}return y(),{unsubscribe:v(y)}},[W_](){return this}}}return p({type:qb.INIT}),{dispatch:p,subscribe:f,getState:u,replaceReducer:d,[W_]:h}}function T9(e){Object.keys(e).forEach(t=>{let n=e[t];if(typeof n(void 0,{type:qb.INIT})>"u")throw new Error(Cr(12));if(typeof n(void 0,{type:qb.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Cr(13))})}function Gb(e){let t=Object.keys(e),n={};for(let s=0;s<t.length;s++){let a=t[s];typeof e[a]=="function"&&(n[a]=e[a])}let r=Object.keys(n),i,o;try{T9(n)}catch(s){o=s}return function(a={},l){if(o)throw o;let c=!1,u={};for(let f=0;f<r.length;f++){let p=r[f],d=n[p],h=a[p],m=d(h,l);if(typeof m>"u"){let v=l&&l.type;throw new Error(Cr(14))}u[p]=m,c=c||m!==h}return c=c||r.length!==Object.keys(a).length,c?u:a}}function fh(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...r)=>t(n(...r)))}function Y_(...e){return t=>(n,r)=>{let i=t(n,r),o=()=>{throw new Error(Cr(15))},s={getState:i.getState,dispatch:(l,...c)=>o(l,...c)},a=e.map(l=>l(s));return o=fh(...a)(i.dispatch),{...i,dispatch:o}}}function Kb(e){return ra(e)&&"type"in e&&typeof e.type=="string"}Ti();function H9(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function U9(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function $9(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){let n=e.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${t}[${n}]`)}}var pV=e=>Array.isArray(e)?e:[e];function j9(e){let t=Array.isArray(e[0])?e[0]:e;return $9(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function q9(e,t){let n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}var Pme=Object.getPrototypeOf({});var G9=class{constructor(e){this.value=e}deref(){return this.value}},K9=typeof WeakRef<"u"?WeakRef:G9,W9=0,dV=1;function sS(){return{s:W9,v:void 0,o:null,p:null}}function Du(e,t={}){let n=sS(),{resultEqualityCheck:r}=t,i,o=0;function s(){let a=n,{length:l}=arguments;for(let f=0,p=l;f<p;f++){let d=arguments[f];if(typeof d=="function"||typeof d=="object"&&d!==null){let h=a.o;h===null&&(a.o=h=new WeakMap);let m=h.get(d);m===void 0?(a=sS(),h.set(d,a)):a=m}else{let h=a.p;h===null&&(a.p=h=new Map);let m=h.get(d);m===void 0?(a=sS(),h.set(d,a)):a=m}}let c=a,u;if(a.s===dV)u=a.v;else if(u=e.apply(null,arguments),o++,r){let f=i?.deref?.()??i;f!=null&&r(f,u)&&(u=f,o!==0&&o--),i=typeof u=="object"&&u!==null||typeof u=="function"?new K9(u):u}return c.s=dV,c.v=u,u}return s.clearCache=()=>{n=sS(),s.resetResultsCount()},s.resultsCount=()=>o,s.resetResultsCount=()=>{o=0},s}function tM(e,...t){let n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,r=(...i)=>{let o=0,s=0,a,l={},c=i.pop();typeof c=="object"&&(l=c,c=i.pop()),H9(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let u={...n,...l},{memoize:f,memoizeOptions:p=[],argsMemoize:d=Du,argsMemoizeOptions:h=[],devModeChecks:m={}}=u,v=pV(p),g=pV(h),y=j9(i),b=f(function(){return o++,c.apply(null,arguments)},...v),w=!0,S=d(function(){s++;let x=q9(y,arguments);return a=b.apply(null,x),a},...g);return Object.assign(S,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>a,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:f,argsMemoize:d})};return Object.assign(r,{withTypes:()=>r}),r}var Sp=tM(Du),Y9=Object.assign((e,t=Sp)=>{U9(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let n=Object.keys(e),r=n.map(o=>e[o]);return t(r,(...o)=>o.reduce((s,a,l)=>(s[n[l]]=a,s),{}))},{withTypes:()=>Y9});function mV(e){return({dispatch:n,getState:r})=>i=>o=>typeof o=="function"?o(n,r,e):i(o)}var hV=mV(),gV=mV;var Q9=(...e)=>{let t=tM(...e),n=Object.assign((...r)=>{let i=t(...r),o=(s,...a)=>i(zr(s)?Ch(s):s,...a);return Object.assign(o,i),o},{withTypes:()=>n});return n},$me=Q9(Du),X9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?fh:fh.apply(null,arguments)},qme=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}},Z9=e=>e&&typeof e.match=="function";function Hr(e,t){function n(...r){if(t){let i=t(...r);if(!i)throw new Error(zn(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:r[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=r=>Kb(r)&&r.type===e,n}var wV=class Th extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Th.prototype)}static get[Symbol.species](){return Th}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Th(...t[0].concat(this)):new Th(...t.concat(this))}};function yV(e){return si(e)?Wt(e,()=>{}):e}function aS(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function J9(e){return typeof e=="boolean"}var eX=()=>function(e){let{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=e??{},o=new wV;return t&&(J9(t)?o.push(hV):o.push(gV(t.extraArgument))),o},Ah="RTK_autoBatch",xp=()=>e=>({payload:e,meta:{[Ah]:!0}}),vV=e=>t=>{setTimeout(t,e)},tX=(e={type:"raf"})=>t=>(...n)=>{let r=t(...n),i=!0,o=!1,s=!1,a=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:vV(10):e.type==="callback"?e.queueNotification:vV(e.timeout),c=()=>{s=!1,o&&(o=!1,a.forEach(u=>u()))};return Object.assign({},r,{subscribe(u){let f=()=>i&&u(),p=r.subscribe(f);return a.add(u),()=>{p(),a.delete(u)}},dispatch(u){try{return i=!u?.meta?.[Ah],o=!i,o&&(s||(s=!0,l(c))),r.dispatch(u)}finally{i=!0}}})},nX=e=>function(t){let{autoBatch:n=!0}=t??{},r=new wV(e);return n&&r.push(tX(typeof n=="object"?n:void 0)),r};function xV(e){let t=eX(),{reducer:n=void 0,middleware:r,devTools:i=!0,duplicateMiddlewareCheck:o=!0,preloadedState:s=void 0,enhancers:a=void 0}=e||{},l;if(typeof n=="function")l=n;else if(ra(n))l=Gb(n);else throw new Error(zn(1));let c;typeof r=="function"?c=r(t):c=t();let u=fh;i&&(u=X9({trace:!1,...typeof i=="object"&&i}));let f=Y_(...c),p=nX(f),d=typeof a=="function"?a(p):p(),h=u(...d);return UA(l,s,h)}function EV(e){let t={},n=[],r,i={addCase(o,s){let a=typeof o=="string"?o:o.type;if(!a)throw new Error(zn(28));if(a in t)throw new Error(zn(29));return t[a]=s,i},addAsyncThunk(o,s){return s.pending&&(t[o.pending.type]=s.pending),s.rejected&&(t[o.rejected.type]=s.rejected),s.fulfilled&&(t[o.fulfilled.type]=s.fulfilled),s.settled&&n.push({matcher:o.settled,reducer:s.settled}),i},addMatcher(o,s){return n.push({matcher:o,reducer:s}),i},addDefaultCase(o){return r=o,i}};return e(i),[t,n,r]}function rX(e){return typeof e=="function"}function iX(e,t){let[n,r,i]=EV(t),o;if(rX(e))o=()=>yV(e());else{let a=yV(e);o=()=>a}function s(a=o(),l){let c=[n[l.type],...r.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[i]),c.reduce((u,f)=>{if(f)if(zr(u)){let p=f(u,l);return p===void 0?u:p}else{if(si(u))return Wt(u,p=>f(p,l));{let p=f(u,l);if(p===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return u},a)}return s.getInitialState=o,s}var CV=(e,t)=>Z9(e)?e.match(t):e(t);function ia(...e){return t=>e.some(n=>CV(n,t))}function wp(...e){return t=>e.every(n=>CV(n,t))}function cS(e,t){if(!e||!e.meta)return!1;let n=typeof e.meta.requestId=="string",r=t.indexOf(e.meta.requestStatus)>-1;return n&&r}function Mh(e){return typeof e[0]=="function"&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function uS(...e){return e.length===0?t=>cS(t,["pending"]):Mh(e)?ia(...e.map(t=>t.pending)):uS()(e[0])}function Iu(...e){return e.length===0?t=>cS(t,["rejected"]):Mh(e)?ia(...e.map(t=>t.rejected)):Iu()(e[0])}function Rh(...e){let t=n=>n&&n.meta&&n.meta.rejectedWithValue;return e.length===0?wp(Iu(...e),t):Mh(e)?wp(Iu(...e),t):Rh()(e[0])}function qa(...e){return e.length===0?t=>cS(t,["fulfilled"]):Mh(e)?ia(...e.map(t=>t.fulfilled)):qa()(e[0])}function fS(...e){return e.length===0?t=>cS(t,["pending","fulfilled","rejected"]):Mh(e)?ia(...e.flatMap(t=>[t.pending,t.rejected,t.fulfilled])):fS()(e[0])}var oX="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Nh=(e=21)=>{let t="",n=e;for(;n--;)t+=oX[Math.random()*64|0];return t},sX=["name","message","stack","code"],nM=class{constructor(e,t){P(this,"_type");this.payload=e,this.meta=t}},bV=class{constructor(e,t){P(this,"_type");this.payload=e,this.meta=t}},aX=e=>{if(typeof e=="object"&&e!==null){let t={};for(let n of sX)typeof e[n]=="string"&&(t[n]=e[n]);return t}return{message:String(e)}},SV="External signal was aborted",Zt=(()=>{function e(t,n,r){let i=Hr(t+"/fulfilled",(l,c,u,f)=>({payload:l,meta:{...f||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),o=Hr(t+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),s=Hr(t+"/rejected",(l,c,u,f,p)=>({payload:f,error:(r&&r.serializeError||aX)(l||"Rejected"),meta:{...p||{},arg:u,requestId:c,rejectedWithValue:!!f,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function a(l,{signal:c}={}){return(u,f,p)=>{let d=r?.idGenerator?r.idGenerator(l):Nh(),h=new AbortController,m,v;function g(b){v=b,h.abort()}c&&(c.aborted?g(SV):c.addEventListener("abort",()=>g(SV),{once:!0}));let y=(async function(){let b;try{let w=r?.condition?.(l,{getState:f,extra:p});if(cX(w)&&(w=await w),w===!1||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let S=new Promise((C,x)=>{m=()=>{x({name:"AbortError",message:v||"Aborted"})},h.signal.addEventListener("abort",m,{once:!0})});u(o(d,l,r?.getPendingMeta?.({requestId:d,arg:l},{getState:f,extra:p}))),b=await Promise.race([S,Promise.resolve(n(l,{dispatch:u,getState:f,extra:p,requestId:d,signal:h.signal,abort:g,rejectWithValue:(C,x)=>new nM(C,x),fulfillWithValue:(C,x)=>new bV(C,x)})).then(C=>{if(C instanceof nM)throw C;return C instanceof bV?i(C.payload,d,l,C.meta):i(C,d,l)})])}catch(w){b=w instanceof nM?s(null,d,l,w.payload,w.meta):s(w,d,l)}finally{m&&h.signal.removeEventListener("abort",m)}return r&&!r.dispatchConditionRejection&&s.match(b)&&b.meta.condition||u(b),b})();return Object.assign(y,{abort:g,requestId:d,arg:l,unwrap(){return y.then(lX)}})}}return Object.assign(a,{pending:o,rejected:s,fulfilled:i,settled:ia(s,i),typePrefix:t})}return e.withTypes=()=>e,e})();function lX(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function cX(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var TV=Symbol.for("rtk-slice-createasyncthunk"),Kme={[TV]:Zt},uX=(e=>(e.reducer="reducer",e.reducerWithPrepare="reducerWithPrepare",e.asyncThunk="asyncThunk",e))(uX||{});function fX(e,t){return`${e}/${t}`}function pX({creators:e}={}){let t=e?.asyncThunk?.[TV];return function(n){let{name:r,reducerPath:i=r}=n;if(!r)throw new Error(zn(11));let o=(typeof n.reducers=="function"?n.reducers(mX()):n.reducers)||{},s=Object.keys(o),a={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(y,b){let w=typeof y=="string"?y:y.type;if(!w)throw new Error(zn(12));if(w in a.sliceCaseReducersByType)throw new Error(zn(13));return a.sliceCaseReducersByType[w]=b,l},addMatcher(y,b){return a.sliceMatchers.push({matcher:y,reducer:b}),l},exposeAction(y,b){return a.actionCreators[y]=b,l},exposeCaseReducer(y,b){return a.sliceCaseReducersByName[y]=b,l}};s.forEach(y=>{let b=o[y],w={reducerName:y,type:fX(r,y),createNotation:typeof n.reducers=="function"};gX(b)?vX(w,b,l,t):hX(w,b,l)});function c(){let[y={},b=[],w=void 0]=typeof n.extraReducers=="function"?EV(n.extraReducers):[n.extraReducers],S={...y,...a.sliceCaseReducersByType};return iX(n.initialState,C=>{for(let x in S)C.addCase(x,S[x]);for(let x of a.sliceMatchers)C.addMatcher(x.matcher,x.reducer);for(let x of b)C.addMatcher(x.matcher,x.reducer);w&&C.addDefaultCase(w)})}let u=y=>y,f=new Map,p=new WeakMap,d;function h(y,b){return d||(d=c()),d(y,b)}function m(){return d||(d=c()),d.getInitialState()}function v(y,b=!1){function w(C){let x=C[y];return typeof x>"u"&&b&&(x=aS(p,w,m)),x}function S(C=u){let x=aS(f,b,()=>new WeakMap);return aS(x,C,()=>{let E={};for(let[T,A]of Object.entries(n.selectors??{}))E[T]=dX(A,C,()=>aS(p,C,m),b);return E})}return{reducerPath:y,getSelectors:S,get selectors(){return S(w)},selectSlice:w}}let g={name:r,reducer:h,actions:a.actionCreators,caseReducers:a.sliceCaseReducersByName,getInitialState:m,...v(i),injectInto(y,{reducerPath:b,...w}={}){let S=b??i;return y.inject({reducerPath:S,reducer:h},w),{...g,...v(S,!0)}}};return g}}function dX(e,t,n,r){function i(o,...s){let a=t(o);return typeof a>"u"&&r&&(a=n()),e(a,...s)}return i.unwrapped=e,i}var Ga=pX();function mX(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function hX({type:e,reducerName:t,createNotation:n},r,i){let o,s;if("reducer"in r){if(n&&!yX(r))throw new Error(zn(17));o=r.reducer,s=r.prepare}else o=r;i.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,s?Hr(e,s):Hr(e))}function gX(e){return e._reducerDefinitionType==="asyncThunk"}function yX(e){return e._reducerDefinitionType==="reducerWithPrepare"}function vX({type:e,reducerName:t},n,r,i){if(!i)throw new Error(zn(18));let{payloadCreator:o,fulfilled:s,pending:a,rejected:l,settled:c,options:u}=n,f=i(e,o,u);r.exposeAction(t,f),s&&r.addCase(f.fulfilled,s),a&&r.addCase(f.pending,a),l&&r.addCase(f.rejected,l),c&&r.addMatcher(f.settled,c),r.exposeCaseReducer(t,{fulfilled:s||lS,pending:a||lS,rejected:l||lS,settled:c||lS})}function lS(){}var AV="listener",MV="completed",RV="cancelled",Wme=`task-${RV}`,Yme=`task-${MV}`,Qme=`${AV}-${RV}`,Xme=`${AV}-${MV}`;var bX=(e,t)=>{if(typeof e!="function")throw new TypeError(zn(32))};var{assign:rM}=Object;var iM="listenerMiddleware";var SX=e=>{let{type:t,actionCreator:n,matcher:r,predicate:i,effect:o}=e;if(t)i=Hr(t).match;else if(n)t=n.type,i=n.match;else if(r)i=r;else if(!i)throw new Error(zn(21));return bX(o,"options.listener"),{predicate:i,type:t,effect:o}},wX=rM(e=>{let{type:t,predicate:n,effect:r}=SX(e);return{id:Nh(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(zn(22))}}},{withTypes:()=>wX});var xX=rM(Hr(`${iM}/add`),{withTypes:()=>xX}),Zme=Hr(`${iM}/removeAll`),EX=rM(Hr(`${iM}/remove`),{withTypes:()=>EX});function zn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var oM;function pS(e){return{lang:e?.lang??oM?.lang,message:e?.message,abortEarly:e?.abortEarly??oM?.abortEarly,abortPipeEarly:e?.abortPipeEarly??oM?.abortPipeEarly}}var CX;function TX(e){return CX?.get(e)}var AX;function MX(e){return AX?.get(e)}var RX;function NX(e,t){return RX?.get(e)?.get(t)}function Ou(e){let t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function Hn(e,t,n,r,i){let o=i&&"input"in i?i.input:n.value,s=i?.expected??e.expects??null,a=i?.received??Ou(o),l={kind:e.kind,type:e.type,input:o,expected:s,received:a,message:`Invalid ${t}: ${s?`Expected ${s} but r`:"R"}eceived ${a}`,requirement:e.requirement,path:i?.path,issues:i?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=e.kind==="schema",u=i?.message??e.message??NX(e.reference,l.lang)??(c?MX(l.lang):null)??r.message??TX(l.lang);u!==void 0&&(l.message=typeof u=="function"?u(l):u),c&&(n.typed=!1),n.issues?n.issues.push(l):n.issues=[l]}function eo(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},pS())}}}function DX(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function DV(e,t){let n=[...new Set(e)];return n.length>1?`(${n.join(` ${t} `)})`:n[0]??"never"}function sM(e){if(e.path){let t="";for(let n of e.path)if(typeof n.key=="string"||typeof n.key=="number")t?t+=`.${n.key}`:t+=n.key;else return null;return t}return null}var aM=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};var IX=/^\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\d|0[1-9]|3[01])[T ](?:0\d|1\d|2[0-3])(?::[0-5]\d){2}(?:\.\d{1,9})?(?:Z|[+-](?:0\d|1\d|2[0-3])(?::?[0-5]\d)?)$/u;function xn(e,t){return{kind:"validation",type:"check",reference:xn,async:!1,expects:null,requirement:e,message:t,"~run"(n,r){return n.typed&&!this.requirement(n.value)&&Hn(this,"input",n,r),n}}}function lM(e){return{kind:"validation",type:"finite",reference:lM,async:!1,expects:null,requirement:Number.isFinite,message:e,"~run"(t,n){return t.typed&&!this.requirement(t.value)&&Hn(this,"finite",t,n),t}}}function vt(e){return{kind:"validation",type:"integer",reference:vt,async:!1,expects:null,requirement:Number.isInteger,message:e,"~run"(t,n){return t.typed&&!this.requirement(t.value)&&Hn(this,"integer",t,n),t}}}function oa(e){return{kind:"validation",type:"iso_timestamp",reference:oa,async:!1,expects:null,requirement:IX,message:e,"~run"(t,n){return t.typed&&!this.requirement.test(t.value)&&Hn(this,"timestamp",t,n),t}}}function Ao(e,t){return{kind:"validation",type:"max_length",reference:Ao,async:!1,expects:`<=${e}`,requirement:e,message:t,"~run"(n,r){return n.typed&&n.value.length>this.requirement&&Hn(this,"length",n,r,{received:`${n.value.length}`}),n}}}function ms(e,t){return{kind:"validation",type:"max_value",reference:ms,async:!1,expects:`<=${e instanceof Date?e.toJSON():Ou(e)}`,requirement:e,message:t,"~run"(n,r){return n.typed&&!(n.value<=this.requirement)&&Hn(this,"value",n,r,{received:n.value instanceof Date?n.value.toJSON():Ou(n.value)}),n}}}function Ar(e,t){return{kind:"validation",type:"min_length",reference:Ar,async:!1,expects:`>=${e}`,requirement:e,message:t,"~run"(n,r){return n.typed&&n.value.length<this.requirement&&Hn(this,"length",n,r,{received:`${n.value.length}`}),n}}}function Ur(e,t){return{kind:"validation",type:"min_value",reference:Ur,async:!1,expects:`>=${e instanceof Date?e.toJSON():Ou(e)}`,requirement:e,message:t,"~run"(n,r){return n.typed&&!(n.value>=this.requirement)&&Hn(this,"value",n,r,{received:n.value instanceof Date?n.value.toJSON():Ou(n.value)}),n}}}function Ka(e){return{kind:"validation",type:"non_empty",reference:Ka,async:!1,expects:"!0",message:e,"~run"(t,n){return t.typed&&t.value.length===0&&Hn(this,"length",t,n,{received:"0"}),t}}}function Mo(e){return{kind:"transformation",type:"transform",reference:Mo,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function rc(){return{kind:"transformation",type:"trim",reference:rc,async:!1,"~run"(e){return e.value=e.value.trim(),e}}}function OX(e,t,n){return typeof e.fallback=="function"?e.fallback(t,n):e.fallback}function IV(e){let t={};for(let n of e)if(n.path){let r=sM(n);r?(t.nested||(t.nested={}),t.nested[r]?t.nested[r].push(n.message):t.nested[r]=[n.message]):t.other?t.other.push(n.message):t.other=[n.message]}else t.root?t.root.push(n.message):t.root=[n.message];return t}function cM(e,t,n){return typeof e.default=="function"?e.default(t,n):e.default}function Ai(e,t){return{kind:"schema",type:"array",reference:Ai,expects:"Array",async:!1,item:e,message:t,get"~standard"(){return eo(this)},"~run"(n,r){let i=n.value;if(Array.isArray(i)){n.typed=!0,n.value=[];for(let o=0;o<i.length;o++){let s=i[o],a=this.item["~run"]({value:s},r);if(a.issues){let l={type:"array",origin:"value",input:i,key:o,value:s};for(let c of a.issues)c.path?c.path.unshift(l):c.path=[l],n.issues?.push(c);if(n.issues||(n.issues=a.issues),r.abortEarly){n.typed=!1;break}}a.typed||(n.typed=!1),n.value.push(a.value)}}else Hn(this,"type",n,r);return n}}}function $e(e){return{kind:"schema",type:"boolean",reference:$e,expects:"boolean",async:!1,message:e,get"~standard"(){return eo(this)},"~run"(t,n){return typeof t.value=="boolean"?t.typed=!0:Hn(this,"type",t,n),t}}}function dS(e,t){return{kind:"schema",type:"literal",reference:dS,expects:Ou(e),async:!1,literal:e,message:t,get"~standard"(){return eo(this)},"~run"(n,r){return n.value===this.literal?n.typed=!0:Hn(this,"type",n,r),n}}}function mS(e,t){return{kind:"schema",type:"nullable",reference:mS,expects:`(${e.expects} | null)`,async:!1,wrapped:e,default:t,get"~standard"(){return eo(this)},"~run"(n,r){return n.value===null&&(this.default!==void 0&&(n.value=cM(this,n,r)),n.value===null)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function de(e){return{kind:"schema",type:"number",reference:de,expects:"number",async:!1,message:e,get"~standard"(){return eo(this)},"~run"(t,n){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:Hn(this,"type",t,n),t}}}function ke(e,t){return{kind:"schema",type:"object",reference:ke,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return eo(this)},"~run"(n,r){let i=n.value;if(i&&typeof i=="object"){n.typed=!0,n.value={};for(let o in this.entries){let s=this.entries[o];if(o in i||(s.type==="exact_optional"||s.type==="optional"||s.type==="nullish")&&s.default!==void 0){let a=o in i?i[o]:cM(s),l=s["~run"]({value:a},r);if(l.issues){let c={type:"object",origin:"value",input:i,key:o,value:a};for(let u of l.issues)u.path?u.path.unshift(c):u.path=[c],n.issues?.push(u);if(n.issues||(n.issues=l.issues),r.abortEarly){n.typed=!1;break}}l.typed||(n.typed=!1),n.value[o]=l.value}else if(s.fallback!==void 0)n.value[o]=OX(s);else if(s.type!=="exact_optional"&&s.type!=="optional"&&s.type!=="nullish"&&(Hn(this,"key",n,r,{input:void 0,expected:`"${o}"`,path:[{type:"object",origin:"key",input:i,key:o,value:i[o]}]}),r.abortEarly))break}}else Hn(this,"type",n,r);return n}}}function ie(e,t){return{kind:"schema",type:"optional",reference:ie,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return eo(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=cM(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function hs(e,t){return{kind:"schema",type:"picklist",reference:hs,expects:DV(e.map(Ou),"|"),async:!1,options:e,message:t,get"~standard"(){return eo(this)},"~run"(n,r){return this.options.includes(n.value)?n.typed=!0:Hn(this,"type",n,r),n}}}function Dh(e,t,n){return{kind:"schema",type:"record",reference:Dh,expects:"Object",async:!1,key:e,value:t,message:n,get"~standard"(){return eo(this)},"~run"(r,i){let o=r.value;if(o&&typeof o=="object"){r.typed=!0,r.value={};for(let s in o)if(DX(o,s)){let a=o[s],l=this.key["~run"]({value:s},i);if(l.issues){let u={type:"object",origin:"key",input:o,key:s,value:a};for(let f of l.issues)f.path=[u],r.issues?.push(f);if(r.issues||(r.issues=l.issues),i.abortEarly){r.typed=!1;break}}let c=this.value["~run"]({value:a},i);if(c.issues){let u={type:"object",origin:"value",input:o,key:s,value:a};for(let f of c.issues)f.path?f.path.unshift(u):f.path=[u],r.issues?.push(f);if(r.issues||(r.issues=c.issues),i.abortEarly){r.typed=!1;break}}(!l.typed||!c.typed)&&(r.typed=!1),l.typed&&(r.value[l.value]=c.value)}}else Hn(this,"type",r,i);return r}}}function te(e){return{kind:"schema",type:"string",reference:te,expects:"string",async:!1,message:e,get"~standard"(){return eo(this)},"~run"(t,n){return typeof t.value=="string"?t.typed=!0:Hn(this,"type",t,n),t}}}function NV(e){let t;if(e)for(let n of e)t?t.push(...n.issues):t=n.issues;return t}function Ih(e,t){return{kind:"schema",type:"union",reference:Ih,expects:DV(e.map(n=>n.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return eo(this)},"~run"(n,r){let i,o,s;for(let a of this.options){let l=a["~run"]({value:n.value},r);if(l.typed)if(l.issues)o?o.push(l):o=[l];else{i=l;break}else s?s.push(l):s=[l]}if(i)return i;if(o){if(o.length===1)return o[0];Hn(this,"type",n,r,{issues:NV(o)}),n.typed=!0}else{if(s?.length===1)return s[0];Hn(this,"type",n,r,{issues:NV(s)})}return n}}}function Ue(e,t,n){let r=e["~run"]({value:t},pS(n));if(r.issues)throw new aM(r.issues);return r.value}function hS(e,t){let n={};for(let r in e.entries)n[r]=!t||t.includes(r)?ie(e.entries[r]):e.entries[r];return{...e,entries:n,get"~standard"(){return eo(this)}}}function ae(...e){return{...e[0],pipe:e,get"~standard"(){return eo(this)},"~run"(t,n){for(let r of e)if(r.kind!=="metadata"){if(t.issues&&(r.kind==="schema"||r.kind==="transformation")){t.typed=!1;break}(!t.issues||!n.abortEarly&&!n.abortPipeEarly)&&(t=r["~run"](t,n))}return t}}}function un(e,t,n){let r=e["~run"]({value:t},pS(n));return{typed:r.typed,success:!r.issues,output:r.value,issues:r.issues}}async function OV(e,t,n){let r=await e["~run"]({value:t},pS(n));return{typed:r.typed,success:!r.issues,output:r.value,issues:r.issues}}var PX=ke({notePath:te(),manifestPath:te(),createdAt:ae(te(),oa()),lastModified:ae(te(),oa())}),ic=ke({version:te(),notes:Dh(te(),PX)}),kX=ke({line:de(),ch:de()}),_X=ke({content:te(),cursor:kX,scroll:ke({left:de(),top:de()})}),VX=ke({showDescription:ie($e(),!1),showName:ie($e(),!0),showVersionNumber:ie($e(),!0),showPreview:ie($e(),!0),expandByDefault:ie($e(),!1)}),Ro=ke({maxVersionsPerNote:ie(ae(de(),vt(),Ur(1),ms(1e3)),50),autoCleanupOldVersions:ie($e(),!1),autoCleanupDays:ie(ae(de(),vt(),Ur(1)),60),useRelativeTimestamps:ie($e(),!0),enableVersionNaming:ie($e(),!0),enableVersionDescription:ie($e(),!1),showDescriptionInList:ie($e(),!1),isListView:ie($e(),!1),renderMarkdownInPreview:ie($e(),!0),enableWatchMode:ie($e(),!1),watchModeInterval:ie(ae(de(),vt(),Ur(1)),60),autoSaveOnSave:ie($e(),!1),autoSaveOnSaveInterval:ie(ae(de(),vt(),Ur(1)),2),enableMinLinesChangedCheck:ie($e(),!1),minLinesChanged:ie(ae(de(),vt(),Ur(1)),5),enableWordCount:ie($e(),!1),includeMdSyntaxInWordCount:ie($e(),!1),enableCharacterCount:ie($e(),!1),includeMdSyntaxInCharacterCount:ie($e(),!1),enableLineCount:ie($e(),!1),includeMdSyntaxInLineCount:ie($e(),!1),isGlobal:ie($e(),!0),enableDiskPersistence:ie($e(),!0),autoRegisterNotes:ie($e(),!1),pathFilters:ie(Ai(te()),[])}),Mi=ke({version:ie(te(),"0.0.0"),databasePath:ae(te(),Ar(1)),noteIdFrontmatterKey:ae(te(),Ar(1),xn(e=>!e.includes(":"),"Key cannot contain a colon")),legacyNoteIdFrontmatterKeys:ie(Ai(te()),[]),keyUpdatePathFilters:ie(Ai(te()),[]),defaultExportFormat:ie(hs(["md","json","ndjson","txt","zip","gzip"]),"md"),enableCompression:ie($e(),!0),autoRegisterNotes:ie($e(),!1),pathFilters:ie(Ai(te()),[]),noteIdFormat:ie(ae(te(),Ar(1)),"{uuid}"),versionIdFormat:ie(ae(te(),Ar(1)),"{timestamp}_{version}"),centralManifest:ie(ic,{version:"1.0.0",notes:{}}),versionHistorySettings:Ro,editHistorySettings:Ro}),LX=ke({versionNumber:ae(de(),vt()),timestamp:ae(te(),oa()),name:ie(te()),description:ie(te()),size:de(),compressedSize:ie(de()),uncompressedSize:ie(de()),contentHash:ie(te()),wordCount:ie(de()),wordCountWithMd:ie(de()),charCount:ie(de()),charCountWithMd:ie(de()),lineCount:ie(de()),lineCountWithoutMd:ie(de())}),FX=ke({versions:Dh(te(),LX),totalVersions:ae(de(),vt()),settings:ie(hS(Ro)),state:ie(_X),timelineSettings:ie(VX)}),gS=ke({noteId:te(),notePath:te(),currentBranch:te(),branches:Dh(te(),FX),createdAt:ae(te(),oa()),lastModified:ae(te(),oa())}),uM=ke({id:te(),noteId:te(),notePath:te(),branchName:te(),versionNumber:de(),timestamp:ae(te(),oa()),name:ie(te()),description:ie(te()),size:de(),compressedSize:ie(de()),uncompressedSize:ie(de()),contentHash:ie(te()),wordCount:ie(de()),wordCountWithMd:ie(de()),charCount:ie(de()),charCountWithMd:ie(de()),lineCount:ie(de()),lineCountWithoutMd:ie(de())}),fM=ke({...uM.entries,content:te()}),ohe=ke({title:te(),message:te(),details:ie(te())}),BX=hs(["lines","words","chars","smart"]),zX=ke({id:dS("current"),name:dS("Current Note State"),timestamp:ae(te(),oa()),notePath:te()}),HX=Ih([uM,zX]),yS=ke({value:te(),added:ie($e()),removed:ie($e()),count:ie(de()),parts:ie(Ai(ke({value:te(),added:ie($e()),removed:ie($e()),count:ie(de())})))}),she=ke({status:hs(["generating","ready","re-diffing"]),version1:uM,version2:HX,diffChanges:mS(Ai(yS)),diffType:BX,content1:te(),content2:te()}),UX=hs(["CRITICAL","HIGH","NORMAL","LOW","BACKGROUND"]),ahe=ke({id:te(),timestamp:ae(de(),vt()),priority:UX,sequence:ae(de(),vt())}),lhe=ke({noteId:te(),branchName:te(),sequence:ae(de(),vt()),timestamp:ae(de(),vt()),retryCount:ae(de(),vt())}),che=ke({pendingWrites:ae(de(),vt()),queuedOperations:ae(de(),vt()),activeOperations:ae(de(),vt())}),$X=ke({consecutiveErrors:ae(de(),vt()),operationCount:ae(de(),vt()),averageOperationTime:de(),isHealthy:$e()}),uhe=ke({isInitialized:$e(),isActive:$e(),isHealthy:$e(),healthStats:$X}),fhe=ke({size:ae(de(),vt()),capacity:ae(de(),vt()),utilization:de()}),phe=ke({maxVersionsPerNote:ae(de(),vt(),Ur(1),ms(1e3)),autoCleanupOldVersions:$e(),autoCleanupDays:ae(de(),vt(),Ur(1))}),dhe=ke({deletedNoteDirs:ae(de(),vt()),deletedVersionFiles:ae(de(),vt()),success:$e(),errors:ie(Ai(te()))}),mhe=ke({versionNumber:ae(de(),vt()),timestamp:te()}),jX=ke({additions:ae(de(),vt()),deletions:ae(de(),vt())}),hhe=ke({id:ie(ae(de(),vt())),noteId:te(),branchName:te(),source:hs(["version","edit"]),fromVersionId:mS(te()),toVersionId:te(),timestamp:ae(te(),oa()),diffData:Ai(yS),stats:jX,toVersionName:ie(te()),toVersionNumber:ae(de(),vt()),toVersionDescription:ie(te())});var Ep="version-control-view",pM=".versiondb",kV="https://raw.githubusercontent.com/Yuichi-Aragi/Version-Control/main/CHANGELOG.md",Pu="main",PV=Ue(Ro,{autoRegisterNotes:!1,pathFilters:[],enableDiskPersistence:!0}),fn=Ue(Mi,{version:"0.0.0",databasePath:pM,noteIdFrontmatterKey:"vc-id",legacyNoteIdFrontmatterKeys:[],keyUpdatePathFilters:[],defaultExportFormat:"md",autoRegisterNotes:!1,pathFilters:[],enableCompression:!0,centralManifest:{version:"1.0.0",notes:{}},noteIdFormat:"{uuid}",versionIdFormat:"{timestamp}_{version}",versionHistorySettings:PV,editHistorySettings:{...PV,isListView:!0,autoSaveOnSave:!1,enableVersionNaming:!1,enableVersionDescription:!1}});var vS=e=>{let t={property:"versionNumber",direction:"desc"};return{status:"INITIALIZING",contextVersion:0,settings:{...fn,...e},effectiveSettings:fn.versionHistorySettings,error:null,file:null,noteId:null,lastNoteId:null,lastFilePath:null,viewMode:"versions",currentBranch:null,availableBranches:[],isProcessing:!1,isRenaming:!1,panel:null,namingVersionId:null,isManualVersionEdit:!1,highlightedVersionId:null,isSearchActive:!1,searchQuery:"",isSearchCaseSensitive:!1,sortOrder:t,diffRequest:null,watchModeCountdown:null}};var bN={};Ua(bN,{autoRegisterNote:()=>Dz,cleanupOrphanedVersions:()=>xee,initializeView:()=>Nr,loadEffectiveSettingsForNote:()=>Ds,loadHistory:()=>Eee,reconcileNoteId:()=>Iz});var Ug=require("obsidian");function _V(e,t,n){return e<t?n==="asc"?-1:1:e>t?n==="asc"?1:-1:0}function mr(e,t,n){return e.slice().sort((r,i)=>{let o=n.length;for(let s=0;s<t.length;s++){let a=o>s?n[s]:n[o-1],l=t[s],c=typeof l=="function",u=c?l(r):r[l],f=c?l(i):i[l],p=_V(u,f,a);if(p!==0)return p}return 0})}function Oh(e,t,{signal:n,edges:r}={}){let i,o=null,s=r!=null&&r.includes("leading"),a=r==null||r.includes("trailing"),l=()=>{o!==null&&(e.apply(i,o),i=void 0,o=null)},c=()=>{a&&l(),d()},u=null,f=()=>{u!=null&&clearTimeout(u),u=setTimeout(()=>{u=null,c()},t)},p=()=>{u!==null&&(clearTimeout(u),u=null)},d=()=>{p(),i=void 0,o=null},h=()=>{l()},m=function(...v){if(n?.aborted)return;i=this,o=v;let g=u==null;f(),s&&g&&l()};return m.schedule=f,m.cancel=d,m.flush=h,n?.addEventListener("abort",d,{once:!0}),m}function bS(e){return e}function dM(e,t={}){let{cache:n=new Map,getCacheKey:r}=t,i=function(o){let s=r?r(o):o;if(n.has(s))return n.get(s);let a=e.call(this,o);return n.set(s,a),a};return i.cache=n,i}function VV(){}function Ph(e,t,{signal:n,edges:r=["leading","trailing"]}={}){let i=null,o=Oh(function(...a){i=Date.now(),e.apply(this,a)},t,{signal:n,edges:r}),s=function(...a){if(i==null&&(i=Date.now()),Date.now()-i>=t){i=Date.now(),e.apply(this,a),o.cancel(),o.schedule();return}o.apply(this,a)};return s.cancel=o.cancel,s.flush=o.flush,s}function En(e,t,n){return n==null?Math.min(e,t):Math.min(Math.max(e,t),n)}function LV(e,t,n=1){if(t==null&&(t=e,e=0),!Number.isInteger(n)||n===0)throw new Error("The step value must be a non-zero integer.");let r=Math.max(Math.ceil((t-e)/n),0),i=new Array(r);for(let o=0;o<r;o++)i[o]=e+o*n;return i}function kh(e){return e==null||typeof e!="object"&&typeof e!="function"}function SS(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _h(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function ku(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var wS="[object RegExp]",Cp="[object String]",Tp="[object Number]",Ap="[object Boolean]",_u="[object Arguments]",xS="[object Symbol]",ES="[object Date]",CS="[object Map]",TS="[object Set]",AS="[object Array]",FV="[object Function]",MS="[object ArrayBuffer]",Mp="[object Object]",BV="[object Error]",RS="[object DataView]",NS="[object Uint8Array]",DS="[object Uint8ClampedArray]",IS="[object Uint16Array]",OS="[object Uint32Array]",zV="[object BigUint64Array]",PS="[object Int8Array]",kS="[object Int16Array]",_S="[object Int32Array]",HV="[object BigInt64Array]",VS="[object Float32Array]",LS="[object Float64Array]";function UV(e,t){return oc(e,void 0,e,new Map,t)}function oc(e,t,n,r=new Map,i=void 0){let o=i?.(e,t,n,r);if(o!==void 0)return o;if(kh(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){let s=new Array(e.length);r.set(e,s);for(let a=0;a<e.length;a++)s[a]=oc(e[a],a,n,r,i);return Object.hasOwn(e,"index")&&(s.index=e.index),Object.hasOwn(e,"input")&&(s.input=e.input),s}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let s=new RegExp(e.source,e.flags);return s.lastIndex=e.lastIndex,s}if(e instanceof Map){let s=new Map;r.set(e,s);for(let[a,l]of e)s.set(a,oc(l,a,n,r,i));return s}if(e instanceof Set){let s=new Set;r.set(e,s);for(let a of e)s.add(oc(a,void 0,n,r,i));return s}if(SS(e)){let s=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,s);for(let a=0;a<e.length;a++)s[a]=oc(e[a],a,n,r,i);return s}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let s=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,s),gs(s,e,n,r,i),s}if(typeof File<"u"&&e instanceof File){let s=new File([e],e.name,{type:e.type});return r.set(e,s),gs(s,e,n,r,i),s}if(typeof Blob<"u"&&e instanceof Blob){let s=new Blob([e],{type:e.type});return r.set(e,s),gs(s,e,n,r,i),s}if(e instanceof Error){let s=new e.constructor;return r.set(e,s),s.message=e.message,s.name=e.name,s.stack=e.stack,s.cause=e.cause,gs(s,e,n,r,i),s}if(e instanceof Boolean){let s=new Boolean(e.valueOf());return r.set(e,s),gs(s,e,n,r,i),s}if(e instanceof Number){let s=new Number(e.valueOf());return r.set(e,s),gs(s,e,n,r,i),s}if(e instanceof String){let s=new String(e.valueOf());return r.set(e,s),gs(s,e,n,r,i),s}if(typeof e=="object"&&qX(e)){let s=Object.create(Object.getPrototypeOf(e));return r.set(e,s),gs(s,e,n,r,i),s}return e}function gs(e,t,n=e,r,i){let o=[...Object.keys(t),..._h(t)];for(let s=0;s<o.length;s++){let a=o[s],l=Object.getOwnPropertyDescriptor(e,a);(l==null||l.writable)&&(e[a]=oc(t[a],a,n,r,i))}}function qX(e){switch(ku(e)){case _u:case AS:case MS:case RS:case Ap:case ES:case VS:case LS:case PS:case kS:case _S:case CS:case Tp:case Mp:case wS:case TS:case Cp:case xS:case NS:case DS:case IS:case OS:return!0;default:return!1}}function $V(e){return oc(e,void 0,e,new Map,void 0)}function mM(e){if(!e||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function FS(e){return e==="__proto__"}function Rp(e,t){let n={},r=Object.keys(e);for(let i=0;i<r.length;i++){let o=r[i],s=e[o];t(s,o)&&(n[o]=s)}return n}function Vh(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function jV(e,t,n){return Lh(e,t,void 0,void 0,void 0,void 0,n)}function Lh(e,t,n,r,i,o,s){let a=s(e,t,n,r,i,o);if(a!==void 0)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return Fh(e,t,o,s)}return Fh(e,t,o,s)}function Fh(e,t,n,r){if(Object.is(e,t))return!0;let i=ku(e),o=ku(t);if(i===_u&&(i=Mp),o===_u&&(o=Mp),i!==o)return!1;switch(i){case Cp:return e.toString()===t.toString();case Tp:{let l=e.valueOf(),c=t.valueOf();return Vh(l,c)}case Ap:case ES:case xS:return Object.is(e.valueOf(),t.valueOf());case wS:return e.source===t.source&&e.flags===t.flags;case FV:return e===t}n=n??new Map;let s=n.get(e),a=n.get(t);if(s!=null&&a!=null)return s===t;n.set(e,t),n.set(t,e);try{switch(i){case CS:{if(e.size!==t.size)return!1;for(let[l,c]of e.entries())if(!t.has(l)||!Lh(c,t.get(l),l,e,t,n,r))return!1;return!0}case TS:{if(e.size!==t.size)return!1;let l=Array.from(e.values()),c=Array.from(t.values());for(let u=0;u<l.length;u++){let f=l[u],p=c.findIndex(d=>Lh(f,d,void 0,e,t,n,r));if(p===-1)return!1;c.splice(p,1)}return!0}case AS:case NS:case DS:case IS:case OS:case zV:case PS:case kS:case _S:case HV:case VS:case LS:{if(e.length!==t.length)return!1;for(let l=0;l<e.length;l++)if(!Lh(e[l],t[l],l,e,t,n,r))return!1;return!0}case MS:return e.byteLength!==t.byteLength?!1:Fh(new Uint8Array(e),new Uint8Array(t),n,r);case RS:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:Fh(new Uint8Array(e),new Uint8Array(t),n,r);case BV:return e.name===t.name&&e.message===t.message;case Mp:{if(!(Fh(e.constructor,t.constructor,n,r)||mM(e)&&mM(t)))return!1;let c=[...Object.keys(e),..._h(e)],u=[...Object.keys(t),..._h(t)];if(c.length!==u.length)return!1;for(let f=0;f<c.length;f++){let p=c[f],d=e[p];if(!Object.hasOwn(t,p))return!1;let h=t[p];if(!Lh(d,h,p,e,t,n,r))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function Wa(e,t){return jV(e,t,VV)}function qV(e){return Number.isSafeInteger(e)&&e>=0}function sc(e){return e==null}function In(e){return e!=null}function sa(e){return typeof e=="string"}function Np(e){return e===void 0}function hM(e){return e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function BS(e,t){if(t===void 0)return e.trimEnd();let n=e.length;switch(typeof t){case"string":{if(t.length!==1)throw new Error("The 'chars' parameter should be a single character string.");for(;n>0&&e[n-1]===t;)n--;break}case"object":for(;n>0&&t.includes(e[n-1]);)n--}return e.substring(0,n)}function zS(e,t){if(t===void 0)return e.trimStart();let n=0;switch(typeof t){case"string":{for(;n<e.length&&e[n]===t;)n++;break}case"object":for(;n<e.length&&t.includes(e[n]);)n++}return e.substring(n)}function HS(e,t){return t===void 0?e.trim():zS(BS(e,t),t)}var GV=e=>{if(e)return Rp(e,t=>!Np(t))};async function to(e,t,n){if(!n?.plugin?.settings){console.warn("Version Control: Plugin settings not available, using defaults");let a=t==="version"?{...fn.versionHistorySettings,isGlobal:!0}:{...fn.editHistorySettings,isGlobal:!0};return Ue(Ro,a)}let{manifestManager:r,editHistoryManager:i,plugin:o}=n,s=t==="version"?o.settings.versionHistorySettings:o.settings.editHistorySettings;try{let a=await r.loadNoteManifest(e);if(!a)return Ue(Ro,{...s,isGlobal:!0});let l=a.currentBranch,c;if(t==="version"){let p=a.branches[l];c=GV(p?.settings)}else{let p=await i.getEditManifest(e);if(p){let d=p.branches[l];c=GV(d?.settings)}}let u=c?.isGlobal!==!1,f;if(u)f={...s,isGlobal:!0};else{let p=Rp(c??{},d=>!Np(d));f={...s,...p,isGlobal:!1}}return Ue(Ro,f)}catch(a){return console.error("Version Control: Error resolving settings",a),Ue(Ro,{...s,isGlobal:!0})}}var rz=require("obsidian");var GX=e=>{try{return e.plugin?.isUnloading===!0}catch{return!0}},KX=(e,t)=>{let r=e().app;return!(t.contextVersion!==void 0&&r.contextVersion!==t.contextVersion||t.status!==void 0&&r.status!==t.status||t.noteId!==void 0&&r.noteId!==t.noteId||t.filePath!==void 0&&r.file?.path!==t.filePath||t.viewMode!==void 0&&r.viewMode!==t.viewMode||t.branch!==void 0&&r.currentBranch!==t.branch)},q=(e,t,n)=>!!(GX(e)||n&&!KX(t,n));Ti();var KV=class extends Error{constructor(t){super(t[0].message);P(this,"issues");this.name="SchemaError",this.issues=t}};var xM=(e=>(e.uninitialized="uninitialized",e.pending="pending",e.fulfilled="fulfilled",e.rejected="rejected",e))(xM||{}),Qa="uninitialized",yM="pending",zh="fulfilled",Hh="rejected";function WV(e){return{status:e,isUninitialized:e===Qa,isLoading:e===yM,isSuccess:e===zh,isError:e===Hh}}var YV=ra;function GS(e,t){if(e===t||!(YV(e)&&YV(t)||Array.isArray(e)&&Array.isArray(t)))return t;let n=Object.keys(t),r=Object.keys(e),i=n.length===r.length,o=Array.isArray(t)?[]:{};for(let s of n)o[s]=GS(e[s],t[s]),i&&(i=e[s]===o[s]);return i?e:o}function vM(e,t,n){return e.reduce((r,i,o)=>(t(i,o)&&r.push(n(i,o)),r),[]).flat()}function WX(e){return new RegExp("(^|:)//").test(e)}function YX(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function EM(e){return e!=null}function QV(e){return[...e?.values()??[]].filter(EM)}function QX(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var XX=e=>e.replace(/\/$/,""),ZX=e=>e.replace(/^\//,"");function JX(e,t){if(!e)return t;if(!t)return e;if(WX(t))return t;let n=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=XX(e),t=ZX(t),`${e}${n}${t}`}function jS(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}var bM=()=>new Map,e7=e=>{let t=new AbortController;return setTimeout(()=>{let n="signal timed out",r="TimeoutError";t.abort(typeof DOMException<"u"?new DOMException(n,r):Object.assign(new Error(n),{name:r}))},e),t.signal},t7=(...e)=>{for(let n of e)if(n.aborted)return AbortSignal.abort(n.reason);let t=new AbortController;for(let n of e)n.addEventListener("abort",()=>t.abort(n.reason),{signal:t.signal,once:!0});return t.signal},XV=(...e)=>fetch(...e),n7=e=>e.status>=200&&e.status<=299,r7=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function ZV(e){if(!ra(e))return e;let t={...e};for(let[n,r]of Object.entries(t))r===void 0&&delete t[n];return t}var i7=e=>typeof e=="object"&&(ra(e)||Array.isArray(e)||typeof e.toJSON=="function");function cL({baseUrl:e,prepareHeaders:t=f=>f,fetchFn:n=XV,paramsSerializer:r,isJsonContentType:i=r7,jsonContentType:o="application/json",jsonReplacer:s,timeout:a,responseHandler:l,validateStatus:c,...u}={}){return typeof fetch>"u"&&n===XV&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(p,d,h)=>{let{getState:m,extra:v,endpoint:g,forced:y,type:b}=d,w,{url:S,headers:C=new Headers(u.headers),params:x=void 0,responseHandler:E=l??"json",validateStatus:T=c??n7,timeout:A=a,...M}=typeof p=="string"?{url:p}:p,R={...u,signal:A?t7(d.signal,e7(A)):d.signal,...M};C=new Headers(ZV(C)),R.headers=await t(C,{getState:m,arg:p,extra:v,endpoint:g,forced:y,type:b,extraOptions:h})||C;let N=i7(R.body);if(R.body!=null&&!N&&typeof R.body!="string"&&R.headers.delete("content-type"),!R.headers.has("content-type")&&N&&R.headers.set("content-type",o),N&&i(R.headers)&&(R.body=JSON.stringify(R.body,s)),R.headers.has("accept")||(E==="json"?R.headers.set("accept","application/json"):E==="text"&&R.headers.set("accept","text/plain, text/html, */*")),x){let k=~S.indexOf("?")?"&":"?",K=r?r(x):new URLSearchParams(ZV(x));S+=k+K}S=JX(e,S);let I=new Request(S,R);w={request:new Request(S,R)};let _;try{_=await n(I)}catch(k){return{error:{status:(k instanceof Error||typeof DOMException<"u"&&k instanceof DOMException)&&k.name==="TimeoutError"?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(k)},meta:w}}let z=_.clone();w.response=z;let F,L="";try{let k;if(await Promise.all([f(_,E).then(K=>F=K,K=>k=K),z.text().then(K=>L=K,()=>{})]),k)throw k}catch(k){return{error:{status:"PARSING_ERROR",originalStatus:_.status,data:L,error:String(k)},meta:w}}return T(_,F)?{data:F,meta:w}:{error:{status:_.status,data:F},meta:w}};async function f(p,d){if(typeof d=="function")return d(p);if(d==="content-type"&&(d=i(p.headers)?"json":"text"),d==="json"){let h=await p.text();return h.length?JSON.parse(h):null}return p.text()}}var Dp=class{constructor(e,t=void 0){this.value=e,this.meta=t}};async function o7(e=0,t=5,n){let r=Math.min(e,t),i=~~((Math.random()+.4)*(300<<r));await new Promise((o,s)=>{let a=setTimeout(()=>o(),i);if(n){let l=()=>{clearTimeout(a),s(new Error("Aborted"))};n.aborted?(clearTimeout(a),s(new Error("Aborted"))):n.addEventListener("abort",l,{once:!0})}})}function uL(e,t){throw Object.assign(new Dp({error:e,meta:t}),{throwImmediately:!0})}function gM(e){e.aborted&&uL({status:"CUSTOM_ERROR",error:"Aborted"})}var JV={},s7=(e,t)=>async(n,r,i)=>{let o=[5,(t||JV).maxRetries,(i||JV).maxRetries].filter(c=>c!==void 0),[s]=o.slice(-1),a={maxRetries:s,backoff:o7,retryCondition:(c,u,{attempt:f})=>f<=s,...t,...i},l=0;for(;;){gM(r.signal);try{let c=await e(n,r,i);if(c.error)throw new Dp(c);return c}catch(c){if(l++,c.throwImmediately){if(c instanceof Dp)return c.value;throw c}if(c instanceof Dp){if(!a.retryCondition(c.value.error,n,{attempt:l,baseQueryApi:r,extraOptions:i}))return c.value}else if(l>a.maxRetries)return{error:c};gM(r.signal);try{await a.backoff(l,a.maxRetries,r.signal)}catch(u){throw gM(r.signal),u}}}},Lge=Object.assign(s7,{fail:uL}),KS="__rtkq/",a7="online",l7="offline";var fL="focused";var CM=Hr(`${KS}${fL}`),pL=Hr(`${KS}un${fL}`),TM=Hr(`${KS}${a7}`),dL=Hr(`${KS}${l7}`);var jh="query",mL="mutation",hL="infinitequery";function WS(e){return e.type===jh}function c7(e){return e.type===mL}function YS(e){return e.type===hL}function qS(e){return WS(e)||YS(e)}function AM(e,t,n,r,i,o){let s=u7(e)?e(t,n,r,i):e;return s?vM(s,EM,a=>o(gL(a))):[]}function u7(e){return typeof e=="function"}function gL(e){return typeof e=="string"?{type:e}:e}function f7(e,t){return e.catch(t)}var Ip=(e,t)=>e.endpointDefinitions[t],Uh=Symbol("forceQueryFn"),SM=e=>typeof e[Uh]=="function";function p7({serializeQueryArgs:e,queryThunk:t,infiniteQueryThunk:n,mutationThunk:r,api:i,context:o,getInternalState:s}){let a=S=>s(S)?.runningQueries,l=S=>s(S)?.runningMutations,{unsubscribeQueryResult:c,removeMutationResult:u,updateSubscriptionOptions:f}=i.internalActions;return{buildInitiateQuery:y,buildInitiateInfiniteQuery:b,buildInitiateMutation:w,getRunningQueryThunk:p,getRunningMutationThunk:d,getRunningQueriesThunk:h,getRunningMutationsThunk:m};function p(S,C){return x=>{let E=Ip(o,S),T=e({queryArgs:C,endpointDefinition:E,endpointName:S});return a(x)?.get(T)}}function d(S,C){return x=>l(x)?.get(C)}function h(){return S=>QV(a(S))}function m(){return S=>QV(l(S))}function v(S){}function g(S,C){let x=(E,{subscribe:T=!0,forceRefetch:A,subscriptionOptions:M,[Uh]:R,...N}={})=>(I,_)=>{let z=e({queryArgs:E,endpointDefinition:C,endpointName:S}),F,L={...N,type:jh,subscribe:T,forceRefetch:A,subscriptionOptions:M,endpointName:S,originalArgs:E,queryCacheKey:z,[Uh]:R};if(WS(C))F=t(L);else{let{direction:V,initialPageParam:Q,refetchCachedPages:Y}=N;F=n({...L,direction:V,initialPageParam:Q,refetchCachedPages:Y})}let k=i.endpoints[S].select(E),K=I(F),ee=k(_()),{requestId:Se,abort:De}=K,we=ee.requestId!==Se,qe=a(I)?.get(z),Fe=()=>k(_()),pe=Object.assign(R?K.then(Fe):we&&!qe?Promise.resolve(ee):Promise.all([qe,K]).then(Fe),{arg:E,requestId:Se,subscriptionOptions:M,queryCacheKey:z,abort:De,async unwrap(){let V=await pe;if(V.isError)throw V.error;return V.data},refetch:V=>I(x(E,{subscribe:!1,forceRefetch:!0,...V})),unsubscribe(){T&&I(c({queryCacheKey:z,requestId:Se}))},updateSubscriptionOptions(V){pe.subscriptionOptions=V,I(f({endpointName:S,requestId:Se,queryCacheKey:z,options:V}))}});if(!qe&&!we&&!R){let V=a(I);V.set(z,pe),pe.then(()=>{V.delete(z)})}return pe};return x}function y(S,C){return g(S,C)}function b(S,C){return g(S,C)}function w(S){return(C,{track:x=!0,fixedCacheKey:E}={})=>(T,A)=>{let M=r({type:"mutation",endpointName:S,originalArgs:C,track:x,fixedCacheKey:E}),R=T(M),{requestId:N,abort:I,unwrap:_}=R,z=f7(R.unwrap().then(K=>({data:K})),K=>({error:K})),F=()=>{T(u({requestId:N,fixedCacheKey:E}))},L=Object.assign(z,{arg:R.arg,requestId:N,abort:I,unwrap:_,reset:F}),k=l(T);return k.set(N,L),L.then(()=>{k.delete(N)}),E&&(k.set(E,L),L.then(()=>{k.get(E)===L&&k.delete(E)})),L}}}var yL=class extends KV{constructor(e,t,n,r){super(e),this.value=t,this.schemaName=n,this._bqMeta=r}},Vu=(e,t)=>Array.isArray(e)?e.includes(t):!!e;async function Lu(e,t,n,r){let i=await e["~standard"].validate(t);if(i.issues)throw new yL(i.issues,t,n,r);return i.value}function eL(e){return e}var Bh=(e={})=>({...e,[Ah]:!0});function d7({reducerPath:e,baseQuery:t,context:{endpointDefinitions:n},serializeQueryArgs:r,api:i,assertTagType:o,selectors:s,onSchemaFailure:a,catchSchemaFailure:l,skipSchemaValidation:c}){let u=(M,R,N,I)=>(_,z)=>{let F=n[M],L=r({queryArgs:R,endpointDefinition:F,endpointName:M});if(_(i.internalActions.queryResultPatched({queryCacheKey:L,patches:N})),!I)return;let k=i.endpoints[M].select(R)(z()),K=AM(F.providesTags,k.data,void 0,R,{},o);_(i.internalActions.updateProvidedBy([{queryCacheKey:L,providedTags:K}]))};function f(M,R,N=0){let I=[R,...M];return N&&I.length>N?I.slice(0,-1):I}function p(M,R,N=0){let I=[...M,R];return N&&I.length>N?I.slice(1):I}let d=(M,R,N,I=!0)=>(_,z)=>{let F=i.endpoints[M].select(R)(z()),L={patches:[],inversePatches:[],undo:()=>_(i.util.patchQueryData(M,R,L.inversePatches,I))};if(F.status===Qa)return L;let k;if("data"in F)if(si(F.data)){let[K,ee,Se]=JA(F.data,N);L.patches.push(...ee),L.inversePatches.push(...Se),k=K}else k=N(F.data),L.patches.push({op:"replace",path:[],value:k}),L.inversePatches.push({op:"replace",path:[],value:F.data});return L.patches.length===0||_(i.util.patchQueryData(M,R,L.patches,I)),L},h=(M,R,N)=>I=>I(i.endpoints[M].initiate(R,{subscribe:!1,forceRefetch:!0,[Uh]:()=>({data:N})})),m=(M,R)=>M.query&&M[R]?M[R]:eL,v=async(M,{signal:R,abort:N,rejectWithValue:I,fulfillWithValue:_,dispatch:z,getState:F,extra:L})=>{let k=n[M.endpointName],{metaSchema:K,skipSchemaValidation:ee=c}=k,Se=M.type===jh;try{let De=eL,we={signal:R,abort:N,dispatch:z,getState:F,extra:L,endpoint:M.endpointName,type:M.type,forced:Se?g(M,F()):void 0,queryCacheKey:Se?M.queryCacheKey:void 0},qe=Se?M[Uh]:void 0,Fe,pe=async(Q,Y,Ie,yt)=>{if(Y==null&&Q.pages.length)return Promise.resolve({data:Q});let mt={queryArg:M.originalArgs,pageParam:Y},st=await V(mt),xt=yt?f:p;return{data:{pages:xt(Q.pages,st.data,Ie),pageParams:xt(Q.pageParams,Y,Ie)},meta:st.meta}};async function V(Q){let Y,{extraOptions:Ie,argSchema:yt,rawResponseSchema:mt,responseSchema:st}=k;if(yt&&!Vu(ee,"arg")&&(Q=await Lu(yt,Q,"argSchema",{})),qe?Y=qe():k.query?(De=m(k,"transformResponse"),Y=await t(k.query(Q),we,Ie)):Y=await k.queryFn(Q,we,Ie,at=>t(at,we,Ie)),Y.error)throw new Dp(Y.error,Y.meta);let{data:xt}=Y;mt&&!Vu(ee,"rawResponse")&&(xt=await Lu(mt,Y.data,"rawResponseSchema",Y.meta));let Et=await De(xt,Y.meta,Q);return st&&!Vu(ee,"response")&&(Et=await Lu(st,Et,"responseSchema",Y.meta)),{...Y,data:Et}}if(Se&&"infiniteQueryOptions"in k){let{infiniteQueryOptions:Q}=k,{maxPages:Y=1/0}=Q,Ie=M.refetchCachedPages??Q.refetchCachedPages??!0,yt,mt={pages:[],pageParams:[]},st=s.selectQueryEntry(F(),M.queryCacheKey)?.data,xt=g(M,F())&&!M.direction||!st?mt:st;if("direction"in M&&M.direction&&xt.pages.length){let Et=M.direction==="backward",at=(Et?vL:wM)(Q,xt,M.originalArgs);yt=await pe(xt,at,Y,Et)}else{let{initialPageParam:Et=Q.initialPageParam}=M,at=st?.pageParams??[],Dt=at[0]??Et,oi=at.length;if(yt=await pe(xt,Dt,Y),qe&&(yt={data:yt.data.pages[0]}),Ie)for(let wn=1;wn<oi;wn++){let O=wM(Q,yt.data,M.originalArgs);yt=await pe(yt.data,O,Y)}}Fe=yt}else Fe=await V(M.originalArgs);return K&&!Vu(ee,"meta")&&Fe.meta&&(Fe.meta=await Lu(K,Fe.meta,"metaSchema",Fe.meta)),_(Fe.data,Bh({fulfilledTimeStamp:Date.now(),baseQueryMeta:Fe.meta}))}catch(De){let we=De;if(we instanceof Dp){let qe=m(k,"transformErrorResponse"),{rawErrorResponseSchema:Fe,errorResponseSchema:pe}=k,{value:V,meta:Q}=we;try{Fe&&!Vu(ee,"rawErrorResponse")&&(V=await Lu(Fe,V,"rawErrorResponseSchema",Q)),K&&!Vu(ee,"meta")&&(Q=await Lu(K,Q,"metaSchema",Q));let Y=await qe(V,Q,M.originalArgs);return pe&&!Vu(ee,"errorResponse")&&(Y=await Lu(pe,Y,"errorResponseSchema",Q)),I(Y,Bh({baseQueryMeta:Q}))}catch(Y){we=Y}}try{if(we instanceof yL){let qe={endpoint:M.endpointName,arg:M.originalArgs,type:M.type,queryCacheKey:Se?M.queryCacheKey:void 0};k.onSchemaFailure?.(we,qe),a?.(we,qe);let{catchSchemaFailure:Fe=l}=k;if(Fe)return I(Fe(we,qe),Bh({baseQueryMeta:we._bqMeta}))}}catch(qe){we=qe}throw console.error(we),we}};function g(M,R){let N=s.selectQueryEntry(R,M.queryCacheKey),I=s.selectConfig(R).refetchOnMountOrArgChange,_=N?.fulfilledTimeStamp,z=M.forceRefetch??(M.subscribe&&I);return z?z===!0||(Number(new Date)-Number(_))/1e3>=z:!1}let y=()=>Zt(`${e}/executeQuery`,v,{getPendingMeta({arg:M}){let R=n[M.endpointName];return Bh({startedTimeStamp:Date.now(),...YS(R)?{direction:M.direction}:{}})},condition(M,{getState:R}){let N=R(),I=s.selectQueryEntry(N,M.queryCacheKey),_=I?.fulfilledTimeStamp,z=M.originalArgs,F=I?.originalArgs,L=n[M.endpointName],k=M.direction;return SM(M)?!0:I?.status==="pending"?!1:g(M,N)||WS(L)&&L?.forceRefetch?.({currentArg:z,previousArg:F,endpointState:I,state:N})?!0:!(_&&!k)},dispatchConditionRejection:!0}),b=y(),w=y(),S=Zt(`${e}/executeMutation`,v,{getPendingMeta(){return Bh({startedTimeStamp:Date.now()})}}),C=M=>"force"in M,x=M=>"ifOlderThan"in M,E=(M,R,N={})=>(I,_)=>{let z=C(N)&&N.force,F=x(N)&&N.ifOlderThan,L=(K=!0)=>{let ee={forceRefetch:K,subscribe:!1};return i.endpoints[M].initiate(R,ee)},k=i.endpoints[M].select(R)(_());if(z)I(L());else if(F){let K=k?.fulfilledTimeStamp;if(!K){I(L());return}(Number(new Date)-Number(new Date(K)))/1e3>=F&&I(L())}else I(L(!1))};function T(M){return R=>R?.meta?.arg?.endpointName===M}function A(M,R){return{matchPending:wp(uS(M),T(R)),matchFulfilled:wp(qa(M),T(R)),matchRejected:wp(Iu(M),T(R))}}return{queryThunk:b,mutationThunk:S,infiniteQueryThunk:w,prefetch:E,updateQueryData:d,upsertQueryData:h,patchQueryData:u,buildMatchThunkActions:A}}function wM(e,{pages:t,pageParams:n},r){let i=t.length-1;return e.getNextPageParam(t[i],t,n[i],n,r)}function vL(e,{pages:t,pageParams:n},r){return e.getPreviousPageParam?.(t[0],t,n[0],n,r)}function bL(e,t,n,r){return AM(n[e.meta.arg.endpointName][t],qa(e)?e.payload:void 0,Rh(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,r)}function tL(e){return zr(e)?Ch(e):e}function US(e,t,n){let r=e[t];r&&n(r)}function $h(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function nL(e,t,n){let r=e[$h(t)];r&&n(r)}var $S={};function m7({reducerPath:e,queryThunk:t,mutationThunk:n,serializeQueryArgs:r,context:{endpointDefinitions:i,apiUid:o,extractRehydrationInfo:s,hasRehydrationInfo:a},assertTagType:l,config:c}){let u=Hr(`${e}/resetApiState`);function f(T,A,M,R){var N;T[N=A.queryCacheKey]??(T[N]={status:Qa,endpointName:A.endpointName}),US(T,A.queryCacheKey,I=>{I.status=yM,I.requestId=M&&I.requestId?I.requestId:R.requestId,A.originalArgs!==void 0&&(I.originalArgs=A.originalArgs),I.startedTimeStamp=R.startedTimeStamp;let _=i[R.arg.endpointName];YS(_)&&"direction"in A&&(I.direction=A.direction)})}function p(T,A,M,R){US(T,A.arg.queryCacheKey,N=>{if(N.requestId!==A.requestId&&!R)return;let{merge:I}=i[A.arg.endpointName];if(N.status=zh,I)if(N.data!==void 0){let{fulfilledTimeStamp:_,arg:z,baseQueryMeta:F,requestId:L}=A,k=Wt(N.data,K=>I(K,M,{arg:z.originalArgs,baseQueryMeta:F,fulfilledTimeStamp:_,requestId:L}));N.data=k}else N.data=M;else N.data=i[A.arg.endpointName].structuralSharing??!0?GS(zr(N.data)?iV(N.data):N.data,M):M;delete N.error,N.fulfilledTimeStamp=A.fulfilledTimeStamp})}let d=Ga({name:`${e}/queries`,initialState:$S,reducers:{removeQueryResult:{reducer(T,{payload:{queryCacheKey:A}}){delete T[A]},prepare:xp()},cacheEntriesUpserted:{reducer(T,A){for(let M of A.payload){let{queryDescription:R,value:N}=M;f(T,R,!0,{arg:R,requestId:A.meta.requestId,startedTimeStamp:A.meta.timestamp}),p(T,{arg:R,requestId:A.meta.requestId,fulfilledTimeStamp:A.meta.timestamp,baseQueryMeta:{}},N,!0)}},prepare:T=>({payload:T.map(A=>{let{endpointName:M,arg:R,value:N}=A,I=i[M];return{queryDescription:{type:jh,endpointName:M,originalArgs:A.arg,queryCacheKey:r({queryArgs:R,endpointDefinition:I,endpointName:M})},value:N}}),meta:{[Ah]:!0,requestId:Nh(),timestamp:Date.now()}})},queryResultPatched:{reducer(T,{payload:{queryCacheKey:A,patches:M}}){US(T,A,R=>{R.data=eM(R.data,M.concat())})},prepare:xp()}},extraReducers(T){T.addCase(t.pending,(A,{meta:M,meta:{arg:R}})=>{let N=SM(R);f(A,R,N,M)}).addCase(t.fulfilled,(A,{meta:M,payload:R})=>{let N=SM(M.arg);p(A,M,R,N)}).addCase(t.rejected,(A,{meta:{condition:M,arg:R,requestId:N},error:I,payload:_})=>{US(A,R.queryCacheKey,z=>{if(!M){if(z.requestId!==N)return;z.status=Hh,z.error=_??I}})}).addMatcher(a,(A,M)=>{let{queries:R}=s(M);for(let[N,I]of Object.entries(R))(I?.status===zh||I?.status===Hh)&&(A[N]=I)})}}),h=Ga({name:`${e}/mutations`,initialState:$S,reducers:{removeMutationResult:{reducer(T,{payload:A}){let M=$h(A);M in T&&delete T[M]},prepare:xp()}},extraReducers(T){T.addCase(n.pending,(A,{meta:M,meta:{requestId:R,arg:N,startedTimeStamp:I}})=>{N.track&&(A[$h(M)]={requestId:R,status:yM,endpointName:N.endpointName,startedTimeStamp:I})}).addCase(n.fulfilled,(A,{payload:M,meta:R})=>{R.arg.track&&nL(A,R,N=>{N.requestId===R.requestId&&(N.status=zh,N.data=M,N.fulfilledTimeStamp=R.fulfilledTimeStamp)})}).addCase(n.rejected,(A,{payload:M,error:R,meta:N})=>{N.arg.track&&nL(A,N,I=>{I.requestId===N.requestId&&(I.status=Hh,I.error=M??R)})}).addMatcher(a,(A,M)=>{let{mutations:R}=s(M);for(let[N,I]of Object.entries(R))(I?.status===zh||I?.status===Hh)&&N!==I?.requestId&&(A[N]=I)})}}),m={tags:{},keys:{}},v=Ga({name:`${e}/invalidation`,initialState:m,reducers:{updateProvidedBy:{reducer(T,A){var M,R,N;for(let{queryCacheKey:I,providedTags:_}of A.payload){g(T,I);for(let{type:z,id:F}of _){let L=(R=(M=T.tags)[z]??(M[z]={}))[N=F||"__internal_without_id"]??(R[N]=[]);L.includes(I)||L.push(I)}T.keys[I]=_}},prepare:xp()}},extraReducers(T){T.addCase(d.actions.removeQueryResult,(A,{payload:{queryCacheKey:M}})=>{g(A,M)}).addMatcher(a,(A,M)=>{var N,I,_;let{provided:R}=s(M);for(let[z,F]of Object.entries(R.tags??{}))for(let[L,k]of Object.entries(F)){let K=(I=(N=A.tags)[z]??(N[z]={}))[_=L||"__internal_without_id"]??(I[_]=[]);for(let ee of k)K.includes(ee)||K.push(ee),A.keys[ee]=R.keys[ee]}}).addMatcher(ia(qa(t),Rh(t)),(A,M)=>{y(A,[M])}).addMatcher(d.actions.cacheEntriesUpserted.match,(A,M)=>{let R=M.payload.map(({queryDescription:N,value:I})=>({type:"UNKNOWN",payload:I,meta:{requestStatus:"fulfilled",requestId:"UNKNOWN",arg:N}}));y(A,R)})}});function g(T,A){let M=tL(T.keys[A]??[]);for(let R of M){let N=R.type,I=R.id??"__internal_without_id",_=T.tags[N]?.[I];_&&(T.tags[N][I]=tL(_).filter(z=>z!==A))}delete T.keys[A]}function y(T,A){let M=A.map(R=>{let N=bL(R,"providesTags",i,l),{queryCacheKey:I}=R.meta.arg;return{queryCacheKey:I,providedTags:N}});v.caseReducers.updateProvidedBy(T,v.actions.updateProvidedBy(M))}let b=Ga({name:`${e}/subscriptions`,initialState:$S,reducers:{updateSubscriptionOptions(T,A){},unsubscribeQueryResult(T,A){},internal_getRTKQSubscriptions(){}}}),w=Ga({name:`${e}/internalSubscriptions`,initialState:$S,reducers:{subscriptionsUpdated:{reducer(T,A){return eM(T,A.payload)},prepare:xp()}}}),S=Ga({name:`${e}/config`,initialState:{online:QX(),focused:YX(),middlewareRegistered:!1,...c},reducers:{middlewareRegistered(T,{payload:A}){T.middlewareRegistered=T.middlewareRegistered==="conflict"||o!==A?"conflict":!0}},extraReducers:T=>{T.addCase(TM,A=>{A.online=!0}).addCase(dL,A=>{A.online=!1}).addCase(CM,A=>{A.focused=!0}).addCase(pL,A=>{A.focused=!1}).addMatcher(a,A=>({...A}))}}),C=Gb({queries:d.reducer,mutations:h.reducer,provided:v.reducer,subscriptions:w.reducer,config:S.reducer}),x=(T,A)=>C(u.match(A)?void 0:T,A),E={...S.actions,...d.actions,...b.actions,...w.actions,...h.actions,...v.actions,resetApiState:u};return{reducer:x,actions:E}}var No=Symbol.for("RTKQ/skipToken"),SL={status:Qa},rL=Wt(SL,()=>{}),iL=Wt(SL,()=>{});function h7({serializeQueryArgs:e,reducerPath:t,createSelector:n}){let r=b=>rL,i=b=>iL;return{buildQuerySelector:p,buildInfiniteQuerySelector:d,buildMutationSelector:h,selectInvalidatedBy:m,selectCachedArgsForQuery:v,selectApiState:s,selectQueries:a,selectMutations:c,selectQueryEntry:l,selectConfig:u};function o(b){return{...b,...WV(b.status)}}function s(b){return b[t]}function a(b){return s(b)?.queries}function l(b,w){return a(b)?.[w]}function c(b){return s(b)?.mutations}function u(b){return s(b)?.config}function f(b,w,S){return C=>{if(C===No)return n(r,S);let x=e({queryArgs:C,endpointDefinition:w,endpointName:b});return n(E=>l(E,x)??rL,S)}}function p(b,w){return f(b,w,o)}function d(b,w){let{infiniteQueryOptions:S}=w;function C(x){let E={...x,...WV(x.status)},{isLoading:T,isError:A,direction:M}=E,R=M==="forward",N=M==="backward";return{...E,hasNextPage:g(S,E.data,E.originalArgs),hasPreviousPage:y(S,E.data,E.originalArgs),isFetchingNextPage:T&&R,isFetchingPreviousPage:T&&N,isFetchNextPageError:A&&R,isFetchPreviousPageError:A&&N}}return f(b,w,C)}function h(){return b=>{let w;return typeof b=="object"?w=$h(b)??No:w=b,n(w===No?i:S=>s(S)?.mutations?.[w]??iL,o)}}function m(b,w){let S=b[t],C=new Set,x=vM(w,EM,gL);for(let E of x){let T=S.provided.tags[E.type];if(!T)continue;let A=(E.id!==void 0?T[E.id]:Object.values(T).flat())??[];for(let M of A)C.add(M)}return Array.from(C.values()).flatMap(E=>{let T=S.queries[E];return T?{queryCacheKey:E,endpointName:T.endpointName,originalArgs:T.originalArgs}:[]})}function v(b,w){return vM(Object.values(a(b)),S=>S?.endpointName===w&&S.status!==Qa,S=>S.originalArgs)}function g(b,w,S){return w?wM(b,w,S)!=null:!1}function y(b,w,S){return!w||!b.getPreviousPageParam?!1:vL(b,w,S)!=null}}var oL=WeakMap?new WeakMap:void 0,sL=({endpointName:e,queryArgs:t})=>{let n="",r=oL?.get(t);if(typeof r=="string")n=r;else{let i=JSON.stringify(t,(o,s)=>(s=typeof s=="bigint"?{$bigint:s.toString()}:s,s=ra(s)?Object.keys(s).sort().reduce((a,l)=>(a[l]=s[l],a),{}):s,s));ra(t)&&oL?.set(t,i),n=i}return`${e}(${n})`};function MM(...e){return function(t){let n=Du(l=>t.extractRehydrationInfo?.(l,{reducerPath:t.reducerPath??"api"})),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...t,extractRehydrationInfo:n,serializeQueryArgs(l){let c=sL;if("serializeQueryArgs"in l.endpointDefinition){let u=l.endpointDefinition.serializeQueryArgs;c=f=>{let p=u(f);return typeof p=="string"?p:sL({...f,queryArgs:p})}}else t.serializeQueryArgs&&(c=t.serializeQueryArgs);return c(l)},tagTypes:[...t.tagTypes||[]]},i={endpointDefinitions:{},batch(l){l()},apiUid:Nh(),extractRehydrationInfo:n,hasRehydrationInfo:Du(l=>n(l)!=null)},o={injectEndpoints:a,enhanceEndpoints({addTagTypes:l,endpoints:c}){if(l)for(let u of l)r.tagTypes.includes(u)||r.tagTypes.push(u);if(c)for(let[u,f]of Object.entries(c))typeof f=="function"?f(Ip(i,u)):Object.assign(Ip(i,u)||{},f);return o}},s=e.map(l=>l.init(o,r,i));function a(l){let c=l.endpoints({query:u=>({...u,type:jh}),mutation:u=>({...u,type:mL}),infiniteQuery:u=>({...u,type:hL})});for(let[u,f]of Object.entries(c)){if(l.overrideExisting!==!0&&u in i.endpointDefinitions){if(l.overrideExisting==="throw")throw new Error(zn(39));continue}i.endpointDefinitions[u]=f;for(let p of s)p.injectEndpoint(u,f)}return o}return o.injectEndpoints({endpoints:t.endpoints})}}function wL(){return function(){throw new Error(zn(33))}}function Ya(e,...t){return Object.assign(e,...t)}var g7=({api:e,queryThunk:t,internalState:n,mwApi:r})=>{let i=`${e.reducerPath}/subscriptions`,o=null,s=null,{updateSubscriptionOptions:a,unsubscribeQueryResult:l}=e.internalActions,c=(d,h)=>{if(a.match(h)){let{queryCacheKey:v,requestId:g,options:y}=h.payload,b=d.get(v);return b?.has(g)&&b.set(g,y),!0}if(l.match(h)){let{queryCacheKey:v,requestId:g}=h.payload,y=d.get(v);return y&&y.delete(g),!0}if(e.internalActions.removeQueryResult.match(h))return d.delete(h.payload.queryCacheKey),!0;if(t.pending.match(h)){let{meta:{arg:v,requestId:g}}=h,y=jS(d,v.queryCacheKey,bM);return v.subscribe&&y.set(g,v.subscriptionOptions??y.get(g)??{}),!0}let m=!1;if(t.rejected.match(h)){let{meta:{condition:v,arg:g,requestId:y}}=h;if(v&&g.subscribe){let b=jS(d,g.queryCacheKey,bM);b.set(y,g.subscriptionOptions??b.get(y)??{}),m=!0}}return m},u=()=>n.currentSubscriptions,f={getSubscriptions:u,getSubscriptionCount:d=>u().get(d)?.size??0,isRequestSubscribed:(d,h)=>!!u()?.get(d)?.get(h)};function p(d){return JSON.parse(JSON.stringify(Object.fromEntries([...d].map(([h,m])=>[h,Object.fromEntries(m)]))))}return(d,h)=>{if(o||(o=p(n.currentSubscriptions)),e.util.resetApiState.match(d))return o={},n.currentSubscriptions.clear(),s=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(d))return[!1,f];let m=c(n.currentSubscriptions,d),v=!0;if(m){s||(s=setTimeout(()=>{let b=p(n.currentSubscriptions),[,w]=JA(o,()=>b);h.next(e.internalActions.subscriptionsUpdated(w)),o=b,s=null},500));let g=typeof d.type=="string"&&!!d.type.startsWith(i),y=t.rejected.match(d)&&d.meta.condition&&!!d.meta.arg.subscribe;v=!g&&!y}return[v,!1]}},y7=2147483647/1e3-1,v7=({reducerPath:e,api:t,queryThunk:n,context:r,internalState:i,selectors:{selectQueryEntry:o,selectConfig:s},getRunningQueryThunk:a,mwApi:l})=>{let{removeQueryResult:c,unsubscribeQueryResult:u,cacheEntriesUpserted:f}=t.internalActions,p=ia(u.match,n.fulfilled,n.rejected,f.match);function d(b){let w=i.currentSubscriptions.get(b);return w?w.size>0:!1}let h={};function m(b){for(let w of b.values())w?.abort?.()}let v=(b,w)=>{let S=w.getState(),C=s(S);if(p(b)){let x;if(f.match(b))x=b.payload.map(E=>E.queryDescription.queryCacheKey);else{let{queryCacheKey:E}=u.match(b)?b.payload:b.meta.arg;x=[E]}g(x,w,C)}if(t.util.resetApiState.match(b)){for(let[x,E]of Object.entries(h))E&&clearTimeout(E),delete h[x];m(i.runningQueries),m(i.runningMutations)}if(r.hasRehydrationInfo(b)){let{queries:x}=r.extractRehydrationInfo(b);g(Object.keys(x),w,C)}};function g(b,w,S){let C=w.getState();for(let x of b){let E=o(C,x);E?.endpointName&&y(x,E.endpointName,w,S)}}function y(b,w,S,C){let x=Ip(r,w)?.keepUnusedDataFor??C.keepUnusedDataFor;if(x===1/0)return;let E=Math.max(0,Math.min(x,y7));if(!d(b)){let T=h[b];T&&clearTimeout(T),h[b]=setTimeout(()=>{if(!d(b)){let A=o(S.getState(),b);A?.endpointName&&S.dispatch(a(A.endpointName,A.originalArgs))?.abort(),S.dispatch(c({queryCacheKey:b}))}delete h[b]},E*1e3)}}return v},aL=new Error("Promise never resolved before cacheEntryRemoved."),b7=({api:e,reducerPath:t,context:n,queryThunk:r,mutationThunk:i,internalState:o,selectors:{selectQueryEntry:s,selectApiState:a}})=>{let l=fS(r),c=fS(i),u=qa(r,i),f={},{removeQueryResult:p,removeMutationResult:d,cacheEntriesUpserted:h}=e.internalActions;function m(S,C,x){let E=f[S];E?.valueResolved&&(E.valueResolved({data:C,meta:x}),delete E.valueResolved)}function v(S){let C=f[S];C&&(delete f[S],C.cacheEntryRemoved())}function g(S){let{arg:C,requestId:x}=S.meta,{endpointName:E,originalArgs:T}=C;return[E,T,x]}let y=(S,C,x)=>{let E=b(S);function T(A,M,R,N){let I=s(x,M),_=s(C.getState(),M);!I&&_&&w(A,N,M,C,R)}if(r.pending.match(S)){let[A,M,R]=g(S);T(A,E,R,M)}else if(h.match(S))for(let{queryDescription:A,value:M}of S.payload){let{endpointName:R,originalArgs:N,queryCacheKey:I}=A;T(R,I,S.meta.requestId,N),m(I,M,{})}else if(i.pending.match(S)){if(C.getState()[t].mutations[E]){let[A,M,R]=g(S);w(A,M,E,C,R)}}else if(u(S))m(E,S.payload,S.meta.baseQueryMeta);else if(p.match(S)||d.match(S))v(E);else if(e.util.resetApiState.match(S))for(let A of Object.keys(f))v(A)};function b(S){return l(S)?S.meta.arg.queryCacheKey:c(S)?S.meta.arg.fixedCacheKey??S.meta.requestId:p.match(S)?S.payload.queryCacheKey:d.match(S)?$h(S.payload):""}function w(S,C,x,E,T){let A=Ip(n,S),M=A?.onCacheEntryAdded;if(!M)return;let R={},N=new Promise(k=>{R.cacheEntryRemoved=k}),I=Promise.race([new Promise(k=>{R.valueResolved=k}),N.then(()=>{throw aL})]);I.catch(()=>{}),f[x]=R;let _=e.endpoints[S].select(qS(A)?C:x),z=E.dispatch((k,K,ee)=>ee),F={...E,getCacheEntry:()=>_(E.getState()),requestId:T,extra:z,updateCachedData:qS(A)?k=>E.dispatch(e.util.updateQueryData(S,C,k)):void 0,cacheDataLoaded:I,cacheEntryRemoved:N},L=M(C,F);Promise.resolve(L).catch(k=>{if(k!==aL)throw k})}return y},S7=({api:e,context:{apiUid:t},reducerPath:n})=>(r,i)=>{e.util.resetApiState.match(r)&&i.dispatch(e.internalActions.middlewareRegistered(t))},w7=({reducerPath:e,context:t,context:{endpointDefinitions:n},mutationThunk:r,queryThunk:i,api:o,assertTagType:s,refetchQuery:a,internalState:l})=>{let{removeQueryResult:c}=o.internalActions,u=ia(qa(r),Rh(r)),f=ia(qa(i,r),Iu(i,r)),p=[],d=0,h=(g,y)=>{(i.pending.match(g)||r.pending.match(g))&&d++,f(g)&&(d=Math.max(0,d-1)),u(g)?v(bL(g,"invalidatesTags",n,s),y):f(g)?v([],y):o.util.invalidateTags.match(g)&&v(AM(g.payload,void 0,void 0,void 0,void 0,s),y)};function m(){return d>0}function v(g,y){let b=y.getState(),w=b[e];if(p.push(...g),w.config.invalidationBehavior==="delayed"&&m())return;let S=p;if(p=[],S.length===0)return;let C=o.util.selectInvalidatedBy(b,S);t.batch(()=>{let x=Array.from(C.values());for(let{queryCacheKey:E}of x){let T=w.queries[E],A=jS(l.currentSubscriptions,E,bM);T&&(A.size===0?y.dispatch(c({queryCacheKey:E})):T.status!==Qa&&y.dispatch(a(T)))}})}return h},x7=({reducerPath:e,queryThunk:t,api:n,refetchQuery:r,internalState:i})=>{let{currentPolls:o,currentSubscriptions:s}=i,a=new Set,l=null,c=(v,g)=>{(n.internalActions.updateSubscriptionOptions.match(v)||n.internalActions.unsubscribeQueryResult.match(v))&&u(v.payload.queryCacheKey,g),(t.pending.match(v)||t.rejected.match(v)&&v.meta.condition)&&u(v.meta.arg.queryCacheKey,g),(t.fulfilled.match(v)||t.rejected.match(v)&&!v.meta.condition)&&f(v.meta.arg,g),n.util.resetApiState.match(v)&&(h(),l&&(clearTimeout(l),l=null),a.clear())};function u(v,g){a.add(v),l||(l=setTimeout(()=>{for(let y of a)p({queryCacheKey:y},g);a.clear(),l=null},0))}function f({queryCacheKey:v},g){let y=g.getState()[e],b=y.queries[v],w=s.get(v);if(!b||b.status===Qa)return;let{lowestPollingInterval:S,skipPollingIfUnfocused:C}=m(w);if(!Number.isFinite(S))return;let x=o.get(v);x?.timeout&&(clearTimeout(x.timeout),x.timeout=void 0);let E=Date.now()+S;o.set(v,{nextPollTimestamp:E,pollingInterval:S,timeout:setTimeout(()=>{(y.config.focused||!C)&&g.dispatch(r(b)),f({queryCacheKey:v},g)},S)})}function p({queryCacheKey:v},g){let y=g.getState()[e].queries[v],b=s.get(v);if(!y||y.status===Qa)return;let{lowestPollingInterval:w}=m(b);if(!Number.isFinite(w)){d(v);return}let S=o.get(v),C=Date.now()+w;(!S||C<S.nextPollTimestamp)&&f({queryCacheKey:v},g)}function d(v){let g=o.get(v);g?.timeout&&clearTimeout(g.timeout),o.delete(v)}function h(){for(let v of o.keys())d(v)}function m(v=new Map){let g=!1,y=Number.POSITIVE_INFINITY;for(let b of v.values())b.pollingInterval&&(y=Math.min(b.pollingInterval,y),g=b.skipPollingIfUnfocused||g);return{lowestPollingInterval:y,skipPollingIfUnfocused:g}}return c},E7=({api:e,context:t,queryThunk:n,mutationThunk:r})=>{let i=uS(n,r),o=Iu(n,r),s=qa(n,r),a={};return(l,c)=>{if(i(l)){let{requestId:u,arg:{endpointName:f,originalArgs:p}}=l.meta,d=Ip(t,f),h=d?.onQueryStarted;if(h){let m={},v=new Promise((w,S)=>{m.resolve=w,m.reject=S});v.catch(()=>{}),a[u]=m;let g=e.endpoints[f].select(qS(d)?p:u),y=c.dispatch((w,S,C)=>C),b={...c,getCacheEntry:()=>g(c.getState()),requestId:u,extra:y,updateCachedData:qS(d)?w=>c.dispatch(e.util.updateQueryData(f,p,w)):void 0,queryFulfilled:v};h(p,b)}}else if(s(l)){let{requestId:u,baseQueryMeta:f}=l.meta;a[u]?.resolve({data:l.payload,meta:f}),delete a[u]}else if(o(l)){let{requestId:u,rejectedWithValue:f,baseQueryMeta:p}=l.meta;a[u]?.reject({error:l.payload??l.error,isUnhandledError:!f,meta:p}),delete a[u]}}},C7=({reducerPath:e,context:t,api:n,refetchQuery:r,internalState:i})=>{let{removeQueryResult:o}=n.internalActions,s=(l,c)=>{CM.match(l)&&a(c,"refetchOnFocus"),TM.match(l)&&a(c,"refetchOnReconnect")};function a(l,c){let u=l.getState()[e],f=u.queries,p=i.currentSubscriptions;t.batch(()=>{for(let d of p.keys()){let h=f[d],m=p.get(d);if(!m||!h)continue;let v=[...m.values()];(v.some(g=>g[c]===!0)||v.every(g=>g[c]===void 0)&&u.config[c])&&(m.size===0?l.dispatch(o({queryCacheKey:d})):h.status!==Qa&&l.dispatch(r(h)))}})}return s};function T7(e){let{reducerPath:t,queryThunk:n,api:r,context:i,getInternalState:o}=e,{apiUid:s}=i,a={invalidateTags:Hr(`${t}/invalidateTags`)},l=f=>f.type.startsWith(`${t}/`),c=[S7,v7,w7,x7,b7,E7];return{middleware:f=>{let p=!1,d=o(f.dispatch),h={...e,internalState:d,refetchQuery:u,isThisApiSliceAction:l,mwApi:f},m=c.map(y=>y(h)),v=g7(h),g=C7(h);return y=>b=>{if(!Kb(b))return y(b);p||(p=!0,f.dispatch(r.internalActions.middlewareRegistered(s)));let w={...f,next:y},S=f.getState(),[C,x]=v(b,w,S),E;if(C?E=y(b):E=x,f.getState()[t]&&(g(b,w,S),l(b)||i.hasRehydrationInfo(b)))for(let T of m)T(b,w,S);return E}},actions:a};function u(f){return e.api.endpoints[f.endpointName].initiate(f.originalArgs,{subscribe:!1,forceRefetch:!0})}}var lL=Symbol(),RM=({createSelector:e=Sp}={})=>({name:lL,init(t,{baseQuery:n,tagTypes:r,reducerPath:i,serializeQueryArgs:o,keepUnusedDataFor:s,refetchOnMountOrArgChange:a,refetchOnFocus:l,refetchOnReconnect:c,invalidationBehavior:u,onSchemaFailure:f,catchSchemaFailure:p,skipSchemaValidation:d},h){fV();let m=pe=>pe;Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:TM,onOffline:dL,onFocus:CM,onFocusLost:pL},util:{}});let v=h7({serializeQueryArgs:o,reducerPath:i,createSelector:e}),{selectInvalidatedBy:g,selectCachedArgsForQuery:y,buildQuerySelector:b,buildInfiniteQuerySelector:w,buildMutationSelector:S}=v;Ya(t.util,{selectInvalidatedBy:g,selectCachedArgsForQuery:y});let{queryThunk:C,infiniteQueryThunk:x,mutationThunk:E,patchQueryData:T,updateQueryData:A,upsertQueryData:M,prefetch:R,buildMatchThunkActions:N}=d7({baseQuery:n,reducerPath:i,context:h,api:t,serializeQueryArgs:o,assertTagType:m,selectors:v,onSchemaFailure:f,catchSchemaFailure:p,skipSchemaValidation:d}),{reducer:I,actions:_}=m7({context:h,queryThunk:C,infiniteQueryThunk:x,mutationThunk:E,serializeQueryArgs:o,reducerPath:i,assertTagType:m,config:{refetchOnFocus:l,refetchOnReconnect:c,refetchOnMountOrArgChange:a,keepUnusedDataFor:s,reducerPath:i,invalidationBehavior:u}});Ya(t.util,{patchQueryData:T,updateQueryData:A,upsertQueryData:M,prefetch:R,resetApiState:_.resetApiState,upsertQueryEntries:_.cacheEntriesUpserted}),Ya(t.internalActions,_);let z=new WeakMap,F=pe=>jS(z,pe,()=>({currentSubscriptions:new Map,currentPolls:new Map,runningQueries:new Map,runningMutations:new Map})),{buildInitiateQuery:L,buildInitiateInfiniteQuery:k,buildInitiateMutation:K,getRunningMutationThunk:ee,getRunningMutationsThunk:Se,getRunningQueriesThunk:De,getRunningQueryThunk:we}=p7({queryThunk:C,mutationThunk:E,infiniteQueryThunk:x,api:t,serializeQueryArgs:o,context:h,getInternalState:F});Ya(t.util,{getRunningMutationThunk:ee,getRunningMutationsThunk:Se,getRunningQueryThunk:we,getRunningQueriesThunk:De});let{middleware:qe,actions:Fe}=T7({reducerPath:i,context:h,queryThunk:C,mutationThunk:E,infiniteQueryThunk:x,api:t,assertTagType:m,selectors:v,getRunningQueryThunk:we,getInternalState:F});return Ya(t.util,Fe),Ya(t,{reducer:I,middleware:qe}),{name:lL,injectEndpoint(pe,V){var Ie;let Q=t,Y=(Ie=Q.endpoints)[pe]??(Ie[pe]={});WS(V)&&Ya(Y,{name:pe,select:b(pe,V),initiate:L(pe,V)},N(C,pe)),c7(V)&&Ya(Y,{name:pe,select:S(),initiate:K(pe)},N(E,pe)),YS(V)&&Ya(Y,{name:pe,select:w(pe,V),initiate:k(pe,V)},N(C,pe))}}}}),$ge=MM(RM());var Yt=D(U(),1),$L=D(LL(),1);var Y7=Symbol.for("react.forward_ref");var Q7=Symbol.for("react.memo");var X7=Y7,Z7=Q7;function zL(e){e()}function J7(){let e=null,t=null;return{clear(){e=null,t=null},notify(){zL(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){let n=[],r=e;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0,i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!r||e===null||(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var FL={notify(){},get:()=>[]};function eZ(e,t){let n,r=FL,i=0,o=!1;function s(m){u();let v=r.subscribe(m),g=!1;return()=>{g||(g=!0,v(),f())}}function a(){r.notify()}function l(){h.onStateChange&&h.onStateChange()}function c(){return o}function u(){i++,n||(n=t?t.addNestedSub(l):e.subscribe(l),r=J7())}function f(){i--,n&&i===0&&(n(),n=void 0,r.clear(),r=FL)}function p(){o||(o=!0,u())}function d(){o&&(o=!1,f())}let h={addNestedSub:s,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:d,getListeners:()=>r};return h}var tZ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nZ=tZ(),rZ=()=>typeof navigator<"u"&&navigator.product==="ReactNative",iZ=rZ(),oZ=()=>nZ||iZ?Yt.useLayoutEffect:Yt.useEffect,sZ=oZ();function BL(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function kp(e,t){if(BL(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!BL(e[n[i]],t[n[i]]))return!1;return!0}var aZ={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},lZ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Xge={[X7]:aZ,[Z7]:lZ};var Zge=Object.prototype;var VM=Symbol.for("react-redux-context"),LM=typeof globalThis<"u"?globalThis:{};function cZ(){if(!Yt.createContext)return{};let e=LM[VM]??(LM[VM]=new Map),t=e.get(Yt.createContext);return t||(t=Yt.createContext(null),e.set(Yt.createContext,t)),t}var Xa=cZ();function uZ(e){let{children:t,context:n,serverState:r,store:i}=e,o=Yt.useMemo(()=>{let l=eZ(i);return{store:i,subscription:l,getServerState:r?()=>r:void 0}},[i,r]),s=Yt.useMemo(()=>i.getState(),[i]);return sZ(()=>{let{subscription:l}=o;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[o,s]),Yt.createElement((n||Xa).Provider,{value:o},t)}var Gh=uZ;function FM(e=Xa){return function(){return Yt.useContext(e)}}var HL=FM();function UL(e=Xa){let t=e===Xa?HL:FM(e),n=()=>{let{store:r}=t();return r};return Object.assign(n,{withTypes:()=>n}),n}var BM=UL();function fZ(e=Xa){let t=e===Xa?BM:UL(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var XS=fZ(),pZ=(e,t)=>e===t;function dZ(e=Xa){let t=e===Xa?HL:FM(e),n=(r,i={})=>{let{equalityFn:o=pZ}=typeof i=="function"?{equalityFn:i}:i,s=t(),{store:a,subscription:l,getServerState:c}=s,u=Yt.useRef(!0),f=Yt.useCallback({[r.name](d){return r(d)}}[r.name],[r]),p=(0,$L.useSyncExternalStoreWithSelector)(l.addNestedSub,a.getState,c||a.getState,f,o);return Yt.useDebugValue(p),p};return Object.assign(n,{withTypes:()=>n}),n}var ZS=dZ(),jL=zL;var Oe=D(U(),1);var KL=D(U(),1);function JS(e){return e.replace(e[0],e[0].toUpperCase())}var mZ="query",hZ="mutation",gZ="infinitequery";function yZ(e){return e.type===mZ}function vZ(e){return e.type===hZ}function GL(e){return e.type===gZ}function Kh(e,...t){return Object.assign(e,...t)}var zM=Symbol();function HM(e){let t=(0,Oe.useRef)(e),n=(0,Oe.useMemo)(()=>GS(t.current,e),[e]);return(0,Oe.useEffect)(()=>{t.current!==n&&(t.current=n)},[n]),n}function _p(e){let t=(0,Oe.useRef)(e);return(0,Oe.useEffect)(()=>{kp(t.current,e)||(t.current=e)},[e]),kp(t.current,e)?t.current:e}var bZ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SZ=bZ(),wZ=()=>typeof navigator<"u"&&navigator.product==="ReactNative",xZ=wZ(),EZ=()=>SZ||xZ?Oe.useLayoutEffect:Oe.useEffect,CZ=EZ(),qL=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:xM.pending}:e;function UM(e,...t){let n={};return t.forEach(r=>{n[r]=e[r]}),n}var $M=["data","status","isLoading","isSuccess","isError","error"];function TZ({api:e,moduleOptions:{batch:t,hooks:{useDispatch:n,useSelector:r,useStore:i},unstable__sideEffectsInRender:o,createSelector:s},serializeQueryArgs:a,context:l}){let c=o?C=>C():Oe.useEffect,u=C=>C.current?.unsubscribe?.(),f=l.endpointDefinitions;return{buildQueryHooks:b,buildInfiniteQueryHooks:w,buildMutationHook:S,usePrefetch:h};function p(C,x,E){if(x?.endpointName&&C.isUninitialized){let{endpointName:I}=x,_=f[I];E!==No&&a({queryArgs:x.originalArgs,endpointDefinition:_,endpointName:I})===a({queryArgs:E,endpointDefinition:_,endpointName:I})&&(x=void 0)}let T=C.isSuccess?C.data:x?.data;T===void 0&&(T=C.data);let A=T!==void 0,M=C.isLoading,R=(!x||x.isLoading||x.isUninitialized)&&!A&&M,N=C.isSuccess||A&&(M&&!x?.isError||C.isUninitialized);return{...C,data:T,currentData:C.data,isFetching:M,isLoading:R,isSuccess:N}}function d(C,x,E){if(x?.endpointName&&C.isUninitialized){let{endpointName:I}=x,_=f[I];E!==No&&a({queryArgs:x.originalArgs,endpointDefinition:_,endpointName:I})===a({queryArgs:E,endpointDefinition:_,endpointName:I})&&(x=void 0)}let T=C.isSuccess?C.data:x?.data;T===void 0&&(T=C.data);let A=T!==void 0,M=C.isLoading,R=(!x||x.isLoading||x.isUninitialized)&&!A&&M,N=C.isSuccess||M&&A;return{...C,data:T,currentData:C.data,isFetching:M,isLoading:R,isSuccess:N}}function h(C,x){let E=n(),T=_p(x);return(0,Oe.useCallback)((A,M)=>E(e.util.prefetch(C,A,{...T,...M})),[C,E,T])}function m(C,x,{refetchOnReconnect:E,refetchOnFocus:T,refetchOnMountOrArgChange:A,skip:M=!1,pollingInterval:R=0,skipPollingIfUnfocused:N=!1,...I}={}){let{initiate:_}=e.endpoints[C],z=n(),F=(0,Oe.useRef)(void 0);if(!F.current){let Q=z(e.internalActions.internal_getRTKQSubscriptions());F.current=Q}let L=HM(M?No:x),k=_p({refetchOnReconnect:E,refetchOnFocus:T,pollingInterval:R,skipPollingIfUnfocused:N}),K=I.initialPageParam,ee=_p(K),Se=I.refetchCachedPages,De=_p(Se),we=(0,Oe.useRef)(void 0),{queryCacheKey:qe,requestId:Fe}=we.current||{},pe=!1;qe&&Fe&&(pe=F.current.isRequestSubscribed(qe,Fe));let V=!pe&&we.current!==void 0;return c(()=>{V&&(we.current=void 0)},[V]),c(()=>{let Q=we.current;if(L===No){Q?.unsubscribe(),we.current=void 0;return}let Y=we.current?.subscriptionOptions;if(!Q||Q.arg!==L){Q?.unsubscribe();let Ie=z(_(L,{subscriptionOptions:k,forceRefetch:A,...GL(f[C])?{initialPageParam:ee,refetchCachedPages:De}:{}}));we.current=Ie}else k!==Y&&Q.updateSubscriptionOptions(k)},[z,_,A,L,k,V,ee,De,C]),[we,z,_,k]}function v(C,x){return(E,{skip:T=!1,selectFromResult:A}={})=>{let{select:M}=e.endpoints[C],R=HM(T?No:E),N=(0,Oe.useRef)(void 0),I=(0,Oe.useMemo)(()=>s([M(R),(k,K)=>K,k=>R],x,{memoizeOptions:{resultEqualityCheck:kp}}),[M,R]),_=(0,Oe.useMemo)(()=>A?s([I],A,{devModeChecks:{identityFunctionCheck:"never"}}):I,[I,A]),z=r(k=>_(k,N.current),kp),F=i(),L=I(F.getState(),N.current);return CZ(()=>{N.current=L},[L]),z}}function g(C){(0,Oe.useEffect)(()=>()=>{u(C),C.current=void 0},[C])}function y(C){if(!C.current)throw new Error(zn(38));return C.current.refetch()}function b(C){let x=(A,M={})=>{let[R]=m(C,A,M);return g(R),(0,Oe.useMemo)(()=>({refetch:()=>y(R)}),[R])},E=({refetchOnReconnect:A,refetchOnFocus:M,pollingInterval:R=0,skipPollingIfUnfocused:N=!1}={})=>{let{initiate:I}=e.endpoints[C],_=n(),[z,F]=(0,Oe.useState)(zM),L=(0,Oe.useRef)(void 0),k=_p({refetchOnReconnect:A,refetchOnFocus:M,pollingInterval:R,skipPollingIfUnfocused:N});c(()=>{let De=L.current?.subscriptionOptions;k!==De&&L.current?.updateSubscriptionOptions(k)},[k]);let K=(0,Oe.useRef)(k);c(()=>{K.current=k},[k]);let ee=(0,Oe.useCallback)(function(De,we=!1){let qe;return t(()=>{u(L),L.current=qe=_(I(De,{subscriptionOptions:K.current,forceRefetch:!we})),F(De)}),qe},[_,I]),Se=(0,Oe.useCallback)(()=>{L.current?.queryCacheKey&&_(e.internalActions.removeQueryResult({queryCacheKey:L.current?.queryCacheKey}))},[_]);return(0,Oe.useEffect)(()=>()=>{u(L)},[]),(0,Oe.useEffect)(()=>{z!==zM&&!L.current&&ee(z,!0)},[z,ee]),(0,Oe.useMemo)(()=>[ee,z,{reset:Se}],[ee,z,Se])},T=v(C,p);return{useQueryState:T,useQuerySubscription:x,useLazyQuerySubscription:E,useLazyQuery(A){let[M,R,{reset:N}]=E(A),I=T(R,{...A,skip:R===zM}),_=(0,Oe.useMemo)(()=>({lastArg:R}),[R]);return(0,Oe.useMemo)(()=>[M,{...I,reset:N},_],[M,I,N,_])},useQuery(A,M){let R=x(A,M),N=T(A,{selectFromResult:A===No||M?.skip?void 0:qL,...M}),I=UM(N,...$M);return(0,Oe.useDebugValue)(I),(0,Oe.useMemo)(()=>({...N,...R}),[N,R])}}}function w(C){let x=(T,A={})=>{let[M,R,N,I]=m(C,T,A),_=(0,Oe.useRef)(I);c(()=>{_.current=I},[I]);let z=A.refetchCachedPages,F=_p(z),L=(0,Oe.useCallback)(function(ee,Se){let De;return t(()=>{u(M),M.current=De=R(N(ee,{subscriptionOptions:_.current,direction:Se}))}),De},[M,R,N]);g(M);let k=HM(A.skip?No:T),K=(0,Oe.useCallback)(ee=>{if(!M.current)throw new Error(zn(38));let Se={refetchCachedPages:ee?.refetchCachedPages??F};return M.current.refetch(Se)},[M,F]);return(0,Oe.useMemo)(()=>({trigger:L,refetch:K,fetchNextPage:()=>L(k,"forward"),fetchPreviousPage:()=>L(k,"backward")}),[K,L,k])},E=v(C,d);return{useInfiniteQueryState:E,useInfiniteQuerySubscription:x,useInfiniteQuery(T,A){let{refetch:M,fetchNextPage:R,fetchPreviousPage:N}=x(T,A),I=E(T,{selectFromResult:T===No||A?.skip?void 0:qL,...A}),_=UM(I,...$M,"hasNextPage","hasPreviousPage");return(0,Oe.useDebugValue)(_),(0,Oe.useMemo)(()=>({...I,fetchNextPage:R,fetchPreviousPage:N,refetch:M}),[I,R,N,M])}}}function S(C){return({selectFromResult:x,fixedCacheKey:E}={})=>{let{select:T,initiate:A}=e.endpoints[C],M=n(),[R,N]=(0,Oe.useState)();(0,Oe.useEffect)(()=>()=>{R?.arg.fixedCacheKey||R?.reset()},[R]);let I=(0,Oe.useCallback)(function(De){let we=M(A(De,{fixedCacheKey:E}));return N(we),we},[M,A,E]),{requestId:_}=R||{},z=(0,Oe.useMemo)(()=>T({fixedCacheKey:E,requestId:R?.requestId}),[E,R,T]),F=(0,Oe.useMemo)(()=>x?s([z],x):z,[x,z]),L=r(F,kp),k=E==null?R?.arg.originalArgs:void 0,K=(0,Oe.useCallback)(()=>{t(()=>{R&&N(void 0),E&&M(e.internalActions.removeMutationResult({requestId:_,fixedCacheKey:E}))})},[M,E,R,_]),ee=UM(L,...$M,"endpointName");(0,Oe.useDebugValue)(ee);let Se=(0,Oe.useMemo)(()=>({...L,originalArgs:k,reset:K}),[L,k,K]);return(0,Oe.useMemo)(()=>[I,Se],[I,Se])}}}var AZ=Symbol(),MZ=({batch:e=jL,hooks:t={useDispatch:XS,useSelector:ZS,useStore:BM},createSelector:n=Sp,unstable__sideEffectsInRender:r=!1,...i}={})=>({name:AZ,init(o,{serializeQueryArgs:s},a){let l=o,{buildQueryHooks:c,buildInfiniteQueryHooks:u,buildMutationHook:f,usePrefetch:p}=TZ({api:o,moduleOptions:{batch:e,hooks:t,unstable__sideEffectsInRender:r,createSelector:n},serializeQueryArgs:s,context:a});return Kh(l,{usePrefetch:p}),Kh(a,{batch:e}),{injectEndpoint(d,h){if(yZ(h)){let{useQuery:m,useLazyQuery:v,useLazyQuerySubscription:g,useQueryState:y,useQuerySubscription:b}=c(d);Kh(l.endpoints[d],{useQuery:m,useLazyQuery:v,useLazyQuerySubscription:g,useQueryState:y,useQuerySubscription:b}),o[`use${JS(d)}Query`]=m,o[`useLazy${JS(d)}Query`]=v}if(vZ(h)){let m=f(d);Kh(l.endpoints[d],{useMutation:m}),o[`use${JS(d)}Mutation`]=m}else if(GL(h)){let{useInfiniteQuery:m,useInfiniteQuerySubscription:v,useInfiniteQueryState:g}=u(d);Kh(l.endpoints[d],{useInfiniteQuery:m,useInfiniteQuerySubscription:v,useInfiniteQueryState:g}),o[`use${JS(d)}InfiniteQuery`]=m}}}}});var ew=MM(RM(),MZ());var WL=require("obsidian");var tw=class{constructor(){P(this,"bus",new WL.Events)}on(t,n,r){this.bus.on(t,n,r)}off(t,n){this.bus.off(t,n)}trigger(t,...n){this.bus.trigger(t,...n)}};var qM=D(QL(),1);var GM=class e extends Error{constructor(n,r){super(n,r);P(this,"name","TimeoutError");Error.captureStackTrace?.(this,e)}},XL=e=>e.reason??new DOMException("This operation was aborted.","AbortError");function KM(e,t){let{milliseconds:n,fallback:r,message:i,customTimers:o={setTimeout,clearTimeout},signal:s}=t,a,l,u=new Promise((f,p)=>{if(typeof n!="number"||Math.sign(n)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(s?.aborted){p(XL(s));return}if(s&&(l=()=>{p(XL(s))},s.addEventListener("abort",l,{once:!0})),e.then(f,p),n===Number.POSITIVE_INFINITY)return;let d=new GM;a=o.setTimeout.call(void 0,()=>{if(r){try{f(r())}catch(h){p(h)}return}typeof e.cancel=="function"&&e.cancel(),i===!1?f():i instanceof Error?p(i):(d.message=i??`Promise timed out after ${n} milliseconds`,p(d))},n)}).finally(()=>{u.clear(),l&&s&&s.removeEventListener("abort",l)});return u.clear=()=>{o.clearTimeout.call(void 0,a),a=void 0},u}function WM(e,t,n){let r=0,i=e.length;for(;i>0;){let o=Math.trunc(i/2),s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}var Do,Yh=class{constructor(){Kt(this,Do,[])}enqueue(t,n){let{priority:r=0,id:i}=n??{},o={priority:r,id:i,run:t};if(this.size===0||G(this,Do)[this.size-1].priority>=r){G(this,Do).push(o);return}let s=WM(G(this,Do),o,(a,l)=>l.priority-a.priority);G(this,Do).splice(s,0,o)}setPriority(t,n){let r=G(this,Do).findIndex(o=>o.id===t);if(r===-1)throw new ReferenceError(`No promise function with the id "${t}" exists in the queue.`);let[i]=G(this,Do).splice(r,1);this.enqueue(i.run,{priority:n,id:t})}dequeue(){return G(this,Do).shift()?.run}filter(t){return G(this,Do).filter(n=>n.priority===t.priority).map(n=>n.run)}get size(){return G(this,Do).length}};Do=new WeakMap;var Lp,ys,vs,ac,Bu,Fp,aa,Qh,Bp,la,Za,Io,Ri,li,Un,Xh,Mr,zu,Ja,cw,Hu,he,rw,ZL,JL,iw,eF,tF,nF,rF,iF,ow,sw,YM,aw,QM,XM,lw,Fu,oF,Vp,sF,ZM,bs=class extends qM.default{constructor(n){super();Kt(this,he);Kt(this,Lp);Kt(this,ys);Kt(this,vs,0);Kt(this,ac);Kt(this,Bu,!1);Kt(this,Fp,!1);Kt(this,aa);Kt(this,Qh,0);Kt(this,Bp,0);Kt(this,la);Kt(this,Za);Kt(this,Io);Kt(this,Ri,[]);Kt(this,li,0);Kt(this,Un);Kt(this,Xh);Kt(this,Mr,0);Kt(this,zu);Kt(this,Ja);Kt(this,cw,1n);Kt(this,Hu,new Map);P(this,"timeout");if(n={carryoverIntervalCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Yh,strict:!1,...n},!(typeof n.intervalCap=="number"&&n.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${n.intervalCap?.toString()??""}\` (${typeof n.intervalCap})`);if(n.interval===void 0||!(Number.isFinite(n.interval)&&n.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${n.interval?.toString()??""}\` (${typeof n.interval})`);if(n.strict&&n.interval===0)throw new TypeError("The `strict` option requires a non-zero `interval`");if(n.strict&&n.intervalCap===Number.POSITIVE_INFINITY)throw new TypeError("The `strict` option requires a finite `intervalCap`");if(It(this,Lp,n.carryoverIntervalCount??n.carryoverConcurrencyCount??!1),It(this,ys,n.intervalCap===Number.POSITIVE_INFINITY||n.interval===0),It(this,ac,n.intervalCap),It(this,aa,n.interval),It(this,Io,n.strict),It(this,Un,new n.queueClass),It(this,Xh,n.queueClass),this.concurrency=n.concurrency,n.timeout!==void 0&&!(Number.isFinite(n.timeout)&&n.timeout>0))throw new TypeError(`Expected \`timeout\` to be a positive finite number, got \`${n.timeout}\` (${typeof n.timeout})`);this.timeout=n.timeout,It(this,Ja,n.autoStart===!1),He(this,he,oF).call(this)}get concurrency(){return G(this,zu)}set concurrency(n){if(!(typeof n=="number"&&n>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${n}\` (${typeof n})`);It(this,zu,n),He(this,he,lw).call(this)}setPriority(n,r){if(typeof r!="number"||!Number.isFinite(r))throw new TypeError(`Expected \`priority\` to be a finite number, got \`${r}\` (${typeof r})`);G(this,Un).setPriority(n,r)}async add(n,r={}){return r={timeout:this.timeout,...r,id:r.id??(Tu(this,cw)._++).toString()},new Promise((i,o)=>{let s=Symbol(`task-${r.id}`);G(this,Un).enqueue(async()=>{Tu(this,Mr)._++,G(this,Hu).set(s,{id:r.id,priority:r.priority??0,startTime:Date.now(),timeout:r.timeout});let a;try{try{r.signal?.throwIfAborted()}catch(u){throw He(this,he,sF).call(this),G(this,Hu).delete(s),u}It(this,Bp,Date.now());let l=n({signal:r.signal});if(r.timeout&&(l=KM(Promise.resolve(l),{milliseconds:r.timeout,message:`Task timed out after ${r.timeout}ms (queue has ${G(this,Mr)} running, ${G(this,Un).size} waiting)`})),r.signal){let{signal:u}=r;l=Promise.race([l,new Promise((f,p)=>{a=()=>{p(u.reason)},u.addEventListener("abort",a,{once:!0})})])}let c=await l;i(c),this.emit("completed",c)}catch(l){o(l),this.emit("error",l)}finally{a&&r.signal?.removeEventListener("abort",a),G(this,Hu).delete(s),queueMicrotask(()=>{He(this,he,nF).call(this)})}},r),this.emit("add"),He(this,he,aw).call(this)})}async addAll(n,r){return Promise.all(n.map(async i=>this.add(i,r)))}start(){return G(this,Ja)?(It(this,Ja,!1),He(this,he,lw).call(this),this):this}pause(){It(this,Ja,!0)}clear(){It(this,Un,new(G(this,Xh))),He(this,he,sw).call(this),He(this,he,ZM).call(this),this.emit("empty"),G(this,Mr)===0&&(He(this,he,YM).call(this),this.emit("idle")),this.emit("next")}async onEmpty(){G(this,Un).size!==0&&await He(this,he,Fu).call(this,"empty")}async onSizeLessThan(n){G(this,Un).size<n||await He(this,he,Fu).call(this,"next",()=>G(this,Un).size<n)}async onIdle(){G(this,Mr)===0&&G(this,Un).size===0||await He(this,he,Fu).call(this,"idle")}async onPendingZero(){G(this,Mr)!==0&&await He(this,he,Fu).call(this,"pendingZero")}async onRateLimit(){this.isRateLimited||await He(this,he,Fu).call(this,"rateLimit")}async onRateLimitCleared(){this.isRateLimited&&await He(this,he,Fu).call(this,"rateLimitCleared")}onError(){return new Promise((n,r)=>{let i=o=>{this.off("error",i),r(o)};this.on("error",i)})}get size(){return G(this,Un).size}sizeBy(n){return G(this,Un).filter(n).length}get pending(){return G(this,Mr)}get isPaused(){return G(this,Ja)}get isRateLimited(){return G(this,Bu)}get isSaturated(){return G(this,Mr)===G(this,zu)&&G(this,Un).size>0||this.isRateLimited&&G(this,Un).size>0}get runningTasks(){return[...G(this,Hu).values()].map(n=>({...n}))}};Lp=new WeakMap,ys=new WeakMap,vs=new WeakMap,ac=new WeakMap,Bu=new WeakMap,Fp=new WeakMap,aa=new WeakMap,Qh=new WeakMap,Bp=new WeakMap,la=new WeakMap,Za=new WeakMap,Io=new WeakMap,Ri=new WeakMap,li=new WeakMap,Un=new WeakMap,Xh=new WeakMap,Mr=new WeakMap,zu=new WeakMap,Ja=new WeakMap,cw=new WeakMap,Hu=new WeakMap,he=new WeakSet,rw=function(n){for(;G(this,li)<G(this,Ri).length;){let i=G(this,Ri)[G(this,li)];if(i!==void 0&&n-i>=G(this,aa))Tu(this,li)._++;else break}(G(this,li)>100&&G(this,li)>G(this,Ri).length/2||G(this,li)===G(this,Ri).length)&&(It(this,Ri,G(this,Ri).slice(G(this,li))),It(this,li,0))},ZL=function(n){G(this,Io)?G(this,Ri).push(n):Tu(this,vs)._++},JL=function(){G(this,Io)?G(this,Ri).length>G(this,li)&&G(this,Ri).pop():G(this,vs)>0&&Tu(this,vs)._--},iw=function(){return G(this,Ri).length-G(this,li)},eF=function(){return G(this,ys)?!0:G(this,Io)?He(this,he,iw).call(this)<G(this,ac):G(this,vs)<G(this,ac)},tF=function(){return G(this,Mr)<G(this,zu)},nF=function(){Tu(this,Mr)._--,G(this,Mr)===0&&this.emit("pendingZero"),He(this,he,aw).call(this),this.emit("next")},rF=function(){It(this,Za,void 0),He(this,he,XM).call(this),He(this,he,QM).call(this)},iF=function(n){if(G(this,Io)){if(He(this,he,rw).call(this,n),He(this,he,iw).call(this)>=G(this,ac)){let i=G(this,Ri)[G(this,li)],o=G(this,aa)-(n-i);return He(this,he,ow).call(this,o),!0}return!1}if(G(this,la)===void 0){let r=G(this,Qh)-n;if(r<0){if(G(this,Bp)>0){let i=n-G(this,Bp);if(i<G(this,aa))return He(this,he,ow).call(this,G(this,aa)-i),!0}It(this,vs,G(this,Lp)?G(this,Mr):0)}else return He(this,he,ow).call(this,r),!0}return!1},ow=function(n){G(this,Za)===void 0&&It(this,Za,setTimeout(()=>{He(this,he,rF).call(this)},n))},sw=function(){G(this,la)&&(clearInterval(G(this,la)),It(this,la,void 0))},YM=function(){G(this,Za)&&(clearTimeout(G(this,Za)),It(this,Za,void 0))},aw=function(){if(G(this,Un).size===0){if(He(this,he,sw).call(this),this.emit("empty"),G(this,Mr)===0){if(He(this,he,YM).call(this),G(this,Io)&&G(this,li)>0){let r=Date.now();He(this,he,rw).call(this,r)}this.emit("idle")}return!1}let n=!1;if(!G(this,Ja)){let r=Date.now(),i=!He(this,he,iF).call(this,r);if(G(this,he,eF)&&G(this,he,tF)){let o=G(this,Un).dequeue();G(this,ys)||(He(this,he,ZL).call(this,r),He(this,he,Vp).call(this)),this.emit("active"),o(),i&&He(this,he,QM).call(this),n=!0}}return n},QM=function(){G(this,ys)||G(this,la)!==void 0||G(this,Io)||(It(this,la,setInterval(()=>{He(this,he,XM).call(this)},G(this,aa))),It(this,Qh,Date.now()+G(this,aa)))},XM=function(){G(this,Io)||(G(this,vs)===0&&G(this,Mr)===0&&G(this,la)&&He(this,he,sw).call(this),It(this,vs,G(this,Lp)?G(this,Mr):0)),He(this,he,lw).call(this),He(this,he,Vp).call(this)},lw=function(){for(;He(this,he,aw).call(this););},Fu=async function(n,r){return new Promise(i=>{let o=()=>{r&&!r()||(this.off(n,o),i())};this.on(n,o)})},oF=function(){G(this,ys)||(this.on("add",()=>{G(this,Un).size>0&&He(this,he,Vp).call(this)}),this.on("next",()=>{He(this,he,Vp).call(this)}))},Vp=function(){G(this,ys)||G(this,Fp)||(It(this,Fp,!0),queueMicrotask(()=>{It(this,Fp,!1),He(this,he,ZM).call(this)}))},sF=function(){G(this,ys)||(He(this,he,JL).call(this),He(this,he,Vp).call(this))},ZM=function(){let n=G(this,Bu);if(G(this,ys)||G(this,Un).size===0){n&&(It(this,Bu,!1),this.emit("rateLimitCleared"));return}let r;if(G(this,Io)){let o=Date.now();He(this,he,rw).call(this,o),r=He(this,he,iw).call(this)}else r=G(this,vs);let i=r>=G(this,ac);i!==n&&(It(this,Bu,i),this.emit(i?"rateLimit":"rateLimitCleared"))};var uw=class{constructor(){P(this,"queues",new Map)}getQueue(t){if(!this.queues.has(t)){let n=new bs({concurrency:1,autoStart:!0});this.queues.set(t,n)}return this.queues.get(t)}async add(t,n,r={}){let i=r.priority??0,o=Array.isArray(t)?t:[t];o.sort();let s=async a=>{if(a>=o.length)return await n();let l=o[a];return this.getQueue(l).add(()=>s(a+1),{priority:i})};return s(0)}enqueue(t,n){return this.add(t,n,{priority:0})}clear(t){this.queues.has(t)&&(this.queues.get(t).clear(),this.queues.delete(t))}clearAll(){for(let t of this.queues.values())t.clear();this.queues.clear()}async onIdle(t){this.queues.has(t)&&await this.queues.get(t).onIdle()}};var el=require("obsidian");var DZ=ae(te("noteId must be a string"),Ka("noteId cannot be empty"),Ao(500,"noteId cannot exceed 500 characters"),Mo(e=>e.trim())),IZ=ae(te("versionId must be a string"),Ka("versionId cannot be empty"),Ao(500,"versionId cannot exceed 500 characters"),Mo(e=>e.trim())),OZ=ae(te("branchName must be a string"),Ka("branchName cannot be empty"),Ao(255,"branchName cannot exceed 255 characters"),Mo(e=>e.trim())),fw=class{constructor(t){this.plugin=t;P(this,"FALLBACK_DB_ROOT",pM);if(!t)throw new Error("PathService: Plugin dependency is required and cannot be null or undefined.")}getDbRoot(){try{let n=this.plugin?.settings?.databasePath;(!n||typeof n!="string"||n.trim().length===0)&&(n=this.FALLBACK_DB_ROOT);let r=(0,el.normalizePath)(n.trim());if(!r||typeof r!="string")throw new Error("Normalization failed: result is not a valid string.");return r}catch(t){return console.warn("PathService.getDbRoot: Fallback to default due to error:",t),(0,el.normalizePath)(this.FALLBACK_DB_ROOT)}}getNoteDbPath(t){this.validateNoteId(t,"getNoteDbPath");try{let n=this.getDbRoot(),r=this.sanitizePathComponent(t),i=`${n}/${r}`,o=(0,el.normalizePath)(i);if(!o||typeof o!="string")throw new Error("Path normalization failed for note database path.");return o}catch(n){throw new Error(`PathService.getNoteDbPath: Failed to generate path for noteId "${t}": ${n instanceof Error?n.message:"Unknown error"}`)}}getNoteManifestPath(t){this.validateNoteId(t,"getNoteManifestPath");try{let r=`${this.getNoteDbPath(t)}/manifest.json`,i=(0,el.normalizePath)(r);if(!i||typeof i!="string")throw new Error("Path normalization failed for manifest path.");return i}catch(n){throw new Error(`PathService.getNoteManifestPath: Failed to generate manifest path for noteId "${t}": ${n instanceof Error?n.message:"Unknown error"}`)}}getNoteVersionsPath(t){this.validateNoteId(t,"getNoteVersionsPath");try{let r=`${this.getNoteDbPath(t)}/versions`,i=(0,el.normalizePath)(r);if(!i||typeof i!="string")throw new Error("Path normalization failed for versions path.");return i}catch(n){throw new Error(`PathService.getNoteVersionsPath: Failed to generate versions path for noteId "${t}": ${n instanceof Error?n.message:"Unknown error"}`)}}getNoteVersionPath(t,n){this.validateNoteId(t,"getNoteVersionPath"),this.validateVersionId(n,"getNoteVersionPath");try{let r=this.getNoteVersionsPath(t),i=this.sanitizePathComponent(n),o=`${r}/${i}.md`,s=(0,el.normalizePath)(o);if(!s||typeof s!="string")throw new Error("Path normalization failed for version path.");return s}catch(r){throw new Error(`PathService.getNoteVersionPath: Failed to generate version path for noteId "${t}", versionId "${n}": ${r instanceof Error?r.message:"Unknown error"}`)}}getBranchesPath(t){this.validateNoteId(t,"getBranchesPath");try{let r=`${this.getNoteDbPath(t)}/branches`;return(0,el.normalizePath)(r)}catch(n){throw new Error(`PathService.getBranchesPath: Failed to generate path for noteId "${t}": ${n instanceof Error?n.message:"Unknown error"}`)}}getBranchPath(t,n){this.validateNoteId(t,"getBranchPath"),this.validateBranchName(n,"getBranchPath");try{let r=this.getBranchesPath(t),i=this.sanitizePathComponent(n),o=`${r}/${i}`;return(0,el.normalizePath)(o)}catch(r){throw new Error(`PathService.getBranchPath: Failed to generate path for noteId "${t}", branch "${n}": ${r instanceof Error?r.message:"Unknown error"}`)}}getVctrlFilename(t){return`${t.replace(/[^0-9]/g,"")}.vctrl`}validateNoteId(t,n){let r=un(DZ,t);if(!r.success){let i=r.issues.map(o=>o.message).join("; ");throw new Error(`PathService.${n}: Invalid noteId - ${i}`)}}validateVersionId(t,n){let r=un(IZ,t);if(!r.success){let i=r.issues.map(o=>o.message).join("; ");throw new Error(`PathService.${n}: Invalid versionId - ${i}`)}}validateBranchName(t,n){let r=un(OZ,t);if(!r.success){let i=r.issues.map(o=>o.message).join("; ");throw new Error(`PathService.${n}: Invalid branchName - ${i}`)}}sanitizePathComponent(t){return typeof t!="string"?"":t.replace(/\.{2,}/g,".").replace(/[\\/]/g,"_").replace(/[\x00-\x1F\x7F]/g,"_")}};var dw=require("obsidian");var PZ={maxRetries:3,baseDelay:100,maxDelay:5e3,timeout:0};async function Oo(e,t={}){let n={...PZ,...t},r;for(let i=1;i<=n.maxRetries+1;i++)try{return n.timeout>0?await Promise.race([e(),new Promise((o,s)=>setTimeout(()=>s(new Error(`Timeout: ${n.context||"Operation timed out"}`)),n.timeout))]):await e()}catch(o){if(r=o,n.validateSuccess)try{if(await n.validateSuccess())return}catch{}let s=i>n.maxRetries,a=n.shouldRetry?n.shouldRetry(o,i):!0;if(s||!a)throw o;let l=Math.random()*.3+.85,c=n.baseDelay*Math.pow(2,i-1),u=Math.min(c*l,n.maxDelay);await new Promise(f=>setTimeout(f,u))}throw r}var pw=class{constructor(t){P(this,"vault");this.vault=t.vault}async ensureFolderExists(t){let n=(0,dw.normalizePath)(t),r=n.split("/");await Oo(async()=>{let i="";for(let o of r){if(!o)continue;i=i===""?o:`${i}/${o}`;let s=this.vault.getAbstractFileByPath(i);if(s){if(s instanceof dw.TFolder)continue;throw new Error(`A file exists at the required folder path "${i}".`)}try{await this.vault.createFolder(i)}catch(a){try{if(await this.vault.adapter.exists(i)){let c=await this.vault.adapter.stat(i);if(c?.type==="folder")continue;if(c?.type==="file")throw new Error(`A file exists at the required folder path "${i}".`)}}catch{}throw a}}},{context:`ensureFolderExists:${t}`,validateSuccess:async()=>await this.vault.adapter.exists(n)?(await this.vault.adapter.stat(n))?.type==="folder":!1})}async permanentlyDeleteFolder(t){await Oo(async()=>{if(await this.vault.adapter.exists(t))try{await this.vault.adapter.rmdir(t,!0)}catch(r){if(!await this.vault.adapter.exists(t))return;throw r}},{context:`permanentlyDeleteFolder:${t}`,validateSuccess:async()=>!await this.vault.adapter.exists(t)})}async renameFolder(t,n){await Oo(async()=>{let r=await this.vault.adapter.exists(t),i=await this.vault.adapter.exists(n);if(!r){if(i)return;throw new Error(`Source folder "${t}" does not exist.`)}if(i)throw new Error(`Destination path "${n}" already exists.`);try{await this.vault.adapter.rename(t,n)}catch(o){let s=await this.vault.adapter.exists(t),a=await this.vault.adapter.exists(n);if(!s&&a)return;throw o}},{context:`renameFolder:${t}->${n}`,validateSuccess:async()=>{let r=await this.vault.adapter.exists(t),i=await this.vault.adapter.exists(n);return!r&&i}})}};Ti();var JM="system:central-manifest",mw=class{constructor(t,n){this.plugin=t;this.queueService=n;P(this,"cache",null);P(this,"pathToIdMap",null);P(this,"initializationPromise",null)}async load(t=!1){return this.queueService.enqueue(JM,()=>this._loadInternal(t))}async getNoteIdByPath(t){return!t||typeof t!="string"?null:this.queueService.enqueue(JM,async()=>(this.pathToIdMap||await this._loadInternal(!0),this.pathToIdMap?.get(t)??null))}async addNoteEntry(t,n,r){let i=new Date().toISOString();await this._updateAndSaveManifest(o=>{for(let[s,a]of Object.entries(o.notes))if(a&&a.notePath===n&&s!==t)throw new Error(`Integrity Violation: Path "${n}" is already assigned to noteId "${s}". Cannot assign to "${t}".`);o.notes[t]&&console.warn(`VC: Note ID ${t} already exists. Overwriting entry.`),o.notes[t]={notePath:n,manifestPath:r,createdAt:i,lastModified:i}})}async removeNoteEntry(t){await this._updateAndSaveManifest(n=>{n.notes[t]&&delete n.notes[t]})}async updateNotePath(t,n){let r=new Date().toISOString();await this._updateAndSaveManifest(i=>{for(let[s,a]of Object.entries(i.notes))if(a&&a.notePath===n&&s!==t)throw new Error(`Integrity Violation: Path "${n}" is already assigned to noteId "${s}". Cannot move "${t}" to this path.`);let o=i.notes[t];o&&(o.notePath=n,o.lastModified=r)})}async replaceNoteId(t,n,r){await this._updateAndSaveManifest(i=>{let o=i.notes[t];if(!o)throw new Error(`Cannot replace ID: Old ID "${t}" not found.`);if(n!==t&&i.notes[n])throw new Error(`Cannot replace ID: New ID "${n}" already exists.`);i.notes[n]={...o,manifestPath:r,lastModified:new Date().toISOString()},n!==t&&delete i.notes[t]})}invalidateCache(){this.cache=null,this.pathToIdMap=null}async getAllNotes(){return{...(await this.load()).notes}}async _loadInternal(t){if(this.cache&&!t&&this.plugin.settings.centralManifest===this.cache)return{...this.cache};if(this.initializationPromise&&(await this.initializationPromise,this.cache&&!t&&this.plugin.settings.centralManifest===this.cache))return{...this.cache};if(await this._initializeManifestInternal(),!this.cache)throw new Error("Failed to initialize central manifest");return{...this.cache}}async _initializeManifestInternal(){try{let t=this.plugin.settings.centralManifest,n=un(ic,t);n.success?(this.cache=n.output,JSON.stringify(t)!==JSON.stringify(n.output)&&(this.plugin.settings=Wt(this.plugin.settings,r=>{r.centralManifest=n.output}),await this.plugin.saveSettings())):(console.warn("Version Control: Central manifest validation failed. Resetting.",n.issues),this.cache=Ue(ic,{version:"1.0.0",notes:{}}),this.plugin.settings=Wt(this.plugin.settings,r=>{r.centralManifest=this.cache}),await this.plugin.saveSettings()),this.rebuildPathToIdMap()}catch(t){console.error("CentralManifestRepository.initializeManifest failed:",t),this.cache=Ue(ic,{version:"1.0.0",notes:{}}),this.rebuildPathToIdMap()}}async _updateAndSaveManifest(t){return this.queueService.enqueue(JM,async()=>{try{let n=await this._loadInternal(!0),r=Wt(n,o=>{t(o)}),i=Ue(ic,r);this.plugin.settings=Wt(this.plugin.settings,o=>{o.centralManifest=i}),await this.plugin.saveSettings(),this.cache=i,this.rebuildPathToIdMap()}catch(n){throw console.error("updateAndSaveManifest failed:",n),this.invalidateCache(),n}})}rebuildPathToIdMap(){if(this.pathToIdMap=new Map,!!this.cache?.notes)for(let[t,n]of Object.entries(this.cache.notes))this.pathToIdMap.set(n.notePath,t)}};Ti();var hw=class{constructor(t,n,r,i){this.app=t;this.pathService=n;this.queueService=r;this.storageService=i;P(this,"cache",new Map);P(this,"QUEUE_PREFIX","manifest:")}getQueueKey(t){return`${this.QUEUE_PREFIX}${t}`}async load(t,n=!1){return this.queueService.add(this.getQueueKey(t),()=>this._loadInternal(t,n),{priority:0})}async create(t,n){return this.queueService.add(this.getQueueKey(t),async()=>{if(await this._loadInternal(t,!0))throw new Error(`Manifest already exists for noteId: ${t}`);let i=new Date().toISOString(),o={noteId:t,notePath:n,currentBranch:Pu,branches:{[Pu]:{versions:{},totalVersions:0}},createdAt:i,lastModified:i},s=Ue(gS,o);return await this._writeManifestInternal(t,s),s},{priority:50})}async update(t,n){return this.queueService.add(this.getQueueKey(t),async()=>{let r=await this._loadInternal(t,!0);if(!r)throw new Error(`Cannot update manifest for non-existent note ID: ${t}`);let i=Wt(r,s=>{n(s);let a=s.branches[s.currentBranch];a&&(a.totalVersions=Object.keys(a.versions||{}).length)}),o=Ue(gS,i);return await this._writeManifestInternal(t,o),o},{priority:50})}invalidateCache(t){this.cache.delete(t)}clearCache(){this.cache.clear()}async _loadInternal(t,n){let r=this.pathService.getNoteManifestPath(t),i;try{i=await this.app.vault.adapter.stat(r)}catch{i=null}if(!i)return this.cache.delete(t),null;if(!n&&this.cache.has(t)){let o=this.cache.get(t);if(o.mtime>=i.mtime)return o.data}try{let o=await this._readAndParseManifestInternal(t);if(!o)return this.cache.delete(t),null;try{if(this.isV1Manifest(o)){let l=this.migrateV1Manifest(o);return await this._writeManifestInternal(t,l),o=l,l}if(this.isLegacyBranchSettings(o)){let l=this.migrateLegacyBranchSettings(o);await this._writeManifestInternal(t,l),o=l}}catch(l){console.error(`VC: Migration failed for note ${t}. Preserving original structure.`,l)}let s=un(gS,o);if(!s.success)return console.error(`VC: Manifest for note ${t} is invalid.`,s.issues),await this.tryBackupCorruptFile(r),this.cache.delete(t),null;let a=s.output;return this.cache.set(t,{data:a,mtime:i.mtime}),a}catch(o){throw console.error(`VC: Failed to load manifest for noteId: ${t}`,o),this.cache.delete(t),o}}async _readAndParseManifestInternal(t){let n=this.pathService.getNoteManifestPath(t);return Oo(async()=>{if(!await this.app.vault.adapter.exists(n))return null;let r=await this.app.vault.adapter.read(n);return!r||r.trim()===""?null:JSON.parse(r)})}async _writeManifestInternal(t,n){let r=this.pathService.getNoteManifestPath(t),i=JSON.stringify(n,null,2);try{let o=this.pathService.getNoteDbPath(t);await this.storageService.ensureFolderExists(o),await Oo(async()=>{await this.app.vault.adapter.write(r,i)});let s=await this.app.vault.adapter.stat(r);s?this.cache.set(t,{data:n,mtime:s.mtime}):this.cache.set(t,{data:n,mtime:Date.now()})}catch(o){throw this.cache.delete(t),o}}async tryBackupCorruptFile(t){let n=`${t}.corrupt.${Date.now()}`;try{await this.app.vault.adapter.exists(t)&&await this.app.vault.adapter.copy(t,n)}catch{}}isV1Manifest(t){return t!==null&&typeof t=="object"&&"versions"in t&&!("branches"in t)}migrateV1Manifest(t){let n={versions:t.versions,totalVersions:t.totalVersions,settings:t.settings};return{noteId:t.noteId,notePath:t.notePath,createdAt:t.createdAt,lastModified:t.lastModified,currentBranch:Pu,branches:{[Pu]:n}}}isLegacyBranchSettings(t){if(!t||typeof t!="object"||!("branches"in t))return!1;let n=t;for(let r of Object.values(n.branches))if(r.settings&&("noteIdFormat"in r.settings||"versionIdFormat"in r.settings||"defaultExportFormat"in r.settings))return!0;return!1}migrateLegacyBranchSettings(t){let n=JSON.parse(JSON.stringify(t));if(n.branches)for(let r in n.branches){let i=n.branches[r];i&&i.settings&&(delete i.settings.noteIdFormat,delete i.settings.versionIdFormat,delete i.settings.defaultExportFormat)}return n}};var gw=class{constructor(t,n,r,i,o,s){this.app=t;this.plugin=n;this.pathService=r;this.queueService=i;this.compressionManager=o;this.storageService=s;P(this,"FILE_OPERATION_TIMEOUT_MS",5e3);P(this,"QUEUE_PREFIX","content:");P(this,"GZIP_MAGIC_0",31);P(this,"GZIP_MAGIC_1",139);if(!this.app?.vault?.adapter)throw new Error("VersionContentRepository: Invalid dependencies")}getQueueKey(t){return`${this.QUEUE_PREFIX}${t}`}async read(t,n){return this.queueService.add(this.getQueueKey(t),()=>this._readInternal(t,n),{priority:0})}async readBinary(t,n){return this.queueService.add(this.getQueueKey(t),()=>this._readBinaryInternal(t,n),{priority:0})}async write(t,n,r){return this.queueService.add(this.getQueueKey(t),()=>this._writeInternal(t,n,r),{priority:50})}async delete(t,n){return this.queueService.add(this.getQueueKey(t),()=>this._deleteInternal(t,n),{priority:50})}async rename(t,n,r){return this.queueService.add(this.getQueueKey(t),()=>this._renameInternal(t,n,r),{priority:50})}async getLatestVersionContent(t,n){if(!n||!n.branches)return null;let r=n.branches[n.currentBranch];if(!r||!r.versions)return null;let i=Object.entries(r.versions).sort(([,a],[,l])=>l.versionNumber-a.versionNumber);if(i.length===0)return null;let o=i[0];if(!o)return null;let s=o[0];return s?this.read(t,s):null}isGzip(t){if(t.byteLength<2)return!1;let n=new Uint8Array(t);return n[0]===this.GZIP_MAGIC_0&&n[1]===this.GZIP_MAGIC_1}async _readInternal(t,n){let r=this.pathService.getNoteVersionPath(t,n);return Oo(async()=>{if(!await this.app.vault.adapter.exists(r))return null;let o=await this.app.vault.adapter.readBinary(r),s=this.isGzip(o),a=this.plugin.settings.enableCompression;if(s){let l=await this.compressionManager.decompress(o);return a||await this.app.vault.adapter.write(r,l),l}else{let c=new TextDecoder("utf-8").decode(o);if(a){let u=await this.compressionManager.compress(c);await this.app.vault.adapter.writeBinary(r,u)}return c}},{context:`read_${t}_${n}`,timeout:this.FILE_OPERATION_TIMEOUT_MS}).catch(i=>(console.error(`VC: Failed to read version ${n}`,i),null))}async _readBinaryInternal(t,n){let r=await this._readInternal(t,n);return r===null?null:new TextEncoder().encode(r).buffer}async _writeInternal(t,n,r){let i=this.pathService.getNoteVersionPath(t,n),o=this.plugin.settings.enableCompression,s=this.pathService.getNoteVersionsPath(t);return await this.storageService.ensureFolderExists(s),await Oo(async()=>{if(o){let a=await this.compressionManager.compress(r);await this.app.vault.adapter.writeBinary(i,a)}else await this.app.vault.adapter.write(i,r)},{context:`write_${t}_${n}`,timeout:this.FILE_OPERATION_TIMEOUT_MS}),{size:new Blob([r]).size}}async _deleteInternal(t,n){let r=this.pathService.getNoteVersionPath(t,n);await Oo(async()=>{await this.app.vault.adapter.exists(r)&&await this.app.vault.adapter.remove(r)},{context:`delete_${t}_${n}`,timeout:this.FILE_OPERATION_TIMEOUT_MS})}async _renameInternal(t,n,r){let i=this.pathService.getNoteVersionPath(t,n),o=this.pathService.getNoteVersionPath(t,r),s=this.pathService.getNoteVersionsPath(t);await this.storageService.ensureFolderExists(s),await Oo(async()=>{let a=await this.app.vault.adapter.exists(i),l=await this.app.vault.adapter.exists(o);if(!a){if(l)return;throw new Error(`Source file missing: ${i}`)}if(l)throw new Error(`Target file exists: ${o}`);try{await this.app.vault.adapter.rename(i,o)}catch(c){let u=await this.app.vault.adapter.exists(i),f=await this.app.vault.adapter.exists(o);if(!u&&f)return;throw c}},{context:`rename_${t}_${n}_to_${r}`,timeout:this.FILE_OPERATION_TIMEOUT_MS})}};var gF=require("obsidian");var lF=Symbol("Comlink.proxy"),kZ=Symbol("Comlink.endpoint"),nR=Symbol("Comlink.releaseProxy"),eR=Symbol("Comlink.finalizer"),vw=Symbol("Comlink.thrown"),cF=e=>typeof e=="object"&&e!==null||typeof e=="function",_Z={canHandle:e=>cF(e)&&e[lF],serialize(e){let{port1:t,port2:n}=new MessageChannel;return fF(e,t),[n,[n]]},deserialize(e){return e.start(),rR(e)}},VZ={canHandle:e=>cF(e)&&vw in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},uF=new Map([["proxy",_Z],["throw",VZ]]);function LZ(e,t){for(let n of e)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function fF(e,t=globalThis,n=["*"]){t.addEventListener("message",function r(i){if(!i||!i.data)return;if(!LZ(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}let{id:o,type:s,path:a}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(Uu),c;try{let u=a.slice(0,-1).reduce((p,d)=>p[d],e),f=a.reduce((p,d)=>p[d],e);switch(s){case"GET":c=f;break;case"SET":u[a.slice(-1)[0]]=Uu(i.data.value),c=!0;break;case"APPLY":c=f.apply(u,l);break;case"CONSTRUCT":{let p=new f(...l);c=UZ(p)}break;case"ENDPOINT":{let{port1:p,port2:d}=new MessageChannel;fF(e,d),c=no(p,[p])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[vw]:0}}Promise.resolve(c).catch(u=>({value:u,[vw]:0})).then(u=>{let[f,p]=ww(u);t.postMessage(Object.assign(Object.assign({},f),{id:o}),p),s==="RELEASE"&&(t.removeEventListener("message",r),pF(t),eR in e&&typeof e[eR]=="function"&&e[eR]())}).catch(u=>{let[f,p]=ww({value:new TypeError("Unserializable return value"),[vw]:0});t.postMessage(Object.assign(Object.assign({},f),{id:o}),p)})}),t.start&&t.start()}function FZ(e){return e.constructor.name==="MessagePort"}function pF(e){FZ(e)&&e.close()}function rR(e,t){let n=new Map;return e.addEventListener("message",function(i){let{data:o}=i;if(!o||!o.id)return;let s=n.get(o.id);if(s)try{s(o)}finally{n.delete(o.id)}}),tR(e,n,[],t)}function yw(e){if(e)throw new Error("Proxy has been released and is not useable")}function dF(e){return zp(e,new Map,{type:"RELEASE"}).then(()=>{pF(e)})}var bw=new WeakMap,Sw="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{let t=(bw.get(e)||0)-1;bw.set(e,t),t===0&&dF(e)});function BZ(e,t){let n=(bw.get(t)||0)+1;bw.set(t,n),Sw&&Sw.register(e,t,e)}function zZ(e){Sw&&Sw.unregister(e)}function tR(e,t,n=[],r=function(){}){let i=!1,o=new Proxy(r,{get(s,a){if(yw(i),a===nR)return()=>{zZ(o),dF(e),t.clear(),i=!0};if(a==="then"){if(n.length===0)return{then:()=>o};let l=zp(e,t,{type:"GET",path:n.map(c=>c.toString())}).then(Uu);return l.then.bind(l)}return tR(e,t,[...n,a])},set(s,a,l){yw(i);let[c,u]=ww(l);return zp(e,t,{type:"SET",path:[...n,a].map(f=>f.toString()),value:c},u).then(Uu)},apply(s,a,l){yw(i);let c=n[n.length-1];if(c===kZ)return zp(e,t,{type:"ENDPOINT"}).then(Uu);if(c==="bind")return tR(e,t,n.slice(0,-1));let[u,f]=aF(l);return zp(e,t,{type:"APPLY",path:n.map(p=>p.toString()),argumentList:u},f).then(Uu)},construct(s,a){yw(i);let[l,c]=aF(a);return zp(e,t,{type:"CONSTRUCT",path:n.map(u=>u.toString()),argumentList:l},c).then(Uu)}});return BZ(o,e),o}function HZ(e){return Array.prototype.concat.apply([],e)}function aF(e){let t=e.map(ww);return[t.map(n=>n[0]),HZ(t.map(n=>n[1]))]}var mF=new WeakMap;function no(e,t){return mF.set(e,t),e}function UZ(e){return Object.assign(e,{[lF]:!0})}function ww(e){for(let[t,n]of uF)if(n.canHandle(e)){let[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},mF.get(e)||[]]}function Uu(e){switch(e.type){case"HANDLER":return uF.get(e.name).deserialize(e.value);case"RAW":return e.value}}function zp(e,t,n,r){return new Promise(i=>{let o=$Z();t.set(o,i),e.start&&e.start(),e.postMessage(Object.assign({id:o},n),r)})}function $Z(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var Ss=class{constructor(t){P(this,"worker",null);P(this,"workerProxy",null);P(this,"workerUrl",null);P(this,"isTerminated",!1);P(this,"isInitializing",!1);P(this,"initPromise",null);P(this,"consecutiveErrors",0);P(this,"lastErrorTime",0);P(this,"lastSuccessTime",0);P(this,"operationCount",0);P(this,"totalOperationTime",0);P(this,"workerString");P(this,"workerName");P(this,"validateOnInit");P(this,"maxConsecutiveErrors");P(this,"errorResetTime");this.workerString=t.workerString,this.workerName=t.workerName,this.validateOnInit=t.validateOnInit??!0,this.maxConsecutiveErrors=t.maxConsecutiveErrors??3,this.errorResetTime=t.errorResetTime??6e4}async execute(t,n={}){let{timeout:r=3e4,retry:i=!0,retryAttempts:o=1,forceRestart:s=!1}=n;if(this.isTerminated)throw new Vn(`${this.workerName} has been terminated`,"WORKER_UNAVAILABLE");s&&await this.restart();try{this.workerProxy||await this.initializeAsync()}catch(l){throw new Vn(`Failed to initialize ${this.workerName} for execution`,"INIT_FAILED",{originalError:l})}let a=performance.now();try{let l=await this.runWithTimeout(()=>t(this.workerProxy),r);return this.recordOperation(performance.now()-a),l}catch(l){if(this.recordError(),i&&o>0&&this.isRetryableError(l)&&!this.isTerminated)return console.warn(`Version Control: Retrying ${this.workerName} operation after error:`,l),await this.restart(),this.execute(t,{...n,retryAttempts:o-1,forceRestart:!1});throw l instanceof Vn?l:new Vn(`${this.workerName} operation failed: ${l instanceof Error?l.message:String(l)}`,"OPERATION_FAILED",{originalError:l})}}runWithTimeout(t,n){return new Promise(async(r,i)=>{let o,s=new Promise((a,l)=>{o=window.setTimeout(()=>{l(new Vn(`${this.workerName} operation timed out after ${n}ms`,"OPERATION_TIMEOUT"))},n)});try{let a=await Promise.race([Promise.resolve(t()),s]);r(a)}catch(a){i(a)}finally{o!==void 0&&clearTimeout(o)}})}isRetryableError(t){if(this.isTerminated)return!1;let n=t instanceof Error?t.message:String(t);return!!(n.includes("Proxy has been released")||n.includes("MessagePort was closed")||n.includes("The worker has been terminated")||t instanceof Vn&&t.code==="OPERATION_TIMEOUT")}async initializeAsync(){if(!this.isTerminated){if(this.initPromise)return this.initPromise;if(!(this.worker&&this.workerProxy))return this.initPromise=(async()=>{this.isInitializing=!0;try{this.createWorker(),this.validateOnInit&&this.workerProxy&&await this.validateWorker()}catch(t){throw this.cleanupResources(),t}finally{this.isInitializing=!1,this.initPromise=null}})(),this.initPromise}}initialize(){this.initializeAsync().catch(t=>{console.warn(`Version Control: Background initialization of ${this.workerName} failed`,t)})}createWorker(){if(!this.worker){if(!this.workerString)throw new Vn(`${this.workerName} code missing`,"WORKER_CODE_MISSING");try{let t=new Blob([this.workerString],{type:"application/javascript"});this.workerUrl=URL.createObjectURL(t),this.worker=new Worker(this.workerUrl),this.worker.onerror=n=>{console.error(`Version Control: ${this.workerName} error:`,n),this.recordError()},this.workerProxy=rR(this.worker)}catch(t){throw this.cleanupResources(),new Vn("Worker creation failed","WORKER_CREATION_FAILED",{originalError:t})}}}async validateWorker(){}ensureWorker(){if(this.isTerminated)throw new Vn(`${this.workerName} has been terminated`,"WORKER_UNAVAILABLE");if(this.workerProxy||this.createWorker(),!this.workerProxy)throw new Vn(`${this.workerName} not available`,"WORKER_UNAVAILABLE");return this.workerProxy}recordOperation(t){this.operationCount++,this.totalOperationTime+=t,this.lastSuccessTime=Date.now(),Date.now()-this.lastErrorTime>this.errorResetTime&&(this.consecutiveErrors=0)}recordError(){this.consecutiveErrors++,this.lastErrorTime=Date.now()}getHealthStats(){return{consecutiveErrors:this.consecutiveErrors,operationCount:this.operationCount,averageOperationTime:this.operationCount>0?this.totalOperationTime/this.operationCount:0,isHealthy:this.consecutiveErrors<this.maxConsecutiveErrors,lastErrorTime:this.lastErrorTime,lastSuccessTime:this.lastSuccessTime}}isHealthy(){return this.consecutiveErrors<this.maxConsecutiveErrors}terminate(){this.isTerminated||(this.isTerminated=!0,this.cleanupResources())}async restart(){this.isTerminated||(this.cleanupResources(),this.consecutiveErrors=0,await this.initializeAsync())}cleanupResources(){if(this.workerProxy){try{let t=nR,n=this.workerProxy[t];typeof n=="function"&&n()}catch{}this.workerProxy=null}if(this.worker){try{this.worker.terminate()}catch{}this.worker=null}if(this.workerUrl){try{URL.revokeObjectURL(this.workerUrl)}catch{}this.workerUrl=null}}isTerminatedState(){return this.isTerminated}isInitialized(){return this.worker!==null}isActive(){return this.worker!==null&&!this.isTerminated}getStatus(){let t=this.getHealthStats();return{isInitialized:this.isInitialized(),isActive:this.isActive(),isHealthy:t.isHealthy,healthStats:t}}},Vn=class extends Error{constructor(n,r,i){super(n);this.code=r;this.context=i;this.name="WorkerManagerError"}};var Zh=class{diff(t,n,r={}){let i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);let o=this.castInput(t,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)}diffWithOptionsObj(t,n,r,i){var o;let s=y=>{if(y=this.postProcess(y,r),i){setTimeout(function(){i(y)},0);return}else return y},a=n.length,l=t.length,c=1,u=a+l;r.maxEditLength!=null&&(u=Math.min(u,r.maxEditLength));let f=(o=r.timeout)!==null&&o!==void 0?o:1/0,p=Date.now()+f,d=[{oldPos:-1,lastComponent:void 0}],h=this.extractCommon(d[0],n,t,0,r);if(d[0].oldPos+1>=l&&h+1>=a)return s(this.buildValues(d[0].lastComponent,n,t));let m=-1/0,v=1/0,g=()=>{for(let y=Math.max(m,-c);y<=Math.min(v,c);y+=2){let b,w=d[y-1],S=d[y+1];w&&(d[y-1]=void 0);let C=!1;if(S){let E=S.oldPos-y;C=S&&0<=E&&E<a}let x=w&&w.oldPos+1<l;if(!C&&!x){d[y]=void 0;continue}if(!x||C&&w.oldPos<S.oldPos?b=this.addToPath(S,!0,!1,0,r):b=this.addToPath(w,!1,!0,1,r),h=this.extractCommon(b,n,t,y,r),b.oldPos+1>=l&&h+1>=a)return s(this.buildValues(b.lastComponent,n,t))||!0;d[y]=b,b.oldPos+1>=l&&(v=Math.min(v,y-1)),h+1>=a&&(m=Math.max(m,y+1))}c++};if(i)(function y(){setTimeout(function(){if(c>u||Date.now()>p)return i(void 0);g()||y()},0)})();else for(;c<=u&&Date.now()<=p;){let y=g();if(y)return y}}addToPath(t,n,r,i,o){let s=t.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:t.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:t.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}}extractCommon(t,n,r,i,o){let s=n.length,a=r.length,l=t.oldPos,c=l-i,u=0;for(;c+1<s&&l+1<a&&this.equals(r[l+1],n[c+1],o);)c++,l++,u++,o.oneChangePerToken&&(t.lastComponent={count:1,previousComponent:t.lastComponent,added:!1,removed:!1});return u&&!o.oneChangePerToken&&(t.lastComponent={count:u,previousComponent:t.lastComponent,added:!1,removed:!1}),t.oldPos=l,c}equals(t,n,r){return r.comparator?r.comparator(t,n):t===n||!!r.ignoreCase&&t.toLowerCase()===n.toLowerCase()}removeEmpty(t){let n=[];for(let r=0;r<t.length;r++)t[r]&&n.push(t[r]);return n}castInput(t,n){return t}tokenize(t,n){return Array.from(t)}join(t){return t.join("")}postProcess(t,n){return t}get useLongestToken(){return!1}buildValues(t,n,r){let i=[],o;for(;t;)i.push(t),o=t.previousComponent,delete t.previousComponent,t=o;i.reverse();let s=i.length,a=0,l=0,c=0;for(;a<s;a++){let u=i[a];if(u.removed)u.value=this.join(r.slice(c,c+u.count)),c+=u.count;else{if(!u.added&&this.useLongestToken){let f=n.slice(l,l+u.count);f=f.map(function(p,d){let h=r[c+d];return h.length>p.length?h:p}),u.value=this.join(f)}else u.value=this.join(n.slice(l,l+u.count));l+=u.count,u.added||(c+=u.count)}}return i}};var iR=class extends Zh{constructor(){super(...arguments),this.tokenize=jZ}equals(t,n,r){return r.ignoreWhitespace?((!r.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!r.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):r.ignoreNewlineAtEof&&!r.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(t,n,r)}},hF=new iR;function oR(e,t,n){return hF.diff(e,t,n)}function jZ(e,t){t.stripTrailingCr&&(e=e.replace(/\r\n/g,`
`));let n=[],r=e.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(let i=0;i<r.length;i++){let o=r[i];i%2&&!t.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}var qZ=ae(te(),Ka(),Ao(500)),GZ=ae(te(),Ka(),Ao(255)),KZ=ae(te(),Ka(),Ao(500)),WZ=hs(["version","edit"]);function YZ(e){if(!e)return{};let t={};return e.name!==void 0&&(t.name=e.name),e.description!==void 0&&(t.description=e.description),t}function xw(e,t,n){let r=un(e,t);if(!r.success)throw new Vn(`TimelineDatabase: Invalid ${n}`,"INVALID_INPUT");return r.output}var sR=class extends Ss{constructor(){super({workerString:'(()=>{var wo=Object.create;var di=Object.defineProperty;var _o=Object.getOwnPropertyDescriptor;var Eo=Object.getOwnPropertyNames;var xo=Object.getPrototypeOf,ko=Object.prototype.hasOwnProperty;var Ao=(s,o)=>()=>(o||s((o={exports:{}}).exports,o),o.exports);var So=(s,o,u,d)=>{if(o&&typeof o=="object"||typeof o=="function")for(let f of Eo(o))!ko.call(s,f)&&f!==u&&di(s,f,{get:()=>o[f],enumerable:!(d=_o(o,f))||d.enumerable});return s};var Oo=(s,o,u)=>(u=s!=null?wo(xo(s)):{},So(o||!s||!s.__esModule?di(u,"default",{value:s,enumerable:!0}):u,s));var _i=Ao((hr,dr)=>{(function(s,o){typeof hr=="object"&&typeof dr<"u"?dr.exports=o():typeof define=="function"&&define.amd?define(o):(s=typeof globalThis<"u"?globalThis:s||self).Dexie=o()})(hr,function(){"use strict";var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])})(e,t)},o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function u(e,t,n){if(n||arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var d=typeof globalThis<"u"?globalThis:typeof self<"u"?self:window,f=Object.keys,g=Array.isArray;function k(e,t){return typeof t!="object"||f(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||d.Promise||(d.Promise=Promise);var O=Object.getPrototypeOf,D={}.hasOwnProperty;function P(e,t){return D.call(e,t)}function L(e,t){typeof t=="function"&&(t=t(O(e))),(typeof Reflect>"u"?f:Reflect.ownKeys)(t).forEach(function(n){F(e,n,t[n])})}var N=Object.defineProperty;function F(e,t,n,r){N(e,t,k(n&&P(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function $(e){return{from:function(t){return e.prototype=Object.create(t.prototype),F(e.prototype,"constructor",e),{extend:L.bind(null,e.prototype)}}}}var Z=Object.getOwnPropertyDescriptor,we=[].slice;function ee(e,t,n){return we.call(e,t,n)}function ie(e,t){return t(e)}function oe(e){if(!e)throw new Error("Assertion Failed")}function ne(e){d.setImmediate?setImmediate(e):setTimeout(e,0)}function le(e,t){if(typeof t=="string"&&P(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=le(e,t[r]);n.push(a)}return n}var c=t.indexOf(".");if(c!==-1){var l=e[t.substr(0,c)];return l==null?void 0:le(l,t.substr(c+1))}}function re(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){oe(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)re(e,t[r],n[r])}else{var a,c,l=t.indexOf(".");l!==-1?(a=t.substr(0,l),(c=t.substr(l+1))===""?n===void 0?g(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n:re(l=!(l=e[a])||!P(e,a)?e[a]={}:l,c,n)):n===void 0?g(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Ce(e){var t,n={};for(t in e)P(e,t)&&(n[t]=e[t]);return n}var xn=[].concat;function Tr(e){return xn.apply([],e)}var $e="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Tr([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return d[e]}),Pr=new Set($e.map(function(e){return d[e]})),yt=null;function Fe(e){return yt=new WeakMap,e=(function t(n){if(!n||typeof n!="object")return n;var r=yt.get(n);if(r)return r;if(g(n)){r=[],yt.set(n,r);for(var i=0,a=n.length;i<a;++i)r.push(t(n[i]))}else if(Pr.has(n.constructor))r=n;else{var c,l=O(n);for(c in r=l===Object.prototype?{}:Object.create(l),yt.set(n,r),n)P(n,c)&&(r[c]=t(n[c]))}return r})(e),yt=null,e}var Ni={}.toString;function kn(e){return Ni.call(e).slice(8,-1)}var An=typeof Symbol<"u"?Symbol.iterator:"@@iterator",qi=typeof An=="symbol"?function(e){var t;return e!=null&&(t=e[An])&&t.apply(e)}:function(){return null};function Ve(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var rt={};function Te(e){var t,n,r,i;if(arguments.length===1){if(g(e))return e.slice();if(this===rt&&typeof e=="string")return[e];if(i=qi(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Sn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},wt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xe=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(wt),Fi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function it(e,t){this.name=e,this.message=t}function Dr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`\n`)}function Kt(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Dr(e,t)}function ot(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Dr(e,this.failures)}$(it).from(Error).extend({toString:function(){return this.name+": "+this.message}}),$(Kt).from(it),$(ot).from(it);var On=xe.reduce(function(e,t){return e[t]=t+"Error",e},{}),Vi=it,U=xe.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`\n `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=Fi[t]||n,this.inner=null)}return $(r).from(Vi),e[t]=r,e},{});U.Syntax=SyntaxError,U.Type=TypeError,U.Range=RangeError;var Ir=wt.reduce(function(e,t){return e[t+"Error"]=U[t],e},{}),Rt=xe.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=U[t]),e},{});function J(){}function vt(e){return e}function Ui(e,t){return e==null||e===vt?t:function(n){return t(e(n))}}function Ue(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function $i(e,t){return e===J?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ue(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ue(i,this.onerror):i),a!==void 0?a:n}}function zi(e,t){return e===J?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ue(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ue(r,this.onerror):r)}}function Wi(e,t){return e===J?t:function(n){var r=e.apply(this,arguments);k(n,r);var i=this.onsuccess,a=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Ue(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ue(a,this.onerror):a),r===void 0?n===void 0?void 0:n:k(r,n)}}function Yi(e,t){return e===J?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Tn(e,t){return e===J?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}Rt.ModifyError=Kt,Rt.DexieError=it,Rt.BulkError=ot;var Ae=typeof location<"u"&&/^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);function Cr(e){Ae=e}var bt={},Lr=100,$e=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,O(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,O(t),e]})(),wt=$e[0],xe=$e[1],$e=$e[2],xe=xe&&xe.then,ze=wt&&wt.constructor,Pn=!!$e,_t=function(e,t){Et.push([e,t]),Mt&&(queueMicrotask(Gi),Mt=!1)},Dn=!0,Mt=!0,We=[],jt=[],In=vt,Le={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:J,pgp:!1,env:{},finalize:J},V=Le,Et=[],Ye=0,Bt=[];function B(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=V;if(typeof e!="function"){if(e!==bt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ln(this,this._value))}this._state=null,this._value=null,++t.ref,(function n(r,i){try{i(function(a){if(r._state===null){if(a===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&at();a&&typeof a.then=="function"?n(r,function(l,p){a instanceof B?a._then(l,p):a.then(l,p)}):(r._state=!0,r._value=a,Rr(r)),c&&st()}},Ln.bind(null,r))}catch(a){Ln(r,a)}})(this,e)}var Cn={get:function(){var e=V,t=Vt;function n(r,i){var a=this,c=!e.global&&(e!==V||t!==Vt),l=c&&!Re(),p=new B(function(m,w){Kn(a,new Kr(jr(r,e,c,l),jr(i,e,c,l),m,w,e))});return this._consoleTask&&(p._consoleTask=this._consoleTask),p}return n.prototype=bt,n},set:function(e){F(this,"then",e&&e.prototype===bt?Cn:{get:function(){return e},set:Cn.set})}};function Kr(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}function Ln(e,t){var n,r;jt.push(t),e._state===null&&(n=e._lib&&at(),t=In(t),e._state=!1,e._value=t,r=e,We.some(function(i){return i._value===r._value})||We.push(r),Rr(e),n&&st())}function Rr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Kn(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Ye===0&&(++Ye,_t(function(){--Ye==0&&Rn()},[]))}function Kn(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ye,_t(Hi,[n,e,t])}else e._listeners.push(t)}function Hi(e,t,n){try{var r,i=t._value;!t._state&&jt.length&&(jt=[]),r=Ae&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||jt.indexOf(i)!==-1||(function(a){for(var c=We.length;c;)if(We[--c]._value===a._value)return We.splice(c,1)})(t),n.resolve(r)}catch(a){n.reject(a)}finally{--Ye==0&&Rn(),--n.psd.ref||n.psd.finalize()}}function Gi(){He(Le,function(){at()&&st()})}function at(){var e=Dn;return Mt=Dn=!1,e}function st(){var e,t,n;do for(;0<Et.length;)for(e=Et,Et=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<Et.length);Mt=Dn=!0}function Rn(){var e=We;We=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=Bt.slice(0),n=t.length;n;)t[--n]()}function Nt(e){return new B(bt,!1,e)}function ae(e,t){var n=V;return function(){var r=at(),i=V;try{return Me(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{Me(i,!1),r&&st()}}}L(B.prototype,{then:Cn,_then:function(e,t){Kn(this,new Kr(null,null,e,t,V))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:Nt)(r)}):this.then(null,function(r){return(r&&r.name===t?n:Nt)(r)})},finally:function(e){return this.then(function(t){return B.resolve(e()).then(function(){return t})},function(t){return B.resolve(e()).then(function(){return Nt(t)})})},timeout:function(e,t){var n=this;return e<1/0?new B(function(r,i){var a=setTimeout(function(){return i(new U.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&F(B.prototype,Symbol.toStringTag,"Dexie.Promise"),Le.env=Mr(),L(B,{all:function(){var e=Te.apply(null,arguments).map(Ut);return new B(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return B.resolve(i).then(function(c){e[a]=c,--r||t(e)},n)})})},resolve:function(e){return e instanceof B?e:e&&typeof e.then=="function"?new B(function(t,n){e.then(t,n)}):new B(bt,!0,e)},reject:Nt,race:function(){var e=Te.apply(null,arguments).map(Ut);return new B(function(t,n){e.map(function(r){return B.resolve(r).then(t,n)})})},PSD:{get:function(){return V},set:function(e){return V=e}},totalEchoes:{get:function(){return Vt}},newPSD:Ke,usePSD:He,scheduler:{get:function(){return _t},set:function(e){_t=e}},rejectionMapper:{get:function(){return In},set:function(e){In=e}},follow:function(e,t){return new B(function(n,r){return Ke(function(i,a){var c=V;c.unhandleds=[],c.onunhandled=a,c.finalize=Ue(function(){var l,p=this;l=function(){p.unhandleds.length===0?i():a(p.unhandleds[0])},Bt.push(function m(){l(),Bt.splice(Bt.indexOf(m),1)}),++Ye,_t(function(){--Ye==0&&Rn()},[])},c.finalize),e()},t,n,r)})}}),ze&&(ze.allSettled&&F(B,"allSettled",function(){var e=Te.apply(null,arguments).map(Ut);return new B(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return B.resolve(i).then(function(c){return r[a]={status:"fulfilled",value:c}},function(c){return r[a]={status:"rejected",reason:c}}).then(function(){return--n||t(r)})})})}),ze.any&&typeof AggregateError<"u"&&F(B,"any",function(){var e=Te.apply(null,arguments).map(Ut);return new B(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,c){return B.resolve(a).then(function(l){return t(l)},function(l){i[c]=l,--r||n(new AggregateError(i))})})})}),ze.withResolvers&&(B.withResolvers=ze.withResolvers));var he={awaits:0,echoes:0,id:0},Xi=0,qt=[],Ft=0,Vt=0,Qi=0;function Ke(e,t,n,r){var i=V,a=Object.create(i);return a.parent=i,a.ref=0,a.global=!1,a.id=++Qi,Le.env,a.env=Pn?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},t&&k(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},r=He(a,e,n,r),a.ref===0&&a.finalize(),r}function ut(){return he.id||(he.id=++Xi),++he.awaits,he.echoes+=Lr,he.id}function Re(){return!!he.awaits&&(--he.awaits==0&&(he.id=0),he.echoes=he.awaits*Lr,!0)}function Ut(e){return he.echoes&&e&&e.constructor===ze?(ut(),e.then(function(t){return Re(),t},function(t){return Re(),ue(t)})):e}function Zi(){var e=qt[qt.length-1];qt.pop(),Me(e,!1)}function Me(e,t){var n,r=V;(t?!he.echoes||Ft++&&e===V:!Ft||--Ft&&e===V)||queueMicrotask(t?function(i){++Vt,he.echoes&&--he.echoes!=0||(he.echoes=he.awaits=he.id=0),qt.push(V),Me(i,!0)}.bind(null,e):Zi),e!==V&&(V=e,r===Le&&(Le.env=Mr()),Pn&&(n=Le.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(d,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Mr(){var e=d.Promise;return Pn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(d,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function He(e,t,n,r,i){var a=V;try{return Me(e,!0),t(n,r,i)}finally{Me(a,!1)}}function jr(e,t,n,r){return typeof e!="function"?e:function(){var i=V;n&&ut(),Me(t,!0);try{return e.apply(this,arguments)}finally{Me(i,!1),r&&queueMicrotask(Re)}}}function Mn(e){Promise===ze&&he.echoes===0?Ft===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+xe).indexOf("[native code]")===-1&&(ut=Re=J);var ue=B.reject,Ge="\\uFFFF",Pe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Br="String expected.",ct=[],$t="__dbnames",jn="readonly",Bn="readwrite";function Xe(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Nr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function zt(e){return typeof e!="string"||/\\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Fe(t))[e],t}}function qr(){throw U.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function G(e,t){try{var n=Fr(e),r=Fr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return(function(i,a){for(var c=i.length,l=a.length,p=c<l?c:l,m=0;m<p;++m)if(i[m]!==a[m])return i[m]<a[m]?-1:1;return c===l?0:c<l?-1:1})(Vr(e),Vr(t));case"Array":return(function(i,a){for(var c=i.length,l=a.length,p=c<l?c:l,m=0;m<p;++m){var w=G(i[m],a[m]);if(w!==0)return w}return c===l?0:c<l?-1:1})(e,t)}}catch{}return NaN}function Fr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=kn(e),e==="ArrayBuffer"?"binary":e)}function Vr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Wt(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(i,a){return!n.failures[a]})),Promise.all(r.map(function(i){return i=i.updatesTable,t?e.db.table(i).where("k").anyOf(t).delete():e.db.table(i).clear()})).then(function(){return n})):n}var xt=(Ur.prototype.execute=function(e){var t=this["@@propmod"];if(t.add!==void 0){var n=t.add;if(g(n))return u(u([],g(e)?e:[],!0),n,!0).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(t.remove!==void 0){var r=t.remove;if(g(r))return g(e)?e.filter(function(i){return!r.includes(i)}).sort():[];if(typeof r=="number")return Number(e)-r;if(typeof r=="bigint")try{return BigInt(e)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=t.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?t.replacePrefix[1]+e.substring(n.length):e},Ur);function Ur(e){this["@@propmod"]=e}function $r(e,t){for(var n=f(t),r=n.length,i=!1,a=0;a<r;++a){var c=n[a],l=t[c],p=le(e,c);l instanceof xt?(re(e,c,l.execute(p)),i=!0):p!==l&&(re(e,c,l),i=!0)}return i}var zr=(te.prototype._trans=function(e,t,n){var r=this._tx||V.trans,i=this.name,a=Ae&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(m,w,h){if(!h.schema[i])throw new U.NotFound("Table "+i+" not part of transaction");return t(h.idbtrans,h)}var l=at();try{var p=r&&r.db._novip===this.db._novip?r===V.trans?r._promise(e,c,n):Ke(function(){return r._promise(e,c,n)},{trans:r,transless:V.transless||V}):(function m(w,h,E,y){if(w.idbdb&&(w._state.openComplete||V.letThrough||w._vip)){var v=w._createTransaction(h,E,w._dbSchema);try{v.create(),w._state.PR1398_maxLoop=3}catch(b){return b.name===On.InvalidState&&w.isOpen()&&0<--w._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),w.close({disableAutoOpen:!1}),w.open().then(function(){return m(w,h,E,y)})):ue(b)}return v._promise(h,function(b,_){return Ke(function(){return V.trans=v,y(b,_,v)})}).then(function(b){if(h==="readwrite")try{v.idbtrans.commit()}catch{}return h==="readonly"?b:v._completion.then(function(){return b})})}if(w._state.openComplete)return ue(new U.DatabaseClosed(w._state.dbOpenError));if(!w._state.isBeingOpened){if(!w._state.autoOpen)return ue(new U.DatabaseClosed);w.open().catch(J)}return w._state.dbReadyPromise.then(function(){return m(w,h,E,y)})})(this.db,e,[this.name],c);return a&&(p._consoleTask=a,p=p.catch(function(m){return console.trace(m),ue(m)})),p}finally{l&&st()}},te.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?ue(new U.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(i){return n.hook.reading.fire(i)})}).then(t)},te.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(g(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=f(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(l){if(l.compound&&t.every(function(m){return 0<=l.keyPath.indexOf(m)})){for(var p=0;p<t.length;++p)if(t.indexOf(l.keyPath[p])===-1)return!1;return!0}return!1}).sort(function(l,p){return l.keyPath.length-p.keyPath.length})[0];if(n&&this.db._maxKey!==Ge){var a=n.keyPath.slice(0,t.length);return this.where(a).equals(a.map(function(p){return e[p]}))}!n&&Ae&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName;function i(l,p){return G(l,p)===0}var c=t.reduce(function(h,p){var m=h[0],w=h[1],h=r[p],E=e[p];return[m||h,m||!h?Xe(w,h&&h.multi?function(y){return y=le(y,p),g(y)&&y.some(function(v){return i(E,v)})}:function(y){return i(E,le(y,p))}):w]},[null,null]),a=c[0],c=c[1];return a?this.where(a.name).equals(e[a.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},te.prototype.filter=function(e){return this.toCollection().and(e)},te.prototype.count=function(e){return this.toCollection().count(e)},te.prototype.offset=function(e){return this.toCollection().offset(e)},te.prototype.limit=function(e){return this.toCollection().limit(e)},te.prototype.each=function(e){return this.toCollection().each(e)},te.prototype.toArray=function(e){return this.toCollection().toArray(e)},te.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},te.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,g(e)?"[".concat(e.join("+"),"]"):e))},te.prototype.reverse=function(){return this.toCollection().reverse()},te.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function i(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof qr&&((function(p,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");function w(){this.constructor=p}s(p,m),p.prototype=m===null?Object.create(m):(w.prototype=m.prototype,new w)})(i,t=e),Object.defineProperty(i.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),i.prototype.table=function(){return r},e=i);for(var a=new Set,c=e.prototype;c;c=O(c))Object.getOwnPropertyNames(c).forEach(function(p){return a.add(p)});function l(p){if(!p)return p;var m,w=Object.create(e.prototype);for(m in p)if(!a.has(m))try{w[m]=p[m]}catch{}return w}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=l,this.hook("reading",l),e},te.prototype.defineClass=function(){return this.mapToClass(function(e){k(this,e)})},te.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,c=e;return a&&i&&(c=zt(a)(e)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"add",keys:t!=null?[t]:null,values:[c]})}).then(function(l){return l.numFailures?B.reject(l.failures[0]):l.lastResult}).then(function(l){if(a)try{re(e,a,l)}catch{}return l})},te.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(i){return n.core.get({trans:i,key:e}).then(function(a){var c=a??{};return $r(c,t),r&&re(c,r,e),n.core.mutate({trans:i,type:"put",values:[c],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(l){return l.numFailures?B.reject(l.failures[0]):!!a})})})},te.prototype.update=function(e,t){return typeof e!="object"||g(e)?this.where(":id").equals(e).modify(t):(e=le(e,this.schema.primKey.keyPath),e===void 0?ue(new U.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},te.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,c=e;return a&&i&&(c=zt(a)(e)),this._trans("readwrite",function(l){return n.core.mutate({trans:l,type:"put",values:[c],keys:t!=null?[t]:null})}).then(function(l){return l.numFailures?B.reject(l.failures[0]):l.lastResult}).then(function(l){if(a)try{re(e,a,l)}catch{}return l})},te.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(r){return Wt(t,[e],r)}).then(function(r){return r.numFailures?B.reject(r.failures[0]):void 0})})},te.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Nr}).then(function(n){return Wt(e,null,n)})}).then(function(t){return t.numFailures?B.reject(t.failures[0]):void 0})},te.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(i){return t.hook.reading.fire(i)})})})},te.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var m=r.schema.primKey,l=m.auto,m=m.keyPath;if(m&&i)throw new U.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");var p=e.length,m=m&&l?e.map(zt(m)):e;return r.core.mutate({trans:c,type:"add",keys:i,values:m,wantResults:a}).then(function(v){var h=v.numFailures,E=v.results,y=v.lastResult,v=v.failures;if(h===0)return a?E:y;throw new ot("".concat(r.name,".bulkAdd(): ").concat(h," of ").concat(p," operations failed"),v)})})},te.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var m=r.schema.primKey,l=m.auto,m=m.keyPath;if(m&&i)throw new U.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new U.InvalidArgument("Arguments objects and keys must have the same length");var p=e.length,m=m&&l?e.map(zt(m)):e;return r.core.mutate({trans:c,type:"put",keys:i,values:m,wantResults:a}).then(function(v){var h=v.numFailures,E=v.results,y=v.lastResult,v=v.failures;if(h===0)return a?E:y;throw new ot("".concat(r.name,".bulkPut(): ").concat(h," of ").concat(p," operations failed"),v)})})},te.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(c){return c.key}),i=e.map(function(c){return c.changes}),a=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:r,cache:"clone"}).then(function(l){var p=[],m=[];e.forEach(function(h,E){var y=h.key,v=h.changes,b=l[E];if(b){for(var _=0,x=Object.keys(v);_<x.length;_++){var A=x[_],S=v[A];if(A===t.schema.primKey.keyPath){if(G(S,y)!==0)throw new U.Constraint("Cannot update primary key in bulkUpdate()")}else re(b,A,S)}a.push(E),p.push(y),m.push(b)}});var w=p.length;return n.mutate({trans:c,type:"put",keys:p,values:m,updates:{keys:r,changeSpecs:i}}).then(function(h){var E=h.numFailures,y=h.failures;if(E===0)return w;for(var v=0,b=Object.keys(y);v<b.length;v++){var _,x=b[v],A=a[Number(x)];A!=null&&(_=y[x],delete y[x],y[A]=_)}throw new ot("".concat(t.name,".bulkUpdate(): ").concat(E," of ").concat(w," operations failed"),y)})})})},te.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e}).then(function(i){return Wt(t,e,i)})}).then(function(c){var i=c.numFailures,a=c.lastResult,c=c.failures;if(i===0)return a;throw new ot("".concat(t.name,".bulkDelete(): ").concat(i," of ").concat(n," operations failed"),c)})},te);function te(){}function kt(e){function t(c,l){if(l){for(var p=arguments.length,m=new Array(p-1);--p;)m[p-1]=arguments[p];return n[c].subscribe.apply(null,m),e}if(typeof c=="string")return n[c]}var n={};t.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return t;function a(c,l,p){if(typeof c!="object"){var m;l=l||Yi;var w={subscribers:[],fire:p=p||J,subscribe:function(h){w.subscribers.indexOf(h)===-1&&(w.subscribers.push(h),w.fire=l(w.fire,h))},unsubscribe:function(h){w.subscribers=w.subscribers.filter(function(E){return E!==h}),w.fire=w.subscribers.reduce(l,p)}};return n[c]=t[c]=w}f(m=c).forEach(function(h){var E=m[h];if(g(E))a(h,m[h][0],m[h][1]);else{if(E!=="asap")throw new U.InvalidArgument("Invalid event config");var y=a(h,vt,function(){for(var v=arguments.length,b=new Array(v);v--;)b[v]=arguments[v];y.subscribers.forEach(function(_){ne(function(){_.apply(null,b)})})})}})}}function At(e,t){return $(t).from({prototype:e}),t}function lt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Nn(e,t){e.filter=Xe(e.filter,t)}function qn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Xe(r(),t())}:t,e.justLimit=n&&!r}function Yt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new U.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Wr(e,t,n){var r=Yt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function Ht(e,t,n,r){var i=e.replayFilter?Xe(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},c=function(l,p,m){var w,h;i&&!i(p,m,function(E){return p.stop(E)},function(E){return p.fail(E)})||((h=""+(w=p.primaryKey))=="[object ArrayBuffer]"&&(h=""+new Uint8Array(w)),P(a,h)||(a[h]=!0,t(l,p,m)))};return Promise.all([e.or._iterate(c,n),Yr(Wr(e,r,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return Yr(Wr(e,r,n),Xe(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Yr(e,t,n,r){var i=ae(r?function(a,c,l){return n(r(a),c,l)}:n);return e.then(function(a){if(a)return a.start(function(){var c=function(){return a.continue()};t&&!t(a,function(l){return c=l},function(l){a.stop(l),c=J},function(l){a.fail(l),c=J})||i(a.value,a,function(l){return c=l}),c()})})}var Ji=(X.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ue.bind(null,n.error)):n.table._trans("readonly",e).then(t)},X.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,ue.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},X.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Xe(t.algorithm,e)},X.prototype._iterate=function(e,t){return Ht(this._ctx,e,t,this._ctx.table.core)},X.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&k(n,e),t._ctx=n,t},X.prototype.raw=function(){return this._ctx.valueMapper=null,this},X.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Ht(t,e,n,t.table.core)})},X.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,i=r.table.core;if(lt(r,!0))return i.count({trans:n,query:{index:Yt(r,i.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var a=0;return Ht(r,function(){return++a,!1},n,i).then(function(){return a})}).then(e)},X.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function a(p,m){return m?a(p[n[m]],m-1):p[r]}var c=this._ctx.dir==="next"?1:-1;function l(p,m){return G(a(p,i),a(m,i))*c}return this.toArray(function(p){return p.sort(l)}).then(t)},X.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&lt(r,!0)&&0<r.limit){var i=r.valueMapper,a=Yt(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:a,range:r.range}}).then(function(l){return l=l.result,i?l.map(i):l})}var c=[];return Ht(r,function(l){return c.push(l)},n,r.table.core).then(function(){return c})},e)},X.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,lt(t)?qn(t,function(){var n=e;return function(r,i){return n===0||(n===1?--n:i(function(){r.advance(n),n=0}),!1)}}):qn(t,function(){var n=e;return function(){return--n<0}})),this},X.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),qn(this._ctx,function(){var t=e;return function(n,r,i){return--t<=0&&r(i),0<=t}},!0),this},X.prototype.until=function(e,t){return Nn(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},X.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},X.prototype.last=function(e){return this.reverse().first(e)},X.prototype.filter=function(e){var t;return Nn(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=Xe(t.isMatch,e),this},X.prototype.and=function(e){return this.filter(e)},X.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},X.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},X.prototype.desc=function(){return this.reverse()},X.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},X.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},X.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},X.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.key)}).then(function(){return n}).then(e)},X.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&lt(t,!0)&&0<t.limit)return this._read(function(r){var i=Yt(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:i,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.primaryKey)}).then(function(){return n}).then(e)},X.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},X.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},X.prototype.lastKey=function(e){return this.reverse().firstKey(e)},X.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Nn(this._ctx,function(i){var r=i.primaryKey.toString(),i=P(t,r);return t[r]=!0,!i}),this},X.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var i=typeof e=="function"?e:function(b){return $r(b,e)},a=n.table.core,m=a.schema.primaryKey,c=m.outbound,l=m.extractKey,p=200,m=t.db._options.modifyChunkSize;m&&(p=typeof m=="object"?m[a.name]||m["*"]||200:m);function w(b,A){var x=A.failures,A=A.numFailures;E+=b-A;for(var S=0,T=f(x);S<T.length;S++){var C=T[S];h.push(x[C])}}var h=[],E=0,y=[],v=e===Hr;return t.clone().primaryKeys().then(function(b){function _(A){var S=Math.min(p,b.length-A),T=b.slice(A,A+S);return(v?Promise.resolve([]):a.getMany({trans:r,keys:T,cache:"immutable"})).then(function(C){var M=[],I=[],K=c?[]:null,j=v?T:[];if(!v)for(var R=0;R<S;++R){var q=C[R],W={value:Fe(q),primKey:b[A+R]};i.call(W,W.value,W)!==!1&&(W.value==null?j.push(b[A+R]):c||G(l(q),l(W.value))===0?(I.push(W.value),c&&K.push(b[A+R])):(j.push(b[A+R]),M.push(W.value)))}return Promise.resolve(0<M.length&&a.mutate({trans:r,type:"add",values:M}).then(function(Y){for(var H in Y.failures)j.splice(parseInt(H),1);w(M.length,Y)})).then(function(){return(0<I.length||x&&typeof e=="object")&&a.mutate({trans:r,type:"put",keys:K,values:I,criteria:x,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<A}).then(function(Y){return w(I.length,Y)})}).then(function(){return(0<j.length||x&&v)&&a.mutate({trans:r,type:"delete",keys:j,criteria:x,isAdditionalChunk:0<A}).then(function(Y){return Wt(n.table,j,Y)}).then(function(Y){return w(j.length,Y)})}).then(function(){return b.length>A+S&&_(A+p)})})}var x=lt(n)&&n.limit===1/0&&(typeof e!="function"||v)&&{index:n.index,range:n.range};return _(0).then(function(){if(0<h.length)throw new Kt("Error modifying one or more objects",h,E,y);return b.length})})})},X.prototype.delete=function(){var e=this._ctx,t=e.range;return!lt(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Hr):this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(a){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(p){var l=p.failures,p=p.numFailures;if(p)throw new Kt("Could not delete some values",Object.keys(l).map(function(m){return l[m]}),a-p);return a-p})})})},X);function X(){}var Hr=function(e,t){return t.value=null};function eo(e,t){return e<t?-1:e===t?0:1}function to(e,t){return t<e?-1:e===t?0:1}function _e(e,t,n){return e=e instanceof Xr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function ft(e){return new e.Collection(e,function(){return Gr("")}).limit(0)}function Gt(e,t,n,r){var i,a,c,l,p,m,w,h=n.length;if(!n.every(function(v){return typeof v=="string"}))return _e(e,Br);function E(v){i=v==="next"?function(_){return _.toUpperCase()}:function(_){return _.toLowerCase()},a=v==="next"?function(_){return _.toLowerCase()}:function(_){return _.toUpperCase()},c=v==="next"?eo:to;var b=n.map(function(_){return{lower:a(_),upper:i(_)}}).sort(function(_,x){return c(_.lower,x.lower)});l=b.map(function(_){return _.upper}),p=b.map(function(_){return _.lower}),w=(m=v)==="next"?"":r}E("next"),e=new e.Collection(e,function(){return je(l[0],p[h-1]+r)}),e._ondirectionchange=function(v){E(v)};var y=0;return e._addAlgorithm(function(v,b,_){var x=v.key;if(typeof x!="string")return!1;var A=a(x);if(t(A,p,y))return!0;for(var S=null,T=y;T<h;++T){var C=(function(M,I,K,j,R,q){for(var W=Math.min(M.length,j.length),Y=-1,H=0;H<W;++H){var Ee=I[H];if(Ee!==j[H])return R(M[H],K[H])<0?M.substr(0,H)+K[H]+K.substr(H+1):R(M[H],j[H])<0?M.substr(0,H)+j[H]+K.substr(H+1):0<=Y?M.substr(0,Y)+I[Y]+K.substr(Y+1):null;R(M[H],Ee)<0&&(Y=H)}return W<j.length&&q==="next"?M+K.substr(M.length):W<M.length&&q==="prev"?M.substr(0,K.length):Y<0?null:M.substr(0,Y)+j[Y]+K.substr(Y+1)})(x,A,l[T],p[T],c,m);C===null&&S===null?y=T+1:(S===null||0<c(S,C))&&(S=C)}return b(S!==null?function(){v.continue(S+w)}:_),!1}),e}function je(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Gr(e){return{type:1,lower:e,upper:e}}var Xr=(Object.defineProperty(de.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),de.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?ft(this):new this.Collection(this,function(){return je(e,t,!n,!r)})}catch{return _e(this,Pe)}},de.prototype.equals=function(e){return e==null?_e(this,Pe):new this.Collection(this,function(){return Gr(e)})},de.prototype.above=function(e){return e==null?_e(this,Pe):new this.Collection(this,function(){return je(e,void 0,!0)})},de.prototype.aboveOrEqual=function(e){return e==null?_e(this,Pe):new this.Collection(this,function(){return je(e,void 0,!1)})},de.prototype.below=function(e){return e==null?_e(this,Pe):new this.Collection(this,function(){return je(void 0,e,!1,!0)})},de.prototype.belowOrEqual=function(e){return e==null?_e(this,Pe):new this.Collection(this,function(){return je(void 0,e)})},de.prototype.startsWith=function(e){return typeof e!="string"?_e(this,Br):this.between(e,e+Ge,!0,!0)},de.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Gt(this,function(t,n){return t.indexOf(n[0])===0},[e],Ge)},de.prototype.equalsIgnoreCase=function(e){return Gt(this,function(t,n){return t===n[0]},[e],"")},de.prototype.anyOfIgnoreCase=function(){var e=Te.apply(rt,arguments);return e.length===0?ft(this):Gt(this,function(t,n){return n.indexOf(t)!==-1},e,"")},de.prototype.startsWithAnyOfIgnoreCase=function(){var e=Te.apply(rt,arguments);return e.length===0?ft(this):Gt(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,Ge)},de.prototype.anyOf=function(){var e=this,t=Te.apply(rt,arguments),n=this._cmp;try{t.sort(n)}catch{return _e(this,Pe)}if(t.length===0)return ft(this);var r=new this.Collection(this,function(){return je(t[0],t[t.length-1])});r._ondirectionchange=function(a){n=a==="next"?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(a,c,l){for(var p=a.key;0<n(p,t[i]);)if(++i===t.length)return c(l),!1;return n(p,t[i])===0||(c(function(){a.continue(t[i])}),!1)}),r},de.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},de.prototype.noneOf=function(){var e=Te.apply(rt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return _e(this,Pe)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},de.prototype.inAnyRange=function(x,t){var n=this,r=this._cmp,i=this._ascending,a=this._descending,c=this._min,l=this._max;if(x.length===0)return ft(this);if(!x.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&i(A[0],A[1])<=0}))return _e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",U.InvalidArgument);var p=!t||t.includeLowers!==!1,m=t&&t.includeUppers===!0,w,h=i;function E(A,S){return h(A[0],S[0])}try{(w=x.reduce(function(A,S){for(var T=0,C=A.length;T<C;++T){var M=A[T];if(r(S[0],M[1])<0&&0<r(S[1],M[0])){M[0]=c(M[0],S[0]),M[1]=l(M[1],S[1]);break}}return T===C&&A.push(S),A},[])).sort(E)}catch{return _e(this,Pe)}var y=0,v=m?function(A){return 0<i(A,w[y][1])}:function(A){return 0<=i(A,w[y][1])},b=p?function(A){return 0<a(A,w[y][0])}:function(A){return 0<=a(A,w[y][0])},_=v,x=new this.Collection(this,function(){return je(w[0][0],w[w.length-1][1],!p,!m)});return x._ondirectionchange=function(A){h=A==="next"?(_=v,i):(_=b,a),w.sort(E)},x._addAlgorithm(function(A,S,T){for(var C,M=A.key;_(M);)if(++y===w.length)return S(T),!1;return!v(C=M)&&!b(C)||(n._cmp(M,w[y][1])===0||n._cmp(M,w[y][0])===0||S(function(){h===i?A.continue(w[y][0]):A.continue(w[y][1])}),!1)}),x},de.prototype.startsWithAnyOf=function(){var e=Te.apply(rt,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?ft(this):this.inAnyRange(e.map(function(t){return[t,t+Ge]})):_e(this,"startsWithAnyOf() only works with strings")},de);function de(){}function Se(e){return ae(function(t){return St(t),e(t.target.error),!1})}function St(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ot="storagemutated",Fn="x-storagemutated-1",Be=kt(null,Ot),no=(Oe.prototype._lock=function(){return oe(!V.global),++this._reculock,this._reculock!==1||V.global||(V.lockOwnerFor=this),this},Oe.prototype._unlock=function(){if(oe(!V.global),--this._reculock==0)for(V.global||(V.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{He(e[1],e[0])}catch{}}return this},Oe.prototype._locked=function(){return this._reculock&&V.lockOwnerFor!==this},Oe.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(oe(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new U.DatabaseClosed(r);case"MissingAPIError":throw new U.MissingAPI(r.message,r);default:throw new U.OpenFailed(r)}if(!this.active)throw new U.TransactionInactive;return oe(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ae(function(i){St(i),t._reject(e.error)}),e.onabort=ae(function(i){St(i),t.active&&t._reject(new U.Abort(e.error)),t.active=!1,t.on("abort").fire(i)}),e.oncomplete=ae(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Be.storagemutated.fire(e.mutatedParts)}),this},Oe.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return ue(new U.ReadOnly("Transaction is readonly"));if(!this.active)return ue(new U.TransactionInactive);if(this._locked())return new B(function(a,c){r._blockedFuncs.push([function(){r._promise(e,t,n).then(a,c)},V])});if(n)return Ke(function(){var a=new B(function(c,l){r._lock();var p=t(c,l,r);p&&p.then&&p.then(c,l)});return a.finally(function(){return r._unlock()}),a._lib=!0,a});var i=new B(function(a,c){var l=t(a,c,r);l&&l.then&&l.then(a,c)});return i._lib=!0,i},Oe.prototype._root=function(){return this.parent?this.parent._root():this},Oe.prototype.waitFor=function(e){var t,n=this._root(),r=B.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=a)})());var i=n._waitingFor;return new B(function(a,c){r.then(function(l){return n._waitingQueue.push(ae(a.bind(null,l)))},function(l){return n._waitingQueue.push(ae(c.bind(null,l)))}).finally(function(){n._waitingFor===i&&(n._waitingFor=null)})})},Oe.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new U.Abort))},Oe.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(P(t,e))return t[e];var n=this.schema[e];if(!n)throw new U.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},Oe);function Oe(){}function Vn(e,t,n,r,i,a,c,l){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!c?"&":"")+(r?"*":"")+(i?"++":"")+Qr(t),type:l}}function Qr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Un(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(i){return[i.name,i]},n.reduce(function(i,a,c){return c=r(a,c),c&&(i[c[0]]=c[1]),i},{}))};var r}var Tt=function(e){try{return e.only([[]]),Tt=function(){return[[]]},[[]]}catch{return Tt=function(){return Ge},Ge}};function $n(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return le(n,t)}:function(n){return le(n,e)};var t}function Zr(e){return[].slice.call(e)}var ro=0;function Pt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function io(e,t,p){function r(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=_.lower,v=_.upper,b=_.lowerOpen,_=_.upperOpen;return y===void 0?v===void 0?null:t.upperBound(v,!!_):v===void 0?t.lowerBound(y,!!b):t.bound(y,v,!!b,!!_)}function i(E){var y,v=E.name;return{name:v,schema:E,mutate:function(b){var _=b.trans,x=b.type,A=b.keys,S=b.values,T=b.range;return new Promise(function(C,M){C=ae(C);var I=_.objectStore(v),K=I.keyPath==null,j=x==="put"||x==="add";if(!j&&x!=="delete"&&x!=="deleteRange")throw new Error("Invalid operation type: "+x);var R,q=(A||S||{length:1}).length;if(A&&S&&A.length!==S.length)throw new Error("Given keys array must have same length as given values array.");if(q===0)return C({numFailures:0,failures:{},results:[],lastResult:void 0});function W(ve){++Ee,St(ve)}var Y=[],H=[],Ee=0;if(x==="deleteRange"){if(T.type===4)return C({numFailures:Ee,failures:H,results:[],lastResult:void 0});T.type===3?Y.push(R=I.clear()):Y.push(R=I.delete(r(T)))}else{var K=j?K?[S,A]:[S,null]:[A,null],z=K[0],ge=K[1];if(j)for(var me=0;me<q;++me)Y.push(R=ge&&ge[me]!==void 0?I[x](z[me],ge[me]):I[x](z[me])),R.onerror=W;else for(me=0;me<q;++me)Y.push(R=I[x](z[me])),R.onerror=W}function un(ve){ve=ve.target.result,Y.forEach(function(Je,ur){return Je.error!=null&&(H[ur]=Je.error)}),C({numFailures:Ee,failures:H,results:x==="delete"?A:Y.map(function(Je){return Je.result}),lastResult:ve})}R.onerror=function(ve){W(ve),un(ve)},R.onsuccess=un})},getMany:function(b){var _=b.trans,x=b.keys;return new Promise(function(A,S){A=ae(A);for(var T,C=_.objectStore(v),M=x.length,I=new Array(M),K=0,j=0,R=function(Y){Y=Y.target,I[Y._pos]=Y.result,++j===K&&A(I)},q=Se(S),W=0;W<M;++W)x[W]!=null&&((T=C.get(x[W]))._pos=W,T.onsuccess=R,T.onerror=q,++K);K===0&&A(I)})},get:function(b){var _=b.trans,x=b.key;return new Promise(function(A,S){A=ae(A);var T=_.objectStore(v).get(x);T.onsuccess=function(C){return A(C.target.result)},T.onerror=Se(S)})},query:(y=m,function(b){return new Promise(function(_,x){_=ae(_);var A,S,T,K=b.trans,C=b.values,M=b.limit,R=b.query,I=M===1/0?void 0:M,j=R.index,R=R.range,K=K.objectStore(v),j=j.isPrimaryKey?K:K.index(j.name),R=r(R);if(M===0)return _({result:[]});y?((I=C?j.getAll(R,I):j.getAllKeys(R,I)).onsuccess=function(q){return _({result:q.target.result})},I.onerror=Se(x)):(A=0,S=!C&&"openKeyCursor"in j?j.openKeyCursor(R):j.openCursor(R),T=[],S.onsuccess=function(q){var W=S.result;return W?(T.push(C?W.value:W.primaryKey),++A===M?_({result:T}):void W.continue()):_({result:T})},S.onerror=Se(x))})}),openCursor:function(b){var _=b.trans,x=b.values,A=b.query,S=b.reverse,T=b.unique;return new Promise(function(C,M){C=ae(C);var j=A.index,I=A.range,K=_.objectStore(v),K=j.isPrimaryKey?K:K.index(j.name),j=S?T?"prevunique":"prev":T?"nextunique":"next",R=!x&&"openKeyCursor"in K?K.openKeyCursor(r(I),j):K.openCursor(r(I),j);R.onerror=Se(M),R.onsuccess=ae(function(q){var W,Y,H,Ee,z=R.result;z?(z.___id=++ro,z.done=!1,W=z.continue.bind(z),Y=(Y=z.continuePrimaryKey)&&Y.bind(z),H=z.advance.bind(z),Ee=function(){throw new Error("Cursor not stopped")},z.trans=_,z.stop=z.continue=z.continuePrimaryKey=z.advance=function(){throw new Error("Cursor not started")},z.fail=ae(M),z.next=function(){var ge=this,me=1;return this.start(function(){return me--?ge.continue():ge.stop()}).then(function(){return ge})},z.start=function(ge){function me(){if(R.result)try{ge()}catch(ve){z.fail(ve)}else z.done=!0,z.start=function(){throw new Error("Cursor behind last entry")},z.stop()}var un=new Promise(function(ve,Je){ve=ae(ve),R.onerror=Se(Je),z.fail=Je,z.stop=function(ur){z.stop=z.continue=z.continuePrimaryKey=z.advance=Ee,ve(ur)}});return R.onsuccess=ae(function(ve){R.onsuccess=me,me()}),z.continue=W,z.continuePrimaryKey=Y,z.advance=H,me(),un},C(z)):C(null)},M)})},count:function(b){var _=b.query,x=b.trans,A=_.index,S=_.range;return new Promise(function(T,C){var M=x.objectStore(v),I=A.isPrimaryKey?M:M.index(A.name),M=r(S),I=M?I.count(M):I.count();I.onsuccess=ae(function(K){return T(K.target.result)}),I.onerror=Se(C)})}}}var a,c,l,w=(c=p,l=Zr((a=e).objectStoreNames),{schema:{name:a.name,tables:l.map(function(E){return c.objectStore(E)}).map(function(E){var y=E.keyPath,_=E.autoIncrement,v=g(y),b={},_={name:E.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:v,keyPath:y,autoIncrement:_,unique:!0,extractKey:$n(y)},indexes:Zr(E.indexNames).map(function(x){return E.index(x)}).map(function(T){var A=T.name,S=T.unique,C=T.multiEntry,T=T.keyPath,C={name:A,compound:g(T),keyPath:T,unique:S,multiEntry:C,extractKey:$n(T)};return b[Pt(T)]=C}),getIndexByKeyPath:function(x){return b[Pt(x)]}};return b[":id"]=_.primaryKey,y!=null&&(b[Pt(y)]=_.primaryKey),_})},hasGetAll:0<l.length&&"getAll"in c.objectStore(l[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\\/|Edge\\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1]<604)}),p=w.schema,m=w.hasGetAll,w=p.tables.map(i),h={};return w.forEach(function(E){return h[E.name]=E}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(E){if(!h[E])throw new Error("Table \'".concat(E,"\' not found"));return h[E]},MIN_KEY:-1/0,MAX_KEY:Tt(t),schema:p}}function oo(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=io(t,i,r),e.dbcore.reduce(function(a,c){return c=c.create,o(o({},a),c(a))},r))}}function Xt(e,r){var n=r.db,r=oo(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(c){return c.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function Qt(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(c){var l=(function p(m,w){return Z(m,w)||(m=O(m))&&p(m,w)})(c,i);(!l||"value"in l&&l.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?F(c,i,{get:function(){return this.table(i)},set:function(p){N(this,i,{value:p,writable:!0,configurable:!0,enumerable:!0})}}):c[i]=new e.Table(i,a))})})}function zn(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function ao(e,t){return e._cfg.version-t._cfg.version}function so(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=Un("$meta",ei("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var c=a._reject.bind(a),l=V.transless||V;Ke(function(){return V.trans=a,V.transless=l,t!==0?(Xt(e,n),m=t,((p=a).storeNames.includes("$meta")?p.table("$meta").get("version").then(function(w){return w??m}):B.resolve(m)).then(function(w){return E=w,y=a,v=n,b=[],w=(h=e)._versions,_=h._dbSchema=Jt(0,h.idbdb,v),(w=w.filter(function(x){return x._cfg.version>=E})).length!==0?(w.forEach(function(x){b.push(function(){var A=_,S=x._cfg.dbschema;en(h,A,v),en(h,S,v),_=h._dbSchema=S;var T=Wn(A,S);T.add.forEach(function(j){Yn(v,j[0],j[1].primKey,j[1].indexes)}),T.change.forEach(function(j){if(j.recreate)throw new U.Upgrade("Not yet support for changing primary key");var R=v.objectStore(j.name);j.add.forEach(function(q){return Zt(R,q)}),j.change.forEach(function(q){R.deleteIndex(q.name),Zt(R,q)}),j.del.forEach(function(q){return R.deleteIndex(q)})});var C=x._cfg.contentUpgrade;if(C&&x._cfg.version>E){Xt(h,v),y._memoizedTables={};var M=Ce(S);T.del.forEach(function(j){M[j]=A[j]}),zn(h,[h.Transaction.prototype]),Qt(h,[h.Transaction.prototype],f(M),M),y.schema=M;var I,K=Sn(C);return K&&ut(),T=B.follow(function(){var j;(I=C(y))&&K&&(j=Re.bind(null,null),I.then(j,j))}),I&&typeof I.then=="function"?B.resolve(I):T.then(function(){return I})}}),b.push(function(A){var S,T,C=x._cfg.dbschema;S=C,T=A,[].slice.call(T.db.objectStoreNames).forEach(function(M){return S[M]==null&&T.db.deleteObjectStore(M)}),zn(h,[h.Transaction.prototype]),Qt(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),y.schema=h._dbSchema}),b.push(function(A){h.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(h.idbdb.version/10)===x._cfg.version?(h.idbdb.deleteObjectStore("$meta"),delete h._dbSchema.$meta,h._storeNames=h._storeNames.filter(function(S){return S!=="$meta"})):A.objectStore("$meta").put(x._cfg.version,"version"))})}),(function x(){return b.length?B.resolve(b.shift()(y.idbtrans)).then(x):B.resolve()})().then(function(){Jr(_,v)})):B.resolve();var h,E,y,v,b,_}).catch(c)):(f(i).forEach(function(w){Yn(n,w,i[w].primKey,i[w].indexes)}),Xt(e,n),void B.follow(function(){return e.on.populate.fire(a)}).catch(c));var p,m})}function uo(e,t){Jr(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Jt(0,e.idbdb,t);en(e,e._dbSchema,t);for(var r=0,i=Wn(n,e._dbSchema).change;r<i.length;r++){var a=(function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var l=t.objectStore(c.name);c.add.forEach(function(p){Ae&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(p.src)),Zt(l,p)})})(i[r]);if(typeof a=="object")return a.value}}function Wn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],a=t[n];if(i){var c={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)c.recreate=!0,r.change.push(c);else{var l=i.idxByName,p=a.idxByName,m=void 0;for(m in l)p[m]||c.del.push(m);for(m in p){var w=l[m],h=p[m];w?w.src!==h.src&&c.change.push(h):c.add.push(h)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([n,a])}return r}function Yn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return Zt(i,a)}),i}function Jr(e,t){f(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Ae&&console.debug("Dexie: Creating missing table",n),Yn(t,n,e[n].primKey,e[n].indexes))})}function Zt(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Jt(e,t,n){var r={};return ee(t.objectStoreNames,0).forEach(function(i){for(var a=n.objectStore(i),c=Vn(Qr(m=a.keyPath),m||"",!0,!1,!!a.autoIncrement,m&&typeof m!="string",!0),l=[],p=0;p<a.indexNames.length;++p){var w=a.index(a.indexNames[p]),m=w.keyPath,w=Vn(w.name,m,!!w.unique,!!w.multiEntry,!1,m&&typeof m!="string",!1);l.push(w)}r[i]=Un(i,c,l)}),r}function en(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],c=n.objectStore(a);e._hasGetAll="getAll"in c;for(var l=0;l<c.indexNames.length;++l){var p=c.indexNames[l],m=c.index(p).keyPath,w=typeof m=="string"?m:"["+ee(m).join("+")+"]";!t[a]||(m=t[a].idxByName[w])&&(m.name=p,delete t[a].idxByName[w],t[a].idxByName[p]=m)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\\/|Edge\\/)/.test(navigator.userAgent)&&d.WorkerGlobalScope&&d instanceof d.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1]<604&&(e._hasGetAll=!1)}function ei(e){return e.split(",").map(function(t,n){var a=t.split(":"),r=(i=a[1])===null||i===void 0?void 0:i.trim(),i=(t=a[0].trim()).replace(/([&*]|\\+\\+)/g,""),a=/^\\[/.test(i)?i.match(/^\\[(.*)\\]$/)[1].split("+"):i;return Vn(i,a||null,/\\&/.test(t),/\\*/.test(t),/\\+\\+/.test(t),g(a),n===0,r)})}var co=(ht.prototype._createTableSchema=Un,ht.prototype._parseIndexSyntax=ei,ht.prototype._parseStoresSpec=function(e,t){var n=this;f(e).forEach(function(r){if(e[r]!==null){var i=n._parseIndexSyntax(e[r]),a=i.shift();if(!a)throw new U.Schema("Invalid schema for table "+r+": "+e[r]);if(a.unique=!0,a.multi)throw new U.Schema("Primary key cannot be multiEntry*");i.forEach(function(c){if(c.auto)throw new U.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new U.Schema("Index must have a name and cannot be an empty string")}),i=n._createTableSchema(r,a,i),t[r]=i}})},ht.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?k(this._cfg.storesSource,n):n;var n=t._versions,r={},i={};return n.forEach(function(a){k(r,a._cfg.storesSource),i=a._cfg.dbschema={},a._parseStoresSpec(r,i)}),t._dbSchema=i,zn(t,[t._allTables,t,t.Transaction.prototype]),Qt(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],f(i),i),t._storeNames=f(i),this},ht.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Tn(this._cfg.contentUpgrade||J,e),this},ht);function ht(){}function Hn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new De($t,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Gn(e){return e&&typeof e.databases=="function"}function Xn(e){return Ke(function(){return V.letThrough=!0,e()})}function Qn(e){return!("from"in e)}var pe=function(e,t){if(!this){var n=new pe;return e&&"d"in e&&k(n,e),n}k(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Dt(e,t,n){var r=G(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(Qn(e))return k(e,{from:t,to:n,d:1});var i=e.l,r=e.r;if(G(n,e.from)<0)return i?Dt(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},ni(e);if(0<G(t,e.to))return r?Dt(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},ni(e);G(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<G(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,i&&!e.l&&It(e,i),r&&n&&It(e,r)}}function It(e,t){Qn(t)||(function n(r,p){var a=p.from,c=p.to,l=p.l,p=p.r;Dt(r,a,c),l&&n(r,l),p&&n(r,p)})(e,t)}function ti(e,t){var n=tn(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=tn(e),c=a.next(i.from),l=c.value;!r.done&&!c.done;){if(G(l.from,i.to)<=0&&0<=G(l.to,i.from))return!0;G(i.from,l.from)<0?i=(r=n.next(l.from)).value:l=(c=a.next(i.from)).value}return!1}function tn(e){var t=Qn(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&G(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||G(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function ni(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=1<r?"r":r<-1?"l":"";i&&(t=i=="r"?"l":"r",n=o({},e),r=e[i],e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],(e[t]=n).d=ri(n)),e.d=ri(e)}function ri(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function nn(e,t){return f(t).forEach(function(n){e[n]?It(e[n],t[n]):e[n]=(function r(i){var a,c,l={};for(a in i)P(i,a)&&(c=i[a],l[a]=!c||typeof c!="object"||Pr.has(c.constructor)?c:r(c));return l})(t[n])}),e}function Zn(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&ti(t[n],e[n])})}L(pe.prototype,((xe={add:function(e){return It(this,e),this},addKey:function(e){return Dt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Dt(t,n,n)}),this},hasKey:function(e){var t=tn(this).next(e).value;return t&&G(t.from,e)<=0&&0<=G(t.to,e)}})[An]=function(){return tn(this)},xe));var Qe={},Jn={},er=!1;function rn(e){nn(Jn,e),er||(er=!0,setTimeout(function(){er=!1,tr(Jn,!(Jn={}))},0))}function tr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(Qe);r<i.length;r++)ii(c=i[r],e,n,t);else for(var a in e){var c,l=/^idb\\:\\/\\/(.*)\\/(.*)\\//.exec(a);l&&(a=l[1],l=l[2],(c=Qe["idb://".concat(a,"/").concat(l)])&&ii(c,e,n,t))}n.forEach(function(p){return p()})}function ii(e,t,n,r){for(var i=[],a=0,c=Object.entries(e.queries.query);a<c.length;a++){for(var l=c[a],p=l[0],m=[],w=0,h=l[1];w<h.length;w++){var E=h[w];Zn(t,E.obsSet)?E.subscribers.forEach(function(_){return n.add(_)}):r&&m.push(E)}r&&i.push([p,m])}if(r)for(var y=0,v=i;y<v.length;y++){var b=v[y],p=b[0],m=b[1];e.queries.query[p]=m}}function lo(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ue(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),a=!1;function c(){if(t.openCanceller!==r)throw new U.DatabaseClosed("db.open() was cancelled")}function l(){return new B(function(E,y){if(c(),!n)throw new U.MissingAPI;var v=e.name,b=t.autoSchema||!i?n.open(v):n.open(v,i);if(!b)throw new U.MissingAPI;b.onerror=Se(y),b.onblocked=ae(e._fireOnBlocked),b.onupgradeneeded=ae(function(_){var x;w=b.transaction,t.autoSchema&&!e._options.allowEmptyDB?(b.onerror=St,w.abort(),b.result.close(),(x=n.deleteDatabase(v)).onsuccess=x.onerror=ae(function(){y(new U.NoSuchDatabase("Database ".concat(v," doesnt exist")))})):(w.onerror=Se(y),_=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,h=_<1,e.idbdb=b.result,a&&uo(e,w),so(e,_/10,w,y))},y),b.onsuccess=ae(function(){w=null;var _,x,A,S,T,C=e.idbdb=b.result,M=ee(C.objectStoreNames);if(0<M.length)try{var I=C.transaction((S=M).length===1?S[0]:S,"readonly");if(t.autoSchema)x=C,A=I,(_=e).verno=x.version/10,A=_._dbSchema=Jt(0,x,A),_._storeNames=ee(x.objectStoreNames,0),Qt(_,[_._allTables],f(A),A);else if(en(e,e._dbSchema,I),((T=Wn(Jt(0,(T=e).idbdb,I),T._dbSchema)).add.length||T.change.some(function(K){return K.add.length||K.change.length}))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),C.close(),i=C.version+1,a=!0,E(l());Xt(e,I)}catch{}ct.push(e),C.onversionchange=ae(function(K){t.vcFired=!0,e.on("versionchange").fire(K)}),C.onclose=ae(function(){e.close({disableAutoOpen:!1})}),h&&(T=e._deps,I=v,C=T.indexedDB,T=T.IDBKeyRange,Gn(C)||I===$t||Hn(C,T).put({name:I}).catch(J)),E()},y)}).catch(function(E){switch(E?.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l();break;case"VersionError":if(0<i)return i=0,l()}return B.reject(E)})}var p,m=t.dbReadyResolve,w=null,h=!1;return B.race([r,(typeof navigator>"u"?B.resolve():!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(E){function y(){return indexedDB.databases().finally(E)}p=setInterval(y,100),y()}).finally(function(){return clearInterval(p)}):Promise.resolve()).then(l)]).then(function(){return c(),t.onReadyBeingFired=[],B.resolve(Xn(function(){return e.on.ready.fire(e.vip)})).then(function E(){if(0<t.onReadyBeingFired.length){var y=t.onReadyBeingFired.reduce(Tn,J);return t.onReadyBeingFired=[],B.resolve(Xn(function(){return y(e.vip)})).then(E)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(E){t.dbOpenError=E;try{w&&w.abort()}catch{}return r===t.openCanceller&&e._close(),ue(E)}).finally(function(){t.openComplete=!0,m()}).then(function(){var E;return h&&(E={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(v){v.name&&(E["idb://".concat(e.name,"/").concat(y.name,"/").concat(v.name)]=new pe(-1/0,[[[]]]))}),E["idb://".concat(e.name,"/").concat(y.name,"/")]=E["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new pe(-1/0,[[[]]])}),Be(Ot).fire(E),tr(E,!0)),e})}function nr(e){function t(a){return e.next(a)}var n=i(t),r=i(function(a){return e.throw(a)});function i(a){return function(p){var l=a(p),p=l.value;return l.done?p:p&&typeof p.then=="function"?p.then(n,r):g(p)?Promise.all(p).then(n,r):n(p)}}return i(t)()}function on(e,t,n){for(var r=g(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var fo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function c(h,E,y){var v=Pt(h),b=i[v]=i[v]||[],_=h==null?0:typeof h=="string"?1:h.length,x=0<E,x=o(o({},y),{name:x?"".concat(v,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:x,keyTail:E,keyLength:_,extractKey:$n(h),unique:!x&&y.unique});return b.push(x),x.isPrimaryKey||a.push(x),1<_&&c(_===2?h[0]:h.slice(0,_-1),E+1,y),b.sort(function(A,S){return A.keyTail-S.keyTail}),x}t=c(r.primaryKey.keyPath,0,r.primaryKey),i[":id"]=[t];for(var l=0,p=r.indexes;l<p.length;l++){var m=p[l];c(m.keyPath,0,m)}function w(h){var E,y=h.query.index;return y.isVirtual?o(o({},h),{query:{index:y.lowLevelIndex,range:(E=h.query.range,y=y.keyTail,{type:E.type===1?2:E.type,lower:on(E.lower,E.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:on(E.upper,E.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):h}return o(o({},n),{schema:o(o({},r),{primaryKey:t,indexes:a,getIndexByKeyPath:function(h){return(h=i[Pt(h)])&&h[0]}}),count:function(h){return n.count(w(h))},query:function(h){return n.query(w(h))},openCursor:function(h){var E=h.query.index,y=E.keyTail,v=E.isVirtual,b=E.keyLength;return v?n.openCursor(w(h)).then(function(x){return x&&_(x)}):n.openCursor(h);function _(x){return Object.create(x,{continue:{value:function(A){A!=null?x.continue(on(A,h.reverse?e.MAX_KEY:e.MIN_KEY,y)):h.unique?x.continue(x.key.slice(0,b).concat(h.reverse?e.MIN_KEY:e.MAX_KEY,y)):x.continue()}},continuePrimaryKey:{value:function(A,S){x.continuePrimaryKey(on(A,e.MAX_KEY,y),S)}},primaryKey:{get:function(){return x.primaryKey}},key:{get:function(){var A=x.key;return b===1?A[0]:A.slice(0,b)}},value:{get:function(){return x.value}}})}}})}})}};function rr(e,t,n,r){return n=n||{},r=r||"",f(e).forEach(function(i){var a,c,l;P(t,i)?(a=e[i],c=t[i],typeof a=="object"&&typeof c=="object"&&a&&c?(l=kn(a))!==kn(c)?n[r+i]=t[i]:l==="Object"?rr(a,c,n,r+i+"."):a!==c&&(n[r+i]=t[i]):a!==c&&(n[r+i]=t[i])):n[r+i]=void 0}),f(t).forEach(function(i){P(e,i)||(n[r+i]=t[i])}),n}function ir(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var ho={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return o(o({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return o(o({},n),{mutate:function(i){var a=V.trans,c=a.table(t).hook,l=c.deleting,p=c.creating,m=c.updating;switch(i.type){case"add":if(p.fire===J)break;return a._promise("readwrite",function(){return w(i)},!0);case"put":if(p.fire===J&&m.fire===J)break;return a._promise("readwrite",function(){return w(i)},!0);case"delete":if(l.fire===J)break;return a._promise("readwrite",function(){return w(i)},!0);case"deleteRange":if(l.fire===J)break;return a._promise("readwrite",function(){return(function h(E,y,v){return n.query({trans:E,values:!1,query:{index:r,range:y},limit:v}).then(function(b){var _=b.result;return w({type:"delete",keys:_,trans:E}).then(function(x){return 0<x.numFailures?Promise.reject(x.failures[0]):_.length<v?{failures:[],numFailures:0,lastResult:void 0}:h(E,o(o({},y),{lower:_[_.length-1],lowerOpen:!0}),v)})})})(i.trans,i.range,1e4)},!0)}return n.mutate(i);function w(h){var E,y,v,b=V.trans,_=h.keys||ir(r,h);if(!_)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?o(o({},h),{keys:_}):o({},h)).type!=="delete"&&(h.values=u([],h.values,!0)),h.keys&&(h.keys=u([],h.keys,!0)),E=n,v=_,((y=h).type==="add"?Promise.resolve([]):E.getMany({trans:y.trans,keys:v,cache:"immutable"})).then(function(x){var A=_.map(function(S,T){var C,M,I,K=x[T],j={onerror:null,onsuccess:null};return h.type==="delete"?l.fire.call(j,S,K,b):h.type==="add"||K===void 0?(C=p.fire.call(j,S,h.values[T],b),S==null&&C!=null&&(h.keys[T]=S=C,r.outbound||re(h.values[T],r.keyPath,S))):(C=rr(K,h.values[T]),(M=m.fire.call(j,C,S,K,b))&&(I=h.values[T],Object.keys(M).forEach(function(R){P(I,R)?I[R]=M[R]:re(I,R,M[R])}))),j});return n.mutate(h).then(function(S){for(var T=S.failures,C=S.results,M=S.numFailures,S=S.lastResult,I=0;I<_.length;++I){var K=(C||_)[I],j=A[I];K==null?j.onerror&&j.onerror(T[I]):j.onsuccess&&j.onsuccess(h.type==="put"&&x[I]?h.values[I]:K)}return{failures:T,results:C,numFailures:M,lastResult:S}}).catch(function(S){return A.forEach(function(T){return T.onerror&&T.onerror(S)}),Promise.reject(S)})})}}})}})}};function oi(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)G(t.keys[i],e[a])===0&&(r.push(n?Fe(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var po={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return o(o({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=oi(r.keys,r.trans._cache,r.cache==="clone");return i?B.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Fe(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function ai(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function si(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var go={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new pe(e.MIN_KEY,e.MAX_KEY);return o(o({},e),{transaction:function(r,i,a){if(V.subscr&&i!=="readonly")throw new U.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(V.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,c=a.primaryKey,h=a.indexes,l=c.extractKey,p=c.outbound,m=c.autoIncrement&&h.filter(function(y){return y.compound&&y.keyPath.includes(c.keyPath)}),w=o(o({},i),{mutate:function(y){function v(R){return R="idb://".concat(t,"/").concat(r,"/").concat(R),S[R]||(S[R]=new pe)}var b,_,x,A=y.trans,S=y.mutatedParts||(y.mutatedParts={}),T=v(""),C=v(":dels"),M=y.type,j=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[ir(c,y).filter(function(R){return R}),y.values]:[],I=j[0],K=j[1],j=y.trans._cache;return g(I)?(T.addKeys(I),(j=M==="delete"||I.length===K.length?oi(I,j):null)||C.addKeys(I),(j||K)&&(b=v,_=j,x=K,a.indexes.forEach(function(R){var q=b(R.name||"");function W(H){return H!=null?R.extractKey(H):null}function Y(H){return R.multiEntry&&g(H)?H.forEach(function(Ee){return q.addKey(Ee)}):q.addKey(H)}(_||x).forEach(function(H,ge){var z=_&&W(_[ge]),ge=x&&W(x[ge]);G(z,ge)!==0&&(z!=null&&Y(z),ge!=null&&Y(ge))})}))):I?(K={from:(K=I.lower)!==null&&K!==void 0?K:e.MIN_KEY,to:(K=I.upper)!==null&&K!==void 0?K:e.MAX_KEY},C.add(K),T.add(K)):(T.add(n),C.add(n),a.indexes.forEach(function(R){return v(R.name).add(n)})),i.mutate(y).then(function(R){return!I||y.type!=="add"&&y.type!=="put"||(T.addKeys(R.results),m&&m.forEach(function(q){for(var W=y.values.map(function(z){return q.extractKey(z)}),Y=q.keyPath.findIndex(function(z){return z===c.keyPath}),H=0,Ee=R.results.length;H<Ee;++H)W[H][Y]=R.results[H];v(q.name).addKeys(W)})),A.mutatedParts=nn(A.mutatedParts||{},S),R})}}),h=function(v){var b=v.query,v=b.index,b=b.range;return[v,new pe((v=b.lower)!==null&&v!==void 0?v:e.MIN_KEY,(b=b.upper)!==null&&b!==void 0?b:e.MAX_KEY)]},E={get:function(y){return[c,new pe(y.key)]},getMany:function(y){return[c,new pe().addKeys(y.keys)]},count:h,query:h,openCursor:h};return f(E).forEach(function(y){w[y]=function(v){var b=V.subscr,_=!!b,x=ai(V,i)&&si(y,v)?v.obsSet={}:b;if(_){var A=function(K){return K="idb://".concat(t,"/").concat(r,"/").concat(K),x[K]||(x[K]=new pe)},S=A(""),T=A(":dels"),b=E[y](v),_=b[0],b=b[1];if((y==="query"&&_.isPrimaryKey&&!v.values?T:A(_.name||"")).add(b),!_.isPrimaryKey){if(y!=="count"){var C=y==="query"&&p&&v.values&&i.query(o(o({},v),{values:!1}));return i[y].apply(this,arguments).then(function(K){if(y==="query"){if(p&&v.values)return C.then(function(W){return W=W.result,S.addKeys(W),K});var j=v.values?K.result.map(l):K.result;(v.values?S:T).addKeys(j)}else if(y==="openCursor"){var R=K,q=v.values;return R&&Object.create(R,{key:{get:function(){return T.addKey(R.primaryKey),R.key}},primaryKey:{get:function(){var W=R.primaryKey;return T.addKey(W),W}},value:{get:function(){return q&&S.addKey(R.primaryKey),R.value}}})}return K})}T.add(n)}}return i[y].apply(this,arguments)}}),w}})}};function ui(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=o({},t),g(t.keys)&&(t.keys=t.keys.filter(function(i,a){return!(a in n.failures)})),"values"in t&&g(t.values)&&(t.values=t.values.filter(function(i,a){return!(a in n.failures)})),t)}function or(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<G(n,r.lower):0<=G(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?G(e,t.upper)<0:G(e,t.upper)<=0));var n,r}function ci(e,t,E,r,i,a){if(!E||E.length===0)return e;var c=t.query.index,l=c.multiEntry,p=t.query.range,m=r.schema.primaryKey.extractKey,w=c.extractKey,h=(c.lowLevelIndex||c).extractKey,E=E.reduce(function(y,v){var b=y,_=[];if(v.type==="add"||v.type==="put")for(var x=new pe,A=v.values.length-1;0<=A;--A){var S,T=v.values[A],C=m(T);x.hasKey(C)||(S=w(T),(l&&g(S)?S.some(function(R){return or(R,p)}):or(S,p))&&(x.addKey(C),_.push(T)))}switch(v.type){case"add":var M=new pe().addKeys(t.values?y.map(function(q){return m(q)}):y),b=y.concat(t.values?_.filter(function(q){return q=m(q),!M.hasKey(q)&&(M.addKey(q),!0)}):_.map(function(q){return m(q)}).filter(function(q){return!M.hasKey(q)&&(M.addKey(q),!0)}));break;case"put":var I=new pe().addKeys(v.values.map(function(q){return m(q)}));b=y.filter(function(q){return!I.hasKey(t.values?m(q):q)}).concat(t.values?_:_.map(function(q){return m(q)}));break;case"delete":var K=new pe().addKeys(v.keys);b=y.filter(function(q){return!K.hasKey(t.values?m(q):q)});break;case"deleteRange":var j=v.range;b=y.filter(function(q){return!or(m(q),j)})}return b},e);return E===e?e:(E.sort(function(y,v){return G(h(y),h(v))||G(m(y),m(v))}),t.limit&&t.limit<1/0&&(E.length>t.limit?E.length=t.limit:e.length===t.limit&&E.length<t.limit&&(i.dirty=!0)),a?Object.freeze(E):E)}function li(e,t){return G(e.lower,t.lower)===0&&G(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function mo(e,t){return(function(n,r,i,a){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=G(n,r))===0){if(i&&a)return 0;if(i)return 1;if(a)return-1}return r})(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=(function(n,r,i,a){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=G(n,r))===0){if(i&&a)return 0;if(i)return-1;if(a)return 1}return r})(e.upper,t.upper,e.upperOpen,t.upperOpen)}function yo(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var i,a;e.subscribers.delete(n),e.subscribers.size===0&&(i=e,a=t,setTimeout(function(){i.subscribers.size===0&&Ve(a,i)},3e3))})}var vo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return o(o({},e),{transaction:function(n,r,i){var a,c,l=e.transaction(n,r,i);return r==="readwrite"&&(c=(a=new AbortController).signal,i=function(p){return function(){if(a.abort(),r==="readwrite"){for(var m=new Set,w=0,h=n;w<h.length;w++){var E=h[w],y=Qe["idb://".concat(t,"/").concat(E)];if(y){var v=e.table(E),b=y.optimisticOps.filter(function(q){return q.trans===l});if(l._explicit&&p&&l.mutatedParts)for(var _=0,x=Object.values(y.queries.query);_<x.length;_++)for(var A=0,S=(M=x[_]).slice();A<S.length;A++)Zn((I=S[A]).obsSet,l.mutatedParts)&&(Ve(M,I),I.subscribers.forEach(function(q){return m.add(q)}));else if(0<b.length){y.optimisticOps=y.optimisticOps.filter(function(q){return q.trans!==l});for(var T=0,C=Object.values(y.queries.query);T<C.length;T++)for(var M,I,K,j=0,R=(M=C[T]).slice();j<R.length;j++)(I=R[j]).res!=null&&l.mutatedParts&&(p&&!I.dirty?(K=Object.isFrozen(I.res),K=ci(I.res,I.req,b,v,I,K),I.dirty?(Ve(M,I),I.subscribers.forEach(function(q){return m.add(q)})):K!==I.res&&(I.res=K,I.promise=B.resolve({result:K}))):(I.dirty&&Ve(M,I),I.subscribers.forEach(function(q){return m.add(q)})))}}}m.forEach(function(q){return q()})}}},l.addEventListener("abort",i(!1),{signal:c}),l.addEventListener("error",i(!1),{signal:c}),l.addEventListener("complete",i(!0),{signal:c})),l},table:function(n){var r=e.table(n),i=r.schema.primaryKey;return o(o({},r),{mutate:function(a){var c=V.trans;if(i.outbound||c.db._options.cache==="disabled"||c.explicit||c.idbtrans.mode!=="readwrite")return r.mutate(a);var l=Qe["idb://".concat(t,"/").concat(n)];return l?(c=r.mutate(a),a.type!=="add"&&a.type!=="put"||!(50<=a.values.length||ir(i,a).some(function(p){return p==null}))?(l.optimisticOps.push(a),a.mutatedParts&&rn(a.mutatedParts),c.then(function(p){0<p.numFailures&&(Ve(l.optimisticOps,a),(p=ui(0,a,p))&&l.optimisticOps.push(p),a.mutatedParts&&rn(a.mutatedParts))}),c.catch(function(){Ve(l.optimisticOps,a),a.mutatedParts&&rn(a.mutatedParts)})):c.then(function(p){var m=ui(0,o(o({},a),{values:a.values.map(function(w,h){var E;return p.failures[h]?w:(w=(E=i.keyPath)!==null&&E!==void 0&&E.includes(".")?Fe(w):o({},w),re(w,i.keyPath,p.results[h]),w)})}),p);l.optimisticOps.push(m),queueMicrotask(function(){return a.mutatedParts&&rn(a.mutatedParts)})}),c):r.mutate(a)},query:function(a){if(!ai(V,r)||!si("query",a))return r.query(a);var c=((m=V.trans)===null||m===void 0?void 0:m.db._options.cache)==="immutable",h=V,l=h.requery,p=h.signal,m=(function(v,b,_,x){var A=Qe["idb://".concat(v,"/").concat(b)];if(!A)return[];if(!(b=A.queries[_]))return[null,!1,A,null];var S=b[(x.query?x.query.index.name:null)||""];if(!S)return[null,!1,A,null];switch(_){case"query":var T=S.find(function(C){return C.req.limit===x.limit&&C.req.values===x.values&&li(C.req.query.range,x.query.range)});return T?[T,!0,A,S]:[S.find(function(C){return("limit"in C.req?C.req.limit:1/0)>=x.limit&&(!x.values||C.req.values)&&mo(C.req.query.range,x.query.range)}),!1,A,S];case"count":return T=S.find(function(C){return li(C.req.query.range,x.query.range)}),[T,!!T,A,S]}})(t,n,"query",a),w=m[0],h=m[1],E=m[2],y=m[3];return w&&h?w.obsSet=a.obsSet:(h=r.query(a).then(function(v){var b=v.result;if(w&&(w.res=b),c){for(var _=0,x=b.length;_<x;++_)Object.freeze(b[_]);Object.freeze(b)}else v.result=Fe(b);return v}).catch(function(v){return y&&w&&Ve(y,w),Promise.reject(v)}),w={obsSet:a.obsSet,promise:h,subscribers:new Set,type:"query",req:a,dirty:!1},y?y.push(w):(y=[w],(E=E||(Qe["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[a.query.index.name||""]=y)),yo(w,y,l,p),w.promise.then(function(v){return{result:ci(v.result,a,E?.optimisticOps,r,w,c)}})}})}})}};function an(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var De=(ce.prototype.version=function(e){if(isNaN(e)||e<.1)throw new U.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new U.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(ao),n.stores({}),this._state.autoSchema=!1,n)},ce.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||V.letThrough||this._vip)?e():new B(function(n,r){if(t._state.openComplete)return r(new U.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new U.DatabaseClosed);t.open().catch(J)}t._state.dbReadyPromise.then(n,r)}).then(e)},ce.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:i}),e.sort(function(a,c){return a.level-c.level}),this},ce.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(i){return r?i.create!==r:!!n&&i.name!==n})),this},ce.prototype.open=function(){var e=this;return He(Le,function(){return lo(e)})},ce.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=ct.indexOf(this);if(0<=t&&ct.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new B(function(n){e.dbReadyResolve=n}),e.openCanceller=new B(function(n,r){e.cancelOpen=r}))},ce.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new U.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new U.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ce.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new B(function(i,a){function c(){t.close(e);var l=t._deps.indexedDB.deleteDatabase(t.name);l.onsuccess=ae(function(){var p,m,w;p=t._deps,m=t.name,w=p.indexedDB,p=p.IDBKeyRange,Gn(w)||m===$t||Hn(w,p).delete(m).catch(J),i()}),l.onerror=Se(a),l.onblocked=t._fireOnBlocked}if(n)throw new U.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},ce.prototype.backendDB=function(){return this.idbdb},ce.prototype.isOpen=function(){return this.idbdb!==null},ce.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ce.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ce.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ce.prototype,"tables",{get:function(){var e=this;return f(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ce.prototype.transaction=function(){var e=function(t,n,r){var i=arguments.length;if(i<2)throw new U.InvalidArgument("Too few arguments");for(var a=new Array(i-1);--i;)a[i-1]=arguments[i];return r=a.pop(),[t,Tr(a),r]}.apply(this,arguments);return this._transaction.apply(this,e)},ce.prototype._transaction=function(e,t,n){var r=this,i=V.trans;i&&i.db===this&&e.indexOf("!")===-1||(i=null);var a,c,l=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=t.map(function(m){if(m=m instanceof r.Table?m.name:m,typeof m!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return m}),e=="r"||e===jn)a=jn;else{if(e!="rw"&&e!=Bn)throw new U.InvalidArgument("Invalid transaction mode: "+e);a=Bn}if(i){if(i.mode===jn&&a===Bn){if(!l)throw new U.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&c.forEach(function(m){if(i&&i.storeNames.indexOf(m)===-1){if(!l)throw new U.SubTransaction("Table "+m+" not included in parent transaction.");i=null}}),l&&i&&!i.active&&(i=null)}}catch(m){return i?i._promise(null,function(w,h){h(m)}):ue(m)}var p=function m(w,h,E,y,v){return B.resolve().then(function(){var b=V.transless||V,_=w._createTransaction(h,E,w._dbSchema,y);if(_.explicit=!0,b={trans:_,transless:b},y)_.idbtrans=y.idbtrans;else try{_.create(),_.idbtrans._explicit=!0,w._state.PR1398_maxLoop=3}catch(S){return S.name===On.InvalidState&&w.isOpen()&&0<--w._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),w.close({disableAutoOpen:!1}),w.open().then(function(){return m(w,h,E,null,v)})):ue(S)}var x,A=Sn(v);return A&&ut(),b=B.follow(function(){var S;(x=v.call(_,_))&&(A?(S=Re.bind(null,null),x.then(S,S)):typeof x.next=="function"&&typeof x.throw=="function"&&(x=nr(x)))},b),(x&&typeof x.then=="function"?B.resolve(x).then(function(S){return _.active?S:ue(new U.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):b.then(function(){return x})).then(function(S){return y&&_._resolve(),_._completion.then(function(){return S})}).catch(function(S){return _._reject(S),ue(S)})})}.bind(null,this,a,c,i,n);return i?i._promise(a,p,"lock"):V.trans?He(V.transless,function(){return r._whenReady(p)}):this._whenReady(p)},ce.prototype.table=function(e){if(!P(this._allTables,e))throw new U.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ce);function ce(e,t){var n=this;this._middlewares={},this.verno=0;var r=ce.dependencies;this._options=t=o({addons:ce.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var i,a,c,l,p,m={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:J,dbReadyPromise:null,cancelOpen:J,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};m.dbReadyPromise=new B(function(h){m.dbReadyResolve=h}),m.openCanceller=new B(function(h,E){m.cancelOpen=E}),this._state=m,this.name=e,this.on=kt(this,"populate","blocked","versionchange","close",{ready:[Tn,J]}),this.once=function(h,E){var y=function(){for(var v=[],b=0;b<arguments.length;b++)v[b]=arguments[b];n.on(h).unsubscribe(y),E.apply(n,v)};return n.on(h,y)},this.on.ready.subscribe=ie(this.on.ready.subscribe,function(h){return function(E,y){ce.vip(function(){var v,b=n._state;b.openComplete?(b.dbOpenError||B.resolve().then(E),y&&h(E)):b.onReadyBeingFired?(b.onReadyBeingFired.push(E),y&&h(E)):(h(E),v=n,y||h(function _(){v.on.ready.unsubscribe(E),v.on.ready.unsubscribe(_)}))})}}),this.Collection=(i=this,At(Ji.prototype,function(x,_){this.db=i;var y=Nr,v=null;if(_)try{y=_()}catch(A){v=A}var b=x._ctx,_=b.table,x=_.hook.reading.fire;this._ctx={table:_,index:b.index,isPrimKey:!b.index||_.schema.primKey.keyPath&&b.index===_.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:v,or:b.or,valueMapper:x!==vt?x:null}})),this.Table=(a=this,At(zr.prototype,function(h,E,y){this.db=a,this._tx=y,this.name=h,this.schema=E,this.hook=a._allTables[h]?a._allTables[h].hook:kt(null,{creating:[$i,J],reading:[Ui,vt],updating:[Wi,J],deleting:[zi,J]})})),this.Transaction=(c=this,At(no.prototype,function(h,E,y,v,b){var _=this;h!=="readonly"&&E.forEach(function(x){x=(x=y[x])===null||x===void 0?void 0:x.yProps,x&&(E=E.concat(x.map(function(A){return A.updatesTable})))}),this.db=c,this.mode=h,this.storeNames=E,this.schema=y,this.chromeTransactionDurability=v,this.idbtrans=null,this.on=kt(this,"complete","error","abort"),this.parent=b||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(x,A){_._resolve=x,_._reject=A}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(x){var A=_.active;return _.active=!1,_.on.error.fire(x),_.parent?_.parent._reject(x):A&&_.idbtrans&&_.idbtrans.abort(),ue(x)})})),this.Version=(l=this,At(co.prototype,function(h){this.db=l,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(p=this,At(Xr.prototype,function(h,E,y){if(this.db=p,this._ctx={table:h,index:E===":id"?null:E,or:y},this._cmp=this._ascending=G,this._descending=function(v,b){return G(b,v)},this._max=function(v,b){return 0<G(v,b)?v:b},this._min=function(v,b){return G(v,b)<0?v:b},this._IDBKeyRange=p._deps.IDBKeyRange,!this._IDBKeyRange)throw new U.MissingAPI})),this.on("versionchange",function(h){0<h.newVersion?console.warn("Another connection wants to upgrade database \'".concat(n.name,"\'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database \'".concat(n.name,"\'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete(\'".concat(n.name,"\') was blocked")):console.warn("Upgrade \'".concat(n.name,"\' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=Tt(t.IDBKeyRange),this._createTransaction=function(h,E,y,v){return new n.Transaction(h,E,y,n._options.chromeTransactionDurability,v)},this._fireOnBlocked=function(h){n.on("blocked").fire(h),ct.filter(function(E){return E.name===n.name&&E!==n&&!E._state.vcFired}).map(function(E){return E.on("versionchange").fire(h)})},this.use(po),this.use(vo),this.use(go),this.use(fo),this.use(ho);var w=new Proxy(this,{get:function(h,E,y){if(E==="_vip")return!0;if(E==="table")return function(b){return an(n.table(b),w)};var v=Reflect.get(h,E,y);return v instanceof zr?an(v,w):E==="tables"?v.map(function(b){return an(b,w)}):E==="_createTransaction"?function(){return an(v.apply(this,arguments),w)}:v}});this.vip=w,r.forEach(function(h){return h(n)})}var sn,xe=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",bo=(ar.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},ar.prototype[xe]=function(){return this},ar);function ar(e){this._subscribe=e}try{sn={indexedDB:d.indexedDB||d.mozIndexedDB||d.webkitIndexedDB||d.msIndexedDB,IDBKeyRange:d.IDBKeyRange||d.webkitIDBKeyRange}}catch{sn={indexedDB:null,IDBKeyRange:null}}function fi(e){var t,n=!1,r=new bo(function(i){var a=Sn(e),c,l=!1,p={},m={},w={get closed(){return l},unsubscribe:function(){l||(l=!0,c&&c.abort(),h&&Be.storagemutated.unsubscribe(y))}};i.start&&i.start(w);var h=!1,E=function(){return Mn(v)},y=function(b){nn(p,b),Zn(m,p)&&E()},v=function(){var b,_,x;!l&&sn.indexedDB&&(p={},b={},c&&c.abort(),c=new AbortController,x=(function(A){var S=at();try{a&&ut();var T=Ke(e,A);return T=a?T.finally(Re):T}finally{S&&st()}})(_={subscr:b,signal:c.signal,requery:E,querier:e,trans:null}),Promise.resolve(x).then(function(A){n=!0,t=A,l||_.signal.aborted||(p={},(function(S){for(var T in S)if(P(S,T))return;return 1})(m=b)||h||(Be(Ot,y),h=!0),Mn(function(){return!l&&i.next&&i.next(A)}))},function(A){n=!1,["DatabaseClosedError","AbortError"].includes(A?.name)||l||Mn(function(){l||i.error&&i.error(A)})}))};return setTimeout(E,0),w});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var Ze=De;function sr(e){var t=Ne;try{Ne=!0,Be.storagemutated.fire(e),tr(e,!0)}finally{Ne=t}}L(Ze,o(o({},Rt),{delete:function(e){return new Ze(e,{addons:[]}).delete()},exists:function(e){return new Ze(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Ze.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Gn(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==$t})}):Hn(n,t).toCollection().primaryKeys()).then(e)}catch{return ue(new U.MissingAPI)}var t,n},defineClass:function(){return function(e){k(this,e)}},ignoreTransaction:function(e){return V.trans?He(V.transless,e):e()},vip:Xn,async:function(e){return function(){try{var t=nr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:B.resolve(t)}catch(n){return ue(n)}}},spawn:function(e,t,n){try{var r=nr(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:B.resolve(r)}catch(i){return ue(i)}},currentTransaction:{get:function(){return V.trans||null}},waitFor:function(e,t){return t=B.resolve(typeof e=="function"?Ze.ignoreTransaction(e):e).timeout(t||6e4),V.trans?V.trans.waitFor(t):t},Promise:B,debug:{get:function(){return Ae},set:function(e){Cr(e)}},derive:$,extend:k,props:L,override:ie,Events:kt,on:Be,liveQuery:fi,extendObservabilitySet:nn,getByKeyPath:le,setByKeyPath:re,delByKeyPath:function(e,t){typeof t=="string"?re(e,t,void 0):"length"in t&&[].map.call(t,function(n){re(e,n,void 0)})},shallowClone:Ce,deepClone:Fe,getObjectDiff:rr,cmp:G,asap:ne,minKey:-1/0,addons:[],connections:ct,errnames:On,dependencies:sn,cache:Qe,semVer:"4.2.1",version:"4.2.1".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),Ze.maxKey=Tt(Ze.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Be(Ot,function(e){Ne||(e=new CustomEvent(Fn,{detail:e}),Ne=!0,dispatchEvent(e),Ne=!1)}),addEventListener(Fn,function(e){e=e.detail,Ne||sr(e)}));var dt,Ne=!1,hi=function(){};return typeof BroadcastChannel<"u"&&((hi=function(){(dt=new BroadcastChannel(Fn)).onmessage=function(e){return e.data&&sr(e.data)}})(),typeof dt.unref=="function"&&dt.unref(),Be(Ot,function(e){Ne||dt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!De.disableBfCache&&e.persisted){Ae&&console.debug("Dexie: handling persisted pagehide"),dt?.close();for(var t=0,n=ct;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!De.disableBfCache&&e.persisted&&(Ae&&console.debug("Dexie: handling persisted pageshow"),hi(),sr({all:new pe(-1/0,[[]])}))})),B.rejectionMapper=function(e,t){return!e||e instanceof it||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ir[e.name]?e:(t=new Ir[e.name](t||e.message,e),"stack"in e&&F(t,"stack",{get:function(){return this.inner.stack}}),t)},Cr(Ae),o(De,Object.freeze({__proto__:null,Dexie:De,liveQuery:fi,Entity:qr,cmp:G,PropModification:xt,replacePrefix:function(e,t){return new xt({replacePrefix:[e,t]})},add:function(e){return new xt({add:e})},remove:function(e){return new xt({remove:e})},default:De,RangeSet:pe,mergeRanges:It,rangesOverlap:ti}),{default:De}),De})});var gi=Symbol("Comlink.proxy"),To=Symbol("Comlink.endpoint"),Po=Symbol("Comlink.releaseProxy"),cr=Symbol("Comlink.finalizer"),ln=Symbol("Comlink.thrown"),mi=s=>typeof s=="object"&&s!==null||typeof s=="function",Do={canHandle:s=>mi(s)&&s[gi],serialize(s){let{port1:o,port2:u}=new MessageChannel;return pn(s,o),[u,[u]]},deserialize(s){return s.start(),Ko(s)}},Io={canHandle:s=>mi(s)&&ln in s,serialize({value:s}){let o;return s instanceof Error?o={isError:!0,value:{message:s.message,name:s.name,stack:s.stack}}:o={isError:!1,value:s},[o,[]]},deserialize(s){throw s.isError?Object.assign(new Error(s.value.message),s.value):s.value}},yi=new Map([["proxy",Do],["throw",Io]]);function Co(s,o){for(let u of s)if(o===u||u==="*"||u instanceof RegExp&&u.test(o))return!0;return!1}function pn(s,o=globalThis,u=["*"]){o.addEventListener("message",function d(f){if(!f||!f.data)return;if(!Co(u,f.origin)){console.warn(`Invalid origin \'${f.origin}\' for comlink proxy`);return}let{id:g,type:k,path:O}=Object.assign({path:[]},f.data),D=(f.data.argumentList||[]).map(et),P;try{let L=O.slice(0,-1).reduce((F,$)=>F[$],s),N=O.reduce((F,$)=>F[$],s);switch(k){case"GET":P=N;break;case"SET":L[O.slice(-1)[0]]=et(f.data.value),P=!0;break;case"APPLY":P=N.apply(L,D);break;case"CONSTRUCT":{let F=new N(...D);P=Bo(F)}break;case"ENDPOINT":{let{port1:F,port2:$}=new MessageChannel;pn(s,$),P=fr(F,[F])}break;case"RELEASE":P=void 0;break;default:return}}catch(L){P={value:L,[ln]:0}}Promise.resolve(P).catch(L=>({value:L,[ln]:0})).then(L=>{let[N,F]=dn(L);o.postMessage(Object.assign(Object.assign({},N),{id:g}),F),k==="RELEASE"&&(o.removeEventListener("message",d),vi(o),cr in s&&typeof s[cr]=="function"&&s[cr]())}).catch(L=>{let[N,F]=dn({value:new TypeError("Unserializable return value"),[ln]:0});o.postMessage(Object.assign(Object.assign({},N),{id:g}),F)})}),o.start&&o.start()}function Lo(s){return s.constructor.name==="MessagePort"}function vi(s){Lo(s)&&s.close()}function Ko(s,o){let u=new Map;return s.addEventListener("message",function(f){let{data:g}=f;if(!g||!g.id)return;let k=u.get(g.id);if(k)try{k(g)}finally{u.delete(g.id)}}),lr(s,u,[],o)}function cn(s){if(s)throw new Error("Proxy has been released and is not useable")}function bi(s){return pt(s,new Map,{type:"RELEASE"}).then(()=>{vi(s)})}var fn=new WeakMap,hn="FinalizationRegistry"in globalThis&&new FinalizationRegistry(s=>{let o=(fn.get(s)||0)-1;fn.set(s,o),o===0&&bi(s)});function Ro(s,o){let u=(fn.get(o)||0)+1;fn.set(o,u),hn&&hn.register(s,o,s)}function Mo(s){hn&&hn.unregister(s)}function lr(s,o,u=[],d=function(){}){let f=!1,g=new Proxy(d,{get(k,O){if(cn(f),O===Po)return()=>{Mo(g),bi(s),o.clear(),f=!0};if(O==="then"){if(u.length===0)return{then:()=>g};let D=pt(s,o,{type:"GET",path:u.map(P=>P.toString())}).then(et);return D.then.bind(D)}return lr(s,o,[...u,O])},set(k,O,D){cn(f);let[P,L]=dn(D);return pt(s,o,{type:"SET",path:[...u,O].map(N=>N.toString()),value:P},L).then(et)},apply(k,O,D){cn(f);let P=u[u.length-1];if(P===To)return pt(s,o,{type:"ENDPOINT"}).then(et);if(P==="bind")return lr(s,o,u.slice(0,-1));let[L,N]=pi(D);return pt(s,o,{type:"APPLY",path:u.map(F=>F.toString()),argumentList:L},N).then(et)},construct(k,O){cn(f);let[D,P]=pi(O);return pt(s,o,{type:"CONSTRUCT",path:u.map(L=>L.toString()),argumentList:D},P).then(et)}});return Ro(g,s),g}function jo(s){return Array.prototype.concat.apply([],s)}function pi(s){let o=s.map(dn);return[o.map(u=>u[0]),jo(o.map(u=>u[1]))]}var wi=new WeakMap;function fr(s,o){return wi.set(s,o),s}function Bo(s){return Object.assign(s,{[gi]:!0})}function dn(s){for(let[o,u]of yi)if(u.canHandle(s)){let[d,f]=u.serialize(s);return[{type:"HANDLER",name:o,value:d},f]}return[{type:"RAW",value:s},wi.get(s)||[]]}function et(s){switch(s.type){case"HANDLER":return yi.get(s.name).deserialize(s.value);case"RAW":return s.value}}function pt(s,o,u,d){return new Promise(f=>{let g=No();o.set(g,f),s.start&&s.start(),s.postMessage(Object.assign({id:g},u),d)})}function No(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var Q=class s extends Error{constructor(u,d,f){super(u);this.code=d;this.context=f;this.name="WorkerError",Object.setPrototypeOf(this,s.prototype)}};var gn=Oo(_i(),1),Ei=Symbol.for("Dexie"),Ie=globalThis[Ei]||(globalThis[Ei]=gn.default);if(gn.default.semVer!==Ie.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${gn.default.semVer} and ${Ie.semVer}`);var{liveQuery:ma,mergeRanges:ya,rangesOverlap:va,RangeSet:ba,cmp:wa,Entity:_a,PropModification:Ea,replacePrefix:xa,add:ka,remove:Aa,DexieYProvider:Sa}=Ie;var xi="VersionControlTimelineDB";function qe(s){return typeof s=="string"&&s.trim().length>0}function Ai(s){return s instanceof ArrayBuffer}function Si(s){return s==="version"||s==="edit"}function gt(s){return typeof s=="number"&&Number.isFinite(s)&&!Number.isNaN(s)}function fe(s,o){if(!qe(s))throw new Q(`Invalid input: ${o} must be a non-empty string`,"INVALID_INPUT",{field:o,value:s});return s}function mn(s){if(!(typeof s=="string"||Ai(s)))throw new Q("Content must be string or ArrayBuffer","INVALID_INPUT");let o=new TextEncoder,u=typeof s=="string"?o.encode(s).byteLength:s.byteLength;if(u>52428800)throw new Q("Content exceeds maximum allowed size for diffing","CONTENT_TOO_LARGE",{size:u,limit:52428800})}function tt(s){if(!s||typeof s!="object")throw new Q("Invalid event structure","VALIDATION_FAILED");let o=s;if(!qe(o.noteId)||!qe(o.branchName)||!Si(o.source)||!qe(o.toVersionId)||!qe(o.timestamp)||!gt(o.toVersionNumber))throw new Q("Invalid event fields","VALIDATION_FAILED");if(!Array.isArray(o.diffData))throw new Q("diffData must be an Array of Changes","VALIDATION_FAILED")}var yn=class extends Ie{timeline;MAX_RETRIES=3;RETRY_DELAY_BASE=50;MAX_RETRY_DELAY=1e3;constructor(){super(xi),this.version(4).stores({timeline:"++id, [noteId+branchName+source], &[noteId+branchName+source+toVersionId], toVersionId, timestamp"}),this.version(5).stores({timeline:"++id, [noteId+branchName+source], &[noteId+branchName+source+toVersionId], toVersionId, timestamp"}),this.version(6).stores({timeline:"++id, [noteId+branchName+source], &[noteId+branchName+source+toVersionId], toVersionId, timestamp"}).upgrade(o=>(console.log("VC Timeline: Upgrading to v6 - Clearing legacy compressed data"),o.table("timeline").clear())),this.on("populate",()=>{this.timeline.hook("creating",(o,u)=>{tt(u)})}),this.on("blocked",()=>{console.warn("VC Timeline: Database upgrade blocked")}),this.on("versionchange",o=>{console.info(`VC Timeline: Version changed to ${o.newVersion}. Closing.`),this.close()})}async execute(o,u="timeline-op"){if(Ie.currentTransaction)return o();let d=0,f;for(;d<=this.MAX_RETRIES;)try{return this.isOpen()||await this.open(),await o()}catch(g){if(f=g,d++,g.name==="QuotaExceededError"||g.message?.toLowerCase().includes("quota"))throw new Q("Storage quota exceeded","CAPACITY_ERROR",{originalError:g.message});if(g.name==="SchemaError"||g.name==="DataError"||!(g.name==="DatabaseClosedError"||g.name==="TransactionInactiveError"||g.name==="UnknownError"||g.name==="AbortError"||g.name==="TimeoutError"||g.name==="InvalidStateError"||g.message&&g.message.includes("closing"))||d>this.MAX_RETRIES)throw g;if(g.name==="DatabaseClosedError"||g.name==="UnknownError"||g.name==="InvalidStateError")try{this.close()}catch{}let O=Math.min(this.MAX_RETRY_DELAY,this.RETRY_DELAY_BASE*Math.pow(2,d)),D=Math.random()*(O*.5),P=O+D;console.warn(`VC Timeline: Retrying ${u} (Attempt ${d}) in ${Math.round(P)}ms`),await new Promise(L=>setTimeout(L,P))}throw f}},pr=null;function ke(){return pr||(pr=new yn),pr}async function gr(s,o,u){let d=ke();try{return await d.execute(async()=>(await d.timeline.where("[noteId+branchName+source]").equals([s,o,u]).toArray()).sort((g,k)=>g.timestamp<k.timestamp?-1:g.timestamp>k.timestamp?1:(g.toVersionNumber||0)-(k.toVersionNumber||0)),"getTimelineEvents")}catch(f){return console.error("VC Worker: getTimelineEvents failed",f),[]}}async function mr(s){let o=ke();try{return tt(s),await o.execute(async()=>{await o.timeline.put(s)},"putTimelineEvent"),s}catch(u){let d=u instanceof Error?u.message:String(u);throw new Q("Failed to store timeline event","DB_ERROR",{originalError:d})}}async function yr(s,o,u,d){let f=ke();try{return await f.execute(async()=>await f.timeline.where("[noteId+branchName+source+toVersionId]").equals([s,o,u,d]).first(),"findExistingEvent")}catch(g){console.error("VC Worker: findExistingEvent failed",g);return}}async function vr(s,o,u){let d=ke();try{return await d.execute(async()=>await d.timeline.where({noteId:s,toVersionId:o}).modify(f=>{u.name!==void 0&&(u.name.trim()===""?delete f.toVersionName:f.toVersionName=u.name),u.description!==void 0&&(u.description.trim()===""?delete f.toVersionDescription:f.toVersionDescription=u.description)}),"updateEventMetadata")}catch(f){let g=f instanceof Error?f.message:String(f);throw new Q("Metadata update failed","DB_UPDATE_FAILED",{originalError:g})}}async function br(s,o,u,d){let f=ke();try{return await f.execute(async()=>await f.timeline.where("[noteId+branchName+source+toVersionId]").equals([s,o,u,d]).delete(),"deleteEventByVersion")}catch(g){let k=g instanceof Error?g.message:String(g);throw new Q("Event deletion failed","DB_DELETE_FAILED",{originalError:k})}}async function wr(s,o){let u=ke();try{return await u.execute(async()=>{let d=0;return await u.transaction("rw",u.timeline,async()=>{if(o){let f;do f=await u.timeline.where("[noteId+branchName+source]").between([s,Ie.minKey,o],[s,Ie.maxKey,o]).limit(1e3).delete(),d+=f;while(f===1e3)}else{let f;do f=await u.timeline.where("noteId").equals(s).limit(1e3).delete(),d+=f;while(f===1e3)}}),d},"clearTimelineForNote")}catch(d){let f=d instanceof Error?d.message:String(d);throw new Q("Timeline clear failed","DB_CLEAR_FAILED",{originalError:f})}}async function _r(){let s=ke();try{return await s.execute(async()=>{let o=0,u;do u=await s.timeline.limit(1e3).delete(),o+=u;while(u===1e3);return o},"clearAllTimeline")}catch(o){let u=o instanceof Error?o.message:String(o);throw new Q("Global clear failed","DB_GLOBAL_CLEAR_FAILED",{originalError:u})}}var qo=new TextDecoder("utf-8",{fatal:!1}),Fo=new TextEncoder;function vn(s){if(typeof s=="string")return s;try{return qo.decode(s)}catch(o){let u=o instanceof Error?o.message:String(o);throw new Q("Failed to decode content","DECODING_FAILED",{originalError:u})}}function bn(s){return s.replace(/[\\x00-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]/g,"")}function Er(s,o){return s===o}function Ct(s){try{let o=JSON.stringify(s),d=Fo.encode(o).buffer;return fr(d,[d])}catch(o){let u=o instanceof Error?o.message:String(o);throw new Q("Failed to serialize worker response","SERIALIZATION_FAILED",{originalError:u})}}function Lt(s,o,u,d){return`vc:timeline:${s}:${o}:${u}:${d}`}function xr(s){let[o,u]=s;return[o,u]}function Oi(s,o){let u=s,d=o,f=u.length,g=d.length;if(f===0||g===0)return 0;f>g?u=u.substring(f-g):f<g&&(d=d.substring(0,f));let k=Math.min(f,g);if(u===d)return k;let O=0,D=1;for(let P=0;P!==-1;){let L=u.substring(k-D);if(P=d.indexOf(L),P===-1)return O;D+=P,(P===0||u.substring(k-D)===d.substring(0,D))&&(O=D,D++)}return O}function kr(s,o){if(!s||!o||s[0]!==o[0])return 0;let u=0,d=Math.min(s.length,o.length),f=d,g=0;for(;u<f;)s.substring(g,f)===o.substring(g,f)?(u=f,g=u):d=f,f=Math.floor((d-u)/2+u);return f}function En(s,o){if(!s||!o||s[s.length-1]!==o[o.length-1])return 0;let u=0,d=Math.min(s.length,o.length),f=d,g=0;for(;u<f;)s.substring(s.length-f,s.length-g)===o.substring(o.length-f,o.length-g)?(u=f,g=u):d=f,f=Math.floor((d-u)/2+u);return f}function Vo(s){let o=s.charCodeAt(0);return o>=55296&&o<=56319}function Uo(s){let o=s.charCodeAt(0);return o>=56320&&o<=57343}function $o(s,o,u){let d=s.length,f=o.length,g=Math.ceil((d+f)/2),k=g,O=2*g,D=new Array(O),P=new Array(O);for(let ee=0;ee<O;ee++)D[ee]=-1,P[ee]=-1;D[k+1]=0,P[k+1]=0;let L=d-f,N=L%2!==0,F=0,$=0,Z=0,we=0;for(let ee=0;ee<g&&!(Date.now()>u);ee++){for(let ie=-ee+F;ie<=ee-$;ie+=2){let oe=k+ie,ne;ie===-ee||ie!==ee&&D[oe-1]<D[oe+1]?ne=D[oe+1]:ne=D[oe-1]+1;let le=ne-ie;for(;ne<d&&le<f&&s.charAt(ne)===o.charAt(le);)ne++,le++;if(D[oe]=ne,ne>d)$+=2;else if(le>f)F+=2;else if(N){let re=k+L-ie;if(re>=0&&re<O&&P[re]!==-1){let Ce=d-P[re];if(ne>=Ce)return Ti(s,o,ne,le,u)}}}for(let ie=-ee+Z;ie<=ee-we;ie+=2){let oe=k+ie,ne;ie===-ee||ie!==ee&&P[oe-1]<P[oe+1]?ne=P[oe+1]:ne=P[oe-1]+1;let le=ne-ie;for(;ne<d&&le<f&&s.charAt(d-ne-1)===o.charAt(f-le-1);)ne++,le++;if(P[oe]=ne,ne>d)we+=2;else if(le>f)Z+=2;else if(!N){let re=k+L-ie;if(re>=0&&re<O&&D[re]!==-1){let Ce=D[re],xn=k+Ce-re;if(ne=d-ne,Ce>=ne)return Ti(s,o,Ce,xn,u)}}}}return[[be,s],[ye,o]]}function Ti(s,o,u,d,f){let g=s.substring(0,u),k=o.substring(0,d),O=s.substring(u),D=o.substring(d),P=nt(g,k,{checkLines:!1,deadline:f}),L=nt(O,D,{checkLines:!1,deadline:f});return P.concat(L)}function zo(s,o,u=1){if(u<=0)return null;let d=s.length>o.length?s:o,f=s.length>o.length?o:s;if(d.length<4||f.length*2<d.length)return null;let g=Pi(d,f,Math.ceil(d.length/4)),k=Pi(d,f,Math.ceil(d.length/2)),O;if(g&&k)O=g[4].length>k[4].length?g:k;else{if(!g&&!k)return null;k?g||(O=k):O=g}if(!O)throw new Error("Unable to find a half match.");let D,P,L,N;s.length>o.length?(D=O[0],P=O[1],L=O[2],N=O[3]):(L=O[0],N=O[1],D=O[2],P=O[3]);let F=O[4];return[D,P,L,N,F]}function Pi(s,o,u){let d=s.slice(u,u+Math.floor(s.length/4)),f=-1,g="",k,O,D,P;for(;(f=o.indexOf(d,f+1))!==-1;){let L=kr(s.slice(u),o.slice(f)),N=En(s.slice(0,u),o.slice(0,f));g.length<N+L&&(g=o.slice(f-N,f)+o.slice(f,f+L),k=s.slice(0,u-N),O=s.slice(u+L),D=o.slice(0,f-N),P=o.slice(f+L))}return g.length*2>=s.length?[k||"",O||"",D||"",P||"",g||""]:null}function Wo(s,o){for(let u=0;u<s.length;u++){let d=s[u][1],f=[];for(let g=0;g<d.length;g++)f[g]=o[d.charCodeAt(g)];s[u][1]=f.join("")}}function Yo(s,o){let u=[],d={};u[0]="";function f(D){let P="",L=0,N=-1,F=u.length;for(;N<D.length-1;){N=D.indexOf(`\n`,L),N===-1&&(N=D.length-1);let $=D.slice(L,N+1);(d.hasOwnProperty?d.hasOwnProperty($):d[$]!==void 0)?P+=String.fromCharCode(d[$]):(F===g&&($=D.slice(L),N=D.length),P+=String.fromCharCode(F),d[$]=F,u[F++]=$),L=N+1}return P}let g=4e4,k=f(s);g=65535;let O=f(o);return{chars1:k,chars2:O,lineArray:u}}function Ho(s,o,u){let d=s,f=o,g=Yo(d,f);d=g.chars1,f=g.chars2;let k=g.lineArray,O=nt(d,f,{checkLines:!1,deadline:u.deadline});Wo(O,k),O=ia(O),O.push([se,""]);let D=0,P=0,L=0,N="",F="";for(;D<O.length;){switch(O[D][0]){case ye:L++,F+=O[D][1];break;case be:P++,N+=O[D][1];break;case se:if(P>=1&&L>=1){O.splice(D-P-L,P+L),D=D-P-L;let $=nt(N,F,{checkLines:!1,deadline:u.deadline});for(let Z=$.length-1;Z>=0;Z--)O.splice(D,0,$[Z]);D+=$.length}L=0,P=0,N="",F="";break;default:throw new Error("Unknown diff operation.")}D++}return O.pop(),O}function Go(s,o,u){let d;if(!s)return[[ye,o]];if(!o)return[[be,s]];let f=s.length>o.length?s:o,g=s.length>o.length?o:s,k=f.indexOf(g);if(k!==-1)return d=[[ye,f.substring(0,k)],[se,g],[ye,f.substring(k+g.length)]],s.length>o.length&&(d[0][0]=be,d[2][0]=be),d;if(g.length===1)return[[be,s],[ye,o]];let O=zo(s,o);if(O){let D=O[0],P=O[1],L=O[2],N=O[3],F=O[4],$=nt(D,L,u),Z=nt(P,N,u);return $.concat([[se,F]],Z)}return u.checkLines&&s.length>100&&o.length>100?Ho(s,o,u):$o(s,o,u.deadline)}var Xo=Object.defineProperty,Di=Object.getOwnPropertySymbols,Qo=Object.prototype.hasOwnProperty,Zo=Object.prototype.propertyIsEnumerable,Ii=(s,o,u)=>o in s?Xo(s,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[o]=u,Jo=(s,o)=>{for(var u in o||(o={}))Qo.call(o,u)&&Ii(s,u,o[u]);if(Di)for(var u of Di(o))Zo.call(o,u)&&Ii(s,u,o[u]);return s},be=-1,ye=1,se=0;function Mi(s,o,u){if(s===null||o===null)throw new Error("Null input. (diff)");let d=nt(s,o,ta(u||{}));return ra(d),d}function nt(s,o,u){let d=s,f=o;if(d===f)return d?[[se,d]]:[];let g=kr(d,f),k=d.substring(0,g);d=d.substring(g),f=f.substring(g),g=En(d,f);let O=d.substring(d.length-g);d=d.substring(0,d.length-g),f=f.substring(0,f.length-g);let D=Go(d,f,u);return k&&D.unshift([se,k]),O&&D.push([se,O]),D=Ar(D),D}function ea(s){let o=1;return typeof s<"u"&&(o=s<=0?Number.MAX_VALUE:s),Date.now()+o*1e3}function ta(s){return Jo({checkLines:!0,deadline:ea(s.timeout||1)},s)}function wn(s,o,u){return u===1?s+o:o+s}function _n(s,o){return o===1?[s.substring(0,s.length-1),s[s.length-1]]:[s.substring(1),s[0]]}function na(s,o,u,d){return d===1?s[o][1][s[o][1].length-1]===s[u][1][s[u][1].length-1]:s[o][1][0]===s[u][1][0]}function Ci(s,o,u){let d=u===1?-1:1,f=null,g=null,k=o+u;for(;k>=0&&k<s.length&&(f===null||g===null);k+=u){let[P,L]=s[k];if(L.length!==0){if(P===ye){f===null&&(f=k);continue}else if(P===be){g===null&&(g=k);continue}else if(P===se){if(f===null&&g===null){let[N,F]=_n(s[o][1],u);s[o][1]=N,s[k][1]=wn(s[k][1],F,d);return}break}}}if(f!==null&&g!==null&&na(s,f,g,u)){let[P,L]=_n(s[f][1],d),[N]=_n(s[g][1],d);s[f][1]=P,s[g][1]=N,s[o][1]=wn(s[o][1],L,u);return}let[O,D]=_n(s[o][1],u);s[o][1]=O,f===null?(s.splice(k,0,[ye,D]),g!==null&&g>=k&&g++):s[f][1]=wn(s[f][1],D,d),g===null?s.splice(k,0,[be,D]):s[g][1]=wn(s[g][1],D,d)}function ra(s){for(let o=0;o<s.length;o++){let[u,d]=s[o];if(d.length===0)continue;let f=d[0],g=d[d.length-1];Vo(g)&&u===se&&Ci(s,o,1),Uo(f)&&u===se&&Ci(s,o,-1)}for(let o=0;o<s.length;o++)s[o][1].length===0&&s.splice(o,1)}function ia(s){let o=s.map(N=>xr(N)),u=!1,d=[],f=0,g=null,k=0,O=0,D=0,P=0,L=0;for(;k<o.length;)o[k][0]===se?(d[f++]=k,O=P,D=L,P=0,L=0,g=o[k][1]):(o[k][0]===ye?P+=o[k][1].length:L+=o[k][1].length,g&&g.length<=Math.max(O,D)&&g.length<=Math.max(P,L)&&(o.splice(d[f-1],0,[be,g]),o[d[f-1]+1][0]=ye,f--,f--,k=f>0?d[f-1]:-1,O=0,D=0,P=0,L=0,g=null,u=!0)),k++;for(u&&(o=Ar(o)),o=sa(o),k=1;k<o.length;){if(o[k-1][0]===be&&o[k][0]===ye){let N=o[k-1][1],F=o[k][1],$=Oi(N,F),Z=Oi(F,N);$>=Z?($>=N.length/2||$>=F.length/2)&&(o.splice(k,0,[se,F.substring(0,$)]),o[k-1][1]=N.substring(0,N.length-$),o[k+1][1]=F.substring($),k++):(Z>=N.length/2||Z>=F.length/2)&&(o.splice(k,0,[se,N.substring(0,Z)]),o[k-1][0]=ye,o[k-1][1]=F.substring(0,F.length-Z),o[k+1][0]=be,o[k+1][1]=N.substring(Z),k++),k++}k++}return o}var Li=/[^a-zA-Z0-9]/,Ki=/\\s/,Ri=/[\\r\\n]/,oa=/\\n\\r?\\n$/,aa=/^\\r?\\n\\r?\\n/;function sa(s){let o=s.map(f=>xr(f));function u(f,g){if(!f||!g)return 6;let k=f.charAt(f.length-1),O=g.charAt(0),D=k.match(Li),P=O.match(Li),L=D&&k.match(Ki),N=P&&O.match(Ki),F=L&&k.match(Ri),$=N&&O.match(Ri),Z=F&&f.match(oa),we=$&&g.match(aa);return Z||we?5:F||$?4:D&&!L&&N?3:L||N?2:D||P?1:0}let d=1;for(;d<o.length-1;){if(o[d-1][0]===se&&o[d+1][0]===se){let f=o[d-1][1],g=o[d][1],k=o[d+1][1],O=En(f,g);if(O){let F=g.substring(g.length-O);f=f.substring(0,f.length-O),g=F+g.substring(0,g.length-O),k=F+k}let D=f,P=g,L=k,N=u(f,g)+u(g,k);for(;g.charAt(0)===k.charAt(0);){f+=g.charAt(0),g=g.substring(1)+k.charAt(0),k=k.substring(1);let F=u(f,g)+u(g,k);F>=N&&(N=F,D=f,P=g,L=k)}o[d-1][1]!==D&&(D?o[d-1][1]=D:(o.splice(d-1,1),d--),o[d][1]=P,L?o[d+1][1]=L:(o.splice(d+1,1),d--))}d++}return o}function Ar(s){let o=s.map(P=>xr(P));o.push([se,""]);let u=0,d=0,f=0,g="",k="",O;for(;u<o.length;)switch(o[u][0]){case ye:f++,k+=o[u][1],u++;break;case be:d++,g+=o[u][1],u++;break;case se:d+f>1?(d!==0&&f!==0&&(O=kr(k,g),O!==0&&(u-d-f>0&&o[u-d-f-1][0]===se?o[u-d-f-1][1]+=k.substring(0,O):(o.splice(0,0,[se,k.substring(0,O)]),u++),k=k.substring(O),g=g.substring(O)),O=En(k,g),O!==0&&(o[u][1]=k.substring(k.length-O)+o[u][1],k=k.substring(0,k.length-O),g=g.substring(0,g.length-O))),u-=d+f,o.splice(u,d+f),g.length&&(o.splice(u,0,[be,g]),u++),k.length&&(o.splice(u,0,[ye,k]),u++),u++):u!==0&&o[u-1][0]===se?(o[u-1][1]+=o[u][1],o.splice(u,1)):u++,f=0,d=0,g="",k="";break;default:throw new Error("Unknown diff operation")}o[o.length-1][1]===""&&o.pop();let D=!1;for(u=1;u<o.length-1;)o[u-1][0]===se&&o[u+1][0]===se&&(o[u][1].substring(o[u][1].length-o[u-1][1].length)===o[u-1][1]?(o[u][1]=o[u-1][1]+o[u][1].substring(0,o[u][1].length-o[u-1][1].length),o[u+1][1]=o[u-1][1]+o[u+1][1],o.splice(u-1,1),D=!0):o[u][1].substring(0,o[u+1][1].length)===o[u+1][1]&&(o[u-1][1]+=o[u+1][1],o[u][1]=o[u][1].substring(o[u+1][1].length)+o[u+1][1],o.splice(u+1,1),D=!0)),u++;return D&&(o=Ar(o)),o}function ua(s,o){let u=[],d={};u[0]="";function f(O,D){let P="",L=0,N=-1,F=u.length;for(;N<O.length-1;){N=O.indexOf(`\n`,L),N===-1&&(N=O.length-1);let $=O.slice(L,N+1);Object.prototype.hasOwnProperty.call(d,$)?P+=String.fromCharCode(d[$]):(F===D&&($=O.slice(L),N=O.length),P+=String.fromCharCode(F),d[$]=F,u[F++]=$),L=N+1}return P}let g=f(s,4e4),k=f(o,65535);return{chars1:g,chars2:k,lineArray:u}}function ca(s,o){for(let u=0;u<s.length;u++){let d=s[u];if(!d)continue;let f=d[1],g=[];for(let k=0;k<f.length;k++){let O=o[f.charCodeAt(k)];O!==void 0&&(g[k]=O)}d[1]=g.join("")}}function la(s){if(s.length===0)return 0;let o=1;for(let u=0;u<s.length;u++)s[u]===`\n`&&o++;return s.endsWith(`\n`)&&o--,o||1}function fa(s){let o=[];for(let u=0;u<s.length;u++){let d=s[u];if(d===void 0)continue;let[f,g]=d;if(g.length===0)continue;let k={value:g,added:f===ye?!0:void 0,removed:f===be?!0:void 0,count:la(g)};o.push(k)}return o}function ha(s,o){if(Er(s,o))return[];let{chars1:u,chars2:d,lineArray:f}=ua(s,o),g=Mi(u,d,{checkLines:!1,timeout:10});return ca(g,f),fa(g)}function ji(s,o){try{let u=vn(s),d=vn(o),f=bn(u),g=bn(d);return ha(f,g)}catch(u){let d=u instanceof Error?u.message:String(u);throw new Q("Diff computation failed","DIFF_FAILED",{originalError:d})}}function Bi(s){let o=0,u=0;for(let d of s)gt(d.count)&&(d.added?o+=d.count:d.removed&&(u+=d.count));return{additions:o,deletions:u}}async function Sr(s,o,u,d,f,g,k,O,D,P){let L=ke();if(fe(s,"noteId"),fe(o,"branchName"),fe(u,"source"),fe(f,"toVersionId"),fe(g,"toVersionTimestamp"),!gt(k))throw new Q("toVersionNumber must be a valid number","INVALID_INPUT");if(d!==null&&!qe(d))throw new Q("fromVersionId must be null or non-empty string","INVALID_INPUT");mn(O),mn(D);let N=ji(O,D),F=Bi(N),$=Lt(s,o,u,f);return navigator.locks.request($,{ifAvailable:!1},async()=>{try{let Z;return await L.execute(async()=>{await L.transaction("rw",L.timeline,async()=>{let we=await yr(s,o,u,f),ee;P&&P.name!==void 0?ee=P.name:ee=we?.toVersionName;let ie;P&&P.description!==void 0?ie=P.description:ie=we?.toVersionDescription;let oe={noteId:s,branchName:o,source:u,fromVersionId:d,toVersionId:f,timestamp:g,diffData:N,stats:F,toVersionNumber:k};ee!==void 0&&ee.trim()!==""&&(oe.toVersionName=ee),ie!==void 0&&ie.trim()!==""&&(oe.toVersionDescription=ie),we?.id!==void 0&&(oe.id=we.id),tt(oe),await mr(oe),Z=oe})},"generateAndStoreTimelineEvent"),Z}catch(Z){if(Z instanceof Q)throw Z;let we=Z instanceof Error?Z.message:String(Z);throw new Q("Database transaction failed","DB_ERROR",{originalError:we})}})}var Or={async getTimeline(s,o,u){try{fe(s,"noteId"),fe(o,"branchName"),fe(u,"source");let f=await gr(s,o,u);return Ct(f)}catch(d){return console.error("VC Worker: getTimeline failed",d),Ct([])}},async generateAndStoreEvent(s,o,u,d,f,g,k,O,D,P){let L=await Sr(s,o,u,d,f,g,k,O,D,P);return Ct(L)},async updateEventMetadata(s,o,u){if(fe(s,"noteId"),fe(o,"versionId"),u.name!==void 0&&typeof u.name!="string")throw new Q("name must be a string if provided","INVALID_INPUT");if(u.description!==void 0&&typeof u.description!="string")throw new Q("description must be a string if provided","INVALID_INPUT");await vr(s,o,u)},async removeEventByVersion(s,o,u,d){fe(s,"noteId"),fe(o,"branchName"),fe(u,"source"),fe(d,"versionId");let f=Lt(s,o,u,d);await navigator.locks.request(f,{ifAvailable:!1},async()=>{await br(s,o,u,d)})},async clearTimelineForNote(s,o){fe(s,"noteId"),o!==void 0&&fe(o,"source"),await wr(s,o)},async clearAll(){await _r()}};pn(Or);})();\n/*! Bundled license information:\n\ncomlink/dist/esm/comlink.mjs:\n  (**\n   * @license\n   * Copyright 2019 Google LLC\n   * SPDX-License-Identifier: Apache-2.0\n   *)\n*/\n',workerName:"Timeline Worker",validateOnInit:!1,maxConsecutiveErrors:3,errorResetTime:6e4});P(this,"decoder",new TextDecoder("utf-8"))}validateNoteId(n){return xw(qZ,n,"noteId")}validateBranchName(n){return xw(GZ,n,"branchName")}validateVersionId(n){return xw(KZ,n,"versionId")}validateSource(n){return xw(WZ,n,"source")}normalizeMetadata(n){return YZ(n)}deserialize(n){return JSON.parse(this.decoder.decode(n))}prepareTransferable(n){return n instanceof ArrayBuffer?no(n,[n]):n}},Ew=class extends gF.Component{constructor(){super();P(this,"workerManager");this.workerManager=new sR}initialize(){this.workerManager.initialize()}async getTimeline(n,r,i){try{let o=this.workerManager.validateNoteId(n),s=this.workerManager.validateBranchName(r),a=this.workerManager.validateSource(i),l=await this.workerManager.execute(c=>c.getTimeline(o,s,a),{timeout:15e3,retry:!0});return this.workerManager.deserialize(l)}catch(o){return console.error("VC: Failed to get timeline",o),[]}}async generateAndStoreEvent(n,r,i,o,s,a,l,c,u,f){let p=this.workerManager.validateNoteId(n),d=this.workerManager.validateBranchName(r),h=this.workerManager.validateSource(i),m=this.workerManager.validateVersionId(s),v=this.workerManager.normalizeMetadata(f),g=o?this.workerManager.validateVersionId(o):null,y=await this.workerManager.execute(b=>{let w=this.workerManager.prepareTransferable(c),S=this.workerManager.prepareTransferable(u);return b.generateAndStoreEvent(p,d,h,g,m,a,l,w,S,v)},{timeout:3e4,retry:!0});return this.workerManager.deserialize(y)}async updateEventMetadata(n,r,i){let o=this.workerManager.validateNoteId(n),s=this.workerManager.validateVersionId(r),a=this.workerManager.normalizeMetadata(i);await this.workerManager.execute(l=>l.updateEventMetadata(o,s,a),{timeout:5e3,retry:!0})}async removeEventByVersion(n,r,i,o){let s=this.workerManager.validateNoteId(n),a=this.workerManager.validateBranchName(r),l=this.workerManager.validateSource(i),c=this.workerManager.validateVersionId(o);await this.workerManager.execute(u=>u.removeEventByVersion(s,a,l,c),{timeout:5e3,retry:!0})}async clearTimelineForNote(n,r){let i=this.workerManager.validateNoteId(n);await this.workerManager.execute(o=>o.clearTimelineForNote(i,r),{timeout:1e4,retry:!0})}async clearAll(){await this.workerManager.execute(n=>n.clearAll(),{timeout:3e4,retry:!1})}terminate(){this.workerManager.terminate()}onunload(){this.terminate()}};function Cw(e){return e!==null&&typeof e=="object"&&e.noteIdFormat!==void 0}function yF(e){return e!==null&&typeof e=="object"&&typeof e.path=="string"&&typeof e.basename=="string"}function vF(e){return typeof e=="object"&&e!==null&&"randomUUID"in e&&typeof e.randomUUID=="function"}var Ni={CONTROL_CHARS_REGEX:/[\x00-\x1f\x80-\x9f]/g,INVALID_FILENAME_CHARS_REGEX:/[<>:"|?*\\/]/g,PROBLEMATIC_EDGE_CHARS_REGEX:/^[.\s]+|[.\s]+$/g,MULTIPLE_UNDERSCORES_REGEX:/_{2,}/g,EDGE_UNDERSCORES_REGEX:/^_|_$/g,DEFAULT_FALLBACK_ID:"unnamed_id",MAX_ID_LENGTH:255,RESERVED_NAMES:new Set(["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9",".",".."])},bF={EXTENSIONS_TO_TRANSFORM:new Set([".md",".base"]),EXTENSION_TRANSFORM_MAP:new Map([[".md","_md"],[".base","_base"]]),EXTENSION_AT_END_REGEX:/\.(?:md|base)$/},er={ERRORS:{SETTINGS_REQUIRED:"Version Control: Settings parameter is required and cannot be null or undefined",FILE_REQUIRED:"Version Control: File parameter is required and cannot be null or undefined",VERSION_NUM_INVALID:"Version Control: versionNum must be a positive integer",CRYPTO_UNAVAILABLE:"Version Control: Global 'crypto' object is not available or malformed. Cannot generate secure unique IDs.",CRYPTO_RANDOM_UUID_INVALID:"Version Control: 'crypto.randomUUID' is not a function. Cannot generate secure unique IDs.",CRYPTO_INVOCATION_FAILED:"Version Control: Invocation of 'crypto.randomUUID()' failed: ",CRYPTO_RESULT_INVALID:"Version Control: 'crypto.randomUUID()' returned invalid or empty result.",CRYPTO_FORMAT_INVALID:"Version Control: Generated ID does not conform to UUID v4 format."},REGEX:{UUID_V4:/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,UUID_V4_EXTRACTION:/[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}/i,POSITIVE_INTEGER:/^\d+$/,TIMESTAMP:/(?:^|[_.\- ])([0-9]{13}|[0-9]{10})(?:[_.\- ]|$)/}};function Jh(e,t){if(sc(e))return"";if(typeof e!="string")try{return String(e)}catch{return""}return e}function aR(e){if(typeof e!="string"||e.length===0)return e;for(let[t,n]of bF.EXTENSION_TRANSFORM_MAP)if(e.endsWith(t))return e.slice(0,-t.length)+n;return e}function eg(e){let t=Jh(e,"id");if(t.length===0)return"";let n=t;n=n.replace(Ni.CONTROL_CHARS_REGEX,""),n=n.replace(Ni.INVALID_FILENAME_CHARS_REGEX,"_"),n=n.replace(Ni.PROBLEMATIC_EDGE_CHARS_REGEX,""),n=n.replace(Ni.MULTIPLE_UNDERSCORES_REGEX,"_"),n=n.replace(Ni.EDGE_UNDERSCORES_REGEX,""),n.length>Ni.MAX_ID_LENGTH&&(n=n.substring(0,Ni.MAX_ID_LENGTH));let r=n.toUpperCase();return Ni.RESERVED_NAMES.has(r)?Ni.DEFAULT_FALLBACK_ID:n.length>0?n:Ni.DEFAULT_FALLBACK_ID}function Tw(e){if(!e||typeof e!="string")return null;let t=e.match(er.REGEX.UUID_V4_EXTRACTION);return t?t[0]:null}function Aw(e){if(!e||typeof e!="string")return null;let t=e.match(er.REGEX.TIMESTAMP);return t&&t[1]||null}function SF(e){let t=e||new Date;return t.getFullYear().toString().padStart(4,"0")+(t.getMonth()+1).toString().padStart(2,"0")+t.getDate().toString().padStart(2,"0")+t.getHours().toString().padStart(2,"0")+t.getMinutes().toString().padStart(2,"0")+t.getSeconds().toString().padStart(2,"0")}function wF(e){return e!=null?String(e):Date.now().toString()}function Mw(e,t){let n=e;for(let[r,i]of t)n.includes(r)&&(n=n.split(r).join(i));return n}function lR(e,t){return e.includes(t)}function Rw(){if(typeof globalThis>"u"||!("crypto"in globalThis)||!vF(globalThis.crypto))throw console.error(`[CRITICAL FAILURE] ${er.ERRORS.CRYPTO_UNAVAILABLE}`),new Error(er.ERRORS.CRYPTO_UNAVAILABLE);let e=globalThis.crypto;if(typeof e.randomUUID!="function")throw console.error(`[CRITICAL FAILURE] ${er.ERRORS.CRYPTO_RANDOM_UUID_INVALID}`),new Error(er.ERRORS.CRYPTO_RANDOM_UUID_INVALID);let t;try{t=e.randomUUID()}catch(n){let r=er.ERRORS.CRYPTO_INVOCATION_FAILED+(n instanceof Error?n.message:String(n));throw console.error(`[CRITICAL FAILURE] ${r}`),new Error(r)}if(typeof t!="string"||t.trim().length===0)throw console.error(`[CRITICAL FAILURE] ${er.ERRORS.CRYPTO_RESULT_INVALID}`),new Error(er.ERRORS.CRYPTO_RESULT_INVALID);if(!er.REGEX.UUID_V4.test(t))throw console.error(`[CRITICAL FAILURE] ${er.ERRORS.CRYPTO_FORMAT_INVALID}`),new Error(er.ERRORS.CRYPTO_FORMAT_INVALID);return t}function Hp(e,t,n,r){if(!Cw(e))throw new TypeError(er.ERRORS.SETTINGS_REQUIRED);if(!yF(t))throw new TypeError(er.ERRORS.FILE_REQUIRED);let i=typeof e.noteIdFormat=="string"&&e.noteIdFormat.trim().length>0?e.noteIdFormat:"{uuid}";t.extension==="base"&&(i="{path}");let o=Jh(t.path,"file.path"),s=aR(o),l=lR(i,"{timestamp}")?wF(n):"",c=lR(i,"{uuid}"),u="";c&&(r?u=r:u=Rw());let p=Mw(i,[["{path}",s],["{uuid}",u],["{timestamp}",l]]);return eg(p)}function QZ(e){if(typeof e!="number"||!Number.isInteger(e)||e<1)throw new TypeError(er.ERRORS.VERSION_NUM_INVALID);return e}function tg(e,t,n,r){if(!Cw(e))throw new TypeError(er.ERRORS.SETTINGS_REQUIRED);let i=QZ(t),o=Jh(n,"name"),s=typeof e.versionIdFormat=="string"&&e.versionIdFormat.trim().length>0?e.versionIdFormat:"{timestamp}_{version}",l=SF(r||new Date),c=i.toString(),f=Mw(s,[["{timestamp}",l],["{version}",c],["{name}",o]]);return f=f.replace(Ni.MULTIPLE_UNDERSCORES_REGEX,"_"),f=f.replace(Ni.EDGE_UNDERSCORES_REGEX,""),(!f||f.trim().length===0)&&(f=`${l}_${c}`),eg(f)}var Nw=class{constructor(t,n,r,i){this.pathService=t;this.storageService=n;this.centralManifestRepo=r;this.noteManifestRepo=i}async initializeDatabase(){try{await this.storageService.ensureFolderExists(this.pathService.getDbRoot()),await this.centralManifestRepo.load(!0)}catch(t){console.error("VC: CRITICAL: Failed to initialize database structure.",t);let n=t instanceof Error?t.message:"Could not initialize database. Check vault permissions and console.";throw new Error(n)}}async resolveDuplicatesForPath(t){let n=await this.centralManifestRepo.load(),r=[];for(let[a,l]of Object.entries(n.notes))l&&l.notePath===t&&r.push({id:a,createdAt:l.createdAt});if(r.length===0)return{winnerId:null,loserIds:[]};if(r.length===1)return{winnerId:r[0].id,loserIds:[]};r.sort((a,l)=>{let c=new Date(a.createdAt).getTime(),u=new Date(l.createdAt).getTime();return c!==u?c-u:a.id.localeCompare(l.id)});let i=r[0],s=r.slice(1).map(a=>a.id);console.log(`VC: Resolving duplicates for "${t}". Winner: ${i.id}. Removing: ${s.join(", ")}`);for(let a of s){await this.centralManifestRepo.removeNoteEntry(a);let l=this.pathService.getNoteDbPath(a);await this.storageService.permanentlyDeleteFolder(l).catch(c=>{console.error(`VC: Failed to delete physical folder for duplicate note ${a}`,c)}),this.noteManifestRepo.invalidateCache(a)}return{winnerId:i.id,loserIds:s}}async createNoteEntry(t,n){if(!t||!n)throw new Error("VC: Invalid noteId or notePath for createNoteEntry.");let r=this.pathService.getNoteDbPath(t),i=this.pathService.getNoteVersionsPath(t);try{await this.storageService.ensureFolderExists(r),await this.storageService.ensureFolderExists(i);let o=await this.noteManifestRepo.create(t,n);return await this.centralManifestRepo.addNoteEntry(t,n,this.pathService.getNoteManifestPath(t)),o}catch(o){throw console.error(`VC: Failed to create new note entry for ID ${t}. Attempting rollback.`,o),await this.storageService.permanentlyDeleteFolder(r),this.noteManifestRepo.invalidateCache(t),o}}async recoverMissingNoteManifest(t,n){let r=this.pathService.getNoteDbPath(t),i=this.pathService.getNoteVersionsPath(t);try{return await this.storageService.ensureFolderExists(r),await this.storageService.ensureFolderExists(i),await this.noteManifestRepo.create(t,n)}catch(o){throw console.error(`VC: Failed to recover note manifest for ID ${t}.`,o),o}}async deleteNoteEntry(t){try{await this.centralManifestRepo.removeNoteEntry(t);let n=this.pathService.getNoteDbPath(t);await this.storageService.permanentlyDeleteFolder(n),this.noteManifestRepo.invalidateCache(t)}catch(n){throw console.error(`VC: Failed to complete deletion for note entry ID ${t}`,n),new Error("Failed to delete version history for a note. The operation may be incomplete.")}}async updateNotePath(t,n){await this.noteManifestRepo.update(t,r=>{r.notePath=n,r.lastModified=new Date().toISOString()}).catch(r=>{console.warn(`VC: Attempted to update path for non-existent note manifest: ${t}. Error: ${r.message}`)}),await this.centralManifestRepo.updateNotePath(t,n)}async renameNoteEntry(t,n){if(t===n)return;let r=this.pathService.getNoteDbPath(t),i=this.pathService.getNoteDbPath(n);try{await this.storageService.renameFolder(r,i),this.noteManifestRepo.invalidateCache(t),await this.noteManifestRepo.update(n,o=>{o.noteId=n,o.lastModified=new Date().toISOString()}),await this.centralManifestRepo.replaceNoteId(t,n,this.pathService.getNoteManifestPath(n))}catch(o){throw console.error(`VC: Failed to rename note entry from ${t} to ${n}.`,o),new Error("Failed to rename version history folder. Check console for details.")}}async ensureUniqueNoteId(t){let n=await this.centralManifestRepo.load(),r=t,i=1;for(;n.notes[r];)if(r=`${t}_${i}`,i++,i>100){r=`${t}_${Rw()}`;break}return r}loadCentralManifest(t=!1){return this.centralManifestRepo.load(t)}invalidateCentralManifestCache(){this.centralManifestRepo.invalidateCache()}getNoteIdByPath(t){return this.centralManifestRepo.getNoteIdByPath(t)}loadNoteManifest(t){return this.noteManifestRepo.load(t)}updateNoteManifest(t,n){return this.noteManifestRepo.update(t,n)}invalidateNoteManifestCache(t){this.noteManifestRepo.invalidateCache(t)}};var id=require("obsidian");var AB=require("obsidian");var Dw=Symbol.for("yaml.alias"),Iw=Symbol.for("yaml.document"),ws=Symbol.for("yaml.map"),cR=Symbol.for("yaml.pair"),ro=Symbol.for("yaml.scalar"),tl=Symbol.for("yaml.seq"),ci=Symbol.for("yaml.node.type"),Po=e=>!!e&&typeof e=="object"&&e[ci]===Dw,ua=e=>!!e&&typeof e=="object"&&e[ci]===Iw,hr=e=>!!e&&typeof e=="object"&&e[ci]===ws,nt=e=>!!e&&typeof e=="object"&&e[ci]===cR,_e=e=>!!e&&typeof e=="object"&&e[ci]===ro,io=e=>!!e&&typeof e=="object"&&e[ci]===tl;function wt(e){if(e&&typeof e=="object")switch(e[ci]){case ws:case tl:return!0}return!1}function Xe(e){if(e&&typeof e=="object")switch(e[ci]){case Dw:case ws:case ro:case tl:return!0}return!1}var Ow=e=>(_e(e)||wt(e))&&!!e.anchor;var Di=Symbol("break visit"),xF=Symbol("skip children"),fa=Symbol("remove node");function pa(e,t){let n=EF(t);ua(e)?Up(null,e.contents,n,Object.freeze([e]))===fa&&(e.contents=null):Up(null,e,n,Object.freeze([]))}pa.BREAK=Di;pa.SKIP=xF;pa.REMOVE=fa;function Up(e,t,n,r){let i=CF(e,t,n,r);if(Xe(i)||nt(i))return TF(e,r,i),Up(e,i,n,r);if(typeof i!="symbol"){if(wt(t)){r=Object.freeze(r.concat(t));for(let o=0;o<t.items.length;++o){let s=Up(o,t.items[o],n,r);if(typeof s=="number")o=s-1;else{if(s===Di)return Di;s===fa&&(t.items.splice(o,1),o-=1)}}}else if(nt(t)){r=Object.freeze(r.concat(t));let o=Up("key",t.key,n,r);if(o===Di)return Di;o===fa&&(t.key=null);let s=Up("value",t.value,n,r);if(s===Di)return Di;s===fa&&(t.value=null)}}return i}async function Pw(e,t){let n=EF(t);ua(e)?await $p(null,e.contents,n,Object.freeze([e]))===fa&&(e.contents=null):await $p(null,e,n,Object.freeze([]))}Pw.BREAK=Di;Pw.SKIP=xF;Pw.REMOVE=fa;async function $p(e,t,n,r){let i=await CF(e,t,n,r);if(Xe(i)||nt(i))return TF(e,r,i),$p(e,i,n,r);if(typeof i!="symbol"){if(wt(t)){r=Object.freeze(r.concat(t));for(let o=0;o<t.items.length;++o){let s=await $p(o,t.items[o],n,r);if(typeof s=="number")o=s-1;else{if(s===Di)return Di;s===fa&&(t.items.splice(o,1),o-=1)}}}else if(nt(t)){r=Object.freeze(r.concat(t));let o=await $p("key",t.key,n,r);if(o===Di)return Di;o===fa&&(t.key=null);let s=await $p("value",t.value,n,r);if(s===Di)return Di;s===fa&&(t.value=null)}}return i}function EF(e){return typeof e=="object"&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function CF(e,t,n,r){if(typeof n=="function")return n(e,t,r);if(hr(t))return n.Map?.(e,t,r);if(io(t))return n.Seq?.(e,t,r);if(nt(t))return n.Pair?.(e,t,r);if(_e(t))return n.Scalar?.(e,t,r);if(Po(t))return n.Alias?.(e,t,r)}function TF(e,t,n){let r=t[t.length-1];if(wt(r))r.items[e]=n;else if(nt(r))e==="key"?r.key=n:r.value=n;else if(ua(r))r.contents=n;else{let i=Po(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${i} parent`)}}var XZ={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},ZZ=e=>e.replace(/[!,[\]{}]/g,t=>XZ[t]),da=class e{constructor(t,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},e.defaultYaml,t),this.tags=Object.assign({},e.defaultTags,n)}clone(){let t=new e(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){let t=new e(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:e.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},e.defaultTags);break}return t}add(t,n){this.atNextDocument&&(this.yaml={explicit:e.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},e.defaultTags),this.atNextDocument=!1);let r=t.trim().split(/[ \t]+/),i=r.shift();switch(i){case"%TAG":{if(r.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),r.length<2))return!1;let[o,s]=r;return this.tags[o]=s,!0}case"%YAML":{if(this.yaml.explicit=!0,r.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;let[o]=r;if(o==="1.1"||o==="1.2")return this.yaml.version=o,!0;{let s=/^\d+\.\d+$/.test(o);return n(6,`Unsupported YAML version ${o}`,s),!1}}default:return n(0,`Unknown directive ${i}`,!0),!1}}tagName(t,n){if(t==="!")return"!";if(t[0]!=="!")return n(`Not a valid tag: ${t}`),null;if(t[1]==="<"){let s=t.slice(2,-1);return s==="!"||s==="!!"?(n(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(t[t.length-1]!==">"&&n("Verbatim tags must end with a >"),s)}let[,r,i]=t.match(/^(.*!)([^!]*)$/s);i||n(`The ${t} tag has no suffix`);let o=this.tags[r];if(o)try{return o+decodeURIComponent(i)}catch(s){return n(String(s)),null}return r==="!"?t:(n(`Could not resolve tag: ${t}`),null)}tagString(t){for(let[n,r]of Object.entries(this.tags))if(t.startsWith(r))return n+ZZ(t.substring(r.length));return t[0]==="!"?t:`!<${t}>`}toString(t){let n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],r=Object.entries(this.tags),i;if(t&&r.length>0&&Xe(t.contents)){let o={};pa(t.contents,(s,a)=>{Xe(a)&&a.tag&&(o[a.tag]=!0)}),i=Object.keys(o)}else i=[];for(let[o,s]of r)o==="!!"&&s==="tag:yaml.org,2002:"||(!t||i.some(a=>a.startsWith(s)))&&n.push(`%TAG ${o} ${s}`);return n.join(`
`)}};da.defaultYaml={explicit:!1,version:"1.2"};da.defaultTags={"!!":"tag:yaml.org,2002:"};function kw(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){let n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(e)}`;throw new Error(n)}return!0}function uR(e){let t=new Set;return pa(e,{Value(n,r){r.anchor&&t.add(r.anchor)}}),t}function fR(e,t){for(let n=1;;++n){let r=`${e}${n}`;if(!t.has(r))return r}}function AF(e,t){let n=[],r=new Map,i=null;return{onAnchor:o=>{n.push(o),i??(i=uR(e));let s=fR(t,i);return i.add(s),s},setAnchors:()=>{for(let o of n){let s=r.get(o);if(typeof s=="object"&&s.anchor&&(_e(s.node)||wt(s.node)))s.node.anchor=s.anchor;else{let a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=o,a}}},sourceObjects:r}}function lc(e,t,n,r){if(r&&typeof r=="object")if(Array.isArray(r))for(let i=0,o=r.length;i<o;++i){let s=r[i],a=lc(e,r,String(i),s);a===void 0?delete r[i]:a!==s&&(r[i]=a)}else if(r instanceof Map)for(let i of Array.from(r.keys())){let o=r.get(i),s=lc(e,r,i,o);s===void 0?r.delete(i):s!==o&&r.set(i,s)}else if(r instanceof Set)for(let i of Array.from(r)){let o=lc(e,r,i,i);o===void 0?r.delete(i):o!==i&&(r.delete(i),r.add(o))}else for(let[i,o]of Object.entries(r)){let s=lc(e,r,i,o);s===void 0?delete r[i]:s!==o&&(r[i]=s)}return e.call(t,n,r)}function tr(e,t,n){if(Array.isArray(e))return e.map((r,i)=>tr(r,String(i),n));if(e&&typeof e.toJSON=="function"){if(!n||!Ow(e))return e.toJSON(t,n);let r={aliasCount:0,count:1,res:void 0};n.anchors.set(e,r),n.onCreate=o=>{r.res=o,delete n.onCreate};let i=e.toJSON(t,n);return n.onCreate&&n.onCreate(i),i}return typeof e=="bigint"&&!n?.keep?Number(e):e}var cc=class{constructor(t){Object.defineProperty(this,ci,{value:t})}clone(){let t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(t.range=this.range.slice()),t}toJS(t,{mapAsMap:n,maxAliasCount:r,onAnchor:i,reviver:o}={}){if(!ua(t))throw new TypeError("A document argument is required");let s={anchors:new Map,doc:t,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},a=tr(this,"",s);if(typeof i=="function")for(let{count:l,res:c}of s.anchors.values())i(c,l);return typeof o=="function"?lc(o,{"":a},"",a):a}};var nl=class extends cc{constructor(t){super(Dw),this.source=t,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(t,n){let r;n?.aliasResolveCache?r=n.aliasResolveCache:(r=[],pa(t,{Node:(o,s)=>{(Po(s)||Ow(s))&&r.push(s)}}),n&&(n.aliasResolveCache=r));let i;for(let o of r){if(o===this)break;o.anchor===this.source&&(i=o)}return i}toJSON(t,n){if(!n)return{source:this.source};let{anchors:r,doc:i,maxAliasCount:o}=n,s=this.resolve(i,n);if(!s){let l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=r.get(s);if(a||(tr(s,null,n),a=r.get(s)),a?.res===void 0){let l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(o>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=_w(i,s,r)),a.count*a.aliasCount>o)){let l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(t,n,r){let i=`*${this.source}`;if(t){if(kw(this.source),t.options.verifyAliasOrder&&!t.anchors.has(this.source)){let o=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(o)}if(t.implicitKey)return`${i} `}return i}};function _w(e,t,n){if(Po(t)){let r=t.resolve(e),i=n&&r&&n.get(r);return i?i.count*i.aliasCount:0}else if(wt(t)){let r=0;for(let i of t.items){let o=_w(e,i,n);o>r&&(r=o)}return r}else if(nt(t)){let r=_w(e,t.key,n),i=_w(e,t.value,n);return Math.max(r,i)}return 1}var Vw=e=>!e||typeof e!="function"&&typeof e!="object",Ee=class extends cc{constructor(t){super(ro),this.value=t}toJSON(t,n){return n?.keep?this.value:tr(this.value,t,n)}toString(){return String(this.value)}};Ee.BLOCK_FOLDED="BLOCK_FOLDED";Ee.BLOCK_LITERAL="BLOCK_LITERAL";Ee.PLAIN="PLAIN";Ee.QUOTE_DOUBLE="QUOTE_DOUBLE";Ee.QUOTE_SINGLE="QUOTE_SINGLE";var JZ="tag:yaml.org,2002:";function eJ(e,t,n){if(t){let r=n.filter(o=>o.tag===t),i=r.find(o=>!o.format)??r[0];if(!i)throw new Error(`Tag ${t} not found`);return i}return n.find(r=>r.identify?.(e)&&!r.format)}function rl(e,t,n){if(ua(e)&&(e=e.contents),Xe(e))return e;if(nt(e)){let f=n.schema[ws].createNode?.(n.schema,null,n);return f.items.push(e),f}(e instanceof String||e instanceof Number||e instanceof Boolean||typeof BigInt<"u"&&e instanceof BigInt)&&(e=e.valueOf());let{aliasDuplicateObjects:r,onAnchor:i,onTagObj:o,schema:s,sourceObjects:a}=n,l;if(r&&e&&typeof e=="object"){if(l=a.get(e),l)return l.anchor??(l.anchor=i(e)),new nl(l.anchor);l={anchor:null,node:null},a.set(e,l)}t?.startsWith("!!")&&(t=JZ+t.slice(2));let c=eJ(e,t,s.tags);if(!c){if(e&&typeof e.toJSON=="function"&&(e=e.toJSON()),!e||typeof e!="object"){let f=new Ee(e);return l&&(l.node=f),f}c=e instanceof Map?s[ws]:Symbol.iterator in Object(e)?s[tl]:s[ws]}o&&(o(c),delete n.onTagObj);let u=c?.createNode?c.createNode(n.schema,e,n):typeof c?.nodeClass?.from=="function"?c.nodeClass.from(n.schema,e,n):new Ee(e);return t?u.tag=t:c.default||(u.tag=c.tag),l&&(l.node=u),u}function ng(e,t,n){let r=n;for(let i=t.length-1;i>=0;--i){let o=t[i];if(typeof o=="number"&&Number.isInteger(o)&&o>=0){let s=[];s[o]=r,r=s}else r=new Map([[o,r]])}return rl(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}var qp=e=>e==null||typeof e=="object"&&!!e[Symbol.iterator]().next().done,jp=class extends cc{constructor(t,n){super(t),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(t){let n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return t&&(n.schema=t),n.items=n.items.map(r=>Xe(r)||nt(r)?r.clone(t):r),this.range&&(n.range=this.range.slice()),n}addIn(t,n){if(qp(t))this.add(n);else{let[r,...i]=t,o=this.get(r,!0);if(wt(o))o.addIn(i,n);else if(o===void 0&&this.schema)this.set(r,ng(this.schema,i,n));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${i}`)}}deleteIn(t){let[n,...r]=t;if(r.length===0)return this.delete(n);let i=this.get(n,!0);if(wt(i))return i.deleteIn(r);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${r}`)}getIn(t,n){let[r,...i]=t,o=this.get(r,!0);return i.length===0?!n&&_e(o)?o.value:o:wt(o)?o.getIn(i,n):void 0}hasAllNullValues(t){return this.items.every(n=>{if(!nt(n))return!1;let r=n.value;return r==null||t&&_e(r)&&r.value==null&&!r.commentBefore&&!r.comment&&!r.tag})}hasIn(t){let[n,...r]=t;if(r.length===0)return this.has(n);let i=this.get(n,!0);return wt(i)?i.hasIn(r):!1}setIn(t,n){let[r,...i]=t;if(i.length===0)this.set(r,n);else{let o=this.get(r,!0);if(wt(o))o.setIn(i,n);else if(o===void 0&&this.schema)this.set(r,ng(this.schema,i,n));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${i}`)}}};var MF=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function ko(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}var ma=(e,t,n)=>e.endsWith(`
`)?ko(n,t):n.includes(`
`)?`
`+ko(n,t):(e.endsWith(" ")?"":" ")+n;var pR="flow",Lw="block",rg="quoted";function ig(e,t,n="flow",{indentAtStart:r,lineWidth:i=80,minContentWidth:o=20,onFold:s,onOverflow:a}={}){if(!i||i<0)return e;i<o&&(o=0);let l=Math.max(1+o,1+i-t.length);if(e.length<=l)return e;let c=[],u={},f=i-t.length;typeof r=="number"&&(r>i-Math.max(2,o)?c.push(0):f=i-r);let p,d,h=!1,m=-1,v=-1,g=-1;n===Lw&&(m=RF(e,m,t.length),m!==-1&&(f=m+l));for(let b;b=e[m+=1];){if(n===rg&&b==="\\"){switch(v=m,e[m+1]){case"x":m+=3;break;case"u":m+=5;break;case"U":m+=9;break;default:m+=1}g=m}if(b===`
`)n===Lw&&(m=RF(e,m,t.length)),f=m+t.length+l,p=void 0;else{if(b===" "&&d&&d!==" "&&d!==`
`&&d!=="	"){let w=e[m+1];w&&w!==" "&&w!==`
`&&w!=="	"&&(p=m)}if(m>=f)if(p)c.push(p),f=p+l,p=void 0;else if(n===rg){for(;d===" "||d==="	";)d=b,b=e[m+=1],h=!0;let w=m>g+1?m-2:v-1;if(u[w])return e;c.push(w),u[w]=!0,f=w+l,p=void 0}else h=!0}d=b}if(h&&a&&a(),c.length===0)return e;s&&s();let y=e.slice(0,c[0]);for(let b=0;b<c.length;++b){let w=c[b],S=c[b+1]||e.length;w===0?y=`
${t}${e.slice(0,S)}`:(n===rg&&u[w]&&(y+=`${e[w]}\\`),y+=`
${t}${e.slice(w+1,S)}`)}return y}function RF(e,t,n){let r=t,i=t+1,o=e[i];for(;o===" "||o==="	";)if(t<i+n)o=e[++t];else{do o=e[++t];while(o&&o!==`
`);r=t,i=t+1,o=e[i]}return r}var Bw=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),zw=e=>/^(%|---|\.\.\.)/m.test(e);function tJ(e,t,n){if(!t||t<0)return!1;let r=t-n,i=e.length;if(i<=r)return!1;for(let o=0,s=0;o<i;++o)if(e[o]===`
`){if(o-s>r)return!0;if(s=o+1,i-s<=r)return!1}return!0}function og(e,t){let n=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return n;let{implicitKey:r}=t,i=t.options.doubleQuotedMinMultiLineLength,o=t.indent||(zw(e)?"  ":""),s="",a=0;for(let l=0,c=n[l];c;c=n[++l])if(c===" "&&n[l+1]==="\\"&&n[l+2]==="n"&&(s+=n.slice(a,l)+"\\ ",l+=1,a=l,c="\\"),c==="\\")switch(n[l+1]){case"u":{s+=n.slice(a,l);let u=n.substr(l+2,4);switch(u){case"0000":s+="\\0";break;case"0007":s+="\\a";break;case"000b":s+="\\v";break;case"001b":s+="\\e";break;case"0085":s+="\\N";break;case"00a0":s+="\\_";break;case"2028":s+="\\L";break;case"2029":s+="\\P";break;default:u.substr(0,2)==="00"?s+="\\x"+u.substr(2):s+=n.substr(l,6)}l+=5,a=l+1}break;case"n":if(r||n[l+2]==='"'||n.length<i)l+=1;else{for(s+=n.slice(a,l)+`

`;n[l+2]==="\\"&&n[l+3]==="n"&&n[l+4]!=='"';)s+=`
`,l+=2;s+=o,n[l+2]===" "&&(s+="\\"),l+=1,a=l+1}break;default:l+=1}return s=a?s+n.slice(a):n,r?s:ig(s,o,rg,Bw(t,!1))}function dR(e,t){if(t.options.singleQuote===!1||t.implicitKey&&e.includes(`
`)||/[ \t]\n|\n[ \t]/.test(e))return og(e,t);let n=t.indent||(zw(e)?"  ":""),r="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return t.implicitKey?r:ig(r,n,pR,Bw(t,!1))}function Gp(e,t){let{singleQuote:n}=t.options,r;if(n===!1)r=og;else{let i=e.includes('"'),o=e.includes("'");i&&!o?r=dR:o&&!i?r=og:r=n?dR:og}return r(e,t)}var mR;try{mR=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{mR=/\n+(?!\n|$)/g}function Fw({comment:e,type:t,value:n},r,i,o){let{blockQuote:s,commentString:a,lineWidth:l}=r.options;if(!s||/\n[\t ]+$/.test(n))return Gp(n,r);let c=r.indent||(r.forceBlockIndent||zw(n)?"  ":""),u=s==="literal"?!0:s==="folded"||t===Ee.BLOCK_FOLDED?!1:t===Ee.BLOCK_LITERAL?!0:!tJ(n,l,c.length);if(!n)return u?`|
`:`>
`;let f,p;for(p=n.length;p>0;--p){let S=n[p-1];if(S!==`
`&&S!=="	"&&S!==" ")break}let d=n.substring(p),h=d.indexOf(`
`);h===-1?f="-":n===d||h!==d.length-1?(f="+",o&&o()):f="",d&&(n=n.slice(0,-d.length),d[d.length-1]===`
`&&(d=d.slice(0,-1)),d=d.replace(mR,`$&${c}`));let m=!1,v,g=-1;for(v=0;v<n.length;++v){let S=n[v];if(S===" ")m=!0;else if(S===`
`)g=v;else break}let y=n.substring(0,g<v?g+1:v);y&&(n=n.substring(y.length),y=y.replace(/\n+/g,`$&${c}`));let w=(m?c?"2":"1":"")+f;if(e&&(w+=" "+a(e.replace(/ ?[\r\n]+/g," ")),i&&i()),!u){let S=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`),C=!1,x=Bw(r,!0);s!=="folded"&&t!==Ee.BLOCK_FOLDED&&(x.onOverflow=()=>{C=!0});let E=ig(`${y}${S}${d}`,c,Lw,x);if(!C)return`>${w}
${c}${E}`}return n=n.replace(/\n+/g,`$&${c}`),`|${w}
${c}${y}${n}${d}`}function nJ(e,t,n,r){let{type:i,value:o}=e,{actualString:s,implicitKey:a,indent:l,indentStep:c,inFlow:u}=t;if(a&&o.includes(`
`)||u&&/[[\]{},]/.test(o))return Gp(o,t);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(o))return a||u||!o.includes(`
`)?Gp(o,t):Fw(e,t,n,r);if(!a&&!u&&i!==Ee.PLAIN&&o.includes(`
`))return Fw(e,t,n,r);if(zw(o)){if(l==="")return t.forceBlockIndent=!0,Fw(e,t,n,r);if(a&&l===c)return Gp(o,t)}let f=o.replace(/\n+/g,`$&
${l}`);if(s){let p=m=>m.default&&m.tag!=="tag:yaml.org,2002:str"&&m.test?.test(f),{compat:d,tags:h}=t.doc.schema;if(h.some(p)||d?.some(p))return Gp(o,t)}return a?f:ig(f,l,pR,Bw(t,!1))}function $u(e,t,n,r){let{implicitKey:i,inFlow:o}=t,s=typeof e.value=="string"?e:Object.assign({},e,{value:String(e.value)}),{type:a}=e;a!==Ee.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(s.value)&&(a=Ee.QUOTE_DOUBLE);let l=u=>{switch(u){case Ee.BLOCK_FOLDED:case Ee.BLOCK_LITERAL:return i||o?Gp(s.value,t):Fw(s,t,n,r);case Ee.QUOTE_DOUBLE:return og(s.value,t);case Ee.QUOTE_SINGLE:return dR(s.value,t);case Ee.PLAIN:return nJ(s,t,n,r);default:return null}},c=l(a);if(c===null){let{defaultKeyType:u,defaultStringType:f}=t.options,p=i&&u||f;if(c=l(p),c===null)throw new Error(`Unsupported default string type ${p}`)}return c}function Hw(e,t){let n=Object.assign({blockQuote:!0,commentString:MF,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t),r;switch(n.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:e,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:r,options:n}}function rJ(e,t){if(t.tag){let i=e.filter(o=>o.tag===t.tag);if(i.length>0)return i.find(o=>o.format===t.format)??i[0]}let n,r;if(_e(t)){r=t.value;let i=e.filter(o=>o.identify?.(r));if(i.length>1){let o=i.filter(s=>s.test);o.length>0&&(i=o)}n=i.find(o=>o.format===t.format)??i.find(o=>!o.format)}else r=t,n=e.find(i=>i.nodeClass&&r instanceof i.nodeClass);if(!n){let i=r?.constructor?.name??(r===null?"null":typeof r);throw new Error(`Tag not resolved for ${i} value`)}return n}function iJ(e,t,{anchors:n,doc:r}){if(!r.directives)return"";let i=[],o=(_e(e)||wt(e))&&e.anchor;o&&kw(o)&&(n.add(o),i.push(`&${o}`));let s=e.tag??(t.default?null:t.tag);return s&&i.push(r.directives.tagString(s)),i.join(" ")}function il(e,t,n,r){if(nt(e))return e.toString(t,n,r);if(Po(e)){if(t.doc.directives)return e.toString(t);if(t.resolvedAliases?.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let i,o=Xe(e)?e:t.doc.createNode(e,{onTagObj:l=>i=l});i??(i=rJ(t.doc.schema.tags,o));let s=iJ(o,i,t);s.length>0&&(t.indentAtStart=(t.indentAtStart??0)+s.length+1);let a=typeof i.stringify=="function"?i.stringify(o,t,n,r):_e(o)?$u(o,t,n,r):o.toString(t,n,r);return s?_e(o)||a[0]==="{"||a[0]==="["?`${s} ${a}`:`${s}
${t.indent}${a}`:a}function NF({key:e,value:t},n,r,i){let{allNullValues:o,doc:s,indent:a,indentStep:l,options:{commentString:c,indentSeq:u,simpleKeys:f}}=n,p=Xe(e)&&e.comment||null;if(f){if(p)throw new Error("With simple keys, key nodes cannot have comments");if(wt(e)||!Xe(e)&&typeof e=="object"){let x="With simple keys, collection cannot be used as a key value";throw new Error(x)}}let d=!f&&(!e||p&&t==null&&!n.inFlow||wt(e)||(_e(e)?e.type===Ee.BLOCK_FOLDED||e.type===Ee.BLOCK_LITERAL:typeof e=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!d&&(f||!o),indent:a+l});let h=!1,m=!1,v=il(e,n,()=>h=!0,()=>m=!0);if(!d&&!n.inFlow&&v.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");d=!0}if(n.inFlow){if(o||t==null)return h&&r&&r(),v===""?"?":d?`? ${v}`:v}else if(o&&!f||t==null&&d)return v=`? ${v}`,p&&!h?v+=ma(v,n.indent,c(p)):m&&i&&i(),v;h&&(p=null),d?(p&&(v+=ma(v,n.indent,c(p))),v=`? ${v}
${a}:`):(v=`${v}:`,p&&(v+=ma(v,n.indent,c(p))));let g,y,b;Xe(t)?(g=!!t.spaceBefore,y=t.commentBefore,b=t.comment):(g=!1,y=null,b=null,t&&typeof t=="object"&&(t=s.createNode(t))),n.implicitKey=!1,!d&&!p&&_e(t)&&(n.indentAtStart=v.length+1),m=!1,!u&&l.length>=2&&!n.inFlow&&!d&&io(t)&&!t.flow&&!t.tag&&!t.anchor&&(n.indent=n.indent.substring(2));let w=!1,S=il(t,n,()=>w=!0,()=>m=!0),C=" ";if(p||g||y){if(C=g?`
`:"",y){let x=c(y);C+=`
${ko(x,n.indent)}`}S===""&&!n.inFlow?C===`
`&&b&&(C=`

`):C+=`
${n.indent}`}else if(!d&&wt(t)){let x=S[0],E=S.indexOf(`
`),T=E!==-1,A=n.inFlow??t.flow??t.items.length===0;if(T||!A){let M=!1;if(T&&(x==="&"||x==="!")){let R=S.indexOf(" ");x==="&"&&R!==-1&&R<E&&S[R+1]==="!"&&(R=S.indexOf(" ",R+1)),(R===-1||E<R)&&(M=!0)}M||(C=`
${n.indent}`)}}else(S===""||S[0]===`
`)&&(C="");return v+=C+S,n.inFlow?w&&r&&r():b&&!w?v+=ma(v,n.indent,c(b)):m&&i&&i(),v}function Uw(e,t){(e==="debug"||e==="warn")&&console.warn(t)}var $w="<<",xs={identify:e=>e===$w||typeof e=="symbol"&&e.description===$w,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new Ee(Symbol($w)),{addToJSMap:gR}),stringify:()=>$w},DF=(e,t)=>(xs.identify(t)||_e(t)&&(!t.type||t.type===Ee.PLAIN)&&xs.identify(t.value))&&e?.doc.schema.tags.some(n=>n.tag===xs.tag&&n.default);function gR(e,t,n){if(n=e&&Po(n)?n.resolve(e.doc):n,io(n))for(let r of n.items)hR(e,t,r);else if(Array.isArray(n))for(let r of n)hR(e,t,r);else hR(e,t,n)}function hR(e,t,n){let r=e&&Po(n)?n.resolve(e.doc):n;if(!hr(r))throw new Error("Merge sources must be maps or map aliases");let i=r.toJSON(null,e,Map);for(let[o,s]of i)t instanceof Map?t.has(o)||t.set(o,s):t instanceof Set?t.add(o):Object.prototype.hasOwnProperty.call(t,o)||Object.defineProperty(t,o,{value:s,writable:!0,enumerable:!0,configurable:!0});return t}function jw(e,t,{key:n,value:r}){if(Xe(n)&&n.addToJSMap)n.addToJSMap(e,t,r);else if(DF(e,n))gR(e,t,r);else{let i=tr(n,"",e);if(t instanceof Map)t.set(i,tr(r,i,e));else if(t instanceof Set)t.add(i);else{let o=oJ(n,i,e),s=tr(r,o,e);o in t?Object.defineProperty(t,o,{value:s,writable:!0,enumerable:!0,configurable:!0}):t[o]=s}}return t}function oJ(e,t,n){if(t===null)return"";if(typeof t!="object")return String(t);if(Xe(e)&&n?.doc){let r=Hw(n.doc,{});r.anchors=new Set;for(let o of n.anchors.keys())r.anchors.add(o.anchor);r.inFlow=!0,r.inStringifyKey=!0;let i=e.toString(r);if(!n.mapKeyWarned){let o=JSON.stringify(i);o.length>40&&(o=o.substring(0,36)+'..."'),Uw(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${o}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return i}return JSON.stringify(t)}function Kp(e,t,n){let r=rl(e,void 0,n),i=rl(t,void 0,n);return new $t(r,i)}var $t=class e{constructor(t,n=null){Object.defineProperty(this,ci,{value:cR}),this.key=t,this.value=n}clone(t){let{key:n,value:r}=this;return Xe(n)&&(n=n.clone(t)),Xe(r)&&(r=r.clone(t)),new e(n,r)}toJSON(t,n){let r=n?.mapAsMap?new Map:{};return jw(n,r,this)}toString(t,n,r){return t?.doc?NF(this,t,n,r):JSON.stringify(this)}};function Gw(e,t,n){return(t.inFlow??e.flow?aJ:sJ)(e,t,n)}function sJ({comment:e,items:t},n,{blockItemPrefix:r,flowChars:i,itemIndent:o,onChompKeep:s,onComment:a}){let{indent:l,options:{commentString:c}}=n,u=Object.assign({},n,{indent:o,type:null}),f=!1,p=[];for(let h=0;h<t.length;++h){let m=t[h],v=null;if(Xe(m))!f&&m.spaceBefore&&p.push(""),qw(n,p,m.commentBefore,f),m.comment&&(v=m.comment);else if(nt(m)){let y=Xe(m.key)?m.key:null;y&&(!f&&y.spaceBefore&&p.push(""),qw(n,p,y.commentBefore,f))}f=!1;let g=il(m,u,()=>v=null,()=>f=!0);v&&(g+=ma(g,o,c(v))),f&&v&&(f=!1),p.push(r+g)}let d;if(p.length===0)d=i.start+i.end;else{d=p[0];for(let h=1;h<p.length;++h){let m=p[h];d+=m?`
${l}${m}`:`
`}}return e?(d+=`
`+ko(c(e),l),a&&a()):f&&s&&s(),d}function aJ({items:e},t,{flowChars:n,itemIndent:r}){let{indent:i,indentStep:o,flowCollectionPadding:s,options:{commentString:a}}=t;r+=o;let l=Object.assign({},t,{indent:r,inFlow:!0,type:null}),c=!1,u=0,f=[];for(let h=0;h<e.length;++h){let m=e[h],v=null;if(Xe(m))m.spaceBefore&&f.push(""),qw(t,f,m.commentBefore,!1),m.comment&&(v=m.comment);else if(nt(m)){let y=Xe(m.key)?m.key:null;y&&(y.spaceBefore&&f.push(""),qw(t,f,y.commentBefore,!1),y.comment&&(c=!0));let b=Xe(m.value)?m.value:null;b?(b.comment&&(v=b.comment),b.commentBefore&&(c=!0)):m.value==null&&y?.comment&&(v=y.comment)}v&&(c=!0);let g=il(m,l,()=>v=null);h<e.length-1&&(g+=","),v&&(g+=ma(g,r,a(v))),!c&&(f.length>u||g.includes(`
`))&&(c=!0),f.push(g),u=f.length}let{start:p,end:d}=n;if(f.length===0)return p+d;if(!c){let h=f.reduce((m,v)=>m+v.length+2,2);c=t.options.lineWidth>0&&h>t.options.lineWidth}if(c){let h=p;for(let m of f)h+=m?`
${o}${i}${m}`:`
`;return`${h}
${i}${d}`}else return`${p}${s}${f.join(" ")}${s}${d}`}function qw({indent:e,options:{commentString:t}},n,r,i){if(r&&i&&(r=r.replace(/^\n+/,"")),r){let o=ko(t(r),e);n.push(o.trimStart())}}function uc(e,t){let n=_e(t)?t.value:t;for(let r of e)if(nt(r)&&(r.key===t||r.key===n||_e(r.key)&&r.key.value===n))return r}var Qt=class extends jp{static get tagName(){return"tag:yaml.org,2002:map"}constructor(t){super(ws,t),this.items=[]}static from(t,n,r){let{keepUndefined:i,replacer:o}=r,s=new this(t),a=(l,c)=>{if(typeof o=="function")c=o.call(n,l,c);else if(Array.isArray(o)&&!o.includes(l))return;(c!==void 0||i)&&s.items.push(Kp(l,c,r))};if(n instanceof Map)for(let[l,c]of n)a(l,c);else if(n&&typeof n=="object")for(let l of Object.keys(n))a(l,n[l]);return typeof t.sortMapEntries=="function"&&s.items.sort(t.sortMapEntries),s}add(t,n){let r;nt(t)?r=t:!t||typeof t!="object"||!("key"in t)?r=new $t(t,t?.value):r=new $t(t.key,t.value);let i=uc(this.items,r.key),o=this.schema?.sortMapEntries;if(i){if(!n)throw new Error(`Key ${r.key} already set`);_e(i.value)&&Vw(r.value)?i.value.value=r.value:i.value=r.value}else if(o){let s=this.items.findIndex(a=>o(r,a)<0);s===-1?this.items.push(r):this.items.splice(s,0,r)}else this.items.push(r)}delete(t){let n=uc(this.items,t);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(t,n){let i=uc(this.items,t)?.value;return(!n&&_e(i)?i.value:i)??void 0}has(t){return!!uc(this.items,t)}set(t,n){this.add(new $t(t,n),!0)}toJSON(t,n,r){let i=r?new r:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(i);for(let o of this.items)jw(n,i,o);return i}toString(t,n,r){if(!t)return JSON.stringify(this);for(let i of this.items)if(!nt(i))throw new Error(`Map items must all be pairs; found ${JSON.stringify(i)} instead`);return!t.allNullValues&&this.hasAllNullValues(!1)&&(t=Object.assign({},t,{allNullValues:!0})),Gw(this,t,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:t.indent||"",onChompKeep:r,onComment:n})}};var Es={collection:"map",default:!0,nodeClass:Qt,tag:"tag:yaml.org,2002:map",resolve(e,t){return hr(e)||t("Expected a mapping for this tag"),e},createNode:(e,t,n)=>Qt.from(e,t,n)};var nr=class extends jp{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(t){super(tl,t),this.items=[]}add(t){this.items.push(t)}delete(t){let n=Kw(t);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(t,n){let r=Kw(t);if(typeof r!="number")return;let i=this.items[r];return!n&&_e(i)?i.value:i}has(t){let n=Kw(t);return typeof n=="number"&&n<this.items.length}set(t,n){let r=Kw(t);if(typeof r!="number")throw new Error(`Expected a valid index, not ${t}.`);let i=this.items[r];_e(i)&&Vw(n)?i.value=n:this.items[r]=n}toJSON(t,n){let r=[];n?.onCreate&&n.onCreate(r);let i=0;for(let o of this.items)r.push(tr(o,String(i++),n));return r}toString(t,n,r){return t?Gw(this,t,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(t.indent||"")+"  ",onChompKeep:r,onComment:n}):JSON.stringify(this)}static from(t,n,r){let{replacer:i}=r,o=new this(t);if(n&&Symbol.iterator in Object(n)){let s=0;for(let a of n){if(typeof i=="function"){let l=n instanceof Set?a:String(s++);a=i.call(n,l,a)}o.items.push(rl(a,void 0,r))}}return o}};function Kw(e){let t=_e(e)?e.value:e;return t&&typeof t=="string"&&(t=Number(t)),typeof t=="number"&&Number.isInteger(t)&&t>=0?t:null}var Cs={collection:"seq",default:!0,nodeClass:nr,tag:"tag:yaml.org,2002:seq",resolve(e,t){return io(e)||t("Expected a sequence for this tag"),e},createNode:(e,t,n)=>nr.from(e,t,n)};var fc={identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify(e,t,n,r){return t=Object.assign({actualString:!0},t),$u(e,t,n,r)}};var ju={identify:e=>e==null,createNode:()=>new Ee(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new Ee(null),stringify:({source:e},t)=>typeof e=="string"&&ju.test.test(e)?e:t.options.nullStr};var sg={identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new Ee(e[0]==="t"||e[0]==="T"),stringify({source:e,value:t},n){if(e&&sg.test.test(e)){let r=e[0]==="t"||e[0]==="T";if(t===r)return e}return t?n.options.trueStr:n.options.falseStr}};function jr({format:e,minFractionDigits:t,tag:n,value:r}){if(typeof r=="bigint")return String(r);let i=typeof r=="number"?r:Number(r);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let o=Object.is(r,-0)?"-0":JSON.stringify(r);if(!e&&t&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(o)){let s=o.indexOf(".");s<0&&(s=o.length,o+=".");let a=t-(o.length-s-1);for(;a-- >0;)o+="0"}return o}var Ww={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:jr},Yw={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){let t=Number(e.value);return isFinite(t)?t.toExponential():jr(e)}},Qw={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){let t=new Ee(parseFloat(e)),n=e.indexOf(".");return n!==-1&&e[e.length-1]==="0"&&(t.minFractionDigits=e.length-n-1),t},stringify:jr};var Xw=e=>typeof e=="bigint"||Number.isInteger(e),yR=(e,t,n,{intAsBigInt:r})=>r?BigInt(e):parseInt(e.substring(t),n);function IF(e,t,n){let{value:r}=e;return Xw(r)&&r>=0?n+r.toString(t):jr(e)}var Zw={identify:e=>Xw(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,n)=>yR(e,2,8,n),stringify:e=>IF(e,8,"0o")},Jw={identify:Xw,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,n)=>yR(e,0,10,n),stringify:jr},ex={identify:e=>Xw(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,n)=>yR(e,2,16,n),stringify:e=>IF(e,16,"0x")};var OF=[Es,Cs,fc,ju,sg,Zw,Jw,ex,Ww,Yw,Qw];function PF(e){return typeof e=="bigint"||Number.isInteger(e)}var tx=({value:e})=>JSON.stringify(e),lJ=[{identify:e=>typeof e=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:tx},{identify:e=>e==null,createNode:()=>new Ee(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:tx},{identify:e=>typeof e=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>e==="true",stringify:tx},{identify:PF,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:n})=>n?BigInt(e):parseInt(e,10),stringify:({value:e})=>PF(e)?e.toString():JSON.stringify(e)},{identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:tx}],cJ={default:!0,tag:"",test:/^/,resolve(e,t){return t(`Unresolved plain scalar ${JSON.stringify(e)}`),e}},kF=[Es,Cs].concat(lJ,cJ);var ag={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if(typeof atob=="function"){let n=atob(e.replace(/[\n\r]/g,"")),r=new Uint8Array(n.length);for(let i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}else return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:n},r,i,o){if(!n)return"";let s=n,a;if(typeof btoa=="function"){let l="";for(let c=0;c<s.length;++c)l+=String.fromCharCode(s[c]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(t??(t=Ee.BLOCK_LITERAL),t!==Ee.QUOTE_DOUBLE){let l=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),c=Math.ceil(a.length/l),u=new Array(c);for(let f=0,p=0;f<c;++f,p+=l)u[f]=a.substr(p,l);a=u.join(t===Ee.BLOCK_LITERAL?`
`:" ")}return $u({comment:e,type:t,value:a},r,i,o)}};function vR(e,t){if(io(e))for(let n=0;n<e.items.length;++n){let r=e.items[n];if(!nt(r)){if(hr(r)){r.items.length>1&&t("Each pair must have its own sequence indicator");let i=r.items[0]||new $t(new Ee(null));if(r.commentBefore&&(i.key.commentBefore=i.key.commentBefore?`${r.commentBefore}
${i.key.commentBefore}`:r.commentBefore),r.comment){let o=i.value??i.key;o.comment=o.comment?`${r.comment}
${o.comment}`:r.comment}r=i}e.items[n]=nt(r)?r:new $t(r)}}else t("Expected a sequence for this tag");return e}function bR(e,t,n){let{replacer:r}=n,i=new nr(e);i.tag="tag:yaml.org,2002:pairs";let o=0;if(t&&Symbol.iterator in Object(t))for(let s of t){typeof r=="function"&&(s=r.call(t,String(o++),s));let a,l;if(Array.isArray(s))if(s.length===2)a=s[0],l=s[1];else throw new TypeError(`Expected [key, value] tuple: ${s}`);else if(s&&s instanceof Object){let c=Object.keys(s);if(c.length===1)a=c[0],l=s[a];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else a=s;i.items.push(Kp(a,l,n))}return i}var lg={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:vR,createNode:bR};var Wp=class e extends nr{constructor(){super(),this.add=Qt.prototype.add.bind(this),this.delete=Qt.prototype.delete.bind(this),this.get=Qt.prototype.get.bind(this),this.has=Qt.prototype.has.bind(this),this.set=Qt.prototype.set.bind(this),this.tag=e.tag}toJSON(t,n){if(!n)return super.toJSON(t);let r=new Map;n?.onCreate&&n.onCreate(r);for(let i of this.items){let o,s;if(nt(i)?(o=tr(i.key,"",n),s=tr(i.value,o,n)):o=tr(i,"",n),r.has(o))throw new Error("Ordered maps must not include duplicate keys");r.set(o,s)}return r}static from(t,n,r){let i=bR(t,n,r),o=new this;return o.items=i.items,o}};Wp.tag="tag:yaml.org,2002:omap";var cg={collection:"seq",identify:e=>e instanceof Map,nodeClass:Wp,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){let n=vR(e,t),r=[];for(let{key:i}of n.items)_e(i)&&(r.includes(i.value)?t(`Ordered maps must not include duplicate keys: ${i.value}`):r.push(i.value));return Object.assign(new Wp,n)},createNode:(e,t,n)=>Wp.from(e,t,n)};function _F({value:e,source:t},n){return t&&(e?SR:wR).test.test(t)?t:e?n.options.trueStr:n.options.falseStr}var SR={identify:e=>e===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Ee(!0),stringify:_F},wR={identify:e=>e===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new Ee(!1),stringify:_F};var VF={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>e.slice(-3).toLowerCase()==="nan"?NaN:e[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:jr},LF={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){let t=Number(e.value);return isFinite(t)?t.toExponential():jr(e)}},FF={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){let t=new Ee(parseFloat(e.replace(/_/g,""))),n=e.indexOf(".");if(n!==-1){let r=e.substring(n+1).replace(/_/g,"");r[r.length-1]==="0"&&(t.minFractionDigits=r.length)}return t},stringify:jr};var ug=e=>typeof e=="bigint"||Number.isInteger(e);function nx(e,t,n,{intAsBigInt:r}){let i=e[0];if((i==="-"||i==="+")&&(t+=1),e=e.substring(t).replace(/_/g,""),r){switch(n){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`;break}let s=BigInt(e);return i==="-"?BigInt(-1)*s:s}let o=parseInt(e,n);return i==="-"?-1*o:o}function xR(e,t,n){let{value:r}=e;if(ug(r)){let i=r.toString(t);return r<0?"-"+n+i.substr(1):n+i}return jr(e)}var BF={identify:ug,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,n)=>nx(e,2,2,n),stringify:e=>xR(e,2,"0b")},zF={identify:ug,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,n)=>nx(e,1,8,n),stringify:e=>xR(e,8,"0")},HF={identify:ug,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,n)=>nx(e,0,10,n),stringify:jr},UF={identify:ug,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,n)=>nx(e,2,16,n),stringify:e=>xR(e,16,"0x")};var Yp=class e extends Qt{constructor(t){super(t),this.tag=e.tag}add(t){let n;nt(t)?n=t:t&&typeof t=="object"&&"key"in t&&"value"in t&&t.value===null?n=new $t(t.key,null):n=new $t(t,null),uc(this.items,n.key)||this.items.push(n)}get(t,n){let r=uc(this.items,t);return!n&&nt(r)?_e(r.key)?r.key.value:r.key:r}set(t,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);let r=uc(this.items,t);r&&!n?this.items.splice(this.items.indexOf(r),1):!r&&n&&this.items.push(new $t(t))}toJSON(t,n){return super.toJSON(t,n,Set)}toString(t,n,r){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),n,r);throw new Error("Set items must all have null values")}static from(t,n,r){let{replacer:i}=r,o=new this(t);if(n&&Symbol.iterator in Object(n))for(let s of n)typeof i=="function"&&(s=i.call(n,s,s)),o.items.push(Kp(s,null,r));return o}};Yp.tag="tag:yaml.org,2002:set";var fg={collection:"map",identify:e=>e instanceof Set,nodeClass:Yp,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,n)=>Yp.from(e,t,n),resolve(e,t){if(hr(e)){if(e.hasAllNullValues(!0))return Object.assign(new Yp,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};function ER(e,t){let n=e[0],r=n==="-"||n==="+"?e.substring(1):e,i=s=>t?BigInt(s):Number(s),o=r.replace(/_/g,"").split(":").reduce((s,a)=>s*i(60)+i(a),i(0));return n==="-"?i(-1)*o:o}function $F(e){let{value:t}=e,n=s=>s;if(typeof t=="bigint")n=s=>BigInt(s);else if(isNaN(t)||!isFinite(t))return jr(e);let r="";t<0&&(r="-",t*=n(-1));let i=n(60),o=[t%i];return t<60?o.unshift(0):(t=(t-o[0])/i,o.unshift(t%i),t>=60&&(t=(t-o[0])/i,o.unshift(t))),r+o.map(s=>String(s).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var rx={identify:e=>typeof e=="bigint"||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:n})=>ER(e,n),stringify:$F},ix={identify:e=>typeof e=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>ER(e,!1),stringify:$F},Qp={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){let t=e.match(Qp.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,n,r,i,o,s,a]=t.map(Number),l=t[7]?Number((t[7]+"00").substr(1,3)):0,c=Date.UTC(n,r-1,i,o||0,s||0,a||0,l),u=t[8];if(u&&u!=="Z"){let f=ER(u,!1);Math.abs(f)<30&&(f*=60),c-=6e4*f}return new Date(c)},stringify:({value:e})=>e?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""};var CR=[Es,Cs,fc,ju,SR,wR,BF,zF,HF,UF,VF,LF,FF,ag,xs,cg,lg,fg,rx,ix,Qp];var jF=new Map([["core",OF],["failsafe",[Es,Cs,fc]],["json",kF],["yaml11",CR],["yaml-1.1",CR]]),qF={binary:ag,bool:sg,float:Qw,floatExp:Yw,floatNaN:Ww,floatTime:ix,int:Jw,intHex:ex,intOct:Zw,intTime:rx,map:Es,merge:xs,null:ju,omap:cg,pairs:lg,seq:Cs,set:fg,timestamp:Qp},GF={"tag:yaml.org,2002:binary":ag,"tag:yaml.org,2002:merge":xs,"tag:yaml.org,2002:omap":cg,"tag:yaml.org,2002:pairs":lg,"tag:yaml.org,2002:set":fg,"tag:yaml.org,2002:timestamp":Qp};function ox(e,t,n){let r=jF.get(t);if(r&&!e)return n&&!r.includes(xs)?r.concat(xs):r.slice();let i=r;if(!i)if(Array.isArray(e))i=[];else{let o=Array.from(jF.keys()).filter(s=>s!=="yaml11").map(s=>JSON.stringify(s)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${o} or define customTags array`)}if(Array.isArray(e))for(let o of e)i=i.concat(o);else typeof e=="function"&&(i=e(i.slice()));return n&&(i=i.concat(xs)),i.reduce((o,s)=>{let a=typeof s=="string"?qF[s]:s;if(!a){let l=JSON.stringify(s),c=Object.keys(qF).map(u=>JSON.stringify(u)).join(", ");throw new Error(`Unknown custom tag ${l}; use one of ${c}`)}return o.includes(a)||o.push(a),o},[])}var uJ=(e,t)=>e.key<t.key?-1:e.key>t.key?1:0,pg=class e{constructor({compat:t,customTags:n,merge:r,resolveKnownTags:i,schema:o,sortMapEntries:s,toStringDefaults:a}){this.compat=Array.isArray(t)?ox(t,"compat"):t?ox(null,t):null,this.name=typeof o=="string"&&o||"core",this.knownTags=i?GF:{},this.tags=ox(n,this.name,r),this.toStringOptions=a??null,Object.defineProperty(this,ws,{value:Es}),Object.defineProperty(this,ro,{value:fc}),Object.defineProperty(this,tl,{value:Cs}),this.sortMapEntries=typeof s=="function"?s:s===!0?uJ:null}clone(){let t=Object.create(e.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}};function KF(e,t){let n=[],r=t.directives===!0;if(t.directives!==!1&&e.directives){let l=e.directives.toString(e);l?(n.push(l),r=!0):e.directives.docStart&&(r=!0)}r&&n.push("---");let i=Hw(e,t),{commentString:o}=i.options;if(e.commentBefore){n.length!==1&&n.unshift("");let l=o(e.commentBefore);n.unshift(ko(l,""))}let s=!1,a=null;if(e.contents){if(Xe(e.contents)){if(e.contents.spaceBefore&&r&&n.push(""),e.contents.commentBefore){let u=o(e.contents.commentBefore);n.push(ko(u,""))}i.forceBlockIndent=!!e.comment,a=e.contents.comment}let l=a?void 0:()=>s=!0,c=il(e.contents,i,()=>a=null,l);a&&(c+=ma(c,"",o(a))),(c[0]==="|"||c[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${c}`:n.push(c)}else n.push(il(e.contents,i));if(e.directives?.docEnd)if(e.comment){let l=o(e.comment);l.includes(`
`)?(n.push("..."),n.push(ko(l,""))):n.push(`... ${l}`)}else n.push("...");else{let l=e.comment;l&&s&&(l=l.replace(/^\n+/,"")),l&&((!s||a)&&n[n.length-1]!==""&&n.push(""),n.push(ko(o(l),"")))}return n.join(`
`)+`
`}var oo=class e{constructor(t,n,r){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,ci,{value:Iw});let i=null;typeof n=="function"||Array.isArray(n)?i=n:r===void 0&&n&&(r=n,n=void 0);let o=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},r);this.options=o;let{version:s}=o;r?._directives?(this.directives=r._directives.atDocument(),this.directives.yaml.explicit&&(s=this.directives.yaml.version)):this.directives=new da({version:s}),this.setSchema(s,r),this.contents=t===void 0?null:this.createNode(t,i,r)}clone(){let t=Object.create(e.prototype,{[ci]:{value:Iw}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=Xe(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){Xp(this.contents)&&this.contents.add(t)}addIn(t,n){Xp(this.contents)&&this.contents.addIn(t,n)}createAlias(t,n){if(!t.anchor){let r=uR(this);t.anchor=!n||r.has(n)?fR(n||"a",r):n}return new nl(t.anchor)}createNode(t,n,r){let i;if(typeof n=="function")t=n.call({"":t},"",t),i=n;else if(Array.isArray(n)){let v=y=>typeof y=="number"||y instanceof String||y instanceof Number,g=n.filter(v).map(String);g.length>0&&(n=n.concat(g)),i=n}else r===void 0&&n&&(r=n,n=void 0);let{aliasDuplicateObjects:o,anchorPrefix:s,flow:a,keepUndefined:l,onTagObj:c,tag:u}=r??{},{onAnchor:f,setAnchors:p,sourceObjects:d}=AF(this,s||"a"),h={aliasDuplicateObjects:o??!0,keepUndefined:l??!1,onAnchor:f,onTagObj:c,replacer:i,schema:this.schema,sourceObjects:d},m=rl(t,u,h);return a&&wt(m)&&(m.flow=!0),p(),m}createPair(t,n,r={}){let i=this.createNode(t,null,r),o=this.createNode(n,null,r);return new $t(i,o)}delete(t){return Xp(this.contents)?this.contents.delete(t):!1}deleteIn(t){return qp(t)?this.contents==null?!1:(this.contents=null,!0):Xp(this.contents)?this.contents.deleteIn(t):!1}get(t,n){return wt(this.contents)?this.contents.get(t,n):void 0}getIn(t,n){return qp(t)?!n&&_e(this.contents)?this.contents.value:this.contents:wt(this.contents)?this.contents.getIn(t,n):void 0}has(t){return wt(this.contents)?this.contents.has(t):!1}hasIn(t){return qp(t)?this.contents!==void 0:wt(this.contents)?this.contents.hasIn(t):!1}set(t,n){this.contents==null?this.contents=ng(this.schema,[t],n):Xp(this.contents)&&this.contents.set(t,n)}setIn(t,n){qp(t)?this.contents=n:this.contents==null?this.contents=ng(this.schema,Array.from(t),n):Xp(this.contents)&&this.contents.setIn(t,n)}setSchema(t,n={}){typeof t=="number"&&(t=String(t));let r;switch(t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new da({version:"1.1"}),r={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new da({version:t}),r={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,r=null;break;default:{let i=JSON.stringify(t);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(r)this.schema=new pg(Object.assign(r,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:n,mapAsMap:r,maxAliasCount:i,onAnchor:o,reviver:s}={}){let a={anchors:new Map,doc:this,keep:!t,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},l=tr(this.contents,n??"",a);if(typeof o=="function")for(let{count:c,res:u}of a.anchors.values())o(u,c);return typeof s=="function"?lc(s,{"":l},"",l):l}toJSON(t,n){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:n})}toString(t={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||Number(t.indent)<=0)){let n=JSON.stringify(t.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return KF(this,t)}};function Xp(e){if(wt(e))return!0;throw new Error("Expected a YAML collection as document contents")}var dg=class extends Error{constructor(t,n,r,i){super(),this.name=t,this.code=r,this.message=i,this.pos=n}},Ts=class extends dg{constructor(t,n,r){super("YAMLParseError",t,n,r)}},mg=class extends dg{constructor(t,n,r){super("YAMLWarning",t,n,r)}},TR=(e,t)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(a=>t.linePos(a));let{line:r,col:i}=n.linePos[0];n.message+=` at line ${r}, column ${i}`;let o=i-1,s=e.substring(t.lineStarts[r-1],t.lineStarts[r]).replace(/[\n\r]+$/,"");if(o>=60&&s.length>80){let a=Math.min(o-39,s.length-79);s="\u2026"+s.substring(a),o-=a-1}if(s.length>80&&(s=s.substring(0,79)+"\u2026"),r>1&&/^ *$/.test(s.substring(0,o))){let a=e.substring(t.lineStarts[r-2],t.lineStarts[r-1]);a.length>80&&(a=a.substring(0,79)+`\u2026
`),s=a+s}if(/[^ ]/.test(s)){let a=1,l=n.linePos[1];l?.line===r&&l.col>i&&(a=Math.max(1,Math.min(l.col-i,80-o)));let c=" ".repeat(o)+"^".repeat(a);n.message+=`:

${s}
${c}
`}};function ha(e,{flow:t,indicator:n,next:r,offset:i,onError:o,parentIndent:s,startOnNewline:a}){let l=!1,c=a,u=a,f="",p="",d=!1,h=!1,m=null,v=null,g=null,y=null,b=null,w=null,S=null;for(let E of e)switch(h&&(E.type!=="space"&&E.type!=="newline"&&E.type!=="comma"&&o(E.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),h=!1),m&&(c&&E.type!=="comment"&&E.type!=="newline"&&o(m,"TAB_AS_INDENT","Tabs are not allowed as indentation"),m=null),E.type){case"space":!t&&(n!=="doc-start"||r?.type!=="flow-collection")&&E.source.includes("	")&&(m=E),u=!0;break;case"comment":{u||o(E,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let T=E.source.substring(1)||" ";f?f+=p+T:f=T,p="",c=!1;break}case"newline":c?f?f+=E.source:(!w||n!=="seq-item-ind")&&(l=!0):p+=E.source,c=!0,d=!0,(v||g)&&(y=E),u=!0;break;case"anchor":v&&o(E,"MULTIPLE_ANCHORS","A node can have at most one anchor"),E.source.endsWith(":")&&o(E.offset+E.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),v=E,S??(S=E.offset),c=!1,u=!1,h=!0;break;case"tag":{g&&o(E,"MULTIPLE_TAGS","A node can have at most one tag"),g=E,S??(S=E.offset),c=!1,u=!1,h=!0;break}case n:(v||g)&&o(E,"BAD_PROP_ORDER",`Anchors and tags must be after the ${E.source} indicator`),w&&o(E,"UNEXPECTED_TOKEN",`Unexpected ${E.source} in ${t??"collection"}`),w=E,c=n==="seq-item-ind"||n==="explicit-key-ind",u=!1;break;case"comma":if(t){b&&o(E,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),b=E,c=!1,u=!1;break}default:o(E,"UNEXPECTED_TOKEN",`Unexpected ${E.type} token`),c=!1,u=!1}let C=e[e.length-1],x=C?C.offset+C.source.length:i;return h&&r&&r.type!=="space"&&r.type!=="newline"&&r.type!=="comma"&&(r.type!=="scalar"||r.source!=="")&&o(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),m&&(c&&m.indent<=s||r?.type==="block-map"||r?.type==="block-seq")&&o(m,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:b,found:w,spaceBefore:l,comment:f,hasNewline:d,anchor:v,tag:g,newlineAfterProp:y,end:x,start:S??x}}function pc(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes(`
`))return!0;if(e.end){for(let t of e.end)if(t.type==="newline")return!0}return!1;case"flow-collection":for(let t of e.items){for(let n of t.start)if(n.type==="newline")return!0;if(t.sep){for(let n of t.sep)if(n.type==="newline")return!0}if(pc(t.key)||pc(t.value))return!0}return!1;default:return!0}}function hg(e,t,n){if(t?.type==="flow-collection"){let r=t.end[0];r.indent===e&&(r.source==="]"||r.source==="}")&&pc(t)&&n(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function sx(e,t,n){let{uniqueKeys:r}=e.options;if(r===!1)return!1;let i=typeof r=="function"?r:(o,s)=>o===s||_e(o)&&_e(s)&&o.value===s.value;return t.some(o=>i(o.key,n))}var WF="All mapping items must start at the same column";function YF({composeNode:e,composeEmptyNode:t},n,r,i,o){let s=o?.nodeClass??Qt,a=new s(n.schema);n.atRoot&&(n.atRoot=!1);let l=r.offset,c=null;for(let u of r.items){let{start:f,key:p,sep:d,value:h}=u,m=ha(f,{indicator:"explicit-key-ind",next:p??d?.[0],offset:l,onError:i,parentIndent:r.indent,startOnNewline:!0}),v=!m.found;if(v){if(p&&(p.type==="block-seq"?i(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in p&&p.indent!==r.indent&&i(l,"BAD_INDENT",WF)),!m.anchor&&!m.tag&&!d){c=m.end,m.comment&&(a.comment?a.comment+=`
`+m.comment:a.comment=m.comment);continue}(m.newlineAfterProp||pc(p))&&i(p??f[f.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else m.found?.indent!==r.indent&&i(l,"BAD_INDENT",WF);n.atKey=!0;let g=m.end,y=p?e(n,p,m,i):t(n,g,f,null,m,i);n.schema.compat&&hg(r.indent,p,i),n.atKey=!1,sx(n,a.items,y)&&i(g,"DUPLICATE_KEY","Map keys must be unique");let b=ha(d??[],{indicator:"map-value-ind",next:h,offset:y.range[2],onError:i,parentIndent:r.indent,startOnNewline:!p||p.type==="block-scalar"});if(l=b.end,b.found){v&&(h?.type==="block-map"&&!b.hasNewline&&i(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&m.start<b.found.offset-1024&&i(y.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let w=h?e(n,h,b,i):t(n,l,d,null,b,i);n.schema.compat&&hg(r.indent,h,i),l=w.range[2];let S=new $t(y,w);n.options.keepSourceTokens&&(S.srcToken=u),a.items.push(S)}else{v&&i(y.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),b.comment&&(y.comment?y.comment+=`
`+b.comment:y.comment=b.comment);let w=new $t(y);n.options.keepSourceTokens&&(w.srcToken=u),a.items.push(w)}}return c&&c<l&&i(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[r.offset,l,c??l],a}function QF({composeNode:e,composeEmptyNode:t},n,r,i,o){let s=o?.nodeClass??nr,a=new s(n.schema);n.atRoot&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let l=r.offset,c=null;for(let{start:u,value:f}of r.items){let p=ha(u,{indicator:"seq-item-ind",next:f,offset:l,onError:i,parentIndent:r.indent,startOnNewline:!0});if(!p.found)if(p.anchor||p.tag||f)f?.type==="block-seq"?i(p.end,"BAD_INDENT","All sequence items must start at the same column"):i(l,"MISSING_CHAR","Sequence item without - indicator");else{c=p.end,p.comment&&(a.comment=p.comment);continue}let d=f?e(n,f,p,i):t(n,p.end,u,null,p,i);n.schema.compat&&hg(r.indent,f,i),l=d.range[2],a.items.push(d)}return a.range=[r.offset,l,c??l],a}function ga(e,t,n,r){let i="";if(e){let o=!1,s="";for(let a of e){let{source:l,type:c}=a;switch(c){case"space":o=!0;break;case"comment":{n&&!o&&r(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let u=l.substring(1)||" ";i?i+=s+u:i=u,s="";break}case"newline":i&&(s+=l),o=!0;break;default:r(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}t+=l.length}}return{comment:i,offset:t}}var AR="Block collections are not allowed within flow collections",MR=e=>e&&(e.type==="block-map"||e.type==="block-seq");function XF({composeNode:e,composeEmptyNode:t},n,r,i,o){let s=r.start.source==="{",a=s?"flow map":"flow sequence",l=o?.nodeClass??(s?Qt:nr),c=new l(n.schema);c.flow=!0;let u=n.atRoot;u&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let f=r.offset+r.start.source.length;for(let v=0;v<r.items.length;++v){let g=r.items[v],{start:y,key:b,sep:w,value:S}=g,C=ha(y,{flow:a,indicator:"explicit-key-ind",next:b??w?.[0],offset:f,onError:i,parentIndent:r.indent,startOnNewline:!1});if(!C.found){if(!C.anchor&&!C.tag&&!w&&!S){v===0&&C.comma?i(C.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):v<r.items.length-1&&i(C.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),C.comment&&(c.comment?c.comment+=`
`+C.comment:c.comment=C.comment),f=C.end;continue}!s&&n.options.strict&&pc(b)&&i(b,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(v===0)C.comma&&i(C.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(C.comma||i(C.start,"MISSING_CHAR",`Missing , between ${a} items`),C.comment){let x="";e:for(let E of y)switch(E.type){case"comma":case"space":break;case"comment":x=E.source.substring(1);break e;default:break e}if(x){let E=c.items[c.items.length-1];nt(E)&&(E=E.value??E.key),E.comment?E.comment+=`
`+x:E.comment=x,C.comment=C.comment.substring(x.length+1)}}if(!s&&!w&&!C.found){let x=S?e(n,S,C,i):t(n,C.end,w,null,C,i);c.items.push(x),f=x.range[2],MR(S)&&i(x.range,"BLOCK_IN_FLOW",AR)}else{n.atKey=!0;let x=C.end,E=b?e(n,b,C,i):t(n,x,y,null,C,i);MR(b)&&i(E.range,"BLOCK_IN_FLOW",AR),n.atKey=!1;let T=ha(w??[],{flow:a,indicator:"map-value-ind",next:S,offset:E.range[2],onError:i,parentIndent:r.indent,startOnNewline:!1});if(T.found){if(!s&&!C.found&&n.options.strict){if(w)for(let R of w){if(R===T.found)break;if(R.type==="newline"){i(R,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}C.start<T.found.offset-1024&&i(T.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else S&&("source"in S&&S.source?.[0]===":"?i(S,"MISSING_CHAR",`Missing space after : in ${a}`):i(T.start,"MISSING_CHAR",`Missing , or : between ${a} items`));let A=S?e(n,S,T,i):T.found?t(n,T.end,w,null,T,i):null;A?MR(S)&&i(A.range,"BLOCK_IN_FLOW",AR):T.comment&&(E.comment?E.comment+=`
`+T.comment:E.comment=T.comment);let M=new $t(E,A);if(n.options.keepSourceTokens&&(M.srcToken=g),s){let R=c;sx(n,R.items,E)&&i(x,"DUPLICATE_KEY","Map keys must be unique"),R.items.push(M)}else{let R=new Qt(n.schema);R.flow=!0,R.items.push(M);let N=(A??E).range;R.range=[E.range[0],N[1],N[2]],c.items.push(R)}f=A?A.range[2]:T.end}}let p=s?"}":"]",[d,...h]=r.end,m=f;if(d?.source===p)m=d.offset+d.source.length;else{let v=a[0].toUpperCase()+a.substring(1),g=u?`${v} must end with a ${p}`:`${v} in block collection must be sufficiently indented and end with a ${p}`;i(f,u?"MISSING_CHAR":"BAD_INDENT",g),d&&d.source.length!==1&&h.unshift(d)}if(h.length>0){let v=ga(h,m,n.options.strict,i);v.comment&&(c.comment?c.comment+=`
`+v.comment:c.comment=v.comment),c.range=[r.offset,m,v.offset]}else c.range=[r.offset,m,m];return c}function RR(e,t,n,r,i,o){let s=n.type==="block-map"?YF(e,t,n,r,o):n.type==="block-seq"?QF(e,t,n,r,o):XF(e,t,n,r,o),a=s.constructor;return i==="!"||i===a.tagName?(s.tag=a.tagName,s):(i&&(s.tag=i),s)}function ZF(e,t,n,r,i){let o=r.tag,s=o?t.directives.tagName(o.source,p=>i(o,"TAG_RESOLVE_FAILED",p)):null;if(n.type==="block-seq"){let{anchor:p,newlineAfterProp:d}=r,h=p&&o?p.offset>o.offset?p:o:p??o;h&&(!d||d.offset<h.offset)&&i(h,"MISSING_CHAR","Missing newline after block sequence props")}let a=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!o||!s||s==="!"||s===Qt.tagName&&a==="map"||s===nr.tagName&&a==="seq")return RR(e,t,n,i,s);let l=t.schema.tags.find(p=>p.tag===s&&p.collection===a);if(!l){let p=t.schema.knownTags[s];if(p?.collection===a)t.schema.tags.push(Object.assign({},p,{default:!1})),l=p;else return p?i(o,"BAD_COLLECTION_TYPE",`${p.tag} used for ${a} collection, but expects ${p.collection??"scalar"}`,!0):i(o,"TAG_RESOLVE_FAILED",`Unresolved tag: ${s}`,!0),RR(e,t,n,i,s)}let c=RR(e,t,n,i,s,l),u=l.resolve?.(c,p=>i(o,"TAG_RESOLVE_FAILED",p),t.options)??c,f=Xe(u)?u:new Ee(u);return f.range=c.range,f.tag=s,l?.format&&(f.format=l.format),f}function NR(e,t,n){let r=t.offset,i=fJ(t,e.options.strict,n);if(!i)return{value:"",type:null,comment:"",range:[r,r,r]};let o=i.mode===">"?Ee.BLOCK_FOLDED:Ee.BLOCK_LITERAL,s=t.source?pJ(t.source):[],a=s.length;for(let m=s.length-1;m>=0;--m){let v=s[m][1];if(v===""||v==="\r")a=m;else break}if(a===0){let m=i.chomp==="+"&&s.length>0?`
`.repeat(Math.max(1,s.length-1)):"",v=r+i.length;return t.source&&(v+=t.source.length),{value:m,type:o,comment:i.comment,range:[r,v,v]}}let l=t.indent+i.indent,c=t.offset+i.length,u=0;for(let m=0;m<a;++m){let[v,g]=s[m];if(g===""||g==="\r")i.indent===0&&v.length>l&&(l=v.length);else{v.length<l&&n(c+v.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),i.indent===0&&(l=v.length),u=m,l===0&&!e.atRoot&&n(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=v.length+g.length+1}for(let m=s.length-1;m>=a;--m)s[m][0].length>l&&(a=m+1);let f="",p="",d=!1;for(let m=0;m<u;++m)f+=s[m][0].slice(l)+`
`;for(let m=u;m<a;++m){let[v,g]=s[m];c+=v.length+g.length+1;let y=g[g.length-1]==="\r";if(y&&(g=g.slice(0,-1)),g&&v.length<l){let w=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;n(c-g.length-(y?2:1),"BAD_INDENT",w),v=""}o===Ee.BLOCK_LITERAL?(f+=p+v.slice(l)+g,p=`
`):v.length>l||g[0]==="	"?(p===" "?p=`
`:!d&&p===`
`&&(p=`

`),f+=p+v.slice(l)+g,p=`
`,d=!0):g===""?p===`
`?f+=`
`:p=`
`:(f+=p+g,p=" ",d=!1)}switch(i.chomp){case"-":break;case"+":for(let m=a;m<s.length;++m)f+=`
`+s[m][0].slice(l);f[f.length-1]!==`
`&&(f+=`
`);break;default:f+=`
`}let h=r+i.length+t.source.length;return{value:f,type:o,comment:i.comment,range:[r,h,h]}}function fJ({offset:e,props:t},n,r){if(t[0].type!=="block-scalar-header")return r(t[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:i}=t[0],o=i[0],s=0,a="",l=-1;for(let p=1;p<i.length;++p){let d=i[p];if(!a&&(d==="-"||d==="+"))a=d;else{let h=Number(d);!s&&h?s=h:l===-1&&(l=e+p)}}l!==-1&&r(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let c=!1,u="",f=i.length;for(let p=1;p<t.length;++p){let d=t[p];switch(d.type){case"space":c=!0;case"newline":f+=d.source.length;break;case"comment":n&&!c&&r(d,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=d.source.length,u=d.source.substring(1);break;case"error":r(d,"UNEXPECTED_TOKEN",d.message),f+=d.source.length;break;default:{let h=`Unexpected token in block scalar header: ${d.type}`;r(d,"UNEXPECTED_TOKEN",h);let m=d.source;m&&typeof m=="string"&&(f+=m.length)}}}return{mode:o,indent:s,chomp:a,comment:u,length:f}}function pJ(e){let t=e.split(/\n( *)/),n=t[0],r=n.match(/^( *)/),o=[r?.[1]?[r[1],n.slice(r[1].length)]:["",n]];for(let s=1;s<t.length;s+=2)o.push([t[s],t[s+1]]);return o}function DR(e,t,n){let{offset:r,type:i,source:o,end:s}=e,a,l,c=(p,d,h)=>n(r+p,d,h);switch(i){case"scalar":a=Ee.PLAIN,l=dJ(o,c);break;case"single-quoted-scalar":a=Ee.QUOTE_SINGLE,l=mJ(o,c);break;case"double-quoted-scalar":a=Ee.QUOTE_DOUBLE,l=hJ(o,c);break;default:return n(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[r,r+o.length,r+o.length]}}let u=r+o.length,f=ga(s,u,t,n);return{value:l,type:a,comment:f.comment,range:[r,u,f.offset]}}function dJ(e,t){let n="";switch(e[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${e[0]}`;break}case"@":case"`":{n=`reserved character ${e[0]}`;break}}return n&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),JF(e)}function mJ(e,t){return(e[e.length-1]!=="'"||e.length===1)&&t(e.length,"MISSING_CHAR","Missing closing 'quote"),JF(e.slice(1,-1)).replace(/''/g,"'")}function JF(e){let t,n;try{t=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let r=t.exec(e);if(!r)return e;let i=r[1],o=" ",s=t.lastIndex;for(n.lastIndex=s;r=n.exec(e);)r[1]===""?o===`
`?i+=o:o=`
`:(i+=o+r[1],o=" "),s=n.lastIndex;let a=/[ \t]*(.*)/sy;return a.lastIndex=s,r=a.exec(e),i+o+(r?.[1]??"")}function hJ(e,t){let n="";for(let r=1;r<e.length-1;++r){let i=e[r];if(!(i==="\r"&&e[r+1]===`
`))if(i===`
`){let{fold:o,offset:s}=gJ(e,r);n+=o,r=s}else if(i==="\\"){let o=e[++r],s=yJ[o];if(s)n+=s;else if(o===`
`)for(o=e[r+1];o===" "||o==="	";)o=e[++r+1];else if(o==="\r"&&e[r+1]===`
`)for(o=e[++r+1];o===" "||o==="	";)o=e[++r+1];else if(o==="x"||o==="u"||o==="U"){let a={x:2,u:4,U:8}[o];n+=vJ(e,r+1,a,t),r+=a}else{let a=e.substr(r-1,2);t(r-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),n+=a}}else if(i===" "||i==="	"){let o=r,s=e[r+1];for(;s===" "||s==="	";)s=e[++r+1];s!==`
`&&!(s==="\r"&&e[r+2]===`
`)&&(n+=r>o?e.slice(o,r+1):i)}else n+=i}return(e[e.length-1]!=='"'||e.length===1)&&t(e.length,"MISSING_CHAR",'Missing closing "quote'),n}function gJ(e,t){let n="",r=e[t+1];for(;(r===" "||r==="	"||r===`
`||r==="\r")&&!(r==="\r"&&e[t+2]!==`
`);)r===`
`&&(n+=`
`),t+=1,r=e[t+1];return n||(n=" "),{fold:n,offset:t}}var yJ={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xA0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function vJ(e,t,n,r){let i=e.substr(t,n),s=i.length===n&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(s)){let a=e.substr(t-2,n+2);return r(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(s)}function IR(e,t,n,r){let{value:i,type:o,comment:s,range:a}=t.type==="block-scalar"?NR(e,t,r):DR(t,e.options.strict,r),l=n?e.directives.tagName(n.source,f=>r(n,"TAG_RESOLVE_FAILED",f)):null,c;e.options.stringKeys&&e.atKey?c=e.schema[ro]:l?c=bJ(e.schema,i,l,n,r):t.type==="scalar"?c=SJ(e,i,t,r):c=e.schema[ro];let u;try{let f=c.resolve(i,p=>r(n??t,"TAG_RESOLVE_FAILED",p),e.options);u=_e(f)?f:new Ee(f)}catch(f){let p=f instanceof Error?f.message:String(f);r(n??t,"TAG_RESOLVE_FAILED",p),u=new Ee(i)}return u.range=a,u.source=i,o&&(u.type=o),l&&(u.tag=l),c.format&&(u.format=c.format),s&&(u.comment=s),u}function bJ(e,t,n,r,i){if(n==="!")return e[ro];let o=[];for(let a of e.tags)if(!a.collection&&a.tag===n)if(a.default&&a.test)o.push(a);else return a;for(let a of o)if(a.test?.test(t))return a;let s=e.knownTags[n];return s&&!s.collection?(e.tags.push(Object.assign({},s,{default:!1,test:void 0})),s):(i(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),e[ro])}function SJ({atKey:e,directives:t,schema:n},r,i,o){let s=n.tags.find(a=>(a.default===!0||e&&a.default==="key")&&a.test?.test(r))||n[ro];if(n.compat){let a=n.compat.find(l=>l.default&&l.test?.test(r))??n[ro];if(s.tag!==a.tag){let l=t.tagString(s.tag),c=t.tagString(a.tag),u=`Value may be parsed as either ${l} or ${c}`;o(i,"TAG_RESOLVE_FAILED",u,!0)}}return s}function eB(e,t,n){if(t){n??(n=t.length);for(let r=n-1;r>=0;--r){let i=t[r];switch(i.type){case"space":case"comment":case"newline":e-=i.source.length;continue}for(i=t[++r];i?.type==="space";)e+=i.source.length,i=t[++r];break}}return e}var wJ={composeNode:OR,composeEmptyNode:ax};function OR(e,t,n,r){let i=e.atKey,{spaceBefore:o,comment:s,anchor:a,tag:l}=n,c,u=!0;switch(t.type){case"alias":c=xJ(e,t,r),(a||l)&&r(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=IR(e,t,l,r),a&&(c.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=ZF(wJ,e,t,n,r),a&&(c.anchor=a.source.substring(1));break;default:{let f=t.type==="error"?t.message:`Unsupported token (type: ${t.type})`;r(t,"UNEXPECTED_TOKEN",f),c=ax(e,t.offset,void 0,null,n,r),u=!1}}return a&&c.anchor===""&&r(a,"BAD_ALIAS","Anchor cannot be an empty string"),i&&e.options.stringKeys&&(!_e(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")&&r(l??t,"NON_STRING_KEY","With stringKeys, all keys must be strings"),o&&(c.spaceBefore=!0),s&&(t.type==="scalar"&&t.source===""?c.comment=s:c.commentBefore=s),e.options.keepSourceTokens&&u&&(c.srcToken=t),c}function ax(e,t,n,r,{spaceBefore:i,comment:o,anchor:s,tag:a,end:l},c){let u={type:"scalar",offset:eB(t,n,r),indent:-1,source:""},f=IR(e,u,a,c);return s&&(f.anchor=s.source.substring(1),f.anchor===""&&c(s,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(f.spaceBefore=!0),o&&(f.comment=o,f.range[2]=l),f}function xJ({options:e},{offset:t,source:n,end:r},i){let o=new nl(n.substring(1));o.source===""&&i(t,"BAD_ALIAS","Alias cannot be an empty string"),o.source.endsWith(":")&&i(t+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let s=t+n.length,a=ga(r,s,e.strict,i);return o.range=[t,s,a.offset],a.comment&&(o.comment=a.comment),o}function tB(e,t,{offset:n,start:r,value:i,end:o},s){let a=Object.assign({_directives:t},e),l=new oo(void 0,a),c={atKey:!1,atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},u=ha(r,{indicator:"doc-start",next:i??o?.[0],offset:n,onError:s,parentIndent:0,startOnNewline:!0});u.found&&(l.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!u.hasNewline&&s(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=i?OR(c,i,u,s):ax(c,u.end,r,null,u,s);let f=l.contents.range[2],p=ga(o,f,!1,s);return p.comment&&(l.comment=p.comment),l.range=[n,f,p.offset],l}function gg(e){if(typeof e=="number")return[e,e+1];if(Array.isArray(e))return e.length===2?e:[e[0],e[1]];let{offset:t,source:n}=e;return[t,t+(typeof n=="string"?n.length:1)]}function nB(e){let t="",n=!1,r=!1;for(let i=0;i<e.length;++i){let o=e[i];switch(o[0]){case"#":t+=(t===""?"":r?`

`:`
`)+(o.substring(1)||" "),n=!0,r=!1;break;case"%":e[i+1]?.[0]!=="#"&&(i+=1),n=!1;break;default:n||(r=!0),n=!1}}return{comment:t,afterEmptyLine:r}}var yg=class{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,r,i,o)=>{let s=gg(n);o?this.warnings.push(new mg(s,r,i)):this.errors.push(new Ts(s,r,i))},this.directives=new da({version:t.version||"1.2"}),this.options=t}decorate(t,n){let{comment:r,afterEmptyLine:i}=nB(this.prelude);if(r){let o=t.contents;if(n)t.comment=t.comment?`${t.comment}
${r}`:r;else if(i||t.directives.docStart||!o)t.commentBefore=r;else if(wt(o)&&!o.flow&&o.items.length>0){let s=o.items[0];nt(s)&&(s=s.key);let a=s.commentBefore;s.commentBefore=a?`${r}
${a}`:r}else{let s=o.commentBefore;o.commentBefore=s?`${r}
${s}`:r}}n?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:nB(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,n=!1,r=-1){for(let i of t)yield*this.next(i);yield*this.end(n,r)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(n,r,i)=>{let o=gg(t);o[0]+=n,this.onError(o,"BAD_DIRECTIVE",r,i)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{let n=tB(this.options,this.directives,t,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{let n=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,r=new Ts(gg(t),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(r):this.doc.errors.push(r);break}case"doc-end":{if(!this.doc){let r="Unexpected doc-end without preceding document";this.errors.push(new Ts(gg(t),"UNEXPECTED_TOKEN",r));break}this.doc.directives.docEnd=!0;let n=ga(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){let r=this.doc.comment;this.doc.comment=r?`${r}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new Ts(gg(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){let r=Object.assign({_directives:this.directives},this.options),i=new oo(void 0,r);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,n,n],this.decorate(i,!1),yield i}}};var PR=Symbol("break visit"),EJ=Symbol("skip children"),rB=Symbol("remove item");function qu(e,t){"type"in e&&e.type==="document"&&(e={start:e.start,value:e.value}),iB(Object.freeze([]),e,t)}qu.BREAK=PR;qu.SKIP=EJ;qu.REMOVE=rB;qu.itemAtPath=(e,t)=>{let n=e;for(let[r,i]of t){let o=n?.[r];if(o&&"items"in o)n=o.items[i];else return}return n};qu.parentCollection=(e,t)=>{let n=qu.itemAtPath(e,t.slice(0,-1)),r=t[t.length-1][0],i=n?.[r];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};function iB(e,t,n){let r=n(t,e);if(typeof r=="symbol")return r;for(let i of["key","value"]){let o=t[i];if(o&&"items"in o){for(let s=0;s<o.items.length;++s){let a=iB(Object.freeze(e.concat([[i,s]])),o.items[s],n);if(typeof a=="number")s=a-1;else{if(a===PR)return PR;a===rB&&(o.items.splice(s,1),s-=1)}}typeof r=="function"&&i==="key"&&(r=r(t,e))}}return typeof r=="function"?r(t,e):r}var kR="\uFEFF",_R="",VR="",lx="";function oB(e){switch(e){case kR:return"byte-order-mark";case _R:return"doc-mode";case VR:return"flow-error-end";case lx:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}function As(e){switch(e){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}var sB=new Set("0123456789ABCDEFabcdef"),TJ=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),cx=new Set(",[]{}"),AJ=new Set(` ,[]{}
\r	`),LR=e=>!e||AJ.has(e),vg=class{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(t,n=!1){if(t){if(typeof t!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+t:t,this.lineEndPos=null}this.atEnd=!n;let r=this.next??"stream";for(;r&&(n||this.hasChars(1));)r=yield*this.parseNext(r)}atLineEnd(){let t=this.pos,n=this.buffer[t];for(;n===" "||n==="	";)n=this.buffer[++t];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[t+1]===`
`:!1}charAt(t){return this.buffer[this.pos+t]}continueScalar(t){let n=this.buffer[t];if(this.indentNext>0){let r=0;for(;n===" ";)n=this.buffer[++r+t];if(n==="\r"){let i=this.buffer[r+t+1];if(i===`
`||!i&&!this.atEnd)return t+r+1}return n===`
`||r>=this.indentNext||!n&&!this.atEnd?t+r:-1}if(n==="-"||n==="."){let r=this.buffer.substr(t,3);if((r==="---"||r==="...")&&As(this.buffer[t+3]))return-1}return t}getLine(){let t=this.lineEndPos;return(typeof t!="number"||t!==-1&&t<this.pos)&&(t=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=t),t===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[t-1]==="\r"&&(t-=1),this.buffer.substring(this.pos,t))}hasChars(t){return this.pos+t<=this.buffer.length}setNext(t){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=t,null}peek(t){return this.buffer.substr(this.pos,t)}*parseNext(t){switch(t){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let t=this.getLine();if(t===null)return this.setNext("stream");if(t[0]===kR&&(yield*this.pushCount(1),t=t.substring(1)),t[0]==="%"){let n=t.length,r=t.indexOf("#");for(;r!==-1;){let o=t[r-1];if(o===" "||o==="	"){n=r-1;break}else r=t.indexOf("#",r+1)}for(;;){let o=t[n-1];if(o===" "||o==="	")n-=1;else break}let i=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(t.length-i),this.pushNewline(),"stream"}if(this.atLineEnd()){let n=yield*this.pushSpaces(!0);return yield*this.pushCount(t.length-n),yield*this.pushNewline(),"stream"}return yield _R,yield*this.parseLineStart()}*parseLineStart(){let t=this.charAt(0);if(!t&&!this.atEnd)return this.setNext("line-start");if(t==="-"||t==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let n=this.peek(3);if((n==="---"||n==="...")&&As(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,n==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!As(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[t,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((t==="-"||t==="?"||t===":")&&As(n)){let r=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=r,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let t=this.getLine();if(t===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(t[n]){case"#":yield*this.pushCount(t.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(LR),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(t.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let t,n,r=-1;do t=yield*this.pushNewline(),t>0?(n=yield*this.pushSpaces(!1),this.indentValue=r=n):n=0,n+=yield*this.pushSpaces(!0);while(t+n>0);let i=this.getLine();if(i===null)return this.setNext("flow");if((r!==-1&&r<this.indentNext&&i[0]!=="#"||r===0&&(i.startsWith("---")||i.startsWith("..."))&&As(i[3]))&&!(r===this.indentNext-1&&this.flowLevel===1&&(i[0]==="]"||i[0]==="}")))return this.flowLevel=0,yield VR,yield*this.parseLineStart();let o=0;for(;i[o]===",";)o+=yield*this.pushCount(1),o+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(o+=yield*this.pushIndicators(),i[o]){case void 0:return"flow";case"#":return yield*this.pushCount(i.length-o),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(LR),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let s=this.charAt(1);if(this.flowKey||As(s)||s===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let t=this.charAt(0),n=this.buffer.indexOf(t,this.pos+1);if(t==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let o=0;for(;this.buffer[n-1-o]==="\\";)o+=1;if(o%2===0)break;n=this.buffer.indexOf('"',n+1)}let r=this.buffer.substring(0,n),i=r.indexOf(`
`,this.pos);if(i!==-1){for(;i!==-1;){let o=this.continueScalar(i+1);if(o===-1)break;i=r.indexOf(`
`,o)}i!==-1&&(n=i-(r[i-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let t=this.pos;for(;;){let n=this.buffer[++t];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>As(n)||n==="#")}*parseBlockScalar(){let t=this.pos-1,n=0,r;e:for(let o=this.pos;r=this.buffer[o];++o)switch(r){case" ":n+=1;break;case`
`:t=o,n=0;break;case"\r":{let s=this.buffer[o+1];if(!s&&!this.atEnd)return this.setNext("block-scalar");if(s===`
`)break}default:break e}if(!r&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{let o=this.continueScalar(t+1);if(o===-1)break;t=this.buffer.indexOf(`
`,o)}while(t!==-1);if(t===-1){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}let i=t+1;for(r=this.buffer[i];r===" ";)r=this.buffer[++i];if(r==="	"){for(;r==="	"||r===" "||r==="\r"||r===`
`;)r=this.buffer[++i];t=i-1}else if(!this.blockScalarKeep)do{let o=t-1,s=this.buffer[o];s==="\r"&&(s=this.buffer[--o]);let a=o;for(;s===" ";)s=this.buffer[--o];if(s===`
`&&o>=this.pos&&o+1+n>a)t=o;else break}while(!0);return yield lx,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let t=this.flowLevel>0,n=this.pos-1,r=this.pos-1,i;for(;i=this.buffer[++r];)if(i===":"){let o=this.buffer[r+1];if(As(o)||t&&cx.has(o))break;n=r}else if(As(i)){let o=this.buffer[r+1];if(i==="\r"&&(o===`
`?(r+=1,i=`
`,o=this.buffer[r+1]):n=r),o==="#"||t&&cx.has(o))break;if(i===`
`){let s=this.continueScalar(r+1);if(s===-1)break;r=Math.max(r,s-2)}}else{if(t&&cx.has(i))break;n=r}return!i&&!this.atEnd?this.setNext("plain-scalar"):(yield lx,yield*this.pushToIndex(n+1,!0),t?"flow":"doc")}*pushCount(t){return t>0?(yield this.buffer.substr(this.pos,t),this.pos+=t,t):0}*pushToIndex(t,n){let r=this.buffer.slice(this.pos,t);return r?(yield r,this.pos+=r.length,r.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(LR))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let t=this.flowLevel>0,n=this.charAt(1);if(As(n)||t&&cx.has(n))return t?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let t=this.pos+2,n=this.buffer[t];for(;!As(n)&&n!==">";)n=this.buffer[++t];return yield*this.pushToIndex(n===">"?t+1:t,!1)}else{let t=this.pos+1,n=this.buffer[t];for(;n;)if(TJ.has(n))n=this.buffer[++t];else if(n==="%"&&sB.has(this.buffer[t+1])&&sB.has(this.buffer[t+2]))n=this.buffer[t+=3];else break;return yield*this.pushToIndex(t,!1)}}*pushNewline(){let t=this.buffer[this.pos];return t===`
`?yield*this.pushCount(1):t==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(t){let n=this.pos-1,r;do r=this.buffer[++n];while(r===" "||t&&r==="	");let i=n-this.pos;return i>0&&(yield this.buffer.substr(this.pos,i),this.pos=n),i}*pushUntil(t){let n=this.pos,r=this.buffer[n];for(;!t(r);)r=this.buffer[++n];return yield*this.pushToIndex(n,!1)}};var Gu=class{constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let n=0,r=this.lineStarts.length;for(;n<r;){let o=n+r>>1;this.lineStarts[o]<t?n=o+1:r=o}if(this.lineStarts[n]===t)return{line:n+1,col:1};if(n===0)return{line:0,col:t};let i=this.lineStarts[n-1];return{line:n,col:t-i+1}}}};function dc(e,t){for(let n=0;n<e.length;++n)if(e[n].type===t)return!0;return!1}function aB(e){for(let t=0;t<e.length;++t)switch(e[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function cB(e){switch(e?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function ux(e){switch(e.type){case"document":return e.start;case"block-map":{let t=e.items[e.items.length-1];return t.sep??t.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function Zp(e){if(e.length===0)return[];let t=e.length;e:for(;--t>=0;)switch(e[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;e[++t]?.type==="space";);return e.splice(t,e.length)}function lB(e){if(e.start.type==="flow-seq-start")for(let t of e.items)t.sep&&!t.value&&!dc(t.start,"explicit-key-ind")&&!dc(t.sep,"map-value-ind")&&(t.key&&(t.value=t.key),delete t.key,cB(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}var bg=class{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new vg,this.onNewLine=t}*parse(t,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(let r of this.lexer.lex(t,n))yield*this.next(r);n||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}let n=oB(t);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&t[0]===" "&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}else{let r=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:r,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let t=this.peek(1);if(this.type==="doc-end"&&t?.type!=="doc-end"){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){let n=t??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{let r=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in r?r.indent:0:n.type==="flow-collection"&&r.type==="document"&&(n.indent=0),n.type==="flow-collection"&&lB(n),r.type){case"document":r.value=n;break;case"block-scalar":r.props.push(n);break;case"block-map":{let i=r.items[r.items.length-1];if(i.value){r.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=n;else{Object.assign(i,{key:n,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{let i=r.items[r.items.length-1];i.value?r.items.push({start:[],value:n}):i.value=n;break}case"flow-collection":{let i=r.items[r.items.length-1];!i||i.value?r.items.push({start:[],key:n,sep:[]}):i.sep?i.value=n:Object.assign(i,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((r.type==="document"||r.type==="block-map"||r.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){let i=n.items[n.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&aB(i.start)===-1&&(n.indent===0||i.start.every(o=>o.type!=="comment"||o.indent<n.indent))&&(r.type==="document"?r.end=i.start:r.items.push({start:i.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let t={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":{aB(t.start)!==-1?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}let n=this.startBlockValue(t);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if(this.type==="map-value-ind"){let n=ux(this.peek(2)),r=Zp(n),i;t.end?(i=t.end,i.push(this.sourceToken),delete t.end):i=[this.sourceToken];let o={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:r,key:t,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=o}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){let n=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){let r="end"in n.value?n.value.end:void 0;(Array.isArray(r)?r[r.length-1]:void 0)?.type==="comment"?r?.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)t.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,t.indent)){let i=t.items[t.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,n.start),i.push(this.sourceToken),t.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=t.indent){let r=!this.onKeyLine&&this.indent===t.indent,i=r&&(n.sep||n.explicitKey)&&this.type!=="seq-item-ind",o=[];if(i&&n.sep&&!n.value){let s=[];for(let a=0;a<n.sep.length;++a){let l=n.sep[a];switch(l.type){case"newline":s.push(a);break;case"space":break;case"comment":l.indent>t.indent&&(s.length=0);break;default:s.length=0}}s.length>=2&&(o=n.sep.splice(s[1]))}switch(this.type){case"anchor":case"tag":i||n.value?(o.push(this.sourceToken),t.items.push({start:o}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!n.explicitKey?(n.start.push(this.sourceToken),n.explicitKey=!0):i||n.value?(o.push(this.sourceToken),t.items.push({start:o,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(n.explicitKey)if(n.sep)if(n.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(dc(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]});else if(cB(n.key)&&!dc(n.sep,"newline")){let s=Zp(n.start),a=n.key,l=n.sep;l.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:a,sep:l}]})}else o.length>0?n.sep=n.sep.concat(o,this.sourceToken):n.sep.push(this.sourceToken);else if(dc(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{let s=Zp(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||i?t.items.push({start:o,key:null,sep:[this.sourceToken]}):dc(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let s=this.flowScalar(this.type);i||n.value?(t.items.push({start:o,key:s,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(s):(Object.assign(n,{key:s,sep:[]}),this.onKeyLine=!0);return}default:{let s=this.startBlockValue(t);if(s){if(s.type==="block-seq"){if(!n.explicitKey&&n.sep&&!dc(n.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else r&&t.items.push({start:o});this.stack.push(s);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){let n=t.items[t.items.length-1];switch(this.type){case"newline":if(n.value){let r="end"in n.value?n.value.end:void 0;(Array.isArray(r)?r[r.length-1]:void 0)?.type==="comment"?r?.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,t.indent)){let i=t.items[t.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,n.start),i.push(this.sourceToken),t.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=t.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;n.value||dc(n.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>t.indent){let r=this.startBlockValue(t);if(r){this.stack.push(r);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){let n=t.items[t.items.length-1];if(this.type==="flow-error-end"){let r;do yield*this.pop(),r=this.peek(1);while(r?.type==="flow-collection")}else if(t.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?t.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?t.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let i=this.flowScalar(this.type);!n||n.value?t.items.push({start:[],key:i,sep:[]}):n.sep?this.stack.push(i):Object.assign(n,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}let r=this.startBlockValue(t);r?this.stack.push(r):(yield*this.pop(),yield*this.step())}else{let r=this.peek(2);if(r.type==="block-map"&&(this.type==="map-value-ind"&&r.indent===t.indent||this.type==="newline"&&!r.items[r.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&r.type!=="flow-collection"){let i=ux(r),o=Zp(i);lB(t);let s=t.end.splice(1,t.end.length);s.push(this.sourceToken);let a={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:o,key:t,sep:s}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(t)}}flowScalar(t){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let n=ux(t),r=Zp(n);return r.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;let n=ux(t),r=Zp(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,n){return this.type!=="comment"||this.indent<=n?!1:t.every(r=>r.type==="newline"||r.type==="space")}*documentEnd(t){this.type!=="doc-mode"&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}};function MJ(e){let t=e.prettyErrors!==!1;return{lineCounter:e.lineCounter||t&&new Gu||null,prettyErrors:t}}function fx(e,t={}){let{lineCounter:n,prettyErrors:r}=MJ(t),i=new bg(n?.addNewLine),o=new yg(t),s=null;for(let a of o.compose(i.parse(e),!0,e.length))if(!s)s=a;else if(s.options.logLevel!=="silent"){s.errors.push(new Ts(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return r&&n&&(s.errors.forEach(TR(e,n)),s.warnings.forEach(TR(e,n))),s}function FR(e,t,n){let r;typeof t=="function"?r=t:n===void 0&&t&&typeof t=="object"&&(n=t);let i=fx(e,n);if(!i)return null;if(i.warnings.forEach(o=>Uw(i.options.logLevel,o)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:r},n))}var On=Symbol.for("obsidian.frontmatter.delete.v1"),uB=Object.freeze({preserveComments:!0,preserveBlankLines:!0,preserveQuoteStyle:!0,preserveKeyOrder:!0,preserveAnchors:!0,preserveCollectionStyle:!0,preserveScalarStyle:!0,deepMerge:!0,arrayMergeStrategy:"replace",indent:2,lineWidth:0,defaultQuoteStyle:"plain",lineEnding:"preserve",validateKeys:!0,maxDepth:100,sortKeys:!1,createIfMissing:!0,removeIfEmpty:!1,nullStr:"null",trueStr:"true",falseStr:"false",flowStyle:!1,multilineThreshold:40,strictMode:!1}),Jp="---",px="---",fB="...",Ms="\uFEFF";var pB=Object.freeze(new Set(["true","false","yes","no","on","off","null","nil","~","TRUE","FALSE","YES","NO","ON","OFF","NULL","NIL","True","False","Yes","No","On","Off","Null","Nil",".nan",".NaN",".NAN",".inf",".Inf",".INF","-.inf","-.Inf","-.INF"])),dB=Object.freeze(new Set(["-","?",":",",","[","]","{","}","#","&","*","!","|",">","'",'"',"%","@","`"," ","	"]));function ol(e,t=new WeakSet){if(e==null||typeof e!="object")return e;let n=e;if(t.has(n)||(t.add(n),Object.isFrozen(e)))return e;if(Array.isArray(e))for(let r=0;r<e.length;r++)ol(e[r],t);else for(let r of Object.keys(e))ol(e[r],t);return Object.freeze(e)}function dx(e){let t=0,n=0,r=e.length;for(let i=0;i<r;i++)e[i]===`
`&&(i>0&&e[i-1]==="\r"?t++:n++);return t>n?`\r
`:`
`}function Ku(e){let t="",n=e.length;for(let r=0;r<n;r++){let i=e[r];if(i==="\r"){if(r+1<n&&e[r+1]===`
`)continue;t+=`
`}else t+=i}return t}function td(e,t){let n=Ku(e);return t===`\r
`?n.replace(/\n/g,`\r
`):n}function mB(e){if(e.length===0||pB.has(e))return!0;let t=e[0];if(dB.has(t))return!0;let n=e[e.length-1];return!!(n===" "||n==="	"||t===" "||t==="	"||e.includes(": ")||e.includes(" #")||e.endsWith(":")||e.includes(`
`)||e.includes("\r")||/^[+-]?\.?\d/.test(e)||/^0[xXoObB]/.test(e)||/^[+-]?\d+\.?\d*[eE][+-]?\d+$/.test(e))}function hB(e){let t=e.split(`
`),n=new Map;for(let o of t){let s=o.match(/^( +)\S/);if(s&&s[1]){let a=s[1].length,l=n.get(a)??0;n.set(a,l+1)}}let r=0,i=2;for(let[o,s]of n)s>r&&o>0&&(r=s,i=o);if(n.size>1){let o=[...n.keys()].filter(s=>s>0);if(o.length>0){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];l!==void 0&&(s=NJ(s,l))}s>0&&(i=s)}}return i}function NJ(e,t){for(e=Math.abs(e),t=Math.abs(t);t>0;){let n=t;t=e%t,e=n}return e}function ed(e,t,n=new WeakSet){if(e===t)return!0;if(e===null||t===null)return e===t;if(typeof e!=typeof t||typeof e!="object")return!1;if(e===t)return!0;let r=e,i=t;if(n.has(r)||n.has(i))return!0;n.add(r),n.add(i);{let o=Array.isArray(e),s=Array.isArray(t);if(o!==s)return!1;if(o&&s){let f=e,p=t;if(f.length!==p.length)return!1;for(let d=0;d<f.length;d++)if(!ed(f[d],p[d],n))return!1;return!0}let a=e,l=t,c=Object.keys(a),u=Object.keys(l);if(c.length!==u.length)return!1;for(let f of c)if(!Object.prototype.hasOwnProperty.call(l,f)||!ed(a[f],l[f],n))return!1;return!0}}function BR(e){return typeof e!="string"?{valid:!1,reason:"Key must be a string"}:e.length===0?{valid:!1,reason:"Key cannot be empty"}:e.includes("\0")?{valid:!1,reason:"Key cannot contain null bytes"}:{valid:!0}}async function mx(e,t){try{return await e.vault.read(t)}catch(n){let r=n instanceof Error?n.message:String(n);throw new Error(`Failed to read "${t.path}": ${r}`)}}async function zR(e,t,n,r){if(n===r)return!1;try{return await e.vault.modify(t,n),!0}catch(i){let o=i instanceof Error?i.message:String(i);throw new Error(`Failed to write "${t.path}": ${o}`)}}function HR(e,t,n){let r;if(e.trim().length===0)r=`${Jp}
${t.endDelimiter}`;else{let i=e.trim();i.endsWith(`
`)||(i+=`
`),r=`${Jp}
${i}${t.endDelimiter}`}if(t.afterContent.length>0){let i=t.afterContent.startsWith(`
`)?t.afterContent:`
`+t.afterContent;r+=i}else r+=`
`;return t.hasBom&&(r=Ms+r),td(r,n)}function gB(e,t,n,r){let i=e.trim();i.length>0&&!i.endsWith(`
`)&&(i+=`
`);let o=`${Jp}
${i}${px}
`,s=t.trim();return s.length>0&&(o+=`
`+s+`
`),n&&(o=Ms+o),td(o,r)}var yB=require("obsidian");function DJ(e){if(!e.trim())return 0;let t=e.split(`
`),n=0;for(let r of t)if(!(!r.trim()||r.trim().startsWith("#"))){if(/^[a-zA-Z_][a-zA-Z0-9_-]*\s*:/.test(r)){n++;continue}if(/^'[^']+'\s*:/.test(r)){n++;continue}if(/^"[^"]+"\s*:/.test(r)){n++;continue}}return n}function nd(e){let t=(0,yB.getFrontMatterInfo)(e),n=e.startsWith(Ms),r=dx(e),i=()=>ol({exists:!1,raw:"",yamlContent:"",startOffset:n?1:0,endOffset:n?1:0,startDelimiter:"",endDelimiter:"",endDelimiterType:"dashes",beforeContent:n?Ms:"",afterContent:n?Ku(e.slice(1)):Ku(e),lineEnding:r,isEmpty:!0,hasComments:!1,hasAnchors:!1,hasAliases:!1,keyCount:0,rawLineCount:0,hasBom:n,indentSize:2});if(!t.exists)return i();let o=t.frontmatter,s=e.slice(0,t.contentStart),a=px,l="dashes";e.slice(t.to,t.contentStart).includes("...")&&(a=fB,l="dots");let u=/(?:^|\n)[ \t]*#/.test(o),f=/&[a-zA-Z_][a-zA-Z0-9_]*/.test(o),p=/\*[a-zA-Z_][a-zA-Z0-9_]*/.test(o),d=hB(o),h=o.trim().length===0||o.split(/\r\n|\r|\n/).every(g=>g.trim()===""||g.trim().startsWith("#")),m=h?0:DJ(o),v=s.split(/\r\n|\r|\n/).length;return ol({exists:!0,raw:s,yamlContent:o,startOffset:t.from,endOffset:t.to,startDelimiter:Jp,endDelimiter:a,endDelimiterType:l,beforeContent:n?Ms:"",afterContent:Ku(e.slice(t.contentStart)),lineEnding:r,isEmpty:h,hasComments:u,hasAnchors:f,hasAliases:p,keyCount:m,rawLineCount:v,hasBom:n,indentSize:d})}function vB(e,t){let n={keepSourceTokens:!0,lineCounter:new Gu,strict:t.strictMode,merge:!0,prettyErrors:!0,version:"1.2",logLevel:"silent"},r=fx(e,n),o=(r.errors??[]).filter(s=>!s.message.includes("warning")&&s.name!=="YAMLWarning");if(o.length>0)throw new Error(`YAML parse error: ${o[0].message}`);return r}function UR(){let e=new oo({});return e.contents=new Qt,e}function IJ(e){return{indent:e.indent,lineWidth:e.lineWidth===0?0:e.lineWidth,minContentWidth:0,directives:!1,nullStr:e.nullStr,trueStr:e.trueStr,falseStr:e.falseStr,doubleQuotedMinMultiLineLength:e.multilineThreshold,blockQuote:!0}}function OJ(e,t){let n=typeof t=="function"?t:(r,i)=>r.localeCompare(i);e.items.sort((r,i)=>{if(!nt(r)||!nt(i))return 0;let o=_e(r.key)?String(r.key.value):String(r.key),s=_e(i.key)?String(i.key.value):String(i.key);return n(o,s)})}function $R(e,t){let n=IJ(t);Object.assign(e.options,n),t.sortKeys&&hr(e.contents)&&OJ(e.contents,t.sortKeys);let r=e.toString();return r.length>0&&!r.endsWith(`
`)&&(r+=`
`),r}function PJ(e){if(!e||!Xe(e))return{type:null,flow:!1,spaceBefore:!1,commentBefore:null,comment:null,anchor:null};let t=_e(e)?e:null,n=wt(e)?e:null;return{type:t?.type??null,flow:n?n.flow===!0:!1,spaceBefore:e.spaceBefore??!1,commentBefore:e.commentBefore??null,comment:e.comment??null,anchor:e.anchor??null}}function rd(e,t){t.spaceBefore&&(e.spaceBefore=!0),t.commentBefore!==null&&(e.commentBefore=t.commentBefore),t.comment!==null&&(e.comment=t.comment),t.anchor!==null&&(e.anchor=t.anchor),_e(e)&&t.type&&(e.type=t.type),wt(e)&&(e.flow=t.flow)}function jR(e,t){for(let n of e.items)if(nt(n)&&(_e(n.key)?n.key.value:n.key)===t)return n}function Rs(e,t,n,r=null,i=0){if(i>n.maxDepth)throw new Error(`Maximum nesting depth (${n.maxDepth}) exceeded`);if(t===null){let o=e.createNode(null);return r&&rd(o,r),o}if(typeof t=="string"||typeof t=="number"||typeof t=="boolean"){let o=e.createNode(t);return r&&r.type&&n.preserveScalarStyle&&(o.type=r.type),r&&rd(o,r),o}if(Array.isArray(t)){let o=new nr;o.flow=n.flowStyle||(r?.flow??!1);for(let s=0;s<t.length;s++){let a=Rs(e,t[s],n,null,i+1);o.items.push(a)}return r&&rd(o,r),o}if(typeof t=="object"){let o=new Qt;o.flow=n.flowStyle||(r?.flow??!1);let s=Object.entries(t);for(let[a,l]of s){let c=e.createNode(a),u=Rs(e,l,n,null,i+1);o.items.push(new $t(c,u))}return r&&rd(o,r),o}return e.createNode(null)}function qR(e,t,n,r,i=0){if(i>r.maxDepth)throw new Error(`Maximum nesting depth (${r.maxDepth}) exceeded`);let o=PJ(t);if(n===null){if(_e(t)&&t.value===null)return t;let s=e.createNode(null);return rd(s,o),s}if(_e(t)){let s=typeof t.value,a=typeof n;if((a==="string"||a==="number"||a==="boolean")&&(s===a||s==="object"&&t.value===null))return t.value=n,t}if(Array.isArray(n)){if(io(t)&&r.preserveCollectionStyle){let s=t,a=new nr;s.flow!==void 0&&(a.flow=s.flow),rd(a,o);for(let l=0;l<n.length;l++){let c=Rs(e,n[l],r,null,i+1);a.items.push(c)}return a}return Rs(e,n,r,o,i)}if(typeof n=="object"&&n!==null){if(hr(t)&&r.deepMerge){let s=t,a=Object.entries(n);for(let[l,c]of a){let u=jR(s,l);if(u&&Xe(u.value))u.value=qR(e,u.value,c,r,i+1);else if(u)u.value=Rs(e,c,r,null,i+1);else{let f=e.createNode(l),p=Rs(e,c,r,null,i+1);s.items.push(new $t(f,p))}}return s}return Rs(e,n,r,o,i)}return Rs(e,n,r,o,i)}function bB(e,t,n,r,i){if(i>r.maxDepth)throw new Error(`Maximum nesting depth (${r.maxDepth}) exceeded`);switch(n){case"append":return[...e,...t];case"prepend":return[...t,...e];case"unique":{let o=[...e];for(let s of t)o.some(l=>ed(l,s))||o.push(s);return o}case"merge-by-index":{let o=[...e];for(let s=0;s<t.length;s++)if(s<o.length){let a=o[s],l=t[s];typeof a=="object"&&a!==null&&!Array.isArray(a)&&typeof l=="object"&&l!==null&&!Array.isArray(l)?o[s]=GR(a,l,r,i+1):o[s]=l}else o.push(t[s]);return o}default:return[...t]}}function GR(e,t,n,r=0){if(r>n.maxDepth)throw new Error(`Maximum nesting depth (${n.maxDepth}) exceeded`);let i={...e};for(let[o,s]of Object.entries(t)){let a=i[o];if(s!==void 0){if(s===null){i[o]=null;continue}if(Array.isArray(s)){Array.isArray(a)?i[o]=bB(a,s,n.arrayMergeStrategy,n,r+1):i[o]=[...s];continue}if(typeof s=="object"&&typeof a=="object"&&a!==null&&!Array.isArray(a)){i[o]=GR(a,s,n,r+1);continue}i[o]=s}}return i}function SB(e,t,n,r=0){return!n.deepMerge||e==null?t:t===null?null:Array.isArray(t)?Array.isArray(e)?bB(e,t,n.arrayMergeStrategy,n,r):t:typeof t=="object"&&typeof e=="object"&&!Array.isArray(e)?GR(e,t,n,r):t}function KR(e,t,n){let r=[],i=[],o=[],s=!1;hr(e.contents)||(e.contents=new Qt);let a=e.contents,l=Object.entries(t);for(let[c,u]of l){if(n.validateKeys){let v=BR(c);if(!v.valid)throw new Error(`Invalid key "${c}": ${v.reason}`)}let f=jR(a,c),p=f!==void 0;if(u===On||u===void 0){if(p){let v=a.items.indexOf(f);v!==-1&&(a.items.splice(v,1),o.push(c),s=!0)}continue}let d=u,h;p&&f&&Xe(f.value)&&(h=f.value.toJSON());let m=p&&n.deepMerge?SB(h,d,n):d;if(!ed(h,m)){if(p&&f)Xe(f.value)?f.value=qR(e,f.value,m,n):f.value=Rs(e,m,n),i.push(c);else{let v=e.createNode(c),g=Rs(e,m,n);a.items.push(new $t(v,g)),r.push(c)}s=!0}}return ol({changed:s,added:r,modified:i,deleted:o})}function kJ(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function wB(e){if(!e.trim())return new Set;let t=new Set,n=e.split(`
`);for(let r of n){if(!r.trim()||r.trim().startsWith("#"))continue;let i=r.match(/^([a-zA-Z_][a-zA-Z0-9_-]*)\s*:/);if(i&&i[1]){t.add(i[1]);continue}let o=r.match(/^'([^']+)'\s*:/);if(o&&o[1]){t.add(o[1]);continue}let s=r.match(/^"([^"]+)"\s*:/);if(s&&s[1]){t.add(s[1]);continue}}return t}function _J(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"}function VJ(e,t){return e===null?t.nullStr:typeof e=="boolean"?e?t.trueStr:t.falseStr:typeof e=="number"?String(e):typeof e=="string"?mB(e)?JSON.stringify(e):e:new oo(e).toString({indent:t.indent}).trim()}function LJ(e,t,n){let r=[],i=[];for(let[s,a]of Object.entries(t)){if(a===On||a===void 0)continue;let l=VJ(a,n);i.push(`${s}: ${l}`),r.push(s)}if(i.length===0)return{content:e,changed:!1,added:[]};let o=e;return o=o.trimEnd(),o.length>0&&(o+=`
`),o+=i.join(`
`)+`
`,{content:o,changed:!0,added:r}}function xB(e,t){for(let[n,r]of Object.entries(e))if(r===On||r===void 0){if(t.has(n))return!1}else return!1;return!0}function EB(e,t){let n=e.split(`
`),r=kJ(t),i=new RegExp(`^${r}\\s*:`),o=new RegExp(`^'${r}'\\s*:`),s=new RegExp(`^"${r}"\\s*:`);for(let a=0;a<n.length;a++){let l=n[a];if(l===void 0)continue;if(i.test(l)||o.test(l)||s.test(l)){let u=a,f=!0,p=l.indexOf(":"),d=l.slice(p+1).trim(),h=d==="|"||d===">"||d==="|-"||d===">-"||d==="|+"||d===">+",m=d.startsWith("["),v=d.startsWith("{"),g=d==="",y=m&&!d.includes("]"),b=v&&!d.includes("}");(h||g||y||b)&&(f=!1);for(let w=a+1;w<n.length;w++){let S=n[w];if(S===void 0)break;if(S.trim()===""){if(h){u=w;continue}let C=!1;for(let x=w+1;x<n.length;x++){let E=n[x];if(E===void 0)break;if(E.trim()!==""){E.match(/^[ \t]+\S/)&&(C=!0);break}}if(C){u=w,f=!1;continue}break}if(S.match(/^[ \t]+/))u=w,f=!1;else break}return{startLine:a,endLine:u,isSimple:f}}}return null}function FJ(e,t,n){for(let r of e){if(!n.has(r))continue;let i=EB(t,r);if(!i||!i.isSimple)return!1}return!0}function BJ(e,t,n){let r=e.split(`
`),i=[],o=new Set;for(let l of t){if(!n.has(l))continue;let c=EB(e,l);c&&c.isSimple&&(o.add(c.startLine),i.push(l))}if(o.size===0)return{content:e,changed:!1,deleted:[]};let a=r.filter((l,c)=>!o.has(c)).join(`
`);return a=a.replace(/\n{3,}/g,`

`),a=a.trimEnd(),a.length>0&&(a+=`
`),{content:a,changed:!0,deleted:i}}function CB(e,t,n,r){let i=[],o=[];for(let[u,f]of Object.entries(t))f===On||f===void 0?n.has(u)&&o.push(u):n.has(u)||i.push([u,f]);let s=e,a=[],l=[],c=!1;if(o.length>0){let u=BJ(s,o,n);u.changed&&(s=u.content,l.push(...u.deleted),c=!0)}if(i.length>0){let u=Object.fromEntries(i),f=LJ(s,u,r);f.changed&&(s=f.content,a.push(...f.added),c=!0)}return{content:s,changed:c,added:a,deleted:l}}function TB(e,t,n){let r=[],i=[],o=[];for(let[s,a]of Object.entries(e))a===On||a===void 0?n.has(s)&&i.push(s):n.has(s)?o.push(s):r.push(s);if(o.length>0)return{canUseSurgical:!1,hasAdditions:r.length>0,hasDeletions:i.length>0,hasModifications:!0,additionKeys:r,deletionKeys:i,modificationKeys:o,reason:"Modifications to existing keys require full YAML processing"};for(let s of r){let a=e[s];if(a!==void 0&&a!==On&&!_J(a))return{canUseSurgical:!1,hasAdditions:!0,hasDeletions:i.length>0,hasModifications:!1,additionKeys:r,deletionKeys:i,modificationKeys:o,reason:`Key "${s}" has complex value that requires full YAML processing`}}return FJ(i,t,n)?{canUseSurgical:!0,hasAdditions:r.length>0,hasDeletions:i.length>0,hasModifications:!1,additionKeys:r,deletionKeys:i,modificationKeys:o}:{canUseSurgical:!1,hasAdditions:r.length>0,hasDeletions:!0,hasModifications:!1,additionKeys:r,deletionKeys:i,modificationKeys:o,reason:"Some keys to delete have complex values that require full YAML processing"}}function zJ(e){return FR(e,{logLevel:"silent"})}async function sl(e,t,n,r={}){if(!e||typeof e!="object"||!e.vault)return{success:!1,changed:!1,error:new Error("Invalid app: must be a valid Obsidian App instance")};if(!t||!(t instanceof AB.TFile))return{success:!1,changed:!1,error:new Error("Invalid file: must be a TFile instance")};if(n===null||typeof n!="object"||Array.isArray(n))return{success:!1,changed:!1,error:new Error("Invalid updates: must be a plain object")};let i=r.indent,o={...uB,...r};try{let s=await mx(e,t),a=dx(s),l=o.lineEnding==="crlf"?`\r
`:o.lineEnding==="lf"?`
`:a,c=nd(s);c.exists&&i===void 0&&c.indentSize>0&&(o.indent=c.indentSize);let u;if(c.exists){let p=wB(c.yamlContent);if(xB(n,p))return{success:!0,changed:!1,metadata:c};let d=TB(n,c.yamlContent,p);if(!c.isEmpty&&d.canUseSurgical&&(d.hasAdditions||d.hasDeletions)){let g=CB(c.yamlContent,n,p,o);if(!g.changed)return{success:!0,changed:!1,metadata:c};if(g.content.trim().length===0&&o.removeIfEmpty){let w=c.afterContent.replace(/^\n+/,"");u=c.hasBom?Ms+w:w,u=td(u,l)}else u=HR(g.content,c,l);return u===s?{success:!0,changed:!1,metadata:c}:(await zR(e,t,u,s),{success:!0,changed:!0,metadata:nd(u)})}let h=c.isEmpty?UR():vB(c.yamlContent,o);if(!KR(h,n,o).changed)return{success:!0,changed:!1,metadata:c};if((!hr(h.contents)||h.contents.items.length===0)&&o.removeIfEmpty){let g=c.afterContent.replace(/^\n+/,"");u=c.hasBom?Ms+g:g,u=td(u,l)}else{let g=$R(h,o);u=HR(g,c,l)}}else{if(!o.createIfMissing)return{success:!0,changed:!1,metadata:c};let p=Object.entries(n).filter(([d,h])=>h!==On&&h!==void 0);if(p.length===0)return{success:!0,changed:!1,metadata:c};try{await e.fileManager.processFrontMatter(t,m=>{for(let[v,g]of p)m[v]=g});let d=await mx(e,t);return{success:!0,changed:!0,metadata:nd(d)}}catch{let h=UR(),m=Object.fromEntries(p);KR(h,m,o);let v=$R(h,o),g=Ku(s),y=s.startsWith(Ms),b=y?g.slice(1):g;u=gB(v,b,y,l)}}return u===s?{success:!0,changed:!1,metadata:c}:(await zR(e,t,u,s),{success:!0,changed:!0,metadata:nd(u)})}catch(s){return{success:!1,changed:!1,error:s instanceof Error?s:new Error(String(s))}}}async function HJ(e,t){if(!e||!t)return{success:!1,changed:!1,error:new Error("Invalid parameters")};try{let n=await mx(e,t),r=nd(n);if(!r.exists||r.isEmpty)return{success:!0,changed:!1,data:null,metadata:r};let i=zJ(r.yamlContent);return{success:!0,changed:!1,data:i&&typeof i=="object"&&!Array.isArray(i)?ol(i):null,metadata:r}}catch(n){return{success:!1,changed:!1,error:n instanceof Error?n:new Error(String(n))}}}async function hx(e,t,n){let r=await HJ(e,t);return!r.success||!r.data?{success:r.success,changed:!1,data:void 0,error:r.error,metadata:r.metadata}:{success:!0,changed:!1,data:r.data[n],metadata:r.metadata}}var gx=class{constructor(t,n,r,i,o){this.plugin=t;this.app=n;this.manifestManager=r;this.editHistoryManager=i;this.eventBus=o;P(this,"pendingDeviations",new Set);P(this,"internalWriteIgnoreSet",new Set)}get noteIdKey(){return this.plugin.settings.noteIdFrontmatterKey}get legacyNoteIdKeys(){return this.plugin.settings.legacyNoteIdFrontmatterKeys||[]}async getActiveNoteState(t){let n=t;if(!n||!(n.view instanceof id.FileView)||!n.view.file)return{file:null,noteId:null,source:"none"};let r=n.view.file;if(!(r instanceof id.TFile))return{file:null,noteId:null,source:"none"};if(this.isPendingDeviation(r.path))return{file:r,noteId:null,source:"none"};if(r.extension==="base"){let i=await this.getNoteId(r);return i?{file:r,noteId:i,source:"filepath"}:{file:r,noteId:r.path,source:"filepath"}}if(r.extension==="md"){if(!(n.view instanceof id.MarkdownView))return{file:null,noteId:null,source:"none"};let i=await this.getNoteId(r);if(i)return{file:r,noteId:i,source:"frontmatter"};try{let o=await this.manifestManager.getNoteIdByPath(r.path);if(o)return{file:r,noteId:o,source:"manifest"}}catch(o){console.error("Version Control: Error recovering note ID from manifest.",o)}return{file:r,noteId:null,source:"none"}}return{file:null,noteId:null,source:"none"}}async getNoteId(t){if(!t||this.isPendingDeviation(t.path))return null;let{winnerId:n,loserIds:r}=await this.manifestManager.resolveDuplicatesForPath(t.path);if(r.length>0){console.log(`VC: Cleaning up external data for duplicate IDs: ${r.join(", ")}`);for(let o of r)await this.editHistoryManager.deleteNoteHistory(o).catch(s=>console.error(`VC: Failed to delete edit history for duplicate ${o}`,s)),this.eventBus.trigger("history-deleted",o)}if(n){if(t.extension==="md"){let o=this.app.metadataCache.getFileCache(t),s=o?.frontmatter?.[this.noteIdKey],a=this.legacyNoteIdKeys.some(l=>o?.frontmatter?.[l]!==void 0);(s!==n||a)&&await this.writeNoteIdToFrontmatter(t,n)}return n}if(t.extension==="base")return Hp(this.plugin.settings,t);let i=null;if(t.extension==="md"){let s=this.app.metadataCache.getFileCache(t)?.frontmatter,a=s?.[this.noteIdKey];if(this.isValidId(a))i=a;else for(let l of this.legacyNoteIdKeys)if(a=s?.[l],this.isValidId(a)){await this.migrateLegacyKey(t,l,this.noteIdKey,a).catch(c=>console.error(`VC: Failed to migrate legacy key '${l}' to '${this.noteIdKey}' for file '${t.path}'`,c)),i=a;break}}return i&&await this.ensurePathConsistency(i,t.path),i}async ensurePathConsistency(t,n){try{let i=(await this.manifestManager.loadCentralManifest()).notes[t];i&&i.notePath!==n&&(console.log(`VC: External move detected for note "${t}". Updating path from "${i.notePath}" to "${n}".`),await this.manifestManager.updateNotePath(t,n),await this.editHistoryManager.updateNotePath(t,n))}catch(r){console.error(`VC: Failed to ensure path consistency for note ${t}`,r)}}isValidId(t){return typeof t=="string"&&t.trim()!==""}async migrateLegacyKey(t,n,r,i){try{let o=await hx(this.app,t,n);if(o.success&&o.data===i){this.registerInternalWrite(t.path);let s=await sl(this.app,t,{[n]:On,[r]:i});if(!s.success)throw s.error||new Error(`Failed to migrate legacy key ${n}`)}}catch(o){console.error(`VC: Error migrating legacy key for ${t.path}`,o)}}async getOrCreateNoteId(t){let n=await this.getNoteId(t);if(n)return n;if(t.extension==="md"){let r=Hp(this.plugin.settings,t);r=await this.manifestManager.ensureUniqueNoteId(r);try{return await this.writeNoteIdToFrontmatter(t,r),r}catch(i){throw console.error(`VC: Failed to write new vc-id to frontmatter for "${t.path}".`,i),new Error(`Failed to initialize version history for "${t.basename}". Could not write to frontmatter.`)}}return null}async writeNoteIdToFrontmatter(t,n){try{this.registerInternalWrite(t.path);let r={[this.noteIdKey]:n};for(let o of this.legacyNoteIdKeys)r[o]=On;let i=await sl(this.app,t,r);if(!i.success)throw i.error||new Error("Failed to update frontmatter");return!0}catch(r){throw console.error(`VC: CRITICAL: Failed to write vc-id to frontmatter for '${t.path}'. Frontmatter might be invalid.`,r),new Error(`Could not save vc-id to "${t.basename}". Check note's frontmatter.`)}}async handleNoteRename(t,n){try{let r=await this.manifestManager.getNoteIdByPath(n);if(r){let i=this.plugin.settings,o=Aw(r)??void 0;if(!o){let l=await this.manifestManager.loadNoteManifest(r);l&&l.createdAt&&(o=new Date(l.createdAt).getTime().toString())}let s=Tw(r),a=Hp(i,t,o,s);if(a!==r){let l=await this.manifestManager.ensureUniqueNoteId(a);await this.manifestManager.renameNoteEntry(r,l),t.extension==="md"&&await this.writeNoteIdToFrontmatter(t,l),await this.manifestManager.updateNotePath(l,t.path),await this.editHistoryManager.renameNote(r,l,t.path);return}await this.manifestManager.updateNotePath(r,t.path),await this.editHistoryManager.updateNotePath(r,t.path)}else this.manifestManager.invalidateCentralManifestCache()}catch(r){console.error(`VC: Failed to handle note rename from "${n}" to "${t.path}".`,r)}}async verifyNoteIdMatchesPath(t,n){let r=this.plugin.settings;try{let i=Aw(n)??void 0;if(!i){let a=await this.manifestManager.loadNoteManifest(n);a&&a.createdAt&&(i=new Date(a.createdAt).getTime().toString())}let o=Tw(n),s=Hp(r,t,i,o);if(n!==s){console.log(`VC: Note ID mismatch detected for "${t.path}". Updating ID from "${n}" to "${s}".`);let a=await this.manifestManager.ensureUniqueNoteId(s);await this.manifestManager.renameNoteEntry(n,a),t.extension==="md"&&await this.writeNoteIdToFrontmatter(t,a),await this.manifestManager.updateNotePath(a,t.path),await this.editHistoryManager.renameNote(n,a,t.path)}}catch(i){console.error(`VC: Error verifying note ID match for "${t.path}".`,i)}}invalidateCentralManifestCache(){this.manifestManager.invalidateCentralManifestCache()}addPendingDeviation(t){this.pendingDeviations.add(t)}removePendingDeviation(t){this.pendingDeviations.delete(t)}isPendingDeviation(t){return this.pendingDeviations.has(t)}registerInternalWrite(t){this.internalWriteIgnoreSet.add(t),setTimeout(()=>{this.internalWriteIgnoreSet.delete(t)},1500)}isInternalWrite(t){return this.internalWriteIgnoreSet.has(t)}};var Ng=require("obsidian");function yx(e){return e!=null&&typeof e!="function"&&qV(e.length)}function vx(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}function od(e){return typeof e=="string"||typeof e=="symbol"?e:Object.is(e?.valueOf?.(),-0)?"-0":String(e)}function WR(e){if(e==null)return"";if(typeof e=="string")return e;if(Array.isArray(e))return e.map(WR).join(",");let t=String(e);return t==="0"&&Object.is(Number(e),-0)?"-0":t}function bx(e){if(Array.isArray(e))return e.map(od);if(typeof e=="symbol")return[e];e=WR(e);let t=[],n=e.length;if(n===0)return t;let r=0,i="",o="",s=!1;for(e.charCodeAt(0)===46&&(t.push(""),r++);r<n;){let a=e[r];o?a==="\\"&&r+1<n?(r++,i+=e[r]):a===o?o="":i+=a:s?a==='"'||a==="'"?o=a:a==="]"?(s=!1,t.push(i),i=""):i+=a:a==="["?(s=!0,i&&(t.push(i),i="")):a==="."?i&&(t.push(i),i=""):i+=a,r++}return i&&t.push(i),t}function Sg(e,t,n){if(e==null)return n;switch(typeof t){case"string":{if(FS(t))return n;let r=e[t];return r===void 0?vx(t)?Sg(e,bx(t),n):n:r}case"number":case"symbol":{typeof t=="number"&&(t=od(t));let r=e[t];return r===void 0?n:r}default:{if(Array.isArray(t))return UJ(e,t,n);if(Object.is(t?.valueOf(),-0)?t="-0":t=String(t),FS(t))return n;let r=e[t];return r===void 0?n:r}}}function UJ(e,t,n){if(t.length===0)return n;let r=e;for(let i=0;i<t.length;i++){if(r==null||FS(t[i]))return n;r=r[t[i]]}return r===void 0?n:r}function MB(e){return function(t){return Sg(t,e)}}function RB(e){return e!==null&&(typeof e=="object"||typeof e=="function")}function QR(e,t,n){return typeof n!="function"?QR(e,t,()=>{}):YR(e,t,function r(i,o,s,a,l,c){let u=n(i,o,s,a,l,c);return u!==void 0?!!u:YR(i,o,r,c)},new Map)}function YR(e,t,n,r){if(t===e)return!0;switch(typeof t){case"object":return $J(e,t,n,r);case"function":return Object.keys(t).length>0?YR(e,{...t},n,r):Vh(e,t);default:return RB(e)?typeof t=="string"?t==="":!0:Vh(e,t)}}function $J(e,t,n,r){if(t==null)return!0;if(Array.isArray(t))return NB(e,t,n,r);if(t instanceof Map)return jJ(e,t,n,r);if(t instanceof Set)return qJ(e,t,n,r);let i=Object.keys(t);if(e==null||kh(e))return i.length===0;if(i.length===0)return!0;if(r?.has(t))return r.get(t)===e;r?.set(t,e);try{for(let o=0;o<i.length;o++){let s=i[o];if(!kh(e)&&!(s in e)||t[s]===void 0&&e[s]!==void 0||t[s]===null&&e[s]!==null||!n(e[s],t[s],s,e,t,r))return!1}return!0}finally{r?.delete(t)}}function jJ(e,t,n,r){if(t.size===0)return!0;if(!(e instanceof Map))return!1;for(let[i,o]of t.entries()){let s=e.get(i);if(n(s,o,i,e,t,r)===!1)return!1}return!0}function NB(e,t,n,r){if(t.length===0)return!0;if(!Array.isArray(e))return!1;let i=new Set;for(let o=0;o<t.length;o++){let s=t[o],a=!1;for(let l=0;l<e.length;l++){if(i.has(l))continue;let c=e[l],u=!1;if(n(c,s,o,e,t,r)&&(u=!0),u){i.add(l),a=!0;break}}if(!a)return!1}return!0}function qJ(e,t,n,r){return t.size===0?!0:e instanceof Set?NB([...e],[...t],n,r):!1}function Sx(e,t){return QR(e,t,()=>{})}function DB(e){return e=$V(e),t=>Sx(t,e)}function IB(e,t){return UV(e,(n,r,i,o)=>{let s=t?.(n,r,i,o);if(s!==void 0)return s;if(typeof e=="object")switch(Object.prototype.toString.call(e)){case Tp:case Cp:case Ap:{let a=new e.constructor(e?.valueOf());return gs(a,e),a}case _u:{let a={};return gs(a,e),a.length=e.length,a[Symbol.iterator]=e[Symbol.iterator],a}default:return}})}function OB(e){return IB(e)}var GJ=/^(?:0|[1-9]\d*)$/;function PB(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return GJ.test(e)}}function wx(e){return e!==null&&typeof e=="object"&&ku(e)==="[object Arguments]"}function kB(e,t){let n;if(Array.isArray(t)?n=t:typeof t=="string"&&vx(t)&&e?.[t]==null?n=bx(t):n=[t],n.length===0)return!1;let r=e;for(let i=0;i<n.length;i++){let o=n[i];if((r==null||!Object.hasOwn(r,o))&&!((Array.isArray(r)||wx(r))&&PB(o)&&o<r.length))return!1;r=r[o]}return!0}function _B(e,t){switch(typeof e){case"object":{Object.is(e?.valueOf(),-0)&&(e="-0");break}case"number":{e=od(e);break}}return t=OB(t),function(n){let r=Sg(n,e);return r===void 0?kB(n,e):t===void 0?r===void 0:Sx(r,t)}}function VB(e){if(e==null)return bS;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&e.length===2?_B(e[0],e[1]):DB(e);case"string":case"symbol":case"number":return MB(e)}}function wg(e,t){if(!e)return[];let n=yx(e)||Array.isArray(e)?LV(0,e.length):Object.keys(e),r=VB(t??bS),i=new Array(n.length);for(let o=0;o<n.length;o++){let s=n[o],a=e[s];i[o]=r(a,s,e)}return i}function LB(e){let t=e?.constructor,n=typeof t=="function"?t.prototype:Object.prototype;return e===n}function FB(e){return SS(e)}function XR(e){if(e==null)return!0;if(yx(e))return typeof e.splice!="function"&&typeof e!="string"&&!FB(e)&&!wx(e)?!1:e.length===0;if(typeof e=="object"){if(e instanceof Map||e instanceof Set)return e.size===0;let t=Object.keys(e);return LB(e)?t.filter(n=>n!=="constructor").length===0:t.length===0}return!0}function sd(e,t,n){return e==null?"":n!=null||t==null?e.toString().trim():typeof t==="object"?Array.isArray(t)?HS(e,t.flatMap(r=>r.toString().split(""))):HS(e,t.toString().split("")):HS(e,t.toString().split(""))}function xx(e,t,n){return e==null?"":n!=null||t==null?e.toString().trimEnd():BS(e,t.toString().split(""))}function ZR(e,t,n){return e==null?"":n!=null||t==null?e.toString().trimStart():zS(e,t.toString().split(""))}var Ex=require("obsidian");var xg="Untitled Export",BB=1e3,zB=200,KJ=/^(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])$/i,WJ=/[\x00-\x1f\x7f-\x9f\\/:*?"<>|#%&{}$!'"@+=`~\[\]\(\)]/g,YJ=/_+/g,QJ=/^[_.\s]+$/,Wu=new Map,XJ=1e3;function ZJ(e){if(!e)throw new TypeError("App instance is required");if(typeof e!="object")throw new TypeError("App must be an object");if(!e.vault)throw new TypeError("App instance must have a vault property");if(typeof e.vault.getAbstractFileByPath!="function")throw new TypeError("Invalid App instance: vault.getAbstractFileByPath method missing")}function JJ(e){if(e==null||e==="/")return"";let t=String(e).trim();return t==="."||t==="./"?"":t}function eee(e,t){if(!t)return!1;let n=(0,Ex.normalizePath)(String(t));if(Wu.has(n))return Wu.get(n);let r=e.vault.getAbstractFileByPath(n)!==null;if(Wu.size>=XJ){let i=Wu.keys().next().value;i!==void 0?Wu.delete(i):Wu.clear()}return Wu.set(n,r),r}async function HB(e,t,n,r="md"){if(ZJ(e),typeof t!="string")throw new TypeError("baseName must be a string");if(n!==void 0&&typeof n!="string")throw new TypeError("parentPath must be a string or undefined");let i=JJ(n),o=i?`${i}/`:"",s=`.${r}`,a=mc(t),l=1,c,u;if(c=a+s,u=(0,Ex.normalizePath)(String(o+c)),!u||typeof u!="string")throw new Error("Path normalization failed");for(;l<=BB;)try{if(!eee(e,u))return u;l++,c=`${a} ${l}${s}`;let d=o+c;if(u=(0,Ex.normalizePath)(String(d)),!u||typeof u!="string")throw new Error("Path normalization failed during iteration")}catch(p){throw console.error("Version Control: Error during unique file path generation:",{baseName:t,parentPath:n??"N/A",attempt:l,error:p instanceof Error?p.message:String(p)}),new Error(`Failed to generate unique file path: ${p instanceof Error?p.message:"Unknown error"}`)}let f=`Could not generate unique file path after ${BB} attempts for baseName: "${t}", parentPath: "${n||""}"`;throw console.error("Version Control: "+f),new Error(f)}function mc(e){if(e==null)return xg;let t=String(e);if(sd(t)==="")return xg;try{let n=t;n=n.replace(WJ,"_");let i=n.split(".")[0]||"";if(KJ.test(i)&&(n=`_${n}`),n.length>zB&&(n=n.substring(0,zB),n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=xx(n,"._ ")),n=sd(n),n=ZR(n,"._ "),n=xx(n,"._ "),n=sd(n),n=n.replace(YJ,"_"),XR(n)||QJ.test(n))return xg;let o=n;return!o||sd(o)===""?xg:o}catch(n){return console.error("Filename sanitization failed:",{originalName:e,error:n instanceof Error?n.message:String(n)}),xg}}var qr=class{static validateFile(t){if(!t)throw new Error("Invalid file provided to saveNewVersionForFile.")}static validateNoteId(t,n){if(!t)throw new Error(`Invalid noteId for ${n}.`)}static validateVersionId(t,n){if(!t)throw new Error(`Invalid versionId for ${n}.`)}static validateNoteAndVersionId(t,n,r){if(!t||!n)throw new Error(`Invalid noteId or versionId for ${r}.`)}static validateRestoreParams(t,n,r){if(!t||!n||!r)throw new Error("Invalid parameters for version restoration.")}static validateDeviationParams(t,n){if(!t||n!==void 0&&!n)throw new Error("Invalid parameters for creating deviation.")}static validateBranchDeletion(t,n){if(!t||!n)throw new Error("Invalid noteId or branchName for deleteBranch.")}};var Yu=class{static buildVersionMetadata(t,n,r,i,o){let s={versionNumber:t,timestamp:n,size:r,wordCount:i.wordCount,wordCountWithMd:i.wordCountWithMd,charCount:i.charCount,charCountWithMd:i.charCountWithMd,lineCount:i.lineCount,lineCountWithoutMd:i.lineCountWithoutMd};return o&&(s.name=o),s}static calculateNextVersionNumber(t){return t.length===0?1:Math.max(...t)+1}static generateDisplayName(t,n){return n?`"${n}" (V${t})`:`Version ${t}`}};var ad=class{static isDuplicate(t,n){return t===null?!1:t===n}static shouldSkipMinimalChanges(t,n,r,i){if(!r||t===null)return!1;let o=i;if(!o.enableMinLinesChangedCheck)return!1;let s=oR(t,n),a=0;for(let l of s)(l.added||l.removed)&&(a+=l.count);return a<o.minLinesChanged}};Ti();Ti();var Gr=Object.freeze({MAX_INPUT_BYTES:10*1024*1024,MAX_INPUT_LENGTH:1e7,MAX_OUTPUT_SIZE:20*1024*1024,MAX_PATTERN_LENGTH:1e3,MAX_CACHE_SIZE:100,CHUNK_SIZE:32768,ASYNC_THRESHOLD:5e4,YIELD_INTERVAL:16}),JR=To([{pattern:"```[\\s\\S]*?```",flags:"g",replacement:"",priority:1},{pattern:"`[^`]+`",flags:"g",replacement:(e,...t)=>{let n=t[0];return typeof n=="string"?n:""},priority:2},{pattern:"<[^>]*>",flags:"g",replacement:"",priority:3},{pattern:"!\\[([^\\]]*)\\]\\([^)]*\\)",flags:"g",replacement:"$1",priority:4},{pattern:"\\[([^\\]]*)\\]\\([^)]*\\)",flags:"g",replacement:"$1",priority:5},{pattern:"\\*\\*\\*([^*]+)\\*\\*\\*",flags:"g",replacement:"$1",priority:6},{pattern:"___([^_]+)___",flags:"g",replacement:"$1",priority:7},{pattern:"\\*\\*([^*]+)\\*\\*",flags:"g",replacement:"$1",priority:8},{pattern:"__([^_]+)__",flags:"g",replacement:"$1",priority:9},{pattern:"\\*([^*]+)\\*",flags:"g",replacement:"$1",priority:10},{pattern:"_([^_]+)_",flags:"g",replacement:"$1",priority:11},{pattern:"~~([^~]+)~~",flags:"g",replacement:"$1",priority:12},{pattern:"==([^=]+)==",flags:"g",replacement:"$1",priority:13},{pattern:"^#{1,6}\\s+",flags:"gm",replacement:"",priority:14},{pattern:"^>\\s*",flags:"gm",replacement:"",priority:15},{pattern:"^\\s*[-*+]\\s+",flags:"gm",replacement:"",priority:16},{pattern:"^\\s*\\d+\\.\\s+",flags:"gm",replacement:"",priority:17},{pattern:"^\\s*[-*_]{3,}\\s*$",flags:"gm",replacement:"",priority:18},{pattern:"\\[\\^[^\\]]+\\]",flags:"g",replacement:"",priority:19}]);Ti();var al=class e extends Error{constructor(n,r,i=[]){super(r);P(this,"code","VALIDATION_FAILURE");P(this,"paramName");P(this,"issues");this.name="ValidationError",this.paramName=n,this.issues=To(i),Object.setPrototypeOf(this,e.prototype)}},ya=class e extends Error{constructor(n,r,i){super(`Resource "${n}" exceeded: limit=${r}, actual=${i}`);P(this,"code","RESOURCE_EXHAUSTION");P(this,"resource");P(this,"limit");P(this,"actual");this.name="ResourceError",this.resource=n,this.limit=r,this.actual=i,Object.setPrototypeOf(this,e.prototype)}};var tee=()=>{let e=new Map,t=()=>{if(e.size<Gr.MAX_CACHE_SIZE)return;let s=null,a=1/0;for(let[l,c]of e)c.accessCount<a&&(a=c.accessCount,s=l);s!==null&&e.delete(s)},n=s=>{let a=new Set;for(let l of s)"gimsuy".includes(l)&&a.add(l);return[...a].sort().join("")};return To({get:(s,a="")=>{if(s.length>Gr.MAX_PATTERN_LENGTH)throw new ya("regexPattern",Gr.MAX_PATTERN_LENGTH,s.length);let l=n(a),c=`${s}\0${l}`,u=e.get(c);if(u!==void 0)return u.accessCount+=1,new RegExp(u.regex.source,u.regex.flags);t();let f;try{f=new RegExp(s,l)}catch{throw new al("regexPattern",`Invalid regular expression: ${s}`,[])}return e.set(c,{regex:f,createdAt:Date.now(),accessCount:1}),new RegExp(f.source,f.flags)},clear:()=>{e.clear()},size:()=>e.size})},eN=tee();var nee=ae(te(),xn(e=>!/(?:__proto__|constructor\.prototype|constructor\["prototype"\]|constructor\.constructor)/i.test(e),"Prototype pollution pattern detected")),ree=ae(te(),Ao(Gr.MAX_INPUT_LENGTH,`Input exceeds maximum length of ${Gr.MAX_INPUT_LENGTH}`),nee),iee=ke({allowEmpty:ie($e(),!0),sanitizeControlChars:ie($e(),!0),maxLength:ie(de(),Gr.MAX_INPUT_LENGTH)}),ld=(e,t,n={})=>{let r=Ue(iee,n);if(sc(e))throw new al(t,`Parameter "${t}" is required`,[]);let i=un(ree,e);if(!i.success)throw new al(t,`Invalid parameter "${t}": ${i.issues.map(s=>s.message).join(", ")}`,i.issues);let o=i.output;if(typeof Blob<"u"){let s=new Blob([o]).size;if(s>Gr.MAX_INPUT_BYTES)throw new ya(t,Gr.MAX_INPUT_BYTES,s)}if(o.length>r.maxLength)throw new ya(t,r.maxLength,o.length);if(r.sanitizeControlChars&&(o=o.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")),!r.allowEmpty&&o.trim().length===0)throw new al(t,`Parameter "${t}" must not be empty`,[]);return o};var UB=(e,t)=>{let n=e,r=[...t].sort((i,o)=>i.priority-o.priority);for(let{pattern:i,flags:o,replacement:s}of r){let a=eN.get(i,o);if(n=n.replace(a,s),n.length>Gr.MAX_OUTPUT_SIZE)throw new ya("outputText",Gr.MAX_OUTPUT_SIZE,n.length)}return n};var $B=e=>e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/[\t ]+/g," ").replace(/\n{3,}/g,`

`).replace(/^ +| +$/gm,"").trim(),jB=dM($B);var tN=e=>{let t=ld(e,"text",{allowEmpty:!0});if(t.length===0)return"";let n=UB(t,JR);return jB(n)};var see=()=>{if(typeof Intl<"u"&&"Segmenter"in Intl){let t=new Intl.Segmenter(void 0,{granularity:"word"});return n=>{if(n.length===0)return 0;let r=0;for(let i of t.segment(n))i.isWordLike&&(r+=1);return r}}let e=/[\p{L}\p{N}]+(?:['\u2019][\p{L}]+)?/gu;return t=>{if(t.length===0)return 0;let n=t.match(e);return n!==null?n.length:0}},nN=see(),aee=()=>{if(typeof Intl<"u"&&"Segmenter"in Intl){let e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return t=>{if(t.length===0)return 0;let n=0;for(let r of e.segment(t))n+=1;return n}}return e=>e.length===0?0:[...e].length},rN=aee(),iN=e=>e.length===0?0:[...e].length,oN=e=>{if(e.length===0)return 0;let t=1,n=e.length;for(let r=0;r<n;r+=1){let i=e.charCodeAt(r);i===10?t+=1:i===13&&(r+1<n&&e.charCodeAt(r+1)===10&&(r+=1),t+=1)}return t};Ti();var Eg=e=>{let t=typeof performance<"u"?performance.now():Date.now(),n=ld(e,"content",{allowEmpty:!0}),r=tN(n),i=nN(r),o=nN(n),s=rN(r),a=rN(n),l=oN(r),c=To({wordCount:i,wordCountWithMarkdown:o,charCount:s,charCountWithMarkdown:a,codePointCount:iN(r),codePointCountWithMarkdown:iN(n),lineCount:oN(n),lineCountWithoutMarkdown:l,processingTimeMs:0,wordCountWithMd:o,charCountWithMd:a,lineCountWithoutMd:l}),u=typeof performance<"u"?performance.now():Date.now(),f=Math.round((u-t)*1e3)/1e3;return To({...c,processingTimeMs:f})};var Cg=class{static prepareStats(t){return Eg(t)}};var Tg=class{constructor(t,n,r,i,o,s){this.app=t;this.manifestManager=n;this.noteManager=r;this.versionContentRepo=i;this.eventBus=o;this.queueService=s}async execute(t,n){qr.validateFile(t);let{force:r=!1,isAuto:i=!1,settings:o,name:s}=n,a=await this.noteManager.getOrCreateNoteId(t);if(!a)throw new Error("Could not get or create a note ID for the file.");return this.queueService.add(`ver:${a}`,async()=>{let l=await this.manifestManager.loadNoteManifest(a);l||(console.log(`VC: First version for "${t.path}". Creating database entry.`),l=await this.manifestManager.createNoteEntry(a,t.path));let c=l.currentBranch,u=l.branches[c];if(!u)throw new Error(`Current branch "${c}" not found in manifest for note ${a}.`);if(!await this.app.vault.adapter.exists(t.path))throw new Error(`File to be saved does not exist at path: ${t.path}`);let f=await this.app.vault.adapter.read(t.path),p=await this.versionContentRepo.getLatestVersionContent(a,l);if(ad.shouldSkipMinimalChanges(p,f,i,o))return{status:"skipped_min_lines",newVersionEntry:null,displayName:"",newNoteId:a};if(!r&&ad.isDuplicate(p,f))return{status:"duplicate",newVersionEntry:null,displayName:"",newNoteId:a};let d=Object.values(u.versions).map(g=>g.versionNumber),h=Yu.calculateNextVersionNumber(d),m=(s||"").trim(),v=tg(o,h,m);try{let{size:g}=await this.versionContentRepo.write(a,v,f),y=Cg.prepareStats(f),b=new Date().toISOString(),S=(await this.manifestManager.updateNoteManifest(a,x=>{let E=x.branches[c];if(E){let T=Object.values(E.versions),A=T.length>0?Math.max(...T.map(N=>N.versionNumber)):0,M=Math.max(A+1,h),R=Yu.buildVersionMetadata(M,b,g,y,m||void 0);E.versions[v]=R,E.totalVersions=M,x.lastModified=b}})).branches[c]?.versions[v];if(!S)throw new Error(`Failed to retrieve saved version data for version ${v} from manifest after update.`);let C=Yu.generateDisplayName(S.versionNumber,m||void 0);return this.eventBus.trigger("version-saved",a),{status:"saved",newVersionEntry:{id:v,noteId:a,notePath:t.path,branchName:c,versionNumber:S.versionNumber,timestamp:b,size:g,...m&&{name:m},wordCount:S.wordCount,wordCountWithMd:S.wordCountWithMd,charCount:S.charCount,charCountWithMd:S.charCountWithMd,lineCount:S.lineCount,lineCountWithoutMd:S.lineCountWithoutMd},displayName:C,newNoteId:a}}catch(g){throw console.error(`VC: CRITICAL FAILURE in saveNewVersionForFile for "${t.path}". Rolling back.`,g),await this.versionContentRepo.delete(a,v).catch(y=>{console.error(`VC: FAILED to clean up orphaned version file after an error: ${v}`,y)}),this.manifestManager.invalidateNoteManifestCache(a),g}},{priority:100})}};var Ag=class{constructor(t,n,r,i){this.app=t;this.versionContentRepo=n;this.queueService=r;this.noteManager=i}async execute(t,n,r){return qr.validateRestoreParams(t,n,r),this.queueService.add(`ver:${n}`,async()=>{try{if(!this.app.vault.getAbstractFileByPath(t.path))return console.warn(`VC: Restoration failed. Note "${t.basename}" no longer exists.`),!1;let i=await this.versionContentRepo.read(n,r);if(i===null)throw new Error("Could not load version content to restore.");return this.noteManager.registerInternalWrite(t.path),await this.app.vault.modify(t,i),!0}catch(i){throw console.error(`VC: Failed to restore note ${n} to version ${r}.`,i),i}},{priority:100})}};var sN=require("obsidian");var Mg=class{constructor(t,n,r,i,o,s,a,l){this.app=t;this.manifestManager=n;this.versionContentRepo=r;this.eventBus=i;this.plugin=o;this.queueService=s;this.editHistoryManager=a;this.noteManager=l}get noteIdKey(){return this.plugin.settings.noteIdFrontmatterKey}get legacyNoteIdKeys(){return this.plugin.settings.legacyNoteIdFrontmatterKeys||[]}async deleteVersion(t,n){return qr.validateNoteAndVersionId(t,n,"deleteVersion"),this.queueService.add(`ver:${t}`,async()=>{try{let r=await this.manifestManager.loadNoteManifest(t);if(!r)return!1;let i=r.currentBranch,o=r.branches[i];return!o||!o.versions[n]?(console.warn("VC: Version to delete not found in manifest. It may have already been deleted."),await this.versionContentRepo.delete(t,n),!0):(await this.manifestManager.updateNoteManifest(t,s=>{let a=s.branches[i];a&&(delete a.versions[n],s.lastModified=new Date().toISOString())}),await this.versionContentRepo.delete(t,n),this.eventBus.trigger("version-deleted",t),!0)}catch(r){throw console.error(`VC: Failed to delete version ${n} for note ${t}.`,r),r}},{priority:50})}async deleteAllVersionsInCurrentBranch(t){return qr.validateNoteId(t,"deleteAllVersionsInCurrentBranch"),this.queueService.add(`ver:${t}`,async()=>{let n=await this.manifestManager.loadNoteManifest(t);if(!n)return!1;let r=n.currentBranch,i=n.branches[r];if(!i)return!0;let o=Object.keys(i.versions);if(o.length===0)return!0;try{await this.manifestManager.updateNoteManifest(t,s=>{let a=s.branches[r];a&&(a.versions={},a.totalVersions=0,s.lastModified=new Date().toISOString())});for(let s of o)await this.versionContentRepo.delete(t,s);return this.eventBus.trigger("version-deleted",t),!0}catch(s){throw console.error(`VC: Failed to delete all versions for note ${t}.`,s),s}},{priority:50})}async deleteBranch(t,n){return qr.validateBranchDeletion(t,n),this.queueService.add(`ver:${t}`,async()=>{try{let r=await this.manifestManager.loadNoteManifest(t);if(!r||!r.branches[n])return console.warn(`VC: Branch to delete '${n}' not found.`),!0;if(Object.keys(r.branches).length===1){let o=r.notePath;await this.editHistoryManager.deleteNoteHistory(t),await this.manifestManager.deleteNoteEntry(t);let s=this.app.vault.getAbstractFileByPath(o);return s instanceof sN.TFile&&s.extension==="md"&&await this.cleanupFrontmatter(o,t),this.eventBus.trigger("history-deleted",t),!0}await this.editHistoryManager.deleteBranch(t,n);let i=Object.keys(r.branches[n]?.versions??{});await this.manifestManager.updateNoteManifest(t,o=>{delete o.branches[n],o.currentBranch===n&&(o.currentBranch=Object.keys(o.branches)[0]??Pu),o.lastModified=new Date().toISOString()});for(let o of i)await this.versionContentRepo.delete(t,o);return this.eventBus.trigger("version-deleted",t),!0}catch(r){throw console.error(`VC: Failed to delete branch ${n} for note ${t}.`,r),r}},{priority:50})}async cleanupFrontmatter(t,n){let r=this.app.vault.getAbstractFileByPath(t);if(r instanceof sN.TFile)try{let i=await hx(this.app,r,this.noteIdKey);if(i.success&&i.data===n){this.noteManager.registerInternalWrite(r.path);let o={[this.noteIdKey]:On};for(let a of this.legacyNoteIdKeys)o[a]=On;let s=await sl(this.app,r,o);if(!s.success)throw s.error||new Error("Failed to cleanup frontmatter")}}catch(i){console.error(`VC: WARNING: Could not clean vc-id from frontmatter of "${t}". Please remove it manually.`,i)}}};var Rg=class{constructor(t,n,r,i){this.manifestManager=t;this.versionContentRepo=n;this.getEffectiveSettings=r;this.queueService=i}async execute(t,n,r){return qr.validateNoteAndVersionId(t,n,"updateVersionDetails"),this.queueService.add(`ver:${t}`,async()=>{let i=r.name?.trim(),o=r.description?.trim(),s=await this.manifestManager.loadNoteManifest(t);if(!s)throw new Error(`Manifest not found for note ${t}`);let a=s.currentBranch,l=s.branches[a];if(!l)throw new Error(`Current branch not found for note ${t}`);let c=l.versions[n];if(!c)throw new Error(`Version ${n} not found in manifest for note ${t}.`);let u=this.getEffectiveSettings(s),f=u.versionIdFormat,p=r.name!==void 0&&i!==c.name,d=f.includes("{name}"),h=n;if(p&&d){let m=new Date(c.timestamp);if(h=tg(u,c.versionNumber,i,m),h!==n)try{await this.versionContentRepo.rename(t,n,h)}catch(v){throw console.error(`VC: Failed to rename version file from ${n} to ${h}. Aborting update.`,v),v}}return await this.manifestManager.updateNoteManifest(t,m=>{let v=m.branches[m.currentBranch];if(!v)return;if(h!==n){let y=v.versions[n];y&&(delete v.versions[n],v.versions[h]=y)}let g=v.versions[h];g&&(r.name!==void 0&&(i?g.name=i:delete g.name),r.description!==void 0&&(o?g.description=o:delete g.description),m.lastModified=new Date().toISOString())}),h},{priority:50})}};var Qu=class{static resolve(t,n){if(!n)return{...t,isGlobal:!0};if(n.isGlobal!==!1)return{...t,isGlobal:!0};let i=Rp(n,o=>!Np(o));return{...t,...i,isGlobal:!1}}};var Cx=class{constructor(t,n,r,i,o,s,a,l){this.plugin=t;this.app=n;this.manifestManager=r;this.noteManager=i;this.versionContentRepo=o;this.eventBus=s;this.queueService=a;this.editHistoryManager=l;P(this,"saveOperation");P(this,"restoreOperation");P(this,"deleteOperation");P(this,"updateOperation");this.saveOperation=new Tg(this.app,this.manifestManager,this.noteManager,this.versionContentRepo,this.eventBus,this.queueService),this.restoreOperation=new Ag(this.app,this.versionContentRepo,this.queueService,this.noteManager),this.deleteOperation=new Mg(this.app,this.manifestManager,this.versionContentRepo,this.eventBus,this.plugin,this.queueService,this.editHistoryManager,this.noteManager),this.updateOperation=new Rg(this.manifestManager,this.versionContentRepo,this.getEffectiveSettings.bind(this),this.queueService)}get noteIdKey(){return this.plugin.settings.noteIdFrontmatterKey}async saveNewVersionForFile(t,n){return this.saveOperation.execute(t,n)}async updateVersionDetails(t,n,r){return this.updateOperation.execute(t,n,r)}getEffectiveSettings(t){let n=t.branches[t.currentBranch],r=Qu.resolve(this.plugin.settings.versionHistorySettings,n?.settings);return{...this.plugin.settings,versionHistorySettings:r,...r}}async getVersionHistory(t){if(!t)return[];try{let n=await this.manifestManager.loadNoteManifest(t);if(!n)return[];let r=n.currentBranch,i=n.branches[r];if(!i||!i.versions)return[];let o=wg(i.versions,(s,a)=>({id:a,noteId:t,notePath:n.notePath,branchName:r,versionNumber:s.versionNumber,timestamp:s.timestamp,size:s.size,...s.name&&{name:s.name},...s.description&&{description:s.description},wordCount:s.wordCount,wordCountWithMd:s.wordCountWithMd,charCount:s.charCount,charCountWithMd:s.charCountWithMd,lineCount:s.lineCount,lineCountWithoutMd:s.lineCountWithoutMd}));return mr(o,["versionNumber"],["desc"])}catch(n){throw console.error(`VC: Failed to get version history for note ${t}.`,n),new Error(`Failed to get version history for note ${t}.`)}}async getVersionContent(t,n){return this.versionContentRepo.read(t,n)}async restoreVersion(t,n,r){let i=await this.restoreOperation.execute(t,n,r);return i&&t.extension==="md"&&await this.noteManager.writeNoteIdToFrontmatter(t,n),i}async createDeviation(t,n,r){qr.validateDeviationParams(t,n);let i=await this.getVersionContent(t,n);if(i===null)throw new Error("Could not load version content for deviation.");let o=`(from V${n.substring(0,6)}...)`;return this.createDeviationFromContent(t,i,r,o)}async createDeviationFromContent(t,n,r,i){qr.validateDeviationParams(t);let o=await this.manifestManager.loadNoteManifest(t),s=o?this.app.vault.getAbstractFileByPath(o.notePath):null,a=s instanceof Ng.TFile?s:null,l=a?.basename||"Untitled Version",c=a?.extension||"md",u=r?.isRoot()?"":r?.path??a?.parent?.path??"";u==="/"&&(u="");let f=`${l} ${i}`,p=await HB(this.app,f,u,c);this.noteManager.addPendingDeviation(p);try{let d=await this.app.vault.create(p,n);if(!d)throw new Error("Failed to create the new note file for deviation.");if(c==="md")try{let h={[this.noteIdKey]:On},m=this.plugin.settings.legacyNoteIdFrontmatterKeys||[];for(let g of m)h[g]=On;let v=await sl(this.app,d,h);if(!v.success)throw v.error||new Error("Failed to remove ID from deviation")}catch(h){throw console.error(`VC: Failed to remove vc-id from new deviation note "${p}". Trashing.`,h),await this.app.vault.trash(d,!0).catch(m=>{console.error(`VC: CRITICAL: Failed to trash corrupted deviation file "${p}".`,m)}),new Error("Failed to create a clean deviation.")}return d}catch(d){throw console.error(`VC: Failed to create deviation for note ${t}.`,d),d}finally{this.noteManager.removePendingDeviation(p)}}async deleteVersion(t,n){return this.deleteOperation.deleteVersion(t,n)}async deleteAllVersionsInCurrentBranch(t){return this.deleteOperation.deleteAllVersionsInCurrentBranch(t)}async createBranch(t,n){await this.manifestManager.updateNoteManifest(t,r=>{if(r.branches[n])throw new Error(`Branch "${n}" already exists.`);let i=r.branches[r.currentBranch]?.settings,o={versions:{},totalVersions:0};i&&(o.settings=i),r.branches[n]=o})}async switchBranch(t,n){let r=await this.manifestManager.loadNoteManifest(t);if(!r)throw new Error("Manifest not found");let i=r.currentBranch;if(i===n)return;let o=null,s=this.app.workspace.getLeavesOfType("markdown");for(let f of s)if(f.view instanceof Ng.MarkdownView&&f.view.file?.path===r.notePath){o=f.view;break}if(o){let f=null;o.getMode()==="source"?f={content:o.editor.getValue(),cursor:o.editor.getCursor(),scroll:o.editor.getScrollInfo()}:o.file&&(f={content:await this.app.vault.read(o.file),cursor:{line:0,ch:0},scroll:{left:0,top:0}}),f&&await this.manifestManager.updateNoteManifest(t,p=>{let d=p.branches[i];d&&(d.state=f)})}else try{let p={content:await this.app.vault.adapter.read(r.notePath),cursor:{line:0,ch:0},scroll:{left:0,top:0}};await this.manifestManager.updateNoteManifest(t,d=>{let h=d.branches[i];h&&(h.state=p)})}catch(f){console.warn(`VC: Could not save state for ${r.notePath}`,f)}await this.manifestManager.updateNoteManifest(t,f=>{if(!f.branches[n])throw new Error(`Branch "${n}" does not exist.`);f.currentBranch=n});let a=await this.manifestManager.loadNoteManifest(t);if(!a)throw new Error("Failed to reload manifest after switching branch.");let c=a.branches[n]?.state,u=null;if(c?u=c.content:u=await this.versionContentRepo.getLatestVersionContent(t,a),u!==null){let f=this.app.vault.getAbstractFileByPath(r.notePath);if(f instanceof Ng.TFile&&(this.noteManager.registerInternalWrite(f.path),await this.app.vault.modify(f,u),f.extension==="md"&&await this.noteManager.writeNoteIdToFrontmatter(f,t),o&&c&&o.getMode()==="source"))try{o.editor.setCursor(c.cursor),o.editor.scrollTo(c.scroll.left,c.scroll.top)}catch{console.debug("VC: Could not restore cursor position after branch switch.")}}}async deleteBranch(t,n){return this.deleteOperation.deleteBranch(t,n)}};var Tx=class{constructor(t,n,r,i,o,s){this.db=t;this.diffManager=n;this.versionManager=r;this.editHistoryManager=i;this.contentRepo=o;this.eventBus=s;P(this,"queue",new bs({concurrency:4}));P(this,"activeRequests",new Map)}initialize(){this.db.initialize(),this.registerEventListeners()}registerEventListeners(){this.eventBus.on("version-saved",this.handleVersionSaved.bind(this)),this.eventBus.on("version-deleted",this.handleVersionDeleted.bind(this)),this.eventBus.on("history-deleted",this.handleHistoryDeleted.bind(this)),this.eventBus.on("version-updated",this.handleVersionUpdated.bind(this))}async getOrGenerateTimeline(t,n,r){let i=`${t}:${n}:${r}`;if(this.activeRequests.has(i))return this.activeRequests.get(i);let o=this.generateTimelineInternal(t,n,r).finally(()=>{this.activeRequests.delete(i)});return this.activeRequests.set(i,o),o}async generateTimelineInternal(t,n,r){let[i,o]=await Promise.all([r==="version"?this.versionManager.getVersionHistory(t):this.editHistoryManager.getEditHistory(t),this.db.getTimeline(t,n,r)]),s=mr(i,["timestamp","versionNumber"],["asc","asc"]);if(s.length===0)return[];let a=new Map(o.map(p=>[p.toVersionId,p])),l=[],c=null;for(let p of s){let d=a.get(p.id),h=c?c.id:null;d&&d.fromVersionId===h||l.push({from:c,to:p}),c=p}if(l.length>0){let p=l.map(h=>async()=>{try{let[m,v]=await Promise.all([h.from?this.loadContent(t,r,h.from):Promise.resolve(""),this.loadContent(t,r,h.to)]);return await this.generateEvent(t,n,r,h.from,h.to,m,v)}catch(m){return console.error(`VC: Failed to generate event for ${h.to.id}`,m),null}}),d=await this.queue.addAll(p,{priority:0});for(let h of d)h&&a.set(h.toVersionId,h)}let u=new Set(s.map(p=>p.id)),f=[];for(let p of o)u.has(p.toVersionId)||(f.push(this.db.removeEventByVersion(t,n,r,p.toVersionId).catch(d=>console.warn("VC: Failed to cleanup orphan event",d))),a.delete(p.toVersionId));return f.length>0&&await Promise.all(f),mr(Array.from(a.values()),["timestamp","toVersionNumber"],["asc","asc"])}async loadContent(t,n,r){if(n==="version"){let i=await this.contentRepo.readBinary(t,r.id);return i||await this.diffManager.getContent(t,r)||""}else return await this.editHistoryManager.getEditContent(t,r.id)||""}async generateEvent(t,n,r,i,o,s,a){let l=s instanceof ArrayBuffer?s.slice(0):s,c=a instanceof ArrayBuffer?a.slice(0):a;return await this.db.generateAndStoreEvent(t,n,r,i?i.id:null,o.id,o.timestamp,o.versionNumber,l,c,(()=>{let u={};return o.name&&(u.name=o.name),o.description&&(u.description=o.description),u})())}async createEventForNewVersion(t,n,r,i){return this.queue.add(async()=>{let o=[];r==="version"?o=await this.versionManager.getVersionHistory(t):o=await this.editHistoryManager.getEditHistory(t);let s=mr(o,["timestamp","versionNumber"],["desc","desc"]),a=s.findIndex(f=>f.id===i.id);if(a===-1)return null;let l=s[a+1]||null,[c,u]=await Promise.all([l?this.loadContent(t,r,l):Promise.resolve(""),this.loadContent(t,r,i)]);return await this.generateEvent(t,n,r,l,i,c,u)},{priority:10})}async handleVersionSaved(t){}async handleVersionDeleted(t){}async handleHistoryDeleted(t){this.queue.add(async()=>{await this.db.clearTimelineForNote(t)},{priority:5})}async handleVersionUpdated(t,n,r){this.queue.add(async()=>{await this.db.updateEventMetadata(t,n,r)},{priority:5})}};var Ax=class extends Ss{constructor(){super({workerString:'(()=>{var Mc=Object.create;var Rs=Object.defineProperty;var Dc=Object.getOwnPropertyDescriptor;var Tc=Object.getOwnPropertyNames;var Nc=Object.getPrototypeOf,Rc=Object.prototype.hasOwnProperty;var vn=(t,e)=>()=>(t&&(e=t(t=0)),e);var zc=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),jc=(t,e)=>{for(var n in e)Rs(t,n,{get:e[n],enumerable:!0})},Lc=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Tc(e))!Rc.call(t,o)&&o!==n&&Rs(t,o,{get:()=>e[o],enumerable:!(i=Dc(e,o))||i.enumerable});return t};var Bc=(t,e,n)=>(n=t!=null?Mc(Nc(t)):{},Lc(e||!t||!t.__esModule?Rs(n,"default",{value:t,enumerable:!0}):n,t));function yt(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}function xt(t){return t?ja(t)||vi(t)||!!t[Aa]||!!t[ci]?.[Aa]||gi(t)||bi(t):!1}function ja(t){if(!t||!wi(t))return!1;let e=zn(t);if(e===null||e===ut[mi])return!0;let n=ut.hasOwnProperty.call(e,ci)&&e[ci];if(n===Object)return!0;if(!Rn(n))return!1;let i=Ca.get(n);return i===void 0&&(i=Function.toString.call(n),Ca.set(n,i)),i===Yc}function fr(t,e,n=!0){hr(t)===0?(n?Reflect.ownKeys(t):ut.keys(t)).forEach(o=>{e(o,t[o],t)}):t.forEach((i,o)=>e(o,i,t))}function hr(t){let e=t[ue];return e?e.type_:vi(t)?1:gi(t)?2:bi(t)?3:0}function Qc(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function el(t){let e=+t;return Number.isInteger(e)&&String(e)===t}function Ks(t,e){if(gi(t))return new Map(t);if(bi(t))return new Set(t);if(vi(t))return Array[mi].slice.call(t);let n=ja(t);if(e===!0||e==="class_only"&&!n){let i=ut.getOwnPropertyDescriptors(t);delete i[ue];let o=Reflect.ownKeys(i);for(let a=0;a<o.length;a++){let c=o[a],h=i[c];h[ai]===!1&&(h[ai]=!0,h[Fs]=!0),(h.get||h.set)&&(i[c]={[Fs]:!0,[ai]:!0,[li]:h[li],[or]:t[c]})}return ut.create(zn(t),i)}else{let i=zn(t);if(i!==null&&n)return{...t};let o=ut.create(i);return ut.assign(o,t)}}function te(t,e=!1){return xi(t)||Zt(t)||!xt(t)||(hr(t)>1&&ut.defineProperties(t,{set:oi,add:oi,clear:oi,delete:oi}),ut.freeze(t),e&&fr(t,(n,i)=>{te(i,!0)},!1)),t}function rl(){yt(2)}function xi(t){return t===null||!wi(t)?!0:ut.isFrozen(t)}function bn(t){let e=hi[t];return e||yt(0,t),e}function il(t,e){hi[t]||(hi[t]=e)}function Da(t,e){e&&(t.patchPlugin_=bn($s),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Hs(t){Us(t),t.drafts_.forEach(ol),t.drafts_=null}function Us(t){t===ur&&(ur=t.parent_)}function ol(t){let e=t[ue];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Na(t,e){e.unfinalizedDrafts_=e.drafts_.length;let n=e.drafts_[0];if(t!==void 0&&t!==n){n[ue].modified_&&(Hs(e),yt(4)),xt(t)&&(t=Ra(e,t));let{patchPlugin_:o}=e;o&&o.generateReplacementPatches_(n[ue].base_,t,e)}else t=Ra(e,n);return al(e,t,!0),Hs(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==za?t:void 0}function Ra(t,e){if(xi(e))return e;let n=e[ue];if(!n)return di(e,t.handledSet_,t);if(!_i(n,t))return e;if(!n.modified_)return n.base_;if(!n.finalized_){let{callbacks_:i}=n;if(i)for(;i.length>0;)i.pop()(t);Fa(n,t)}return n.copy_}function al(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&te(e,n)}function La(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}function Ba(t,e,n,i){let o=Be(t),a=t.type_;if(i!==void 0&&qs(o,i,a)===e){fi(o,i,n,a);return}if(!t.draftLocations_){let h=t.draftLocations_=new Map;fr(o,(p,d)=>{if(Zt(d)){let m=h.get(d)||[];m.push(p),h.set(d,m)}})}let c=t.draftLocations_.get(e)??ul;for(let h of c)fi(o,h,n,a)}function cl(t,e,n){t.callbacks_.push(function(o){let a=e;if(!a||!_i(a,o))return;o.mapSetPlugin_?.fixSetContents(a);let c=Gs(a);Ba(t,a.draft_??a,c,n),Fa(a,o)})}function Fa(t,e){if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(t.assigned_?.size??0)>0)){let{patchPlugin_:i}=e;if(i){let o=i.getPath(t);o&&i.generatePatches_(t,o,e)}La(t)}}function Vs(t,e,n){let{scope_:i}=t;if(Zt(n)){let o=n[ue];_i(o,i)&&o.callbacks_.push(function(){ui(t);let c=Gs(o);Ba(t,n,c,e)})}else xt(n)&&t.callbacks_.push(function(){let a=Be(t);t.type_===3?a.has(n)&&di(n,i.handledSet_,i):qs(a,e,t.type_)===n&&i.drafts_.length>1&&(t.assigned_.get(e)??!1)===!0&&t.copy_&&di(qs(t.copy_,e,t.type_),i.handledSet_,i)})}function di(t,e,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||Zt(t)||e.has(t)||!xt(t)||xi(t)||(e.add(t),fr(t,(i,o)=>{if(Zt(o)){let a=o[ue];if(_i(a,n)){let c=Gs(a);fi(t,i,c,t.type_),La(a)}}else xt(o)&&di(o,e,n)})),t}function ll(t,e){let n=vi(t),i={type_:n?1:0,scope_:e?e.scope_:pi(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0},o=i,a=yi;n&&(o=[i],a=cr);let{revoke:c,proxy:h}=Proxy.revocable(o,a);return i.draft_=h,i.revoke_=c,[h,i]}function Bs(t,e){let n=t[ue];return(n?Be(n):t)[e]}function fl(t,e,n){let i=qa(e,n);return i?or in i?i[or]:i.get?.call(t.draft_):void 0}function qa(t,e){if(!(e in t))return;let n=zn(t);for(;n;){let i=Object.getOwnPropertyDescriptor(n,e);if(i)return i;n=zn(n)}}function jt(t){t.modified_||(t.modified_=!0,t.parent_&&jt(t.parent_))}function ui(t){t.copy_||(t.assigned_=new Map,t.copy_=Ks(t.base_,t.scope_.immer_.useStrictShallowCopy_))}function lr(t,e,n,i){let[o,a]=gi(e)?bn(ar).proxyMap_(e,n):bi(e)?bn(ar).proxySet_(e,n):ll(e,n);return(n?.scope_??pi()).drafts_.push(o),a.callbacks_=n?.callbacks_??[],a.key_=i,n&&i!==void 0?cl(n,a,i):a.callbacks_.push(function(p){p.mapSetPlugin_?.fixSetContents(a);let{patchPlugin_:d}=p;a.modified_&&d&&d.generatePatches_(a,[],p)}),o}function pl(t){return Zt(t)||yt(10,t),Ka(t)}function Ka(t){if(!xt(t)||xi(t))return t;let e=t[ue],n,i=!0;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=Ks(t,e.scope_.immer_.useStrictShallowCopy_),i=e.scope_.immer_.shouldUseStrictIteration()}else n=Ks(t,!0);return fr(n,(o,a)=>{fi(n,o,Ka(a))},i),e&&(e.finalized_=!1),n}function $a(){class t extends Map{constructor(d,m){super(),this[ue]={type_:2,parent_:m,scope_:m?m.scope_:pi(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:d,draft_:this,isManual_:!1,revoked_:!1,callbacks_:[]}}get size(){return Be(this[ue]).size}has(d){return Be(this[ue]).has(d)}set(d,m){let g=this[ue];return c(g),(!Be(g).has(d)||Be(g).get(d)!==m)&&(n(g),jt(g),g.assigned_.set(d,!0),g.copy_.set(d,m),g.assigned_.set(d,!0),Vs(g,d,m)),this}delete(d){if(!this.has(d))return!1;let m=this[ue];return c(m),n(m),jt(m),m.base_.has(d)?m.assigned_.set(d,!1):m.assigned_.delete(d),m.copy_.delete(d),!0}clear(){let d=this[ue];c(d),Be(d).size&&(n(d),jt(d),d.assigned_=new Map,fr(d.base_,m=>{d.assigned_.set(m,!1)}),d.copy_.clear())}forEach(d,m){let g=this[ue];Be(g).forEach((w,O,T)=>{d.call(m,this.get(O),O,this)})}get(d){let m=this[ue];c(m);let g=Be(m).get(d);if(m.finalized_||!xt(g)||g!==m.base_.get(d))return g;let w=lr(m.scope_,g,m,d);return n(m),m.copy_.set(d,w),w}keys(){return Be(this[ue]).keys()}values(){let d=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{let m=d.next();return m.done?m:{done:!1,value:this.get(m.value)}}}}entries(){let d=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{let m=d.next();if(m.done)return m;let g=this.get(m.value);return{done:!1,value:[m.value,g]}}}}[Symbol.iterator](){return this.entries()}}function e(p,d){let m=new t(p,d);return[m,m[ue]]}function n(p){p.copy_||(p.assigned_=new Map,p.copy_=new Map(p.base_))}class i extends Set{constructor(d,m){super(),this[ue]={type_:3,parent_:m,scope_:m?m.scope_:pi(),modified_:!1,finalized_:!1,copy_:void 0,base_:d,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1,assigned_:void 0,callbacks_:[]}}get size(){return Be(this[ue]).size}has(d){let m=this[ue];return c(m),m.copy_?!!(m.copy_.has(d)||m.drafts_.has(d)&&m.copy_.has(m.drafts_.get(d))):m.base_.has(d)}add(d){let m=this[ue];return c(m),this.has(d)||(a(m),jt(m),m.copy_.add(d),Vs(m,d,d)),this}delete(d){if(!this.has(d))return!1;let m=this[ue];return c(m),a(m),jt(m),m.copy_.delete(d)||(m.drafts_.has(d)?m.copy_.delete(m.drafts_.get(d)):!1)}clear(){let d=this[ue];c(d),Be(d).size&&(a(d),jt(d),d.copy_.clear())}values(){let d=this[ue];return c(d),a(d),d.copy_.values()}entries(){let d=this[ue];return c(d),a(d),d.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(d,m){let g=this.values(),w=g.next();for(;!w.done;)d.call(m,w.value,w.value,this),w=g.next()}}function o(p,d){let m=new i(p,d);return[m,m[ue]]}function a(p){p.copy_||(p.copy_=new Set,p.base_.forEach(d=>{if(xt(d)){let m=lr(p.scope_,d,p,d);p.drafts_.set(d,m),p.copy_.add(m)}else p.copy_.add(d)}))}function c(p){p.revoked_&&yt(3,JSON.stringify(Be(p)))}function h(p){if(p.type_===3&&p.copy_){let d=new Set(p.copy_);p.copy_.clear(),d.forEach(m=>{p.copy_.add(nl(m))})}}il(ar,{proxyMap_:e,proxySet_:o,fixSetContents:h})}var za,Aa,ue,ut,zn,ci,mi,Fs,li,ai,or,Zt,Yc,Ca,Oa,qs,fi,vi,gi,bi,wi,Rn,Ls,tl,Be,nl,Gs,oi,ar,$s,Pa,hi,Ma,ur,pi,sl,Ta,_i,ul,yi,cr,hl,dl,Ue,it=vn(()=>{za=Symbol.for("immer-nothing"),Aa=Symbol.for("immer-draftable"),ue=Symbol.for("immer-state");ut=Object,zn=ut.getPrototypeOf,ci="constructor",mi="prototype",Fs="configurable",li="enumerable",ai="writable",or="value",Zt=t=>!!t&&!!t[ue];Yc=ut[mi][ci].toString(),Ca=new WeakMap;Oa=(t,e,n=hr(t))=>n===2?t.has(e):ut[mi].hasOwnProperty.call(t,e),qs=(t,e,n=hr(t))=>n===2?t.get(e):t[e],fi=(t,e,n,i=hr(t))=>{i===2?t.set(e,n):i===3?t.add(n):t[e]=n};vi=Array.isArray,gi=t=>t instanceof Map,bi=t=>t instanceof Set,wi=t=>typeof t=="object",Rn=t=>typeof t=="function",Ls=t=>typeof t=="boolean";tl=t=>wi(t)?t?.[ue]:null,Be=t=>t.copy_||t.base_,nl=t=>{let e=tl(t);return e?e.copy_??e.base_:t},Gs=t=>t.modified_?t.copy_:t.base_;oi={[or]:rl};ar="MapSet",$s="Patches",Pa="ArrayMethods",hi={};Ma=t=>!!hi[t];pi=()=>ur,sl=(t,e)=>({drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:Ma(ar)?bn(ar):void 0,arrayMethodsPlugin_:Ma(Pa)?bn(Pa):void 0});Ta=t=>ur=sl(ur,t);_i=(t,e)=>t.scope_===e,ul=[];yi={get(t,e){if(e===ue)return t;let n=t.scope_.arrayMethodsPlugin_,i=t.type_===1&&typeof e=="string";if(i&&n?.isArrayOperationMethod(e))return n.createMethodInterceptor(t,e);let o=Be(t);if(!Oa(o,e,t.type_))return fl(t,o,e);let a=o[e];if(t.finalized_||!xt(a)||i&&t.operationMethod&&n?.isMutatingArrayMethod(t.operationMethod)&&el(e))return a;if(a===Bs(t.base_,e)){ui(t);let c=t.type_===1?+e:e,h=lr(t.scope_,a,t,c);return t.copy_[c]=h}return a},has(t,e){return e in Be(t)},ownKeys(t){return Reflect.ownKeys(Be(t))},set(t,e,n){let i=qa(Be(t),e);if(i?.set)return i.set.call(t.draft_,n),!0;if(!t.modified_){let o=Bs(Be(t),e),a=o?.[ue];if(a&&a.base_===n)return t.copy_[e]=n,t.assigned_.set(e,!1),!0;if(Qc(n,o)&&(n!==void 0||Oa(t.base_,e,t.type_)))return!0;ui(t),jt(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_.set(e,!0),Vs(t,e,n)),!0},deleteProperty(t,e){return ui(t),Bs(t.base_,e)!==void 0||e in t.base_?(t.assigned_.set(e,!1),jt(t)):t.assigned_.delete(e),t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){let n=Be(t),i=Reflect.getOwnPropertyDescriptor(n,e);return i&&{[ai]:!0,[Fs]:t.type_!==1||e!=="length",[li]:i[li],[or]:n[e]}},defineProperty(){yt(11)},getPrototypeOf(t){return zn(t.base_)},setPrototypeOf(){yt(12)}},cr={};for(let t in yi){let e=yi[t];cr[t]=function(){let n=arguments;return n[0]=n[0][0],e.apply(this,n)}}cr.deleteProperty=function(t,e){return cr.set.call(this,t,e,void 0)};cr.set=function(t,e,n){return yi.set.call(this,t[0],e,n,t[0])};hl=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(e,n,i)=>{if(Rn(e)&&!Rn(n)){let a=n;n=e;let c=this;return function(p=a,...d){return c.produce(p,m=>n.call(this,m,...d))}}Rn(n)||yt(6),i!==void 0&&!Rn(i)&&yt(7);let o;if(xt(e)){let a=Ta(this),c=lr(a,e,void 0),h=!0;try{o=n(c),h=!1}finally{h?Hs(a):Us(a)}return Da(a,i),Na(o,a)}else if(!e||!wi(e)){if(o=n(e),o===void 0&&(o=e),o===za&&(o=void 0),this.autoFreeze_&&te(o,!0),i){let a=[],c=[];bn($s).generateReplacementPatches_(e,o,{patches_:a,inversePatches_:c}),i(a,c)}return o}else yt(1,e)},this.produceWithPatches=(e,n)=>{if(Rn(e))return(c,...h)=>this.produceWithPatches(c,p=>e(p,...h));let i,o;return[this.produce(e,n,(c,h)=>{i=c,o=h}),i,o]},Ls(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Ls(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Ls(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){xt(t)||yt(8),Zt(t)&&(t=pl(t));let e=Ta(this),n=lr(e,t,void 0);return n[ue].isManual_=!0,Us(e),n}finishDraft(t,e){let n=t&&t[ue];(!n||!n.isManual_)&&yt(9);let{scope_:i}=n;return Da(i,e),Na(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){let o=e[n];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}n>-1&&(e=e.slice(n+1));let i=bn($s).applyPatches_;return Zt(t)?i(t,e):this.produce(t,o=>i(o,e))}};dl=new hl,Ue=dl.produce});var Ws,Ei,Ha=vn(()=>{it();Ws=class extends Error{constructor(e,n,i){super(`Mutex operation ${i} timed out after ${n}ms for keys: ${e.join(", ")}`),this.name="MutexTimeoutError",Object.freeze(this)}},Ei=class{queue=[];heldKeys=new Set;defaultTimeoutMs;isProcessing=!1;operationCounter=0;constructor(e=3e4){this.defaultTimeoutMs=e}async run(e,n,i,o=0){return this.runMultiple([e],n,i,o)}async runMultiple(e,n,i=this.defaultTimeoutMs,o=0){let a=te([...new Set(e)].filter(c=>c.length>0).sort());return a.length===0?n():new Promise((c,h)=>{let p=`op_${++this.operationCounter}`,d=Date.now(),m=setTimeout(()=>{let w=this.queue.findIndex(O=>O.id===p);w!==-1&&(this.queue.splice(w,1),h(new Ws(a,i,p)))},i),g={keys:a,execute:async()=>(clearTimeout(m),n()),resolve:c,reject:h,enqueuedAt:d,priority:o,id:p};this.enqueueOperation(g),this.processQueue()})}enqueueOperation(e){let n=this.queue.findIndex(i=>i.priority>e.priority);n===-1?this.queue.push(e):this.queue.splice(n,0,e)}processQueue(){if(!this.isProcessing){this.isProcessing=!0;try{this.processNextOperation()}finally{this.isProcessing=!1}}}processNextOperation(){let e=this.queue.findIndex(i=>!i.keys.some(o=>this.heldKeys.has(o)));if(e===-1)return;let n=this.queue.splice(e,1)[0];if(n!==void 0){for(let i of n.keys)this.heldKeys.add(i);n.execute().then(n.resolve).catch(n.reject).finally(()=>{for(let i of n.keys)this.heldKeys.delete(i);this.processQueue()})}}get activeKeys(){return te([...this.heldKeys])}get queueLength(){return this.queue.length}getStats(){return{queuedOperations:this.queue.length,heldKeys:this.heldKeys.size,totalOperations:this.operationCounter}}clearQueue(){for(let e of this.queue)e.reject(new Error("Queue cleared"));this.queue.length=0}hasLock(e){return this.heldKeys.has(e)}waitForLock(e,n=this.defaultTimeoutMs){return new Promise((i,o)=>{let a=Date.now(),c=()=>{this.hasLock(e)?Date.now()-a>n?o(new Error(`Timeout waiting for lock on key: ${e}`)):setTimeout(c,10):i()};c()})}}});function ki(t){return new Promise(e=>setTimeout(e,t))}var Si=vn(()=>{Ha()});var Ua=zc((Xs,Zs)=>{(function(t,e){typeof Xs=="object"&&typeof Zs<"u"?Zs.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).Dexie=e()})(Xs,function(){"use strict";var t=function(r,s){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,l){u.__proto__=l}||function(u,l){for(var f in l)Object.prototype.hasOwnProperty.call(l,f)&&(u[f]=l[f])})(r,s)},e=function(){return(e=Object.assign||function(r){for(var s,u=1,l=arguments.length;u<l;u++)for(var f in s=arguments[u])Object.prototype.hasOwnProperty.call(s,f)&&(r[f]=s[f]);return r}).apply(this,arguments)};function n(r,s,u){if(u||arguments.length===2)for(var l,f=0,y=s.length;f<y;f++)!l&&f in s||((l=l||Array.prototype.slice.call(s,0,f))[f]=s[f]);return r.concat(l||Array.prototype.slice.call(s))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:window,o=Object.keys,a=Array.isArray;function c(r,s){return typeof s!="object"||o(s).forEach(function(u){r[u]=s[u]}),r}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var h=Object.getPrototypeOf,p={}.hasOwnProperty;function d(r,s){return p.call(r,s)}function m(r,s){typeof s=="function"&&(s=s(h(r))),(typeof Reflect>"u"?o:Reflect.ownKeys)(s).forEach(function(u){w(r,u,s[u])})}var g=Object.defineProperty;function w(r,s,u,l){g(r,s,c(u&&d(u,"get")&&typeof u.get=="function"?{get:u.get,set:u.set,configurable:!0}:{value:u,configurable:!0,writable:!0},l))}function O(r){return{from:function(s){return r.prototype=Object.create(s.prototype),w(r.prototype,"constructor",r),{extend:m.bind(null,r.prototype)}}}}var T=Object.getOwnPropertyDescriptor,L=[].slice;function j(r,s,u){return L.call(r,s,u)}function F(r,s){return s(r)}function W(r){if(!r)throw new Error("Assertion Failed")}function B(r){i.setImmediate?setImmediate(r):setTimeout(r,0)}function K(r,s){if(typeof s=="string"&&d(r,s))return r[s];if(!s)return r;if(typeof s!="string"){for(var u=[],l=0,f=s.length;l<f;++l){var y=K(r,s[l]);u.push(y)}return u}var v=s.indexOf(".");if(v!==-1){var b=r[s.substr(0,v)];return b==null?void 0:K(b,s.substr(v+1))}}function Y(r,s,u){if(r&&s!==void 0&&!("isFrozen"in Object&&Object.isFrozen(r)))if(typeof s!="string"&&"length"in s){W(typeof u!="string"&&"length"in u);for(var l=0,f=s.length;l<f;++l)Y(r,s[l],u[l])}else{var y,v,b=s.indexOf(".");b!==-1?(y=s.substr(0,b),(v=s.substr(b+1))===""?u===void 0?a(r)&&!isNaN(parseInt(y))?r.splice(y,1):delete r[y]:r[y]=u:Y(b=!(b=r[y])||!d(r,y)?r[y]={}:b,v,u)):u===void 0?a(r)&&!isNaN(parseInt(s))?r.splice(s,1):delete r[s]:r[s]=u}}function ce(r){var s,u={};for(s in r)d(r,s)&&(u[s]=r[s]);return u}var fe=[].concat;function ne(r){return fe.apply([],r)}var an="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ne([8,16,32,64].map(function(r){return["Int","Uint","Float"].map(function(s){return s+r+"Array"})}))).filter(function(r){return i[r]}),Q=new Set(an.map(function(r){return i[r]})),ve=null;function he(r){return ve=new WeakMap,r=(function s(u){if(!u||typeof u!="object")return u;var l=ve.get(u);if(l)return l;if(a(u)){l=[],ve.set(u,l);for(var f=0,y=u.length;f<y;++f)l.push(s(u[f]))}else if(Q.has(u.constructor))l=u;else{var v,b=h(u);for(v in l=b===Object.prototype?{}:Object.create(b),ve.set(u,l),u)d(u,v)&&(l[v]=s(u[v]))}return l})(r),ve=null,r}var Ae={}.toString;function Qe(r){return Ae.call(r).slice(8,-1)}var Me=typeof Symbol<"u"?Symbol.iterator:"@@iterator",De=typeof Me=="symbol"?function(r){var s;return r!=null&&(s=r[Me])&&s.apply(r)}:function(){return null};function be(r,s){return s=r.indexOf(s),0<=s&&r.splice(s,1),0<=s}var ye={};function Ce(r){var s,u,l,f;if(arguments.length===1){if(a(r))return r.slice();if(this===ye&&typeof r=="string")return[r];if(f=De(r)){for(u=[];!(l=f.next()).done;)u.push(l.value);return u}if(r==null)return[r];if(typeof(s=r.length)!="number")return[r];for(u=new Array(s);s--;)u[s]=r[s];return u}for(s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return u}var Te=typeof Symbol<"u"?function(r){return r[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Wn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],dt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Wn),sn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function qe(r,s){this.name=r,this.message=s}function ht(r,s){return r+". Errors: "+Object.keys(s).map(function(u){return s[u].toString()}).filter(function(u,l,f){return f.indexOf(u)===l}).join(`\n`)}function Ke(r,s,u,l){this.failures=s,this.failedKeys=l,this.successCount=u,this.message=ht(r,s)}function Le(r,s){this.name="BulkError",this.failures=Object.keys(s).map(function(u){return s[u]}),this.failuresByPos=s,this.message=ht(r,this.failures)}O(qe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),O(Ke).from(qe),O(Le).from(qe);var ke=dt.reduce(function(r,s){return r[s]=s+"Error",r},{}),pt=qe,J=dt.reduce(function(r,s){var u=s+"Error";function l(f,y){this.name=u,f?typeof f=="string"?(this.message="".concat(f).concat(y?`\n `+y:""),this.inner=y||null):typeof f=="object"&&(this.message="".concat(f.name," ").concat(f.message),this.inner=f):(this.message=sn[s]||u,this.inner=null)}return O(l).from(pt),r[s]=l,r},{});J.Syntax=SyntaxError,J.Type=TypeError,J.Range=RangeError;var Tt=Wn.reduce(function(r,s){return r[s+"Error"]=J[s],r},{}),Nt=dt.reduce(function(r,s){return["Syntax","Type","Range"].indexOf(s)===-1&&(r[s+"Error"]=J[s]),r},{});function de(){}function wt(r){return r}function on(r,s){return r==null||r===wt?s:function(u){return s(r(u))}}function rt(r,s){return function(){r.apply(this,arguments),s.apply(this,arguments)}}function Vn(r,s){return r===de?s:function(){var u=r.apply(this,arguments);u!==void 0&&(arguments[0]=u);var l=this.onsuccess,f=this.onerror;this.onsuccess=null,this.onerror=null;var y=s.apply(this,arguments);return l&&(this.onsuccess=this.onsuccess?rt(l,this.onsuccess):l),f&&(this.onerror=this.onerror?rt(f,this.onerror):f),y!==void 0?y:u}}function rc(r,s){return r===de?s:function(){r.apply(this,arguments);var u=this.onsuccess,l=this.onerror;this.onsuccess=this.onerror=null,s.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?rt(u,this.onsuccess):u),l&&(this.onerror=this.onerror?rt(l,this.onerror):l)}}function ic(r,s){return r===de?s:function(u){var l=r.apply(this,arguments);c(u,l);var f=this.onsuccess,y=this.onerror;return this.onsuccess=null,this.onerror=null,u=s.apply(this,arguments),f&&(this.onsuccess=this.onsuccess?rt(f,this.onsuccess):f),y&&(this.onerror=this.onerror?rt(y,this.onerror):y),l===void 0?u===void 0?void 0:u:c(l,u)}}function sc(r,s){return r===de?s:function(){return s.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function es(r,s){return r===de?s:function(){var u=r.apply(this,arguments);if(u&&typeof u.then=="function"){for(var l=this,f=arguments.length,y=new Array(f);f--;)y[f]=arguments[f];return u.then(function(){return s.apply(l,y)})}return s.apply(this,arguments)}}Nt.ModifyError=Ke,Nt.DexieError=qe,Nt.BulkError=Le;var At=typeof location<"u"&&/^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);function Bo(r){At=r}var Gn={},Fo=100,an=typeof Promise>"u"?[]:(function(){var r=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[r,h(r),r];var s=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[s,h(s),r]})(),Wn=an[0],dt=an[1],an=an[2],dt=dt&&dt.then,un=Wn&&Wn.constructor,ts=!!an,Xn=function(r,s){Zn.push([r,s]),Ar&&(queueMicrotask(ac),Ar=!1)},ns=!0,Ar=!0,cn=[],Cr=[],rs=wt,$t={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:de,pgp:!1,env:{},finalize:de},ee=$t,Zn=[],ln=0,Or=[];function X(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var s=this._PSD=ee;if(typeof r!="function"){if(r!==Gn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ss(this,this._value))}this._state=null,this._value=null,++s.ref,(function u(l,f){try{f(function(y){if(l._state===null){if(y===l)throw new TypeError("A promise cannot be resolved with itself.");var v=l._lib&&In();y&&typeof y.then=="function"?u(l,function(b,_){y instanceof X?y._then(b,_):y.then(b,_)}):(l._state=!0,l._value=y,Ko(l)),v&&An()}},ss.bind(null,l))}catch(y){ss(l,y)}})(this,r)}var is={get:function(){var r=ee,s=Tr;function u(l,f){var y=this,v=!r.global&&(r!==ee||s!==Tr),b=v&&!Ut(),_=new X(function(E,A){os(y,new qo(Ho(l,r,v,b),Ho(f,r,v,b),E,A,r))});return this._consoleTask&&(_._consoleTask=this._consoleTask),_}return u.prototype=Gn,u},set:function(r){w(this,"then",r&&r.prototype===Gn?is:{get:function(){return r},set:is.set})}};function qo(r,s,u,l,f){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof s=="function"?s:null,this.resolve=u,this.reject=l,this.psd=f}function ss(r,s){var u,l;Cr.push(s),r._state===null&&(u=r._lib&&In(),s=rs(s),r._state=!1,r._value=s,l=r,cn.some(function(f){return f._value===l._value})||cn.push(l),Ko(r),u&&An())}function Ko(r){var s=r._listeners;r._listeners=[];for(var u=0,l=s.length;u<l;++u)os(r,s[u]);var f=r._PSD;--f.ref||f.finalize(),ln===0&&(++ln,Xn(function(){--ln==0&&as()},[]))}function os(r,s){if(r._state!==null){var u=r._state?s.onFulfilled:s.onRejected;if(u===null)return(r._state?s.resolve:s.reject)(r._value);++s.psd.ref,++ln,Xn(oc,[u,r,s])}else r._listeners.push(s)}function oc(r,s,u){try{var l,f=s._value;!s._state&&Cr.length&&(Cr=[]),l=At&&s._consoleTask?s._consoleTask.run(function(){return r(f)}):r(f),s._state||Cr.indexOf(f)!==-1||(function(y){for(var v=cn.length;v;)if(cn[--v]._value===y._value)return cn.splice(v,1)})(s),u.resolve(l)}catch(y){u.reject(y)}finally{--ln==0&&as(),--u.psd.ref||u.psd.finalize()}}function ac(){fn($t,function(){In()&&An()})}function In(){var r=ns;return Ar=ns=!1,r}function An(){var r,s,u;do for(;0<Zn.length;)for(r=Zn,Zn=[],u=r.length,s=0;s<u;++s){var l=r[s];l[0].apply(null,l[1])}while(0<Zn.length);Ar=ns=!0}function as(){var r=cn;cn=[],r.forEach(function(l){l._PSD.onunhandled.call(null,l._value,l)});for(var s=Or.slice(0),u=s.length;u;)s[--u]()}function Pr(r){return new X(Gn,!1,r)}function Oe(r,s){var u=ee;return function(){var l=In(),f=ee;try{return Vt(u,!0),r.apply(this,arguments)}catch(y){s&&s(y)}finally{Vt(f,!1),l&&An()}}}m(X.prototype,{then:is,_then:function(r,s){os(this,new qo(null,null,r,s,ee))},catch:function(r){if(arguments.length===1)return this.then(null,r);var s=r,u=arguments[1];return typeof s=="function"?this.then(null,function(l){return(l instanceof s?u:Pr)(l)}):this.then(null,function(l){return(l&&l.name===s?u:Pr)(l)})},finally:function(r){return this.then(function(s){return X.resolve(r()).then(function(){return s})},function(s){return X.resolve(r()).then(function(){return Pr(s)})})},timeout:function(r,s){var u=this;return r<1/0?new X(function(l,f){var y=setTimeout(function(){return f(new J.Timeout(s))},r);u.then(l,f).finally(clearTimeout.bind(null,y))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&w(X.prototype,Symbol.toStringTag,"Dexie.Promise"),$t.env=$o(),m(X,{all:function(){var r=Ce.apply(null,arguments).map(Nr);return new X(function(s,u){r.length===0&&s([]);var l=r.length;r.forEach(function(f,y){return X.resolve(f).then(function(v){r[y]=v,--l||s(r)},u)})})},resolve:function(r){return r instanceof X?r:r&&typeof r.then=="function"?new X(function(s,u){r.then(s,u)}):new X(Gn,!0,r)},reject:Pr,race:function(){var r=Ce.apply(null,arguments).map(Nr);return new X(function(s,u){r.map(function(l){return X.resolve(l).then(s,u)})})},PSD:{get:function(){return ee},set:function(r){return ee=r}},totalEchoes:{get:function(){return Tr}},newPSD:Ht,usePSD:fn,scheduler:{get:function(){return Xn},set:function(r){Xn=r}},rejectionMapper:{get:function(){return rs},set:function(r){rs=r}},follow:function(r,s){return new X(function(u,l){return Ht(function(f,y){var v=ee;v.unhandleds=[],v.onunhandled=y,v.finalize=rt(function(){var b,_=this;b=function(){_.unhandleds.length===0?f():y(_.unhandleds[0])},Or.push(function E(){b(),Or.splice(Or.indexOf(E),1)}),++ln,Xn(function(){--ln==0&&as()},[])},v.finalize),r()},s,u,l)})}}),un&&(un.allSettled&&w(X,"allSettled",function(){var r=Ce.apply(null,arguments).map(Nr);return new X(function(s){r.length===0&&s([]);var u=r.length,l=new Array(u);r.forEach(function(f,y){return X.resolve(f).then(function(v){return l[y]={status:"fulfilled",value:v}},function(v){return l[y]={status:"rejected",reason:v}}).then(function(){return--u||s(l)})})})}),un.any&&typeof AggregateError<"u"&&w(X,"any",function(){var r=Ce.apply(null,arguments).map(Nr);return new X(function(s,u){r.length===0&&u(new AggregateError([]));var l=r.length,f=new Array(l);r.forEach(function(y,v){return X.resolve(y).then(function(b){return s(b)},function(b){f[v]=b,--l||u(new AggregateError(f))})})})}),un.withResolvers&&(X.withResolvers=un.withResolvers));var $e={awaits:0,echoes:0,id:0},uc=0,Mr=[],Dr=0,Tr=0,cc=0;function Ht(r,s,u,l){var f=ee,y=Object.create(f);return y.parent=f,y.ref=0,y.global=!1,y.id=++cc,$t.env,y.env=ts?{Promise:X,PromiseProp:{value:X,configurable:!0,writable:!0},all:X.all,race:X.race,allSettled:X.allSettled,any:X.any,resolve:X.resolve,reject:X.reject}:{},s&&c(y,s),++f.ref,y.finalize=function(){--this.parent.ref||this.parent.finalize()},l=fn(y,r,u,l),y.ref===0&&y.finalize(),l}function Cn(){return $e.id||($e.id=++uc),++$e.awaits,$e.echoes+=Fo,$e.id}function Ut(){return!!$e.awaits&&(--$e.awaits==0&&($e.id=0),$e.echoes=$e.awaits*Fo,!0)}function Nr(r){return $e.echoes&&r&&r.constructor===un?(Cn(),r.then(function(s){return Ut(),s},function(s){return Ut(),Ne(s)})):r}function lc(){var r=Mr[Mr.length-1];Mr.pop(),Vt(r,!1)}function Vt(r,s){var u,l=ee;(s?!$e.echoes||Dr++&&r===ee:!Dr||--Dr&&r===ee)||queueMicrotask(s?function(f){++Tr,$e.echoes&&--$e.echoes!=0||($e.echoes=$e.awaits=$e.id=0),Mr.push(ee),Vt(f,!0)}.bind(null,r):lc),r!==ee&&(ee=r,l===$t&&($t.env=$o()),ts&&(u=$t.env.Promise,s=r.env,(l.global||r.global)&&(Object.defineProperty(i,"Promise",s.PromiseProp),u.all=s.all,u.race=s.race,u.resolve=s.resolve,u.reject=s.reject,s.allSettled&&(u.allSettled=s.allSettled),s.any&&(u.any=s.any))))}function $o(){var r=i.Promise;return ts?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject}:{}}function fn(r,s,u,l,f){var y=ee;try{return Vt(r,!0),s(u,l,f)}finally{Vt(y,!1)}}function Ho(r,s,u,l){return typeof r!="function"?r:function(){var f=ee;u&&Cn(),Vt(s,!0);try{return r.apply(this,arguments)}finally{Vt(f,!1),l&&queueMicrotask(Ut)}}}function us(r){Promise===un&&$e.echoes===0?Dr===0?r():enqueueNativeMicroTask(r):setTimeout(r,0)}(""+dt).indexOf("[native code]")===-1&&(Cn=Ut=de);var Ne=X.reject,hn="\\uFFFF",Rt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Uo="String expected.",On=[],Rr="__dbnames",cs="readonly",ls="readwrite";function pn(r,s){return r?s?function(){return r.apply(this,arguments)&&s.apply(this,arguments)}:r:s}var Vo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function zr(r){return typeof r!="string"||/\\./.test(r)?function(s){return s}:function(s){return s[r]===void 0&&r in s&&delete(s=he(s))[r],s}}function Go(){throw J.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function pe(r,s){try{var u=Wo(r),l=Wo(s);if(u!==l)return u==="Array"?1:l==="Array"?-1:u==="binary"?1:l==="binary"?-1:u==="string"?1:l==="string"?-1:u==="Date"?1:l!=="Date"?NaN:-1;switch(u){case"number":case"Date":case"string":return s<r?1:r<s?-1:0;case"binary":return(function(f,y){for(var v=f.length,b=y.length,_=v<b?v:b,E=0;E<_;++E)if(f[E]!==y[E])return f[E]<y[E]?-1:1;return v===b?0:v<b?-1:1})(Xo(r),Xo(s));case"Array":return(function(f,y){for(var v=f.length,b=y.length,_=v<b?v:b,E=0;E<_;++E){var A=pe(f[E],y[E]);if(A!==0)return A}return v===b?0:v<b?-1:1})(r,s)}}catch{}return NaN}function Wo(r){var s=typeof r;return s!="object"?s:ArrayBuffer.isView(r)?"binary":(r=Qe(r),r==="ArrayBuffer"?"binary":r)}function Xo(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}function jr(r,s,u){var l=r.schema.yProps;return l?(s&&0<u.numFailures&&(s=s.filter(function(f,y){return!u.failures[y]})),Promise.all(l.map(function(f){return f=f.updatesTable,s?r.db.table(f).where("k").anyOf(s).delete():r.db.table(f).clear()})).then(function(){return u})):u}var Jn=(Zo.prototype.execute=function(r){var s=this["@@propmod"];if(s.add!==void 0){var u=s.add;if(a(u))return n(n([],a(r)?r:[],!0),u,!0).sort();if(typeof u=="number")return(Number(r)||0)+u;if(typeof u=="bigint")try{return BigInt(r)+u}catch{return BigInt(0)+u}throw new TypeError("Invalid term ".concat(u))}if(s.remove!==void 0){var l=s.remove;if(a(l))return a(r)?r.filter(function(f){return!l.includes(f)}).sort():[];if(typeof l=="number")return Number(r)-l;if(typeof l=="bigint")try{return BigInt(r)-l}catch{return BigInt(0)-l}throw new TypeError("Invalid subtrahend ".concat(l))}return u=(u=s.replacePrefix)===null||u===void 0?void 0:u[0],u&&typeof r=="string"&&r.startsWith(u)?s.replacePrefix[1]+r.substring(u.length):r},Zo);function Zo(r){this["@@propmod"]=r}function Jo(r,s){for(var u=o(s),l=u.length,f=!1,y=0;y<l;++y){var v=u[y],b=s[v],_=K(r,v);b instanceof Jn?(Y(r,v,b.execute(_)),f=!0):_!==b&&(Y(r,v,b),f=!0)}return f}var Yo=(Se.prototype._trans=function(r,s,u){var l=this._tx||ee.trans,f=this.name,y=At&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(r==="readonly"?"read":"write"," ").concat(this.name));function v(E,A,x){if(!x.schema[f])throw new J.NotFound("Table "+f+" not part of transaction");return s(x.idbtrans,x)}var b=In();try{var _=l&&l.db._novip===this.db._novip?l===ee.trans?l._promise(r,v,u):Ht(function(){return l._promise(r,v,u)},{trans:l,transless:ee.transless||ee}):(function E(A,x,P,k){if(A.idbdb&&(A._state.openComplete||ee.letThrough||A._vip)){var S=A._createTransaction(x,P,A._dbSchema);try{S.create(),A._state.PR1398_maxLoop=3}catch(I){return I.name===ke.InvalidState&&A.isOpen()&&0<--A._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),A.close({disableAutoOpen:!1}),A.open().then(function(){return E(A,x,P,k)})):Ne(I)}return S._promise(x,function(I,C){return Ht(function(){return ee.trans=S,k(I,C,S)})}).then(function(I){if(x==="readwrite")try{S.idbtrans.commit()}catch{}return x==="readonly"?I:S._completion.then(function(){return I})})}if(A._state.openComplete)return Ne(new J.DatabaseClosed(A._state.dbOpenError));if(!A._state.isBeingOpened){if(!A._state.autoOpen)return Ne(new J.DatabaseClosed);A.open().catch(de)}return A._state.dbReadyPromise.then(function(){return E(A,x,P,k)})})(this.db,r,[this.name],v);return y&&(_._consoleTask=y,_=_.catch(function(E){return console.trace(E),Ne(E)})),_}finally{b&&An()}},Se.prototype.get=function(r,s){var u=this;return r&&r.constructor===Object?this.where(r).first(s):r==null?Ne(new J.Type("Invalid argument to Table.get()")):this._trans("readonly",function(l){return u.core.get({trans:l,key:r}).then(function(f){return u.hook.reading.fire(f)})}).then(s)},Se.prototype.where=function(r){if(typeof r=="string")return new this.db.WhereClause(this,r);if(a(r))return new this.db.WhereClause(this,"[".concat(r.join("+"),"]"));var s=o(r);if(s.length===1)return this.where(s[0]).equals(r[s[0]]);var u=this.schema.indexes.concat(this.schema.primKey).filter(function(b){if(b.compound&&s.every(function(E){return 0<=b.keyPath.indexOf(E)})){for(var _=0;_<s.length;++_)if(s.indexOf(b.keyPath[_])===-1)return!1;return!0}return!1}).sort(function(b,_){return b.keyPath.length-_.keyPath.length})[0];if(u&&this.db._maxKey!==hn){var y=u.keyPath.slice(0,s.length);return this.where(y).equals(y.map(function(_){return r[_]}))}!u&&At&&console.warn("The query ".concat(JSON.stringify(r)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(s.join("+"),"]"));var l=this.schema.idxByName;function f(b,_){return pe(b,_)===0}var v=s.reduce(function(x,_){var E=x[0],A=x[1],x=l[_],P=r[_];return[E||x,E||!x?pn(A,x&&x.multi?function(k){return k=K(k,_),a(k)&&k.some(function(S){return f(P,S)})}:function(k){return f(P,K(k,_))}):A]},[null,null]),y=v[0],v=v[1];return y?this.where(y.name).equals(r[y.keyPath]).filter(v):u?this.filter(v):this.where(s).equals("")},Se.prototype.filter=function(r){return this.toCollection().and(r)},Se.prototype.count=function(r){return this.toCollection().count(r)},Se.prototype.offset=function(r){return this.toCollection().offset(r)},Se.prototype.limit=function(r){return this.toCollection().limit(r)},Se.prototype.each=function(r){return this.toCollection().each(r)},Se.prototype.toArray=function(r){return this.toCollection().toArray(r)},Se.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Se.prototype.orderBy=function(r){return new this.db.Collection(new this.db.WhereClause(this,a(r)?"[".concat(r.join("+"),"]"):r))},Se.prototype.reverse=function(){return this.toCollection().reverse()},Se.prototype.mapToClass=function(r){var s,u=this.db,l=this.name;function f(){return s!==null&&s.apply(this,arguments)||this}(this.schema.mappedClass=r).prototype instanceof Go&&((function(_,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");function A(){this.constructor=_}t(_,E),_.prototype=E===null?Object.create(E):(A.prototype=E.prototype,new A)})(f,s=r),Object.defineProperty(f.prototype,"db",{get:function(){return u},enumerable:!1,configurable:!0}),f.prototype.table=function(){return l},r=f);for(var y=new Set,v=r.prototype;v;v=h(v))Object.getOwnPropertyNames(v).forEach(function(_){return y.add(_)});function b(_){if(!_)return _;var E,A=Object.create(r.prototype);for(E in _)if(!y.has(E))try{A[E]=_[E]}catch{}return A}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=b,this.hook("reading",b),r},Se.prototype.defineClass=function(){return this.mapToClass(function(r){c(this,r)})},Se.prototype.add=function(r,s){var u=this,l=this.schema.primKey,f=l.auto,y=l.keyPath,v=r;return y&&f&&(v=zr(y)(r)),this._trans("readwrite",function(b){return u.core.mutate({trans:b,type:"add",keys:s!=null?[s]:null,values:[v]})}).then(function(b){return b.numFailures?X.reject(b.failures[0]):b.lastResult}).then(function(b){if(y)try{Y(r,y,b)}catch{}return b})},Se.prototype.upsert=function(r,s){var u=this,l=this.schema.primKey.keyPath;return this._trans("readwrite",function(f){return u.core.get({trans:f,key:r}).then(function(y){var v=y??{};return Jo(v,s),l&&Y(v,l,r),u.core.mutate({trans:f,type:"put",values:[v],keys:[r],upsert:!0,updates:{keys:[r],changeSpecs:[s]}}).then(function(b){return b.numFailures?X.reject(b.failures[0]):!!y})})})},Se.prototype.update=function(r,s){return typeof r!="object"||a(r)?this.where(":id").equals(r).modify(s):(r=K(r,this.schema.primKey.keyPath),r===void 0?Ne(new J.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(s))},Se.prototype.put=function(r,s){var u=this,l=this.schema.primKey,f=l.auto,y=l.keyPath,v=r;return y&&f&&(v=zr(y)(r)),this._trans("readwrite",function(b){return u.core.mutate({trans:b,type:"put",values:[v],keys:s!=null?[s]:null})}).then(function(b){return b.numFailures?X.reject(b.failures[0]):b.lastResult}).then(function(b){if(y)try{Y(r,y,b)}catch{}return b})},Se.prototype.delete=function(r){var s=this;return this._trans("readwrite",function(u){return s.core.mutate({trans:u,type:"delete",keys:[r]}).then(function(l){return jr(s,[r],l)}).then(function(l){return l.numFailures?X.reject(l.failures[0]):void 0})})},Se.prototype.clear=function(){var r=this;return this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"deleteRange",range:Vo}).then(function(u){return jr(r,null,u)})}).then(function(s){return s.numFailures?X.reject(s.failures[0]):void 0})},Se.prototype.bulkGet=function(r){var s=this;return this._trans("readonly",function(u){return s.core.getMany({keys:r,trans:u}).then(function(l){return l.map(function(f){return s.hook.reading.fire(f)})})})},Se.prototype.bulkAdd=function(r,s,u){var l=this,f=Array.isArray(s)?s:void 0,y=(u=u||(f?void 0:s))?u.allKeys:void 0;return this._trans("readwrite",function(v){var E=l.schema.primKey,b=E.auto,E=E.keyPath;if(E&&f)throw new J.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(f&&f.length!==r.length)throw new J.InvalidArgument("Arguments objects and keys must have the same length");var _=r.length,E=E&&b?r.map(zr(E)):r;return l.core.mutate({trans:v,type:"add",keys:f,values:E,wantResults:y}).then(function(S){var x=S.numFailures,P=S.results,k=S.lastResult,S=S.failures;if(x===0)return y?P:k;throw new Le("".concat(l.name,".bulkAdd(): ").concat(x," of ").concat(_," operations failed"),S)})})},Se.prototype.bulkPut=function(r,s,u){var l=this,f=Array.isArray(s)?s:void 0,y=(u=u||(f?void 0:s))?u.allKeys:void 0;return this._trans("readwrite",function(v){var E=l.schema.primKey,b=E.auto,E=E.keyPath;if(E&&f)throw new J.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(f&&f.length!==r.length)throw new J.InvalidArgument("Arguments objects and keys must have the same length");var _=r.length,E=E&&b?r.map(zr(E)):r;return l.core.mutate({trans:v,type:"put",keys:f,values:E,wantResults:y}).then(function(S){var x=S.numFailures,P=S.results,k=S.lastResult,S=S.failures;if(x===0)return y?P:k;throw new Le("".concat(l.name,".bulkPut(): ").concat(x," of ").concat(_," operations failed"),S)})})},Se.prototype.bulkUpdate=function(r){var s=this,u=this.core,l=r.map(function(v){return v.key}),f=r.map(function(v){return v.changes}),y=[];return this._trans("readwrite",function(v){return u.getMany({trans:v,keys:l,cache:"clone"}).then(function(b){var _=[],E=[];r.forEach(function(x,P){var k=x.key,S=x.changes,I=b[P];if(I){for(var C=0,M=Object.keys(S);C<M.length;C++){var D=M[C],N=S[D];if(D===s.schema.primKey.keyPath){if(pe(N,k)!==0)throw new J.Constraint("Cannot update primary key in bulkUpdate()")}else Y(I,D,N)}y.push(P),_.push(k),E.push(I)}});var A=_.length;return u.mutate({trans:v,type:"put",keys:_,values:E,updates:{keys:l,changeSpecs:f}}).then(function(x){var P=x.numFailures,k=x.failures;if(P===0)return A;for(var S=0,I=Object.keys(k);S<I.length;S++){var C,M=I[S],D=y[Number(M)];D!=null&&(C=k[M],delete k[M],k[D]=C)}throw new Le("".concat(s.name,".bulkUpdate(): ").concat(P," of ").concat(A," operations failed"),k)})})})},Se.prototype.bulkDelete=function(r){var s=this,u=r.length;return this._trans("readwrite",function(l){return s.core.mutate({trans:l,type:"delete",keys:r}).then(function(f){return jr(s,r,f)})}).then(function(v){var f=v.numFailures,y=v.lastResult,v=v.failures;if(f===0)return y;throw new Le("".concat(s.name,".bulkDelete(): ").concat(f," of ").concat(u," operations failed"),v)})},Se);function Se(){}function Yn(r){function s(v,b){if(b){for(var _=arguments.length,E=new Array(_-1);--_;)E[_-1]=arguments[_];return u[v].subscribe.apply(null,E),r}if(typeof v=="string")return u[v]}var u={};s.addEventType=y;for(var l=1,f=arguments.length;l<f;++l)y(arguments[l]);return s;function y(v,b,_){if(typeof v!="object"){var E;b=b||sc;var A={subscribers:[],fire:_=_||de,subscribe:function(x){A.subscribers.indexOf(x)===-1&&(A.subscribers.push(x),A.fire=b(A.fire,x))},unsubscribe:function(x){A.subscribers=A.subscribers.filter(function(P){return P!==x}),A.fire=A.subscribers.reduce(b,_)}};return u[v]=s[v]=A}o(E=v).forEach(function(x){var P=E[x];if(a(P))y(x,E[x][0],E[x][1]);else{if(P!=="asap")throw new J.InvalidArgument("Invalid event config");var k=y(x,wt,function(){for(var S=arguments.length,I=new Array(S);S--;)I[S]=arguments[S];k.subscribers.forEach(function(C){B(function(){C.apply(null,I)})})})}})}}function Qn(r,s){return O(s).from({prototype:r}),s}function Pn(r,s){return!(r.filter||r.algorithm||r.or)&&(s?r.justLimit:!r.replayFilter)}function fs(r,s){r.filter=pn(r.filter,s)}function hs(r,s,u){var l=r.replayFilter;r.replayFilter=l?function(){return pn(l(),s())}:s,r.justLimit=u&&!l}function Lr(r,s){if(r.isPrimKey)return s.primaryKey;var u=s.getIndexByKeyPath(r.index);if(!u)throw new J.Schema("KeyPath "+r.index+" on object store "+s.name+" is not indexed");return u}function Qo(r,s,u){var l=Lr(r,s.schema);return s.openCursor({trans:u,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:l,range:r.range}})}function Br(r,s,u,l){var f=r.replayFilter?pn(r.filter,r.replayFilter()):r.filter;if(r.or){var y={},v=function(b,_,E){var A,x;f&&!f(_,E,function(P){return _.stop(P)},function(P){return _.fail(P)})||((x=""+(A=_.primaryKey))=="[object ArrayBuffer]"&&(x=""+new Uint8Array(A)),d(y,x)||(y[x]=!0,s(b,_,E)))};return Promise.all([r.or._iterate(v,u),ea(Qo(r,l,u),r.algorithm,v,!r.keysOnly&&r.valueMapper)])}return ea(Qo(r,l,u),pn(r.algorithm,f),s,!r.keysOnly&&r.valueMapper)}function ea(r,s,u,l){var f=Oe(l?function(y,v,b){return u(l(y),v,b)}:u);return r.then(function(y){if(y)return y.start(function(){var v=function(){return y.continue()};s&&!s(y,function(b){return v=b},function(b){y.stop(b),v=de},function(b){y.fail(b),v=de})||f(y.value,y,function(b){return v=b}),v()})})}var fc=(me.prototype._read=function(r,s){var u=this._ctx;return u.error?u.table._trans(null,Ne.bind(null,u.error)):u.table._trans("readonly",r).then(s)},me.prototype._write=function(r){var s=this._ctx;return s.error?s.table._trans(null,Ne.bind(null,s.error)):s.table._trans("readwrite",r,"locked")},me.prototype._addAlgorithm=function(r){var s=this._ctx;s.algorithm=pn(s.algorithm,r)},me.prototype._iterate=function(r,s){return Br(this._ctx,r,s,this._ctx.table.core)},me.prototype.clone=function(r){var s=Object.create(this.constructor.prototype),u=Object.create(this._ctx);return r&&c(u,r),s._ctx=u,s},me.prototype.raw=function(){return this._ctx.valueMapper=null,this},me.prototype.each=function(r){var s=this._ctx;return this._read(function(u){return Br(s,r,u,s.table.core)})},me.prototype.count=function(r){var s=this;return this._read(function(u){var l=s._ctx,f=l.table.core;if(Pn(l,!0))return f.count({trans:u,query:{index:Lr(l,f.schema),range:l.range}}).then(function(v){return Math.min(v,l.limit)});var y=0;return Br(l,function(){return++y,!1},u,f).then(function(){return y})}).then(r)},me.prototype.sortBy=function(r,s){var u=r.split(".").reverse(),l=u[0],f=u.length-1;function y(_,E){return E?y(_[u[E]],E-1):_[l]}var v=this._ctx.dir==="next"?1:-1;function b(_,E){return pe(y(_,f),y(E,f))*v}return this.toArray(function(_){return _.sort(b)}).then(s)},me.prototype.toArray=function(r){var s=this;return this._read(function(u){var l=s._ctx;if(l.dir==="next"&&Pn(l,!0)&&0<l.limit){var f=l.valueMapper,y=Lr(l,l.table.core.schema);return l.table.core.query({trans:u,limit:l.limit,values:!0,query:{index:y,range:l.range}}).then(function(b){return b=b.result,f?b.map(f):b})}var v=[];return Br(l,function(b){return v.push(b)},u,l.table.core).then(function(){return v})},r)},me.prototype.offset=function(r){var s=this._ctx;return r<=0||(s.offset+=r,Pn(s)?hs(s,function(){var u=r;return function(l,f){return u===0||(u===1?--u:f(function(){l.advance(u),u=0}),!1)}}):hs(s,function(){var u=r;return function(){return--u<0}})),this},me.prototype.limit=function(r){return this._ctx.limit=Math.min(this._ctx.limit,r),hs(this._ctx,function(){var s=r;return function(u,l,f){return--s<=0&&l(f),0<=s}},!0),this},me.prototype.until=function(r,s){return fs(this._ctx,function(u,l,f){return!r(u.value)||(l(f),s)}),this},me.prototype.first=function(r){return this.limit(1).toArray(function(s){return s[0]}).then(r)},me.prototype.last=function(r){return this.reverse().first(r)},me.prototype.filter=function(r){var s;return fs(this._ctx,function(u){return r(u.value)}),(s=this._ctx).isMatch=pn(s.isMatch,r),this},me.prototype.and=function(r){return this.filter(r)},me.prototype.or=function(r){return new this.db.WhereClause(this._ctx.table,r,this)},me.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},me.prototype.desc=function(){return this.reverse()},me.prototype.eachKey=function(r){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(u,l){r(l.key,l)})},me.prototype.eachUniqueKey=function(r){return this._ctx.unique="unique",this.eachKey(r)},me.prototype.eachPrimaryKey=function(r){var s=this._ctx;return s.keysOnly=!s.isMatch,this.each(function(u,l){r(l.primaryKey,l)})},me.prototype.keys=function(r){var s=this._ctx;s.keysOnly=!s.isMatch;var u=[];return this.each(function(l,f){u.push(f.key)}).then(function(){return u}).then(r)},me.prototype.primaryKeys=function(r){var s=this._ctx;if(s.dir==="next"&&Pn(s,!0)&&0<s.limit)return this._read(function(l){var f=Lr(s,s.table.core.schema);return s.table.core.query({trans:l,values:!1,limit:s.limit,query:{index:f,range:s.range}})}).then(function(l){return l.result}).then(r);s.keysOnly=!s.isMatch;var u=[];return this.each(function(l,f){u.push(f.primaryKey)}).then(function(){return u}).then(r)},me.prototype.uniqueKeys=function(r){return this._ctx.unique="unique",this.keys(r)},me.prototype.firstKey=function(r){return this.limit(1).keys(function(s){return s[0]}).then(r)},me.prototype.lastKey=function(r){return this.reverse().firstKey(r)},me.prototype.distinct=function(){var r=this._ctx,r=r.index&&r.table.schema.idxByName[r.index];if(!r||!r.multi)return this;var s={};return fs(this._ctx,function(f){var l=f.primaryKey.toString(),f=d(s,l);return s[l]=!0,!f}),this},me.prototype.modify=function(r){var s=this,u=this._ctx;return this._write(function(l){var f=typeof r=="function"?r:function(I){return Jo(I,r)},y=u.table.core,E=y.schema.primaryKey,v=E.outbound,b=E.extractKey,_=200,E=s.db._options.modifyChunkSize;E&&(_=typeof E=="object"?E[y.name]||E["*"]||200:E);function A(I,D){var M=D.failures,D=D.numFailures;P+=I-D;for(var N=0,z=o(M);N<z.length;N++){var $=z[N];x.push(M[$])}}var x=[],P=0,k=[],S=r===ta;return s.clone().primaryKeys().then(function(I){function C(D){var N=Math.min(_,I.length-D),z=I.slice(D,D+N);return(S?Promise.resolve([]):y.getMany({trans:l,keys:z,cache:"immutable"})).then(function($){var V=[],q=[],H=v?[]:null,G=S?z:[];if(!S)for(var U=0;U<N;++U){var Z=$[U],ie={value:he(Z),primKey:I[D+U]};f.call(ie,ie.value,ie)!==!1&&(ie.value==null?G.push(I[D+U]):v||pe(b(Z),b(ie.value))===0?(q.push(ie.value),v&&H.push(I[D+U])):(G.push(I[D+U]),V.push(ie.value)))}return Promise.resolve(0<V.length&&y.mutate({trans:l,type:"add",values:V}).then(function(oe){for(var ae in oe.failures)G.splice(parseInt(ae),1);A(V.length,oe)})).then(function(){return(0<q.length||M&&typeof r=="object")&&y.mutate({trans:l,type:"put",keys:H,values:q,criteria:M,changeSpec:typeof r!="function"&&r,isAdditionalChunk:0<D}).then(function(oe){return A(q.length,oe)})}).then(function(){return(0<G.length||M&&S)&&y.mutate({trans:l,type:"delete",keys:G,criteria:M,isAdditionalChunk:0<D}).then(function(oe){return jr(u.table,G,oe)}).then(function(oe){return A(G.length,oe)})}).then(function(){return I.length>D+N&&C(D+_)})})}var M=Pn(u)&&u.limit===1/0&&(typeof r!="function"||S)&&{index:u.index,range:u.range};return C(0).then(function(){if(0<x.length)throw new Ke("Error modifying one or more objects",x,P,k);return I.length})})})},me.prototype.delete=function(){var r=this._ctx,s=r.range;return!Pn(r)||r.table.schema.yProps||!r.isPrimKey&&s.type!==3?this.modify(ta):this._write(function(u){var l=r.table.core.schema.primaryKey,f=s;return r.table.core.count({trans:u,query:{index:l,range:f}}).then(function(y){return r.table.core.mutate({trans:u,type:"deleteRange",range:f}).then(function(_){var b=_.failures,_=_.numFailures;if(_)throw new Ke("Could not delete some values",Object.keys(b).map(function(E){return b[E]}),y-_);return y-_})})})},me);function me(){}var ta=function(r,s){return s.value=null};function hc(r,s){return r<s?-1:r===s?0:1}function pc(r,s){return s<r?-1:r===s?0:1}function ot(r,s,u){return r=r instanceof ra?new r.Collection(r):r,r._ctx.error=new(u||TypeError)(s),r}function Mn(r){return new r.Collection(r,function(){return na("")}).limit(0)}function Fr(r,s,u,l){var f,y,v,b,_,E,A,x=u.length;if(!u.every(function(S){return typeof S=="string"}))return ot(r,Uo);function P(S){f=S==="next"?function(C){return C.toUpperCase()}:function(C){return C.toLowerCase()},y=S==="next"?function(C){return C.toLowerCase()}:function(C){return C.toUpperCase()},v=S==="next"?hc:pc;var I=u.map(function(C){return{lower:y(C),upper:f(C)}}).sort(function(C,M){return v(C.lower,M.lower)});b=I.map(function(C){return C.upper}),_=I.map(function(C){return C.lower}),A=(E=S)==="next"?"":l}P("next"),r=new r.Collection(r,function(){return Gt(b[0],_[x-1]+l)}),r._ondirectionchange=function(S){P(S)};var k=0;return r._addAlgorithm(function(S,I,C){var M=S.key;if(typeof M!="string")return!1;var D=y(M);if(s(D,_,k))return!0;for(var N=null,z=k;z<x;++z){var $=(function(V,q,H,G,U,Z){for(var ie=Math.min(V.length,G.length),oe=-1,ae=0;ae<ie;++ae){var at=q[ae];if(at!==G[ae])return U(V[ae],H[ae])<0?V.substr(0,ae)+H[ae]+H.substr(ae+1):U(V[ae],G[ae])<0?V.substr(0,ae)+G[ae]+H.substr(ae+1):0<=oe?V.substr(0,oe)+q[oe]+H.substr(oe+1):null;U(V[ae],at)<0&&(oe=ae)}return ie<G.length&&Z==="next"?V+H.substr(V.length):ie<V.length&&Z==="prev"?V.substr(0,H.length):oe<0?null:V.substr(0,oe)+G[oe]+H.substr(oe+1)})(M,D,b[z],_[z],v,E);$===null&&N===null?k=z+1:(N===null||0<v(N,$))&&(N=$)}return I(N!==null?function(){S.continue(N+A)}:C),!1}),r}function Gt(r,s,u,l){return{type:2,lower:r,upper:s,lowerOpen:u,upperOpen:l}}function na(r){return{type:1,lower:r,upper:r}}var ra=(Object.defineProperty(He.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),He.prototype.between=function(r,s,u,l){u=u!==!1,l=l===!0;try{return 0<this._cmp(r,s)||this._cmp(r,s)===0&&(u||l)&&(!u||!l)?Mn(this):new this.Collection(this,function(){return Gt(r,s,!u,!l)})}catch{return ot(this,Rt)}},He.prototype.equals=function(r){return r==null?ot(this,Rt):new this.Collection(this,function(){return na(r)})},He.prototype.above=function(r){return r==null?ot(this,Rt):new this.Collection(this,function(){return Gt(r,void 0,!0)})},He.prototype.aboveOrEqual=function(r){return r==null?ot(this,Rt):new this.Collection(this,function(){return Gt(r,void 0,!1)})},He.prototype.below=function(r){return r==null?ot(this,Rt):new this.Collection(this,function(){return Gt(void 0,r,!1,!0)})},He.prototype.belowOrEqual=function(r){return r==null?ot(this,Rt):new this.Collection(this,function(){return Gt(void 0,r)})},He.prototype.startsWith=function(r){return typeof r!="string"?ot(this,Uo):this.between(r,r+hn,!0,!0)},He.prototype.startsWithIgnoreCase=function(r){return r===""?this.startsWith(r):Fr(this,function(s,u){return s.indexOf(u[0])===0},[r],hn)},He.prototype.equalsIgnoreCase=function(r){return Fr(this,function(s,u){return s===u[0]},[r],"")},He.prototype.anyOfIgnoreCase=function(){var r=Ce.apply(ye,arguments);return r.length===0?Mn(this):Fr(this,function(s,u){return u.indexOf(s)!==-1},r,"")},He.prototype.startsWithAnyOfIgnoreCase=function(){var r=Ce.apply(ye,arguments);return r.length===0?Mn(this):Fr(this,function(s,u){return u.some(function(l){return s.indexOf(l)===0})},r,hn)},He.prototype.anyOf=function(){var r=this,s=Ce.apply(ye,arguments),u=this._cmp;try{s.sort(u)}catch{return ot(this,Rt)}if(s.length===0)return Mn(this);var l=new this.Collection(this,function(){return Gt(s[0],s[s.length-1])});l._ondirectionchange=function(y){u=y==="next"?r._ascending:r._descending,s.sort(u)};var f=0;return l._addAlgorithm(function(y,v,b){for(var _=y.key;0<u(_,s[f]);)if(++f===s.length)return v(b),!1;return u(_,s[f])===0||(v(function(){y.continue(s[f])}),!1)}),l},He.prototype.notEqual=function(r){return this.inAnyRange([[-1/0,r],[r,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},He.prototype.noneOf=function(){var r=Ce.apply(ye,arguments);if(r.length===0)return new this.Collection(this);try{r.sort(this._ascending)}catch{return ot(this,Rt)}var s=r.reduce(function(u,l){return u?u.concat([[u[u.length-1][1],l]]):[[-1/0,l]]},null);return s.push([r[r.length-1],this.db._maxKey]),this.inAnyRange(s,{includeLowers:!1,includeUppers:!1})},He.prototype.inAnyRange=function(M,s){var u=this,l=this._cmp,f=this._ascending,y=this._descending,v=this._min,b=this._max;if(M.length===0)return Mn(this);if(!M.every(function(D){return D[0]!==void 0&&D[1]!==void 0&&f(D[0],D[1])<=0}))return ot(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",J.InvalidArgument);var _=!s||s.includeLowers!==!1,E=s&&s.includeUppers===!0,A,x=f;function P(D,N){return x(D[0],N[0])}try{(A=M.reduce(function(D,N){for(var z=0,$=D.length;z<$;++z){var V=D[z];if(l(N[0],V[1])<0&&0<l(N[1],V[0])){V[0]=v(V[0],N[0]),V[1]=b(V[1],N[1]);break}}return z===$&&D.push(N),D},[])).sort(P)}catch{return ot(this,Rt)}var k=0,S=E?function(D){return 0<f(D,A[k][1])}:function(D){return 0<=f(D,A[k][1])},I=_?function(D){return 0<y(D,A[k][0])}:function(D){return 0<=y(D,A[k][0])},C=S,M=new this.Collection(this,function(){return Gt(A[0][0],A[A.length-1][1],!_,!E)});return M._ondirectionchange=function(D){x=D==="next"?(C=S,f):(C=I,y),A.sort(P)},M._addAlgorithm(function(D,N,z){for(var $,V=D.key;C(V);)if(++k===A.length)return N(z),!1;return!S($=V)&&!I($)||(u._cmp(V,A[k][1])===0||u._cmp(V,A[k][0])===0||N(function(){x===f?D.continue(A[k][0]):D.continue(A[k][1])}),!1)}),M},He.prototype.startsWithAnyOf=function(){var r=Ce.apply(ye,arguments);return r.every(function(s){return typeof s=="string"})?r.length===0?Mn(this):this.inAnyRange(r.map(function(s){return[s,s+hn]})):ot(this,"startsWithAnyOf() only works with strings")},He);function He(){}function Ct(r){return Oe(function(s){return er(s),r(s.target.error),!1})}function er(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}var tr="storagemutated",ps="x-storagemutated-1",Wt=Yn(null,tr),dc=(Ot.prototype._lock=function(){return W(!ee.global),++this._reculock,this._reculock!==1||ee.global||(ee.lockOwnerFor=this),this},Ot.prototype._unlock=function(){if(W(!ee.global),--this._reculock==0)for(ee.global||(ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var r=this._blockedFuncs.shift();try{fn(r[1],r[0])}catch{}}return this},Ot.prototype._locked=function(){return this._reculock&&ee.lockOwnerFor!==this},Ot.prototype.create=function(r){var s=this;if(!this.mode)return this;var u=this.db.idbdb,l=this.db._state.dbOpenError;if(W(!this.idbtrans),!r&&!u)switch(l&&l.name){case"DatabaseClosedError":throw new J.DatabaseClosed(l);case"MissingAPIError":throw new J.MissingAPI(l.message,l);default:throw new J.OpenFailed(l)}if(!this.active)throw new J.TransactionInactive;return W(this._completion._state===null),(r=this.idbtrans=r||(this.db.core||u).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Oe(function(f){er(f),s._reject(r.error)}),r.onabort=Oe(function(f){er(f),s.active&&s._reject(new J.Abort(r.error)),s.active=!1,s.on("abort").fire(f)}),r.oncomplete=Oe(function(){s.active=!1,s._resolve(),"mutatedParts"in r&&Wt.storagemutated.fire(r.mutatedParts)}),this},Ot.prototype._promise=function(r,s,u){var l=this;if(r==="readwrite"&&this.mode!=="readwrite")return Ne(new J.ReadOnly("Transaction is readonly"));if(!this.active)return Ne(new J.TransactionInactive);if(this._locked())return new X(function(y,v){l._blockedFuncs.push([function(){l._promise(r,s,u).then(y,v)},ee])});if(u)return Ht(function(){var y=new X(function(v,b){l._lock();var _=s(v,b,l);_&&_.then&&_.then(v,b)});return y.finally(function(){return l._unlock()}),y._lib=!0,y});var f=new X(function(y,v){var b=s(y,v,l);b&&b.then&&b.then(y,v)});return f._lib=!0,f},Ot.prototype._root=function(){return this.parent?this.parent._root():this},Ot.prototype.waitFor=function(r){var s,u=this._root(),l=X.resolve(r);u._waitingFor?u._waitingFor=u._waitingFor.then(function(){return l}):(u._waitingFor=l,u._waitingQueue=[],s=u.idbtrans.objectStore(u.storeNames[0]),(function y(){for(++u._spinCount;u._waitingQueue.length;)u._waitingQueue.shift()();u._waitingFor&&(s.get(-1/0).onsuccess=y)})());var f=u._waitingFor;return new X(function(y,v){l.then(function(b){return u._waitingQueue.push(Oe(y.bind(null,b)))},function(b){return u._waitingQueue.push(Oe(v.bind(null,b)))}).finally(function(){u._waitingFor===f&&(u._waitingFor=null)})})},Ot.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new J.Abort))},Ot.prototype.table=function(r){var s=this._memoizedTables||(this._memoizedTables={});if(d(s,r))return s[r];var u=this.schema[r];if(!u)throw new J.NotFound("Table "+r+" not part of transaction");return u=new this.db.Table(r,u,this),u.core=this.db.core.table(r),s[r]=u},Ot);function Ot(){}function ds(r,s,u,l,f,y,v,b){return{name:r,keyPath:s,unique:u,multi:l,auto:f,compound:y,src:(u&&!v?"&":"")+(l?"*":"")+(f?"++":"")+ia(s),type:b}}function ia(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function ys(r,s,u){return{name:r,primKey:s,indexes:u,mappedClass:null,idxByName:(l=function(f){return[f.name,f]},u.reduce(function(f,y,v){return v=l(y,v),v&&(f[v[0]]=v[1]),f},{}))};var l}var nr=function(r){try{return r.only([[]]),nr=function(){return[[]]},[[]]}catch{return nr=function(){return hn},hn}};function ms(r){return r==null?function(){}:typeof r=="string"?(s=r).split(".").length===1?function(u){return u[s]}:function(u){return K(u,s)}:function(u){return K(u,r)};var s}function sa(r){return[].slice.call(r)}var yc=0;function rr(r){return r==null?":id":typeof r=="string"?r:"[".concat(r.join("+"),"]")}function mc(r,s,_){function l(C){if(C.type===3)return null;if(C.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var k=C.lower,S=C.upper,I=C.lowerOpen,C=C.upperOpen;return k===void 0?S===void 0?null:s.upperBound(S,!!C):S===void 0?s.lowerBound(k,!!I):s.bound(k,S,!!I,!!C)}function f(P){var k,S=P.name;return{name:S,schema:P,mutate:function(I){var C=I.trans,M=I.type,D=I.keys,N=I.values,z=I.range;return new Promise(function($,V){$=Oe($);var q=C.objectStore(S),H=q.keyPath==null,G=M==="put"||M==="add";if(!G&&M!=="delete"&&M!=="deleteRange")throw new Error("Invalid operation type: "+M);var U,Z=(D||N||{length:1}).length;if(D&&N&&D.length!==N.length)throw new Error("Given keys array must have same length as given values array.");if(Z===0)return $({numFailures:0,failures:{},results:[],lastResult:void 0});function ie(et){++at,er(et)}var oe=[],ae=[],at=0;if(M==="deleteRange"){if(z.type===4)return $({numFailures:at,failures:ae,results:[],lastResult:void 0});z.type===3?oe.push(U=q.clear()):oe.push(U=q.delete(l(z)))}else{var H=G?H?[N,D]:[N,null]:[D,null],re=H[0],Xe=H[1];if(G)for(var Ze=0;Ze<Z;++Ze)oe.push(U=Xe&&Xe[Ze]!==void 0?q[M](re[Ze],Xe[Ze]):q[M](re[Ze])),U.onerror=ie;else for(Ze=0;Ze<Z;++Ze)oe.push(U=q[M](re[Ze])),U.onerror=ie}function Yr(et){et=et.target.result,oe.forEach(function(mn,Ns){return mn.error!=null&&(ae[Ns]=mn.error)}),$({numFailures:at,failures:ae,results:M==="delete"?D:oe.map(function(mn){return mn.result}),lastResult:et})}U.onerror=function(et){ie(et),Yr(et)},U.onsuccess=Yr})},getMany:function(I){var C=I.trans,M=I.keys;return new Promise(function(D,N){D=Oe(D);for(var z,$=C.objectStore(S),V=M.length,q=new Array(V),H=0,G=0,U=function(oe){oe=oe.target,q[oe._pos]=oe.result,++G===H&&D(q)},Z=Ct(N),ie=0;ie<V;++ie)M[ie]!=null&&((z=$.get(M[ie]))._pos=ie,z.onsuccess=U,z.onerror=Z,++H);H===0&&D(q)})},get:function(I){var C=I.trans,M=I.key;return new Promise(function(D,N){D=Oe(D);var z=C.objectStore(S).get(M);z.onsuccess=function($){return D($.target.result)},z.onerror=Ct(N)})},query:(k=E,function(I){return new Promise(function(C,M){C=Oe(C);var D,N,z,H=I.trans,$=I.values,V=I.limit,U=I.query,q=V===1/0?void 0:V,G=U.index,U=U.range,H=H.objectStore(S),G=G.isPrimaryKey?H:H.index(G.name),U=l(U);if(V===0)return C({result:[]});k?((q=$?G.getAll(U,q):G.getAllKeys(U,q)).onsuccess=function(Z){return C({result:Z.target.result})},q.onerror=Ct(M)):(D=0,N=!$&&"openKeyCursor"in G?G.openKeyCursor(U):G.openCursor(U),z=[],N.onsuccess=function(Z){var ie=N.result;return ie?(z.push($?ie.value:ie.primaryKey),++D===V?C({result:z}):void ie.continue()):C({result:z})},N.onerror=Ct(M))})}),openCursor:function(I){var C=I.trans,M=I.values,D=I.query,N=I.reverse,z=I.unique;return new Promise(function($,V){$=Oe($);var G=D.index,q=D.range,H=C.objectStore(S),H=G.isPrimaryKey?H:H.index(G.name),G=N?z?"prevunique":"prev":z?"nextunique":"next",U=!M&&"openKeyCursor"in H?H.openKeyCursor(l(q),G):H.openCursor(l(q),G);U.onerror=Ct(V),U.onsuccess=Oe(function(Z){var ie,oe,ae,at,re=U.result;re?(re.___id=++yc,re.done=!1,ie=re.continue.bind(re),oe=(oe=re.continuePrimaryKey)&&oe.bind(re),ae=re.advance.bind(re),at=function(){throw new Error("Cursor not stopped")},re.trans=C,re.stop=re.continue=re.continuePrimaryKey=re.advance=function(){throw new Error("Cursor not started")},re.fail=Oe(V),re.next=function(){var Xe=this,Ze=1;return this.start(function(){return Ze--?Xe.continue():Xe.stop()}).then(function(){return Xe})},re.start=function(Xe){function Ze(){if(U.result)try{Xe()}catch(et){re.fail(et)}else re.done=!0,re.start=function(){throw new Error("Cursor behind last entry")},re.stop()}var Yr=new Promise(function(et,mn){et=Oe(et),U.onerror=Ct(mn),re.fail=mn,re.stop=function(Ns){re.stop=re.continue=re.continuePrimaryKey=re.advance=at,et(Ns)}});return U.onsuccess=Oe(function(et){U.onsuccess=Ze,Ze()}),re.continue=ie,re.continuePrimaryKey=oe,re.advance=ae,Ze(),Yr},$(re)):$(null)},V)})},count:function(I){var C=I.query,M=I.trans,D=C.index,N=C.range;return new Promise(function(z,$){var V=M.objectStore(S),q=D.isPrimaryKey?V:V.index(D.name),V=l(N),q=V?q.count(V):q.count();q.onsuccess=Oe(function(H){return z(H.target.result)}),q.onerror=Ct($)})}}}var y,v,b,A=(v=_,b=sa((y=r).objectStoreNames),{schema:{name:y.name,tables:b.map(function(P){return v.objectStore(P)}).map(function(P){var k=P.keyPath,C=P.autoIncrement,S=a(k),I={},C={name:P.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:k==null,compound:S,keyPath:k,autoIncrement:C,unique:!0,extractKey:ms(k)},indexes:sa(P.indexNames).map(function(M){return P.index(M)}).map(function(z){var D=z.name,N=z.unique,$=z.multiEntry,z=z.keyPath,$={name:D,compound:a(z),keyPath:z,unique:N,multiEntry:$,extractKey:ms(z)};return I[rr(z)]=$}),getIndexByKeyPath:function(M){return I[rr(M)]}};return I[":id"]=C.primaryKey,k!=null&&(I[rr(k)]=C.primaryKey),C})},hasGetAll:0<b.length&&"getAll"in v.objectStore(b[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\\/|Edge\\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1]<604)}),_=A.schema,E=A.hasGetAll,A=_.tables.map(f),x={};return A.forEach(function(P){return x[P.name]=P}),{stack:"dbcore",transaction:r.transaction.bind(r),table:function(P){if(!x[P])throw new Error("Table \'".concat(P,"\' not found"));return x[P]},MIN_KEY:-1/0,MAX_KEY:nr(s),schema:_}}function vc(r,s,u,l){var f=u.IDBKeyRange;return u.indexedDB,{dbcore:(l=mc(s,f,l),r.dbcore.reduce(function(y,v){return v=v.create,e(e({},y),v(y))},l))}}function qr(r,l){var u=l.db,l=vc(r._middlewares,u,r._deps,l);r.core=l.dbcore,r.tables.forEach(function(f){var y=f.name;r.core.schema.tables.some(function(v){return v.name===y})&&(f.core=r.core.table(y),r[y]instanceof r.Table&&(r[y].core=f.core))})}function Kr(r,s,u,l){u.forEach(function(f){var y=l[f];s.forEach(function(v){var b=(function _(E,A){return T(E,A)||(E=h(E))&&_(E,A)})(v,f);(!b||"value"in b&&b.value===void 0)&&(v===r.Transaction.prototype||v instanceof r.Transaction?w(v,f,{get:function(){return this.table(f)},set:function(_){g(this,f,{value:_,writable:!0,configurable:!0,enumerable:!0})}}):v[f]=new r.Table(f,y))})})}function vs(r,s){s.forEach(function(u){for(var l in u)u[l]instanceof r.Table&&delete u[l]})}function gc(r,s){return r._cfg.version-s._cfg.version}function bc(r,s,u,l){var f=r._dbSchema;u.objectStoreNames.contains("$meta")&&!f.$meta&&(f.$meta=ys("$meta",aa("")[0],[]),r._storeNames.push("$meta"));var y=r._createTransaction("readwrite",r._storeNames,f);y.create(u),y._completion.catch(l);var v=y._reject.bind(y),b=ee.transless||ee;Ht(function(){return ee.trans=y,ee.transless=b,s!==0?(qr(r,u),E=s,((_=y).storeNames.includes("$meta")?_.table("$meta").get("version").then(function(A){return A??E}):X.resolve(E)).then(function(A){return P=A,k=y,S=u,I=[],A=(x=r)._versions,C=x._dbSchema=Hr(0,x.idbdb,S),(A=A.filter(function(M){return M._cfg.version>=P})).length!==0?(A.forEach(function(M){I.push(function(){var D=C,N=M._cfg.dbschema;Ur(x,D,S),Ur(x,N,S),C=x._dbSchema=N;var z=gs(D,N);z.add.forEach(function(G){bs(S,G[0],G[1].primKey,G[1].indexes)}),z.change.forEach(function(G){if(G.recreate)throw new J.Upgrade("Not yet support for changing primary key");var U=S.objectStore(G.name);G.add.forEach(function(Z){return $r(U,Z)}),G.change.forEach(function(Z){U.deleteIndex(Z.name),$r(U,Z)}),G.del.forEach(function(Z){return U.deleteIndex(Z)})});var $=M._cfg.contentUpgrade;if($&&M._cfg.version>P){qr(x,S),k._memoizedTables={};var V=ce(N);z.del.forEach(function(G){V[G]=D[G]}),vs(x,[x.Transaction.prototype]),Kr(x,[x.Transaction.prototype],o(V),V),k.schema=V;var q,H=Te($);return H&&Cn(),z=X.follow(function(){var G;(q=$(k))&&H&&(G=Ut.bind(null,null),q.then(G,G))}),q&&typeof q.then=="function"?X.resolve(q):z.then(function(){return q})}}),I.push(function(D){var N,z,$=M._cfg.dbschema;N=$,z=D,[].slice.call(z.db.objectStoreNames).forEach(function(V){return N[V]==null&&z.db.deleteObjectStore(V)}),vs(x,[x.Transaction.prototype]),Kr(x,[x.Transaction.prototype],x._storeNames,x._dbSchema),k.schema=x._dbSchema}),I.push(function(D){x.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(x.idbdb.version/10)===M._cfg.version?(x.idbdb.deleteObjectStore("$meta"),delete x._dbSchema.$meta,x._storeNames=x._storeNames.filter(function(N){return N!=="$meta"})):D.objectStore("$meta").put(M._cfg.version,"version"))})}),(function M(){return I.length?X.resolve(I.shift()(k.idbtrans)).then(M):X.resolve()})().then(function(){oa(C,S)})):X.resolve();var x,P,k,S,I,C}).catch(v)):(o(f).forEach(function(A){bs(u,A,f[A].primKey,f[A].indexes)}),qr(r,u),void X.follow(function(){return r.on.populate.fire(y)}).catch(v));var _,E})}function wc(r,s){oa(r._dbSchema,s),s.db.version%10!=0||s.objectStoreNames.contains("$meta")||s.db.createObjectStore("$meta").add(Math.ceil(s.db.version/10-1),"version");var u=Hr(0,r.idbdb,s);Ur(r,r._dbSchema,s);for(var l=0,f=gs(u,r._dbSchema).change;l<f.length;l++){var y=(function(v){if(v.change.length||v.recreate)return console.warn("Unable to patch indexes of table ".concat(v.name," because it has changes on the type of index or primary key.")),{value:void 0};var b=s.objectStore(v.name);v.add.forEach(function(_){At&&console.debug("Dexie upgrade patch: Creating missing index ".concat(v.name,".").concat(_.src)),$r(b,_)})})(f[l]);if(typeof y=="object")return y.value}}function gs(r,s){var u,l={del:[],add:[],change:[]};for(u in r)s[u]||l.del.push(u);for(u in s){var f=r[u],y=s[u];if(f){var v={name:u,def:y,recreate:!1,del:[],add:[],change:[]};if(""+(f.primKey.keyPath||"")!=""+(y.primKey.keyPath||"")||f.primKey.auto!==y.primKey.auto)v.recreate=!0,l.change.push(v);else{var b=f.idxByName,_=y.idxByName,E=void 0;for(E in b)_[E]||v.del.push(E);for(E in _){var A=b[E],x=_[E];A?A.src!==x.src&&v.change.push(x):v.add.push(x)}(0<v.del.length||0<v.add.length||0<v.change.length)&&l.change.push(v)}}else l.add.push([u,y])}return l}function bs(r,s,u,l){var f=r.db.createObjectStore(s,u.keyPath?{keyPath:u.keyPath,autoIncrement:u.auto}:{autoIncrement:u.auto});return l.forEach(function(y){return $r(f,y)}),f}function oa(r,s){o(r).forEach(function(u){s.db.objectStoreNames.contains(u)||(At&&console.debug("Dexie: Creating missing table",u),bs(s,u,r[u].primKey,r[u].indexes))})}function $r(r,s){r.createIndex(s.name,s.keyPath,{unique:s.unique,multiEntry:s.multi})}function Hr(r,s,u){var l={};return j(s.objectStoreNames,0).forEach(function(f){for(var y=u.objectStore(f),v=ds(ia(E=y.keyPath),E||"",!0,!1,!!y.autoIncrement,E&&typeof E!="string",!0),b=[],_=0;_<y.indexNames.length;++_){var A=y.index(y.indexNames[_]),E=A.keyPath,A=ds(A.name,E,!!A.unique,!!A.multiEntry,!1,E&&typeof E!="string",!1);b.push(A)}l[f]=ys(f,v,b)}),l}function Ur(r,s,u){for(var l=u.db.objectStoreNames,f=0;f<l.length;++f){var y=l[f],v=u.objectStore(y);r._hasGetAll="getAll"in v;for(var b=0;b<v.indexNames.length;++b){var _=v.indexNames[b],E=v.index(_).keyPath,A=typeof E=="string"?E:"["+j(E).join("+")+"]";!s[y]||(E=s[y].idxByName[A])&&(E.name=_,delete s[y].idxByName[A],s[y].idxByName[_]=E)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\\/|Edge\\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1]<604&&(r._hasGetAll=!1)}function aa(r){return r.split(",").map(function(s,u){var y=s.split(":"),l=(f=y[1])===null||f===void 0?void 0:f.trim(),f=(s=y[0].trim()).replace(/([&*]|\\+\\+)/g,""),y=/^\\[/.test(f)?f.match(/^\\[(.*)\\]$/)[1].split("+"):f;return ds(f,y||null,/\\&/.test(s),/\\*/.test(s),/\\+\\+/.test(s),a(y),u===0,l)})}var xc=(Dn.prototype._createTableSchema=ys,Dn.prototype._parseIndexSyntax=aa,Dn.prototype._parseStoresSpec=function(r,s){var u=this;o(r).forEach(function(l){if(r[l]!==null){var f=u._parseIndexSyntax(r[l]),y=f.shift();if(!y)throw new J.Schema("Invalid schema for table "+l+": "+r[l]);if(y.unique=!0,y.multi)throw new J.Schema("Primary key cannot be multiEntry*");f.forEach(function(v){if(v.auto)throw new J.Schema("Only primary key can be marked as autoIncrement (++)");if(!v.keyPath)throw new J.Schema("Index must have a name and cannot be an empty string")}),f=u._createTableSchema(l,y,f),s[l]=f}})},Dn.prototype.stores=function(u){var s=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,u):u;var u=s._versions,l={},f={};return u.forEach(function(y){c(l,y._cfg.storesSource),f=y._cfg.dbschema={},y._parseStoresSpec(l,f)}),s._dbSchema=f,vs(s,[s._allTables,s,s.Transaction.prototype]),Kr(s,[s._allTables,s,s.Transaction.prototype,this._cfg.tables],o(f),f),s._storeNames=o(f),this},Dn.prototype.upgrade=function(r){return this._cfg.contentUpgrade=es(this._cfg.contentUpgrade||de,r),this},Dn);function Dn(){}function ws(r,s){var u=r._dbNamesDB;return u||(u=r._dbNamesDB=new zt(Rr,{addons:[],indexedDB:r,IDBKeyRange:s})).version(1).stores({dbnames:"name"}),u.table("dbnames")}function xs(r){return r&&typeof r.databases=="function"}function _s(r){return Ht(function(){return ee.letThrough=!0,r()})}function Es(r){return!("from"in r)}var We=function(r,s){if(!this){var u=new We;return r&&"d"in r&&c(u,r),u}c(this,arguments.length?{d:1,from:r,to:1<arguments.length?s:r}:{d:0})};function ir(r,s,u){var l=pe(s,u);if(!isNaN(l)){if(0<l)throw RangeError();if(Es(r))return c(r,{from:s,to:u,d:1});var f=r.l,l=r.r;if(pe(u,r.from)<0)return f?ir(f,s,u):r.l={from:s,to:u,d:1,l:null,r:null},ca(r);if(0<pe(s,r.to))return l?ir(l,s,u):r.r={from:s,to:u,d:1,l:null,r:null},ca(r);pe(s,r.from)<0&&(r.from=s,r.l=null,r.d=l?l.d+1:1),0<pe(u,r.to)&&(r.to=u,r.r=null,r.d=r.l?r.l.d+1:1),u=!r.r,f&&!r.l&&sr(r,f),l&&u&&sr(r,l)}}function sr(r,s){Es(s)||(function u(l,_){var y=_.from,v=_.to,b=_.l,_=_.r;ir(l,y,v),b&&u(l,b),_&&u(l,_)})(r,s)}function ua(r,s){var u=Vr(s),l=u.next();if(l.done)return!1;for(var f=l.value,y=Vr(r),v=y.next(f.from),b=v.value;!l.done&&!v.done;){if(pe(b.from,f.to)<=0&&0<=pe(b.to,f.from))return!0;pe(f.from,b.from)<0?f=(l=u.next(b.from)).value:b=(v=y.next(f.from)).value}return!1}function Vr(r){var s=Es(r)?null:{s:0,n:r};return{next:function(u){for(var l=0<arguments.length;s;)switch(s.s){case 0:if(s.s=1,l)for(;s.n.l&&pe(u,s.n.from)<0;)s={up:s,n:s.n.l,s:1};else for(;s.n.l;)s={up:s,n:s.n.l,s:1};case 1:if(s.s=2,!l||pe(u,s.n.to)<=0)return{value:s.n,done:!1};case 2:if(s.n.r){s.s=3,s={up:s,n:s.n.r,s:0};continue}case 3:s=s.up}return{done:!0}}}}function ca(r){var s,u,l=(((s=r.r)===null||s===void 0?void 0:s.d)||0)-(((u=r.l)===null||u===void 0?void 0:u.d)||0),f=1<l?"r":l<-1?"l":"";f&&(s=f=="r"?"l":"r",u=e({},r),l=r[f],r.from=l.from,r.to=l.to,r[f]=l[f],u[f]=l[s],(r[s]=u).d=la(u)),r.d=la(r)}function la(u){var s=u.r,u=u.l;return(s?u?Math.max(s.d,u.d):s.d:u?u.d:0)+1}function Gr(r,s){return o(s).forEach(function(u){r[u]?sr(r[u],s[u]):r[u]=(function l(f){var y,v,b={};for(y in f)d(f,y)&&(v=f[y],b[y]=!v||typeof v!="object"||Q.has(v.constructor)?v:l(v));return b})(s[u])}),r}function ks(r,s){return r.all||s.all||Object.keys(r).some(function(u){return s[u]&&ua(s[u],r[u])})}m(We.prototype,((dt={add:function(r){return sr(this,r),this},addKey:function(r){return ir(this,r,r),this},addKeys:function(r){var s=this;return r.forEach(function(u){return ir(s,u,u)}),this},hasKey:function(r){var s=Vr(this).next(r).value;return s&&pe(s.from,r)<=0&&0<=pe(s.to,r)}})[Me]=function(){return Vr(this)},dt));var dn={},Ss={},Is=!1;function Wr(r){Gr(Ss,r),Is||(Is=!0,setTimeout(function(){Is=!1,As(Ss,!(Ss={}))},0))}function As(r,s){s===void 0&&(s=!1);var u=new Set;if(r.all)for(var l=0,f=Object.values(dn);l<f.length;l++)fa(v=f[l],r,u,s);else for(var y in r){var v,b=/^idb\\:\\/\\/(.*)\\/(.*)\\//.exec(y);b&&(y=b[1],b=b[2],(v=dn["idb://".concat(y,"/").concat(b)])&&fa(v,r,u,s))}u.forEach(function(_){return _()})}function fa(r,s,u,l){for(var f=[],y=0,v=Object.entries(r.queries.query);y<v.length;y++){for(var b=v[y],_=b[0],E=[],A=0,x=b[1];A<x.length;A++){var P=x[A];ks(s,P.obsSet)?P.subscribers.forEach(function(C){return u.add(C)}):l&&E.push(P)}l&&f.push([_,E])}if(l)for(var k=0,S=f;k<S.length;k++){var I=S[k],_=I[0],E=I[1];r.queries.query[_]=E}}function _c(r){var s=r._state,u=r._deps.indexedDB;if(s.isBeingOpened||r.idbdb)return s.dbReadyPromise.then(function(){return s.dbOpenError?Ne(s.dbOpenError):r});s.isBeingOpened=!0,s.dbOpenError=null,s.openComplete=!1;var l=s.openCanceller,f=Math.round(10*r.verno),y=!1;function v(){if(s.openCanceller!==l)throw new J.DatabaseClosed("db.open() was cancelled")}function b(){return new X(function(P,k){if(v(),!u)throw new J.MissingAPI;var S=r.name,I=s.autoSchema||!f?u.open(S):u.open(S,f);if(!I)throw new J.MissingAPI;I.onerror=Ct(k),I.onblocked=Oe(r._fireOnBlocked),I.onupgradeneeded=Oe(function(C){var M;A=I.transaction,s.autoSchema&&!r._options.allowEmptyDB?(I.onerror=er,A.abort(),I.result.close(),(M=u.deleteDatabase(S)).onsuccess=M.onerror=Oe(function(){k(new J.NoSuchDatabase("Database ".concat(S," doesnt exist")))})):(A.onerror=Ct(k),C=C.oldVersion>Math.pow(2,62)?0:C.oldVersion,x=C<1,r.idbdb=I.result,y&&wc(r,A),bc(r,C/10,A,k))},k),I.onsuccess=Oe(function(){A=null;var C,M,D,N,z,$=r.idbdb=I.result,V=j($.objectStoreNames);if(0<V.length)try{var q=$.transaction((N=V).length===1?N[0]:N,"readonly");if(s.autoSchema)M=$,D=q,(C=r).verno=M.version/10,D=C._dbSchema=Hr(0,M,D),C._storeNames=j(M.objectStoreNames,0),Kr(C,[C._allTables],o(D),D);else if(Ur(r,r._dbSchema,q),((z=gs(Hr(0,(z=r).idbdb,q),z._dbSchema)).add.length||z.change.some(function(H){return H.add.length||H.change.length}))&&!y)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),$.close(),f=$.version+1,y=!0,P(b());qr(r,q)}catch{}On.push(r),$.onversionchange=Oe(function(H){s.vcFired=!0,r.on("versionchange").fire(H)}),$.onclose=Oe(function(){r.close({disableAutoOpen:!1})}),x&&(z=r._deps,q=S,$=z.indexedDB,z=z.IDBKeyRange,xs($)||q===Rr||ws($,z).put({name:q}).catch(de)),P()},k)}).catch(function(P){switch(P?.name){case"UnknownError":if(0<s.PR1398_maxLoop)return s.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),b();break;case"VersionError":if(0<f)return f=0,b()}return X.reject(P)})}var _,E=s.dbReadyResolve,A=null,x=!1;return X.race([l,(typeof navigator>"u"?X.resolve():!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(P){function k(){return indexedDB.databases().finally(P)}_=setInterval(k,100),k()}).finally(function(){return clearInterval(_)}):Promise.resolve()).then(b)]).then(function(){return v(),s.onReadyBeingFired=[],X.resolve(_s(function(){return r.on.ready.fire(r.vip)})).then(function P(){if(0<s.onReadyBeingFired.length){var k=s.onReadyBeingFired.reduce(es,de);return s.onReadyBeingFired=[],X.resolve(_s(function(){return k(r.vip)})).then(P)}})}).finally(function(){s.openCanceller===l&&(s.onReadyBeingFired=null,s.isBeingOpened=!1)}).catch(function(P){s.dbOpenError=P;try{A&&A.abort()}catch{}return l===s.openCanceller&&r._close(),Ne(P)}).finally(function(){s.openComplete=!0,E()}).then(function(){var P;return x&&(P={},r.tables.forEach(function(k){k.schema.indexes.forEach(function(S){S.name&&(P["idb://".concat(r.name,"/").concat(k.name,"/").concat(S.name)]=new We(-1/0,[[[]]]))}),P["idb://".concat(r.name,"/").concat(k.name,"/")]=P["idb://".concat(r.name,"/").concat(k.name,"/:dels")]=new We(-1/0,[[[]]])}),Wt(tr).fire(P),As(P,!0)),r})}function Cs(r){function s(y){return r.next(y)}var u=f(s),l=f(function(y){return r.throw(y)});function f(y){return function(_){var b=y(_),_=b.value;return b.done?_:_&&typeof _.then=="function"?_.then(u,l):a(_)?Promise.all(_).then(u,l):u(_)}}return f(s)()}function Xr(r,s,u){for(var l=a(r)?r.slice():[r],f=0;f<u;++f)l.push(s);return l}var Ec={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return e(e({},r),{table:function(s){var u=r.table(s),l=u.schema,f={},y=[];function v(x,P,k){var S=rr(x),I=f[S]=f[S]||[],C=x==null?0:typeof x=="string"?1:x.length,M=0<P,M=e(e({},k),{name:M?"".concat(S,"(virtual-from:").concat(k.name,")"):k.name,lowLevelIndex:k,isVirtual:M,keyTail:P,keyLength:C,extractKey:ms(x),unique:!M&&k.unique});return I.push(M),M.isPrimaryKey||y.push(M),1<C&&v(C===2?x[0]:x.slice(0,C-1),P+1,k),I.sort(function(D,N){return D.keyTail-N.keyTail}),M}s=v(l.primaryKey.keyPath,0,l.primaryKey),f[":id"]=[s];for(var b=0,_=l.indexes;b<_.length;b++){var E=_[b];v(E.keyPath,0,E)}function A(x){var P,k=x.query.index;return k.isVirtual?e(e({},x),{query:{index:k.lowLevelIndex,range:(P=x.query.range,k=k.keyTail,{type:P.type===1?2:P.type,lower:Xr(P.lower,P.lowerOpen?r.MAX_KEY:r.MIN_KEY,k),lowerOpen:!0,upper:Xr(P.upper,P.upperOpen?r.MIN_KEY:r.MAX_KEY,k),upperOpen:!0})}}):x}return e(e({},u),{schema:e(e({},l),{primaryKey:s,indexes:y,getIndexByKeyPath:function(x){return(x=f[rr(x)])&&x[0]}}),count:function(x){return u.count(A(x))},query:function(x){return u.query(A(x))},openCursor:function(x){var P=x.query.index,k=P.keyTail,S=P.isVirtual,I=P.keyLength;return S?u.openCursor(A(x)).then(function(M){return M&&C(M)}):u.openCursor(x);function C(M){return Object.create(M,{continue:{value:function(D){D!=null?M.continue(Xr(D,x.reverse?r.MAX_KEY:r.MIN_KEY,k)):x.unique?M.continue(M.key.slice(0,I).concat(x.reverse?r.MIN_KEY:r.MAX_KEY,k)):M.continue()}},continuePrimaryKey:{value:function(D,N){M.continuePrimaryKey(Xr(D,r.MAX_KEY,k),N)}},primaryKey:{get:function(){return M.primaryKey}},key:{get:function(){var D=M.key;return I===1?D[0]:D.slice(0,I)}},value:{get:function(){return M.value}}})}}})}})}};function Os(r,s,u,l){return u=u||{},l=l||"",o(r).forEach(function(f){var y,v,b;d(s,f)?(y=r[f],v=s[f],typeof y=="object"&&typeof v=="object"&&y&&v?(b=Qe(y))!==Qe(v)?u[l+f]=s[f]:b==="Object"?Os(y,v,u,l+f+"."):y!==v&&(u[l+f]=s[f]):y!==v&&(u[l+f]=s[f])):u[l+f]=void 0}),o(s).forEach(function(f){d(r,f)||(u[l+f]=s[f])}),u}function Ps(r,s){return s.type==="delete"?s.keys:s.keys||s.values.map(r.extractKey)}var kc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(r){return e(e({},r),{table:function(s){var u=r.table(s),l=u.schema.primaryKey;return e(e({},u),{mutate:function(f){var y=ee.trans,v=y.table(s).hook,b=v.deleting,_=v.creating,E=v.updating;switch(f.type){case"add":if(_.fire===de)break;return y._promise("readwrite",function(){return A(f)},!0);case"put":if(_.fire===de&&E.fire===de)break;return y._promise("readwrite",function(){return A(f)},!0);case"delete":if(b.fire===de)break;return y._promise("readwrite",function(){return A(f)},!0);case"deleteRange":if(b.fire===de)break;return y._promise("readwrite",function(){return(function x(P,k,S){return u.query({trans:P,values:!1,query:{index:l,range:k},limit:S}).then(function(I){var C=I.result;return A({type:"delete",keys:C,trans:P}).then(function(M){return 0<M.numFailures?Promise.reject(M.failures[0]):C.length<S?{failures:[],numFailures:0,lastResult:void 0}:x(P,e(e({},k),{lower:C[C.length-1],lowerOpen:!0}),S)})})})(f.trans,f.range,1e4)},!0)}return u.mutate(f);function A(x){var P,k,S,I=ee.trans,C=x.keys||Ps(l,x);if(!C)throw new Error("Keys missing");return(x=x.type==="add"||x.type==="put"?e(e({},x),{keys:C}):e({},x)).type!=="delete"&&(x.values=n([],x.values,!0)),x.keys&&(x.keys=n([],x.keys,!0)),P=u,S=C,((k=x).type==="add"?Promise.resolve([]):P.getMany({trans:k.trans,keys:S,cache:"immutable"})).then(function(M){var D=C.map(function(N,z){var $,V,q,H=M[z],G={onerror:null,onsuccess:null};return x.type==="delete"?b.fire.call(G,N,H,I):x.type==="add"||H===void 0?($=_.fire.call(G,N,x.values[z],I),N==null&&$!=null&&(x.keys[z]=N=$,l.outbound||Y(x.values[z],l.keyPath,N))):($=Os(H,x.values[z]),(V=E.fire.call(G,$,N,H,I))&&(q=x.values[z],Object.keys(V).forEach(function(U){d(q,U)?q[U]=V[U]:Y(q,U,V[U])}))),G});return u.mutate(x).then(function(N){for(var z=N.failures,$=N.results,V=N.numFailures,N=N.lastResult,q=0;q<C.length;++q){var H=($||C)[q],G=D[q];H==null?G.onerror&&G.onerror(z[q]):G.onsuccess&&G.onsuccess(x.type==="put"&&M[q]?x.values[q]:H)}return{failures:z,results:$,numFailures:V,lastResult:N}}).catch(function(N){return D.forEach(function(z){return z.onerror&&z.onerror(N)}),Promise.reject(N)})})}}})}})}};function ha(r,s,u){try{if(!s||s.keys.length<r.length)return null;for(var l=[],f=0,y=0;f<s.keys.length&&y<r.length;++f)pe(s.keys[f],r[y])===0&&(l.push(u?he(s.values[f]):s.values[f]),++y);return l.length===r.length?l:null}catch{return null}}var Sc={stack:"dbcore",level:-1,create:function(r){return{table:function(s){var u=r.table(s);return e(e({},u),{getMany:function(l){if(!l.cache)return u.getMany(l);var f=ha(l.keys,l.trans._cache,l.cache==="clone");return f?X.resolve(f):u.getMany(l).then(function(y){return l.trans._cache={keys:l.keys,values:l.cache==="clone"?he(y):y},y})},mutate:function(l){return l.type!=="add"&&(l.trans._cache=null),u.mutate(l)}})}}}};function pa(r,s){return r.trans.mode==="readonly"&&!!r.subscr&&!r.trans.explicit&&r.trans.db._options.cache!=="disabled"&&!s.schema.primaryKey.outbound}function da(r,s){switch(r){case"query":return s.values&&!s.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ic={stack:"dbcore",level:0,name:"Observability",create:function(r){var s=r.schema.name,u=new We(r.MIN_KEY,r.MAX_KEY);return e(e({},r),{transaction:function(l,f,y){if(ee.subscr&&f!=="readonly")throw new J.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ee.querier));return r.transaction(l,f,y)},table:function(l){var f=r.table(l),y=f.schema,v=y.primaryKey,x=y.indexes,b=v.extractKey,_=v.outbound,E=v.autoIncrement&&x.filter(function(k){return k.compound&&k.keyPath.includes(v.keyPath)}),A=e(e({},f),{mutate:function(k){function S(U){return U="idb://".concat(s,"/").concat(l,"/").concat(U),N[U]||(N[U]=new We)}var I,C,M,D=k.trans,N=k.mutatedParts||(k.mutatedParts={}),z=S(""),$=S(":dels"),V=k.type,G=k.type==="deleteRange"?[k.range]:k.type==="delete"?[k.keys]:k.values.length<50?[Ps(v,k).filter(function(U){return U}),k.values]:[],q=G[0],H=G[1],G=k.trans._cache;return a(q)?(z.addKeys(q),(G=V==="delete"||q.length===H.length?ha(q,G):null)||$.addKeys(q),(G||H)&&(I=S,C=G,M=H,y.indexes.forEach(function(U){var Z=I(U.name||"");function ie(ae){return ae!=null?U.extractKey(ae):null}function oe(ae){return U.multiEntry&&a(ae)?ae.forEach(function(at){return Z.addKey(at)}):Z.addKey(ae)}(C||M).forEach(function(ae,Xe){var re=C&&ie(C[Xe]),Xe=M&&ie(M[Xe]);pe(re,Xe)!==0&&(re!=null&&oe(re),Xe!=null&&oe(Xe))})}))):q?(H={from:(H=q.lower)!==null&&H!==void 0?H:r.MIN_KEY,to:(H=q.upper)!==null&&H!==void 0?H:r.MAX_KEY},$.add(H),z.add(H)):(z.add(u),$.add(u),y.indexes.forEach(function(U){return S(U.name).add(u)})),f.mutate(k).then(function(U){return!q||k.type!=="add"&&k.type!=="put"||(z.addKeys(U.results),E&&E.forEach(function(Z){for(var ie=k.values.map(function(re){return Z.extractKey(re)}),oe=Z.keyPath.findIndex(function(re){return re===v.keyPath}),ae=0,at=U.results.length;ae<at;++ae)ie[ae][oe]=U.results[ae];S(Z.name).addKeys(ie)})),D.mutatedParts=Gr(D.mutatedParts||{},N),U})}}),x=function(S){var I=S.query,S=I.index,I=I.range;return[S,new We((S=I.lower)!==null&&S!==void 0?S:r.MIN_KEY,(I=I.upper)!==null&&I!==void 0?I:r.MAX_KEY)]},P={get:function(k){return[v,new We(k.key)]},getMany:function(k){return[v,new We().addKeys(k.keys)]},count:x,query:x,openCursor:x};return o(P).forEach(function(k){A[k]=function(S){var I=ee.subscr,C=!!I,M=pa(ee,f)&&da(k,S)?S.obsSet={}:I;if(C){var D=function(H){return H="idb://".concat(s,"/").concat(l,"/").concat(H),M[H]||(M[H]=new We)},N=D(""),z=D(":dels"),I=P[k](S),C=I[0],I=I[1];if((k==="query"&&C.isPrimaryKey&&!S.values?z:D(C.name||"")).add(I),!C.isPrimaryKey){if(k!=="count"){var $=k==="query"&&_&&S.values&&f.query(e(e({},S),{values:!1}));return f[k].apply(this,arguments).then(function(H){if(k==="query"){if(_&&S.values)return $.then(function(ie){return ie=ie.result,N.addKeys(ie),H});var G=S.values?H.result.map(b):H.result;(S.values?N:z).addKeys(G)}else if(k==="openCursor"){var U=H,Z=S.values;return U&&Object.create(U,{key:{get:function(){return z.addKey(U.primaryKey),U.key}},primaryKey:{get:function(){var ie=U.primaryKey;return z.addKey(ie),ie}},value:{get:function(){return Z&&N.addKey(U.primaryKey),U.value}}})}return H})}z.add(u)}}return f[k].apply(this,arguments)}}),A}})}};function ya(r,s,u){if(u.numFailures===0)return s;if(s.type==="deleteRange")return null;var l=s.keys?s.keys.length:"values"in s&&s.values?s.values.length:1;return u.numFailures===l?null:(s=e({},s),a(s.keys)&&(s.keys=s.keys.filter(function(f,y){return!(y in u.failures)})),"values"in s&&a(s.values)&&(s.values=s.values.filter(function(f,y){return!(y in u.failures)})),s)}function Ms(r,s){return u=r,((l=s).lower===void 0||(l.lowerOpen?0<pe(u,l.lower):0<=pe(u,l.lower)))&&(r=r,(s=s).upper===void 0||(s.upperOpen?pe(r,s.upper)<0:pe(r,s.upper)<=0));var u,l}function ma(r,s,P,l,f,y){if(!P||P.length===0)return r;var v=s.query.index,b=v.multiEntry,_=s.query.range,E=l.schema.primaryKey.extractKey,A=v.extractKey,x=(v.lowLevelIndex||v).extractKey,P=P.reduce(function(k,S){var I=k,C=[];if(S.type==="add"||S.type==="put")for(var M=new We,D=S.values.length-1;0<=D;--D){var N,z=S.values[D],$=E(z);M.hasKey($)||(N=A(z),(b&&a(N)?N.some(function(U){return Ms(U,_)}):Ms(N,_))&&(M.addKey($),C.push(z)))}switch(S.type){case"add":var V=new We().addKeys(s.values?k.map(function(Z){return E(Z)}):k),I=k.concat(s.values?C.filter(function(Z){return Z=E(Z),!V.hasKey(Z)&&(V.addKey(Z),!0)}):C.map(function(Z){return E(Z)}).filter(function(Z){return!V.hasKey(Z)&&(V.addKey(Z),!0)}));break;case"put":var q=new We().addKeys(S.values.map(function(Z){return E(Z)}));I=k.filter(function(Z){return!q.hasKey(s.values?E(Z):Z)}).concat(s.values?C:C.map(function(Z){return E(Z)}));break;case"delete":var H=new We().addKeys(S.keys);I=k.filter(function(Z){return!H.hasKey(s.values?E(Z):Z)});break;case"deleteRange":var G=S.range;I=k.filter(function(Z){return!Ms(E(Z),G)})}return I},r);return P===r?r:(P.sort(function(k,S){return pe(x(k),x(S))||pe(E(k),E(S))}),s.limit&&s.limit<1/0&&(P.length>s.limit?P.length=s.limit:r.length===s.limit&&P.length<s.limit&&(f.dirty=!0)),y?Object.freeze(P):P)}function va(r,s){return pe(r.lower,s.lower)===0&&pe(r.upper,s.upper)===0&&!!r.lowerOpen==!!s.lowerOpen&&!!r.upperOpen==!!s.upperOpen}function Ac(r,s){return(function(u,l,f,y){if(u===void 0)return l!==void 0?-1:0;if(l===void 0)return 1;if((l=pe(u,l))===0){if(f&&y)return 0;if(f)return 1;if(y)return-1}return l})(r.lower,s.lower,r.lowerOpen,s.lowerOpen)<=0&&0<=(function(u,l,f,y){if(u===void 0)return l!==void 0?1:0;if(l===void 0)return-1;if((l=pe(u,l))===0){if(f&&y)return 0;if(f)return-1;if(y)return 1}return l})(r.upper,s.upper,r.upperOpen,s.upperOpen)}function Cc(r,s,u,l){r.subscribers.add(u),l.addEventListener("abort",function(){var f,y;r.subscribers.delete(u),r.subscribers.size===0&&(f=r,y=s,setTimeout(function(){f.subscribers.size===0&&be(y,f)},3e3))})}var Oc={stack:"dbcore",level:0,name:"Cache",create:function(r){var s=r.schema.name;return e(e({},r),{transaction:function(u,l,f){var y,v,b=r.transaction(u,l,f);return l==="readwrite"&&(v=(y=new AbortController).signal,f=function(_){return function(){if(y.abort(),l==="readwrite"){for(var E=new Set,A=0,x=u;A<x.length;A++){var P=x[A],k=dn["idb://".concat(s,"/").concat(P)];if(k){var S=r.table(P),I=k.optimisticOps.filter(function(Z){return Z.trans===b});if(b._explicit&&_&&b.mutatedParts)for(var C=0,M=Object.values(k.queries.query);C<M.length;C++)for(var D=0,N=(V=M[C]).slice();D<N.length;D++)ks((q=N[D]).obsSet,b.mutatedParts)&&(be(V,q),q.subscribers.forEach(function(Z){return E.add(Z)}));else if(0<I.length){k.optimisticOps=k.optimisticOps.filter(function(Z){return Z.trans!==b});for(var z=0,$=Object.values(k.queries.query);z<$.length;z++)for(var V,q,H,G=0,U=(V=$[z]).slice();G<U.length;G++)(q=U[G]).res!=null&&b.mutatedParts&&(_&&!q.dirty?(H=Object.isFrozen(q.res),H=ma(q.res,q.req,I,S,q,H),q.dirty?(be(V,q),q.subscribers.forEach(function(Z){return E.add(Z)})):H!==q.res&&(q.res=H,q.promise=X.resolve({result:H}))):(q.dirty&&be(V,q),q.subscribers.forEach(function(Z){return E.add(Z)})))}}}E.forEach(function(Z){return Z()})}}},b.addEventListener("abort",f(!1),{signal:v}),b.addEventListener("error",f(!1),{signal:v}),b.addEventListener("complete",f(!0),{signal:v})),b},table:function(u){var l=r.table(u),f=l.schema.primaryKey;return e(e({},l),{mutate:function(y){var v=ee.trans;if(f.outbound||v.db._options.cache==="disabled"||v.explicit||v.idbtrans.mode!=="readwrite")return l.mutate(y);var b=dn["idb://".concat(s,"/").concat(u)];return b?(v=l.mutate(y),y.type!=="add"&&y.type!=="put"||!(50<=y.values.length||Ps(f,y).some(function(_){return _==null}))?(b.optimisticOps.push(y),y.mutatedParts&&Wr(y.mutatedParts),v.then(function(_){0<_.numFailures&&(be(b.optimisticOps,y),(_=ya(0,y,_))&&b.optimisticOps.push(_),y.mutatedParts&&Wr(y.mutatedParts))}),v.catch(function(){be(b.optimisticOps,y),y.mutatedParts&&Wr(y.mutatedParts)})):v.then(function(_){var E=ya(0,e(e({},y),{values:y.values.map(function(A,x){var P;return _.failures[x]?A:(A=(P=f.keyPath)!==null&&P!==void 0&&P.includes(".")?he(A):e({},A),Y(A,f.keyPath,_.results[x]),A)})}),_);b.optimisticOps.push(E),queueMicrotask(function(){return y.mutatedParts&&Wr(y.mutatedParts)})}),v):l.mutate(y)},query:function(y){if(!pa(ee,l)||!da("query",y))return l.query(y);var v=((E=ee.trans)===null||E===void 0?void 0:E.db._options.cache)==="immutable",x=ee,b=x.requery,_=x.signal,E=(function(S,I,C,M){var D=dn["idb://".concat(S,"/").concat(I)];if(!D)return[];if(!(I=D.queries[C]))return[null,!1,D,null];var N=I[(M.query?M.query.index.name:null)||""];if(!N)return[null,!1,D,null];switch(C){case"query":var z=N.find(function($){return $.req.limit===M.limit&&$.req.values===M.values&&va($.req.query.range,M.query.range)});return z?[z,!0,D,N]:[N.find(function($){return("limit"in $.req?$.req.limit:1/0)>=M.limit&&(!M.values||$.req.values)&&Ac($.req.query.range,M.query.range)}),!1,D,N];case"count":return z=N.find(function($){return va($.req.query.range,M.query.range)}),[z,!!z,D,N]}})(s,u,"query",y),A=E[0],x=E[1],P=E[2],k=E[3];return A&&x?A.obsSet=y.obsSet:(x=l.query(y).then(function(S){var I=S.result;if(A&&(A.res=I),v){for(var C=0,M=I.length;C<M;++C)Object.freeze(I[C]);Object.freeze(I)}else S.result=he(I);return S}).catch(function(S){return k&&A&&be(k,A),Promise.reject(S)}),A={obsSet:y.obsSet,promise:x,subscribers:new Set,type:"query",req:y,dirty:!1},k?k.push(A):(k=[A],(P=P||(dn["idb://".concat(s,"/").concat(u)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[y.query.index.name||""]=k)),Cc(A,k,b,_),A.promise.then(function(S){return{result:ma(S.result,y,P?.optimisticOps,l,A,v)}})}})}})}};function Zr(r,s){return new Proxy(r,{get:function(u,l,f){return l==="db"?s:Reflect.get(u,l,f)}})}var zt=(Re.prototype.version=function(r){if(isNaN(r)||r<.1)throw new J.Type("Given version is not a positive number");if(r=Math.round(10*r)/10,this.idbdb||this._state.isBeingOpened)throw new J.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,r);var s=this._versions,u=s.filter(function(l){return l._cfg.version===r})[0];return u||(u=new this.Version(r),s.push(u),s.sort(gc),u.stores({}),this._state.autoSchema=!1,u)},Re.prototype._whenReady=function(r){var s=this;return this.idbdb&&(this._state.openComplete||ee.letThrough||this._vip)?r():new X(function(u,l){if(s._state.openComplete)return l(new J.DatabaseClosed(s._state.dbOpenError));if(!s._state.isBeingOpened){if(!s._state.autoOpen)return void l(new J.DatabaseClosed);s.open().catch(de)}s._state.dbReadyPromise.then(u,l)}).then(r)},Re.prototype.use=function(r){var s=r.stack,u=r.create,l=r.level,f=r.name;return f&&this.unuse({stack:s,name:f}),r=this._middlewares[s]||(this._middlewares[s]=[]),r.push({stack:s,create:u,level:l??10,name:f}),r.sort(function(y,v){return y.level-v.level}),this},Re.prototype.unuse=function(r){var s=r.stack,u=r.name,l=r.create;return s&&this._middlewares[s]&&(this._middlewares[s]=this._middlewares[s].filter(function(f){return l?f.create!==l:!!u&&f.name!==u})),this},Re.prototype.open=function(){var r=this;return fn($t,function(){return _c(r)})},Re.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var r=this._state,s=On.indexOf(this);if(0<=s&&On.splice(s,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}r.isBeingOpened||(r.dbReadyPromise=new X(function(u){r.dbReadyResolve=u}),r.openCanceller=new X(function(u,l){r.cancelOpen=l}))},Re.prototype.close=function(u){var s=(u===void 0?{disableAutoOpen:!0}:u).disableAutoOpen,u=this._state;s?(u.isBeingOpened&&u.cancelOpen(new J.DatabaseClosed),this._close(),u.autoOpen=!1,u.dbOpenError=new J.DatabaseClosed):(this._close(),u.autoOpen=this._options.autoOpen||u.isBeingOpened,u.openComplete=!1,u.dbOpenError=null)},Re.prototype.delete=function(r){var s=this;r===void 0&&(r={disableAutoOpen:!0});var u=0<arguments.length&&typeof arguments[0]!="object",l=this._state;return new X(function(f,y){function v(){s.close(r);var b=s._deps.indexedDB.deleteDatabase(s.name);b.onsuccess=Oe(function(){var _,E,A;_=s._deps,E=s.name,A=_.indexedDB,_=_.IDBKeyRange,xs(A)||E===Rr||ws(A,_).delete(E).catch(de),f()}),b.onerror=Ct(y),b.onblocked=s._fireOnBlocked}if(u)throw new J.InvalidArgument("Invalid closeOptions argument to db.delete()");l.isBeingOpened?l.dbReadyPromise.then(v):v()})},Re.prototype.backendDB=function(){return this.idbdb},Re.prototype.isOpen=function(){return this.idbdb!==null},Re.prototype.hasBeenClosed=function(){var r=this._state.dbOpenError;return r&&r.name==="DatabaseClosed"},Re.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Re.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Re.prototype,"tables",{get:function(){var r=this;return o(this._allTables).map(function(s){return r._allTables[s]})},enumerable:!1,configurable:!0}),Re.prototype.transaction=function(){var r=function(s,u,l){var f=arguments.length;if(f<2)throw new J.InvalidArgument("Too few arguments");for(var y=new Array(f-1);--f;)y[f-1]=arguments[f];return l=y.pop(),[s,ne(y),l]}.apply(this,arguments);return this._transaction.apply(this,r)},Re.prototype._transaction=function(r,s,u){var l=this,f=ee.trans;f&&f.db===this&&r.indexOf("!")===-1||(f=null);var y,v,b=r.indexOf("?")!==-1;r=r.replace("!","").replace("?","");try{if(v=s.map(function(E){if(E=E instanceof l.Table?E.name:E,typeof E!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return E}),r=="r"||r===cs)y=cs;else{if(r!="rw"&&r!=ls)throw new J.InvalidArgument("Invalid transaction mode: "+r);y=ls}if(f){if(f.mode===cs&&y===ls){if(!b)throw new J.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");f=null}f&&v.forEach(function(E){if(f&&f.storeNames.indexOf(E)===-1){if(!b)throw new J.SubTransaction("Table "+E+" not included in parent transaction.");f=null}}),b&&f&&!f.active&&(f=null)}}catch(E){return f?f._promise(null,function(A,x){x(E)}):Ne(E)}var _=function E(A,x,P,k,S){return X.resolve().then(function(){var I=ee.transless||ee,C=A._createTransaction(x,P,A._dbSchema,k);if(C.explicit=!0,I={trans:C,transless:I},k)C.idbtrans=k.idbtrans;else try{C.create(),C.idbtrans._explicit=!0,A._state.PR1398_maxLoop=3}catch(N){return N.name===ke.InvalidState&&A.isOpen()&&0<--A._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),A.close({disableAutoOpen:!1}),A.open().then(function(){return E(A,x,P,null,S)})):Ne(N)}var M,D=Te(S);return D&&Cn(),I=X.follow(function(){var N;(M=S.call(C,C))&&(D?(N=Ut.bind(null,null),M.then(N,N)):typeof M.next=="function"&&typeof M.throw=="function"&&(M=Cs(M)))},I),(M&&typeof M.then=="function"?X.resolve(M).then(function(N){return C.active?N:Ne(new J.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):I.then(function(){return M})).then(function(N){return k&&C._resolve(),C._completion.then(function(){return N})}).catch(function(N){return C._reject(N),Ne(N)})})}.bind(null,this,y,v,f,u);return f?f._promise(y,_,"lock"):ee.trans?fn(ee.transless,function(){return l._whenReady(_)}):this._whenReady(_)},Re.prototype.table=function(r){if(!d(this._allTables,r))throw new J.InvalidTable("Table ".concat(r," does not exist"));return this._allTables[r]},Re);function Re(r,s){var u=this;this._middlewares={},this.verno=0;var l=Re.dependencies;this._options=s=e({addons:Re.addons,autoOpen:!0,indexedDB:l.indexedDB,IDBKeyRange:l.IDBKeyRange,cache:"cloned"},s),this._deps={indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange},l=s.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var f,y,v,b,_,E={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:de,dbReadyPromise:null,cancelOpen:de,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:s.autoOpen};E.dbReadyPromise=new X(function(x){E.dbReadyResolve=x}),E.openCanceller=new X(function(x,P){E.cancelOpen=P}),this._state=E,this.name=r,this.on=Yn(this,"populate","blocked","versionchange","close",{ready:[es,de]}),this.once=function(x,P){var k=function(){for(var S=[],I=0;I<arguments.length;I++)S[I]=arguments[I];u.on(x).unsubscribe(k),P.apply(u,S)};return u.on(x,k)},this.on.ready.subscribe=F(this.on.ready.subscribe,function(x){return function(P,k){Re.vip(function(){var S,I=u._state;I.openComplete?(I.dbOpenError||X.resolve().then(P),k&&x(P)):I.onReadyBeingFired?(I.onReadyBeingFired.push(P),k&&x(P)):(x(P),S=u,k||x(function C(){S.on.ready.unsubscribe(P),S.on.ready.unsubscribe(C)}))})}}),this.Collection=(f=this,Qn(fc.prototype,function(M,C){this.db=f;var k=Vo,S=null;if(C)try{k=C()}catch(D){S=D}var I=M._ctx,C=I.table,M=C.hook.reading.fire;this._ctx={table:C,index:I.index,isPrimKey:!I.index||C.schema.primKey.keyPath&&I.index===C.schema.primKey.name,range:k,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:S,or:I.or,valueMapper:M!==wt?M:null}})),this.Table=(y=this,Qn(Yo.prototype,function(x,P,k){this.db=y,this._tx=k,this.name=x,this.schema=P,this.hook=y._allTables[x]?y._allTables[x].hook:Yn(null,{creating:[Vn,de],reading:[on,wt],updating:[ic,de],deleting:[rc,de]})})),this.Transaction=(v=this,Qn(dc.prototype,function(x,P,k,S,I){var C=this;x!=="readonly"&&P.forEach(function(M){M=(M=k[M])===null||M===void 0?void 0:M.yProps,M&&(P=P.concat(M.map(function(D){return D.updatesTable})))}),this.db=v,this.mode=x,this.storeNames=P,this.schema=k,this.chromeTransactionDurability=S,this.idbtrans=null,this.on=Yn(this,"complete","error","abort"),this.parent=I||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new X(function(M,D){C._resolve=M,C._reject=D}),this._completion.then(function(){C.active=!1,C.on.complete.fire()},function(M){var D=C.active;return C.active=!1,C.on.error.fire(M),C.parent?C.parent._reject(M):D&&C.idbtrans&&C.idbtrans.abort(),Ne(M)})})),this.Version=(b=this,Qn(xc.prototype,function(x){this.db=b,this._cfg={version:x,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(_=this,Qn(ra.prototype,function(x,P,k){if(this.db=_,this._ctx={table:x,index:P===":id"?null:P,or:k},this._cmp=this._ascending=pe,this._descending=function(S,I){return pe(I,S)},this._max=function(S,I){return 0<pe(S,I)?S:I},this._min=function(S,I){return pe(S,I)<0?S:I},this._IDBKeyRange=_._deps.IDBKeyRange,!this._IDBKeyRange)throw new J.MissingAPI})),this.on("versionchange",function(x){0<x.newVersion?console.warn("Another connection wants to upgrade database \'".concat(u.name,"\'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database \'".concat(u.name,"\'. Closing db now to resume the delete request.")),u.close({disableAutoOpen:!1})}),this.on("blocked",function(x){!x.newVersion||x.newVersion<x.oldVersion?console.warn("Dexie.delete(\'".concat(u.name,"\') was blocked")):console.warn("Upgrade \'".concat(u.name,"\' blocked by other connection holding version ").concat(x.oldVersion/10))}),this._maxKey=nr(s.IDBKeyRange),this._createTransaction=function(x,P,k,S){return new u.Transaction(x,P,k,u._options.chromeTransactionDurability,S)},this._fireOnBlocked=function(x){u.on("blocked").fire(x),On.filter(function(P){return P.name===u.name&&P!==u&&!P._state.vcFired}).map(function(P){return P.on("versionchange").fire(x)})},this.use(Sc),this.use(Oc),this.use(Ic),this.use(Ec),this.use(kc);var A=new Proxy(this,{get:function(x,P,k){if(P==="_vip")return!0;if(P==="table")return function(I){return Zr(u.table(I),A)};var S=Reflect.get(x,P,k);return S instanceof Yo?Zr(S,A):P==="tables"?S.map(function(I){return Zr(I,A)}):P==="_createTransaction"?function(){return Zr(S.apply(this,arguments),A)}:S}});this.vip=A,l.forEach(function(x){return x(u)})}var Jr,dt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Pc=(Ds.prototype.subscribe=function(r,s,u){return this._subscribe(r&&typeof r!="function"?r:{next:r,error:s,complete:u})},Ds.prototype[dt]=function(){return this},Ds);function Ds(r){this._subscribe=r}try{Jr={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Jr={indexedDB:null,IDBKeyRange:null}}function ga(r){var s,u=!1,l=new Pc(function(f){var y=Te(r),v,b=!1,_={},E={},A={get closed(){return b},unsubscribe:function(){b||(b=!0,v&&v.abort(),x&&Wt.storagemutated.unsubscribe(k))}};f.start&&f.start(A);var x=!1,P=function(){return us(S)},k=function(I){Gr(_,I),ks(E,_)&&P()},S=function(){var I,C,M;!b&&Jr.indexedDB&&(_={},I={},v&&v.abort(),v=new AbortController,M=(function(D){var N=In();try{y&&Cn();var z=Ht(r,D);return z=y?z.finally(Ut):z}finally{N&&An()}})(C={subscr:I,signal:v.signal,requery:P,querier:r,trans:null}),Promise.resolve(M).then(function(D){u=!0,s=D,b||C.signal.aborted||(_={},(function(N){for(var z in N)if(d(N,z))return;return 1})(E=I)||x||(Wt(tr,k),x=!0),us(function(){return!b&&f.next&&f.next(D)}))},function(D){u=!1,["DatabaseClosedError","AbortError"].includes(D?.name)||b||us(function(){b||f.error&&f.error(D)})}))};return setTimeout(P,0),A});return l.hasValue=function(){return u},l.getValue=function(){return s},l}var yn=zt;function Ts(r){var s=Xt;try{Xt=!0,Wt.storagemutated.fire(r),As(r,!0)}finally{Xt=s}}m(yn,e(e({},Nt),{delete:function(r){return new yn(r,{addons:[]}).delete()},exists:function(r){return new yn(r,{addons:[]}).open().then(function(s){return s.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(r){try{return s=yn.dependencies,u=s.indexedDB,s=s.IDBKeyRange,(xs(u)?Promise.resolve(u.databases()).then(function(l){return l.map(function(f){return f.name}).filter(function(f){return f!==Rr})}):ws(u,s).toCollection().primaryKeys()).then(r)}catch{return Ne(new J.MissingAPI)}var s,u},defineClass:function(){return function(r){c(this,r)}},ignoreTransaction:function(r){return ee.trans?fn(ee.transless,r):r()},vip:_s,async:function(r){return function(){try{var s=Cs(r.apply(this,arguments));return s&&typeof s.then=="function"?s:X.resolve(s)}catch(u){return Ne(u)}}},spawn:function(r,s,u){try{var l=Cs(r.apply(u,s||[]));return l&&typeof l.then=="function"?l:X.resolve(l)}catch(f){return Ne(f)}},currentTransaction:{get:function(){return ee.trans||null}},waitFor:function(r,s){return s=X.resolve(typeof r=="function"?yn.ignoreTransaction(r):r).timeout(s||6e4),ee.trans?ee.trans.waitFor(s):s},Promise:X,debug:{get:function(){return At},set:function(r){Bo(r)}},derive:O,extend:c,props:m,override:F,Events:Yn,on:Wt,liveQuery:ga,extendObservabilitySet:Gr,getByKeyPath:K,setByKeyPath:Y,delByKeyPath:function(r,s){typeof s=="string"?Y(r,s,void 0):"length"in s&&[].map.call(s,function(u){Y(r,u,void 0)})},shallowClone:ce,deepClone:he,getObjectDiff:Os,cmp:pe,asap:B,minKey:-1/0,addons:[],connections:On,errnames:ke,dependencies:Jr,cache:dn,semVer:"4.2.1",version:"4.2.1".split(".").map(function(r){return parseInt(r)}).reduce(function(r,s,u){return r+s/Math.pow(10,2*u)})})),yn.maxKey=nr(yn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Wt(tr,function(r){Xt||(r=new CustomEvent(ps,{detail:r}),Xt=!0,dispatchEvent(r),Xt=!1)}),addEventListener(ps,function(r){r=r.detail,Xt||Ts(r)}));var Tn,Xt=!1,ba=function(){};return typeof BroadcastChannel<"u"&&((ba=function(){(Tn=new BroadcastChannel(ps)).onmessage=function(r){return r.data&&Ts(r.data)}})(),typeof Tn.unref=="function"&&Tn.unref(),Wt(tr,function(r){Xt||Tn.postMessage(r)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(r){if(!zt.disableBfCache&&r.persisted){At&&console.debug("Dexie: handling persisted pagehide"),Tn?.close();for(var s=0,u=On;s<u.length;s++)u[s].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(r){!zt.disableBfCache&&r.persisted&&(At&&console.debug("Dexie: handling persisted pageshow"),ba(),Ts({all:new We(-1/0,[[]])}))})),X.rejectionMapper=function(r,s){return!r||r instanceof qe||r instanceof TypeError||r instanceof SyntaxError||!r.name||!Tt[r.name]?r:(s=new Tt[r.name](s||r.message,r),"stack"in r&&w(s,"stack",{get:function(){return this.inner.stack}}),s)},Bo(At),e(zt,Object.freeze({__proto__:null,Dexie:zt,liveQuery:ga,Entity:Go,cmp:pe,PropModification:Jn,replacePrefix:function(r,s){return new Jn({replacePrefix:[r,s]})},add:function(r){return new Jn({add:r})},remove:function(r){return new Jn({remove:r})},default:zt,RangeSet:We,mergeRanges:sr,rangesOverlap:ua}),{default:zt}),zt})});var Ii,Va,ct,Uf,Vf,Gf,Wf,Xf,Zf,Jf,Yf,Qf,eh,th,pr=vn(()=>{Ii=Bc(Ua(),1),Va=Symbol.for("Dexie"),ct=globalThis[Va]||(globalThis[Va]=Ii.default);if(Ii.default.semVer!==ct.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ii.default.semVer} and ${ct.semVer}`);({liveQuery:Uf,mergeRanges:Vf,rangesOverlap:Gf,RangeSet:Wf,cmp:Xf,Entity:Zf,PropModification:Jf,replacePrefix:Yf,add:Qf,remove:eh,DexieYProvider:th}=ct)});var we,jn=vn(()=>{it();we=te({MAX_CHAIN_LENGTH:50,DIFF_SIZE_THRESHOLD:.8,DB_NAME:"VersionControlEditHistoryDB",COMPRESSION_LEVEL:9,MAX_CONTENT_SIZE:50*1024*1024,MAX_ID_LENGTH:255,MAX_RETRIES:3,RETRY_BASE_DELAY_MS:10,HASH_ALGORITHM:"SHA-256",CHAIN_THRESHOLDS:te({SMALL_SIZE_LIMIT:10*1024,MEDIUM_SIZE_LIMIT:50*1024,SMALL_CHAIN_LENGTH:50,MEDIUM_CHAIN_LENGTH:10,LARGE_CHAIN_LENGTH:1},!0)},!0)});var le,Je,_e,Qt,co,gr,xn,Li,Bi,Fi,qi,$n,Et=vn(()=>{it();le=class extends Error{field;issues;context;recoverable;constructor(e,n,i,o=!0){super(e),this.name="ValidationError",this.field=n,Array.isArray(i)?this.issues=te([...i],!0):i&&(this.context=te({...i},!0)),this.recoverable=o,Object.freeze(this)}},Je=class extends Error{severity;operation;constructor(e,n,i="medium"){super(e),this.name="SecurityError",this.severity=i,this.operation=n,Object.freeze(this)}},_e=class extends Error{context;canRecover;constructor(e,n,i=!1){super(e),this.name="StateConsistencyError",this.context=n!==void 0?te({...n},!0):void 0,this.canRecover=i,Object.freeze(this)}},Qt=class extends Error{expectedHash;actualHash;severity;context;constructor(e,n,i,o="error"){super(e),this.name="IntegrityError",this.expectedHash=n,this.actualHash=i,typeof o=="string"?this.severity=o:(this.severity="error",this.context=te({...o},!0)),Object.freeze(this)}},co=class extends Error{operationName;timeoutMs;stage;constructor(e,n,i="execution"){super(`Operation \'${e}\' timed out after ${n}ms during ${i}`),this.name="OperationTimeoutError",this.operationName=e,this.timeoutMs=n,this.stage=i,Object.freeze(this)}},gr=class extends Error{resource;current;limit;unit;constructor(e,n,i,o,a="bytes"){super(e),this.name="CapacityError",this.resource=n,this.current=i,this.limit=o,this.unit=a,Object.freeze(this)}},xn=class extends Error{conflictingOperation;resource;retryable;constructor(e,n,i,o=!0){super(e),this.name="ConcurrencyError",this.conflictingOperation=n,this.resource=i,this.retryable=o,Object.freeze(this)}},Li=class extends Error{context;constructor(e,n){super(e),this.name="CircularReferenceError",this.context=n?te({...n},!0):void 0,Object.freeze(this)}},Bi=class extends Error{context;constructor(e,n){super(e),this.name="ChainLengthError",this.context=n?te({...n},!0):void 0,Object.freeze(this)}},Fi=class extends Error{context;constructor(e,n){super(e),this.name="MissingEditError",this.context=n?te({...n},!0):void 0,Object.freeze(this)}},qi=class extends Error{context;constructor(e,n){super(e),this.name="BrokenChainError",this.context=n?te({...n},!0):void 0,Object.freeze(this)}},$n=class extends Error{context;constructor(e,n){super(e),this.name="ReconstructionError",this.context=n?te({...n},!0):void 0,Object.freeze(this)}}});var $u={};jc($u,{cleanupDatabase:()=>ko,db:()=>R,initializeDatabase:()=>Eo});async function Eo(){try{await R.open(),console.info("VC: Database initialized successfully")}catch(t){console.error("VC: Database initialization failed:",t)}}async function ko(){try{R.isOpen()&&await R.close()}catch(t){console.error("VC: Database cleanup failed:",t)}}var _o,R,nn=vn(()=>{pr();jn();Si();Et();_o=class extends ct{edits;manifests;MAX_RETRIES=3;RETRY_DELAY_BASE=50;MAX_RETRY_DELAY=1e3;constructor(){super(we.DB_NAME),this.configureDatabase(),this.configureErrorHandling()}configureDatabase(){this.version(1).stores({edits:"++id, [noteId+editId], noteId",manifests:"noteId"}),this.version(2).stores({edits:"++id, [noteId+branchName+editId], [noteId+branchName], noteId, createdAt",manifests:"noteId, updatedAt"}).upgrade(e=>e.table("edits").toCollection().modify(n=>{n.branchName===void 0&&(n.branchName="main"),n.createdAt===void 0&&(n.createdAt=Date.now()),n.storageType===void 0&&(n.storageType="full"),n.chainLength===void 0&&(n.chainLength=0),n.size===void 0&&(n.size=n.content?.byteLength??0)})),this.version(3).stores({edits:"++id, [noteId+branchName+editId], [noteId+branchName], noteId, createdAt, [noteId+branchName+createdAt]",manifests:"noteId, updatedAt"}),this.version(4).stores({edits:"++id, [noteId+branchName+editId], [noteId+branchName], noteId, createdAt, size, [noteId+branchName+createdAt]",manifests:"noteId, updatedAt"}),this.version(5).stores({edits:"++id, [noteId+branchName+editId], [noteId+branchName], noteId, createdAt, size, contentHash, [noteId+branchName+createdAt]",manifests:"noteId, updatedAt"}).upgrade(e=>e.table("edits").toCollection().modify(n=>{n.contentHash===void 0&&(n.contentHash=""),n.uncompressedSize===void 0&&(n.uncompressedSize=0)})),this.version(6).stores({edits:"++id, [noteId+branchName+editId], [noteId+branchName], noteId, createdAt, size, contentHash, [noteId+branchName+createdAt], storageType, chainLength",manifests:"noteId, updatedAt, [updatedAt+noteId]"}).upgrade(e=>e.table("edits").toCollection().modify(n=>{n.storageType=n.storageType||"full",n.chainLength=n.chainLength||0,n.uncompressedSize=n.uncompressedSize||0,n.contentHash=n.contentHash||""})),this.version(7).stores({edits:"++id, [noteId+branchName+editId], [noteId+branchName], noteId, createdAt, size, contentHash, [noteId+branchName+createdAt], storageType, chainLength",manifests:"noteId, updatedAt, [updatedAt+noteId]"}).upgrade(e=>e.table("edits").toCollection().modify(n=>{n.storageType==="full"&&n.chainLength>0&&(n.chainLength=0)}))}configureErrorHandling(){this.on("blocked",()=>{console.warn("VC: Database upgrade blocked - close other tabs or reload")}),this.on("versionchange",e=>{console.info(`VC: Database version changed from ${e.oldVersion} to ${e.newVersion}. Closing connection.`),this.close()}),this.on("populate",async()=>{console.info("VC: Initializing new database")})}async execute(e,n="db-op"){if(ct.currentTransaction)return e();let i=0,o;for(;i<=this.MAX_RETRIES;)try{return this.isOpen()||await this.open(),await e()}catch(a){if(o=a,i++,a.name==="QuotaExceededError"||a.message?.toLowerCase().includes("quota"))throw new gr("Storage quota exceeded","database",0,0,"bytes");if(a.name==="SchemaError"||a.name==="DataError")throw a;if(!this.isRecoverableError(a)||i>this.MAX_RETRIES)throw i>this.MAX_RETRIES&&console.error(`VC: DB Operation \'${n}\' failed after ${i} attempts. Last error:`,a),a;if(this.isConnectionError(a))try{this.close()}catch{}let h=Math.min(this.MAX_RETRY_DELAY,this.RETRY_DELAY_BASE*Math.pow(2,i)),p=Math.random()*(h*.5),d=h+p;console.warn(`VC: Retrying DB op \'${n}\' (${i}/${this.MAX_RETRIES}) in ${Math.round(d)}ms. Error: ${a.name||a.message}`),await ki(d)}throw o}isRecoverableError(e){let n=e.name,i=e.message||"";return n==="DatabaseClosedError"||n==="TransactionInactiveError"||n==="UnknownError"||n==="AbortError"||n==="TimeoutError"||n==="InvalidStateError"||n==="ReadOnlyError"||i.includes("closing")||i.includes("closed")}isConnectionError(e){let n=e.name;return n==="DatabaseClosedError"||n==="UnknownError"||n==="InvalidStateError"}async compact(){try{await this.execute(async()=>{await this.transaction("rw",this.edits,this.manifests,async()=>{let e=await this.edits.count();await this.edits.toCollection().modify(i=>{i.content&&i.content.byteLength===0&&(i.content=void 0)});let n=await this.edits.count();console.info(`VC: Database compacted: ${e} -> ${n} records`)})},"compact")}catch(e){console.error("VC: Database compaction failed:",e)}}async getStats(){return this.execute(async()=>{let[e,n]=await Promise.all([this.edits.count(),this.manifests.count()]),i=0,o=0;return await this.edits.each(a=>{i+=a.content?.byteLength||0,o++}),{editCount:e,manifestCount:n,totalSize:i,avgEditSize:o>0?i/o:0}},"getStats")}async vacuum(){try{await this.execute(async()=>{await this.transaction("rw",this.edits,this.manifests,async()=>{let e=await this.manifests.toArray(),n=new Set(e.map(i=>i.noteId));await this.edits.where("noteId").anyOf(Array.from(n)).delete()})},"vacuum")}catch(e){console.error("VC: Database vacuum failed:",e)}}},R=new _o});var xa=Symbol("Comlink.proxy"),Fc=Symbol("Comlink.endpoint"),qc=Symbol("Comlink.releaseProxy"),zs=Symbol("Comlink.finalizer"),ei=Symbol("Comlink.thrown"),_a=t=>typeof t=="object"&&t!==null||typeof t=="function",Kc={canHandle:t=>_a(t)&&t[xa],serialize(t){let{port1:e,port2:n}=new MessageChannel;return ii(t,e),[n,[n]]},deserialize(t){return t.start(),Vc(t)}},$c={canHandle:t=>_a(t)&&ei in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},Ea=new Map([["proxy",Kc],["throw",$c]]);function Hc(t,e){for(let n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function ii(t,e=globalThis,n=["*"]){e.addEventListener("message",function i(o){if(!o||!o.data)return;if(!Hc(n,o.origin)){console.warn(`Invalid origin \'${o.origin}\' for comlink proxy`);return}let{id:a,type:c,path:h}=Object.assign({path:[]},o.data),p=(o.data.argumentList||[]).map(gn),d;try{let m=h.slice(0,-1).reduce((w,O)=>w[O],t),g=h.reduce((w,O)=>w[O],t);switch(c){case"GET":d=g;break;case"SET":m[h.slice(-1)[0]]=gn(o.data.value),d=!0;break;case"APPLY":d=g.apply(m,p);break;case"CONSTRUCT":{let w=new g(...p);d=Zc(w)}break;case"ENDPOINT":{let{port1:w,port2:O}=new MessageChannel;ii(t,O),d=si(w,[w])}break;case"RELEASE":d=void 0;break;default:return}}catch(m){d={value:m,[ei]:0}}Promise.resolve(d).catch(m=>({value:m,[ei]:0})).then(m=>{let[g,w]=ri(m);e.postMessage(Object.assign(Object.assign({},g),{id:a}),w),c==="RELEASE"&&(e.removeEventListener("message",i),ka(e),zs in t&&typeof t[zs]=="function"&&t[zs]())}).catch(m=>{let[g,w]=ri({value:new TypeError("Unserializable return value"),[ei]:0});e.postMessage(Object.assign(Object.assign({},g),{id:a}),w)})}),e.start&&e.start()}function Uc(t){return t.constructor.name==="MessagePort"}function ka(t){Uc(t)&&t.close()}function Vc(t,e){let n=new Map;return t.addEventListener("message",function(o){let{data:a}=o;if(!a||!a.id)return;let c=n.get(a.id);if(c)try{c(a)}finally{n.delete(a.id)}}),js(t,n,[],e)}function Qr(t){if(t)throw new Error("Proxy has been released and is not useable")}function Sa(t){return Nn(t,new Map,{type:"RELEASE"}).then(()=>{ka(t)})}var ti=new WeakMap,ni="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(ti.get(t)||0)-1;ti.set(t,e),e===0&&Sa(t)});function Gc(t,e){let n=(ti.get(e)||0)+1;ti.set(e,n),ni&&ni.register(t,e,t)}function Wc(t){ni&&ni.unregister(t)}function js(t,e,n=[],i=function(){}){let o=!1,a=new Proxy(i,{get(c,h){if(Qr(o),h===qc)return()=>{Wc(a),Sa(t),e.clear(),o=!0};if(h==="then"){if(n.length===0)return{then:()=>a};let p=Nn(t,e,{type:"GET",path:n.map(d=>d.toString())}).then(gn);return p.then.bind(p)}return js(t,e,[...n,h])},set(c,h,p){Qr(o);let[d,m]=ri(p);return Nn(t,e,{type:"SET",path:[...n,h].map(g=>g.toString()),value:d},m).then(gn)},apply(c,h,p){Qr(o);let d=n[n.length-1];if(d===Fc)return Nn(t,e,{type:"ENDPOINT"}).then(gn);if(d==="bind")return js(t,e,n.slice(0,-1));let[m,g]=wa(p);return Nn(t,e,{type:"APPLY",path:n.map(w=>w.toString()),argumentList:m},g).then(gn)},construct(c,h){Qr(o);let[p,d]=wa(h);return Nn(t,e,{type:"CONSTRUCT",path:n.map(m=>m.toString()),argumentList:p},d).then(gn)}});return Gc(a,t),a}function Xc(t){return Array.prototype.concat.apply([],t)}function wa(t){let e=t.map(ri);return[e.map(n=>n[0]),Xc(e.map(n=>n[1]))]}var Ia=new WeakMap;function si(t,e){return Ia.set(t,e),t}function Zc(t){return Object.assign(t,{[xa]:!0})}function ri(t){for(let[e,n]of Ea)if(n.canHandle(t)){let[i,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:i},o]}return[{type:"RAW",value:t},Ia.get(t)||[]]}function gn(t){switch(t.type){case"HANDLER":return Ea.get(t.name).deserialize(t.value);case"RAW":return t.value}}function Nn(t,e,n,i){return new Promise(o=>{let a=Jc();e.set(a,o),t.start&&t.start(),t.postMessage(Object.assign({id:a},n),i)})}function Jc(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}it();it();Si();pr();jn();var Jt=class{static encoder=new TextEncoder;static async computeHash(e){let n=this.encoder.encode(e),i=await ct.waitFor(crypto.subtle.digest(we.HASH_ALGORITHM,n));return Array.from(new Uint8Array(i)).map(a=>a.toString(16).padStart(2,"0")).join("")}static async verifyIntegrity(e,n){return!n||n.length===0?!0:n.length!==64?!1:await this.computeHash(e)===n}static async computeHashWithSalt(e,n){let i=e+n;return this.computeHash(i)}static async verifyIntegrityWithSalt(e,n,i){return await this.computeHashWithSalt(e,i)===n}static validateHashFormat(e){return/^[a-f0-9]{64}$/i.test(e)}static async computeBatchHashes(e){let n=[];for(let i of e)n.push(await this.computeHash(i));return n}static clearCache(){}};var Ga={},yl=(function(t,e,n,i,o){var a=new Worker(Ga[e]||(Ga[e]=URL.createObjectURL(new Blob([t+\';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})\'],{type:"text/javascript"}))));return a.onmessage=function(c){var h=c.data,p=h.$e$;if(p){var d=new Error(p[0]);d.code=p[1],d.stack=p[2],o(d,null)}else o(null,h)},a.postMessage(n,i),a}),xe=Uint8Array,tt=Uint16Array,mr=Int32Array,qn=new xe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Kn=new xe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dr=new xe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ja=function(t,e){for(var n=new tt(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var o=new mr(n[30]),i=1;i<30;++i)for(var a=n[i];a<n[i+1];++a)o[a]=a-n[i]<<5|i;return{b:n,r:o}},Ya=Ja(qn,2),ro=Ya.b,Mi=Ya.r;ro[28]=258,Mi[258]=28;var Qa=Ja(Kn,0),eu=Qa.b,Ys=Qa.r,yr=new tt(32768);for(ge=0;ge<32768;++ge)Lt=(ge&43690)>>1|(ge&21845)<<1,Lt=(Lt&52428)>>2|(Lt&13107)<<2,Lt=(Lt&61680)>>4|(Lt&3855)<<4,yr[ge]=((Lt&65280)>>8|(Lt&255)<<8)>>1;var Lt,ge,vt=(function(t,e,n){for(var i=t.length,o=0,a=new tt(e);o<i;++o)t[o]&&++a[t[o]-1];var c=new tt(e);for(o=1;o<e;++o)c[o]=c[o-1]+a[o-1]<<1;var h;if(n){h=new tt(1<<e);var p=15-e;for(o=0;o<i;++o)if(t[o])for(var d=o<<4|t[o],m=e-t[o],g=c[t[o]-1]++<<m,w=g|(1<<m)-1;g<=w;++g)h[yr[g]>>p]=d}else for(h=new tt(i),o=0;o<i;++o)t[o]&&(h[o]=yr[c[t[o]-1]++]>>15-t[o]);return h}),Bt=new xe(288);for(ge=0;ge<144;++ge)Bt[ge]=8;var ge;for(ge=144;ge<256;++ge)Bt[ge]=9;var ge;for(ge=256;ge<280;++ge)Bt[ge]=7;var ge;for(ge=280;ge<288;++ge)Bt[ge]=8;var ge,Fn=new xe(32);for(ge=0;ge<32;++ge)Fn[ge]=5;var ge,tu=vt(Bt,9,0),nu=vt(Bt,9,1),ru=vt(Fn,5,0),iu=vt(Fn,5,1),Ci=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},mt=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(e&7)&n},Oi=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},vr=function(t){return(t+7)/8|0},wn=function(t,e,n){return(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length),new xe(t.subarray(e,n))};var su=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Pe=function(t,e,n){var i=new Error(e||su[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,Pe),!n)throw i;return i},Ni=function(t,e,n,i){var o=t.length,a=i?i.length:0;if(!o||e.f&&!e.l)return n||new xe(0);var c=!n,h=c||e.i!=2,p=e.i;c&&(n=new xe(o*3));var d=function(wt){var on=n.length;if(wt>on){var rt=new xe(Math.max(on*2,wt));rt.set(n),n=rt}},m=e.f||0,g=e.p||0,w=e.b||0,O=e.l,T=e.d,L=e.m,j=e.n,F=o*8;do{if(!O){m=mt(t,g,1);var W=mt(t,g+1,3);if(g+=3,W)if(W==1)O=nu,T=iu,L=9,j=5;else if(W==2){var ce=mt(t,g,31)+257,fe=mt(t,g+10,15)+4,ne=ce+mt(t,g+5,31)+1;g+=14;for(var Q=new xe(ne),ve=new xe(19),he=0;he<fe;++he)ve[dr[he]]=mt(t,g+he*3,7);g+=fe*3;for(var Ae=Ci(ve),Qe=(1<<Ae)-1,Me=vt(ve,Ae,1),he=0;he<ne;){var De=Me[mt(t,g,Qe)];g+=De&15;var B=De>>4;if(B<16)Q[he++]=B;else{var be=0,ye=0;for(B==16?(ye=3+mt(t,g,3),g+=2,be=Q[he-1]):B==17?(ye=3+mt(t,g,7),g+=3):B==18&&(ye=11+mt(t,g,127),g+=7);ye--;)Q[he++]=be}}var Ce=Q.subarray(0,ce),Te=Q.subarray(ce);L=Ci(Ce),j=Ci(Te),O=vt(Ce,L,1),T=vt(Te,j,1)}else Pe(1);else{var B=vr(g)+4,K=t[B-4]|t[B-3]<<8,Y=B+K;if(Y>o){p&&Pe(0);break}h&&d(w+K),n.set(t.subarray(B,Y),w),e.b=w+=K,e.p=g=Y*8,e.f=m;continue}if(g>F){p&&Pe(0);break}}h&&d(w+131072);for(var sn=(1<<L)-1,qe=(1<<j)-1,ht=g;;ht=g){var be=O[Oi(t,g)&sn],Ke=be>>4;if(g+=be&15,g>F){p&&Pe(0);break}if(be||Pe(2),Ke<256)n[w++]=Ke;else if(Ke==256){ht=g,O=null;break}else{var Le=Ke-254;if(Ke>264){var he=Ke-257,ke=qn[he];Le=mt(t,g,(1<<ke)-1)+ro[he],g+=ke}var pt=T[Oi(t,g)&qe],J=pt>>4;pt||Pe(3),g+=pt&15;var Te=eu[J];if(J>3){var ke=Kn[J];Te+=Oi(t,g)&(1<<ke)-1,g+=ke}if(g>F){p&&Pe(0);break}h&&d(w+131072);var Tt=w+Le;if(w<Te){var Nt=a-Te,de=Math.min(Te,Tt);for(Nt+w<0&&Pe(3);w<de;++w)n[w]=i[Nt+w]}for(;w<Tt;++w)n[w]=n[w-Te]}}e.l=O,e.p=ht,e.b=w,e.f=m,O&&(m=1,e.m=L,e.d=T,e.n=j)}while(!m);return w!=n.length&&c?wn(n,0,w):n.subarray(0,w)},Pt=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8},Ln=function(t,e,n){n<<=e&7;var i=e/8|0;t[i]|=n,t[i+1]|=n>>8,t[i+2]|=n>>16},Pi=function(t,e){for(var n=[],i=0;i<t.length;++i)t[i]&&n.push({s:i,f:t[i]});var o=n.length,a=n.slice();if(!o)return{t:so,l:0};if(o==1){var c=new xe(n[0].s+1);return c[n[0].s]=1,{t:c,l:1}}n.sort(function(Y,ce){return Y.f-ce.f}),n.push({s:-1,f:25001});var h=n[0],p=n[1],d=0,m=1,g=2;for(n[0]={s:-1,f:h.f+p.f,l:h,r:p};m!=o-1;)h=n[n[d].f<n[g].f?d++:g++],p=n[d!=m&&n[d].f<n[g].f?d++:g++],n[m++]={s:-1,f:h.f+p.f,l:h,r:p};for(var w=a[0].s,i=1;i<o;++i)a[i].s>w&&(w=a[i].s);var O=new tt(w+1),T=Di(n[m-1],O,0);if(T>e){var i=0,L=0,j=T-e,F=1<<j;for(a.sort(function(ce,fe){return O[fe.s]-O[ce.s]||ce.f-fe.f});i<o;++i){var W=a[i].s;if(O[W]>e)L+=F-(1<<T-O[W]),O[W]=e;else break}for(L>>=j;L>0;){var B=a[i].s;O[B]<e?L-=1<<e-O[B]++-1:++i}for(;i>=0&&L;--i){var K=a[i].s;O[K]==e&&(--O[K],++L)}T=e}return{t:new xe(O),l:T}},Di=function(t,e,n){return t.s==-1?Math.max(Di(t.l,e,n+1),Di(t.r,e,n+1)):e[t.s]=n},Qs=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new tt(++e),i=0,o=t[0],a=1,c=function(p){n[i++]=p},h=1;h<=e;++h)if(t[h]==o&&h!=e)++a;else{if(!o&&a>2){for(;a>138;a-=138)c(32754);a>2&&(c(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(c(o),--a;a>6;a-=6)c(8304);a>2&&(c(a-3<<5|8208),a=0)}for(;a--;)c(o);a=1,o=t[h]}return{c:n.subarray(0,i),n:e}},Bn=function(t,e){for(var n=0,i=0;i<e.length;++i)n+=t[i]*e[i];return n},io=function(t,e,n){var i=n.length,o=vr(e+2);t[o]=i&255,t[o+1]=i>>8,t[o+2]=t[o]^255,t[o+3]=t[o+1]^255;for(var a=0;a<i;++a)t[o+a+4]=n[a];return(o+4+i)*8},eo=function(t,e,n,i,o,a,c,h,p,d,m){Pt(e,m++,n),++o[256];for(var g=Pi(o,15),w=g.t,O=g.l,T=Pi(a,15),L=T.t,j=T.l,F=Qs(w),W=F.c,B=F.n,K=Qs(L),Y=K.c,ce=K.n,fe=new tt(19),ne=0;ne<W.length;++ne)++fe[W[ne]&31];for(var ne=0;ne<Y.length;++ne)++fe[Y[ne]&31];for(var Q=Pi(fe,7),ve=Q.t,he=Q.l,Ae=19;Ae>4&&!ve[dr[Ae-1]];--Ae);var Qe=d+5<<3,Me=Bn(o,Bt)+Bn(a,Fn)+c,De=Bn(o,w)+Bn(a,L)+c+14+3*Ae+Bn(fe,ve)+2*fe[16]+3*fe[17]+7*fe[18];if(p>=0&&Qe<=Me&&Qe<=De)return io(e,m,t.subarray(p,p+d));var be,ye,Ce,Te;if(Pt(e,m,1+(De<Me)),m+=2,De<Me){be=vt(w,O,0),ye=w,Ce=vt(L,j,0),Te=L;var sn=vt(ve,he,0);Pt(e,m,B-257),Pt(e,m+5,ce-1),Pt(e,m+10,Ae-4),m+=14;for(var ne=0;ne<Ae;++ne)Pt(e,m+3*ne,ve[dr[ne]]);m+=3*Ae;for(var qe=[W,Y],ht=0;ht<2;++ht)for(var Ke=qe[ht],ne=0;ne<Ke.length;++ne){var Le=Ke[ne]&31;Pt(e,m,sn[Le]),m+=ve[Le],Le>15&&(Pt(e,m,Ke[ne]>>5&127),m+=Ke[ne]>>12)}}else be=tu,ye=Bt,Ce=ru,Te=Fn;for(var ne=0;ne<h;++ne){var ke=i[ne];if(ke>255){var Le=ke>>18&31;Ln(e,m,be[Le+257]),m+=ye[Le+257],Le>7&&(Pt(e,m,ke>>23&31),m+=qn[Le]);var pt=ke&31;Ln(e,m,Ce[pt]),m+=Te[pt],pt>3&&(Ln(e,m,ke>>5&8191),m+=Kn[pt])}else Ln(e,m,be[ke]),m+=ye[ke]}return Ln(e,m,be[256]),m+ye[256]},ou=new mr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),so=new xe(0),au=function(t,e,n,i,o,a){var c=a.z||t.length,h=new xe(i+c+5*(1+Math.ceil(c/7e3))+o),p=h.subarray(i,h.length-o),d=a.l,m=(a.r||0)&7;if(e){m&&(p[0]=a.r>>3);for(var g=ou[e-1],w=g>>13,O=g&8191,T=(1<<n)-1,L=a.p||new tt(32768),j=a.h||new tt(T+1),F=Math.ceil(n/3),W=2*F,B=function(Vn){return(t[Vn]^t[Vn+1]<<F^t[Vn+2]<<W)&T},K=new mr(25e3),Y=new tt(288),ce=new tt(32),fe=0,ne=0,Q=a.i||0,ve=0,he=a.w||0,Ae=0;Q+2<c;++Q){var Qe=B(Q),Me=Q&32767,De=j[Qe];if(L[Me]=De,j[Qe]=Me,he<=Q){var be=c-Q;if((fe>7e3||ve>24576)&&(be>423||!d)){m=eo(t,p,0,K,Y,ce,ne,ve,Ae,Q-Ae,m),ve=fe=ne=0,Ae=Q;for(var ye=0;ye<286;++ye)Y[ye]=0;for(var ye=0;ye<30;++ye)ce[ye]=0}var Ce=2,Te=0,sn=O,qe=Me-De&32767;if(be>2&&Qe==B(Q-qe))for(var ht=Math.min(w,be)-1,Ke=Math.min(32767,Q),Le=Math.min(258,be);qe<=Ke&&--sn&&Me!=De;){if(t[Q+Ce]==t[Q+Ce-qe]){for(var ke=0;ke<Le&&t[Q+ke]==t[Q+ke-qe];++ke);if(ke>Ce){if(Ce=ke,Te=qe,ke>ht)break;for(var pt=Math.min(qe,ke-2),J=0,ye=0;ye<pt;++ye){var Tt=Q-qe+ye&32767,Nt=L[Tt],de=Tt-Nt&32767;de>J&&(J=de,De=Tt)}}}Me=De,De=L[Me],qe+=Me-De&32767}if(Te){K[ve++]=268435456|Mi[Ce]<<18|Ys[Te];var wt=Mi[Ce]&31,on=Ys[Te]&31;ne+=qn[wt]+Kn[on],++Y[257+wt],++ce[on],he=Q+Ce,++fe}else K[ve++]=t[Q],++Y[t[Q]]}}for(Q=Math.max(Q,he);Q<c;++Q)K[ve++]=t[Q],++Y[t[Q]];m=eo(t,p,d,K,Y,ce,ne,ve,Ae,Q-Ae,m),d||(a.r=m&7|p[m/8|0]<<3,m-=7,a.h=j,a.p=L,a.i=Q,a.w=he)}else{for(var Q=a.w||0;Q<c+d;Q+=65535){var rt=Q+65535;rt>=c&&(p[m/8|0]=d,rt=c),m=io(p,m+1,t.subarray(Q,rt))}a.i=c}return wn(h,0,i+vr(m)+o)},ml=(function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var n=e,i=9;--i;)n=(n&1&&-306674912)^n>>>1;t[e]=n}return t})(),uu=function(){var t=-1;return{p:function(e){for(var n=t,i=0;i<e.length;++i)n=ml[n&255^e[i]]^n>>>8;t=n},d:function(){return~t}}};var oo=function(t,e,n,i,o){if(!o&&(o={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),c=new xe(a.length+t.length);c.set(a),c.set(t,a.length),t=c,o.w=a.length}return au(t,e.level==null?6:e.level,e.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,i,o)},ao=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n},Wa=function(t,e,n){for(var i=t(),o=t.toString(),a=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/\\s+/g,"").split(","),c=0;c<i.length;++c){var h=i[c],p=a[c];if(typeof h=="function"){e+=";"+p+"=";var d=h.toString();if(h.prototype)if(d.indexOf("[native code]")!=-1){var m=d.indexOf(" ",8)+1;e+=d.slice(m,d.indexOf("(",m))}else{e+=d;for(var g in h.prototype)e+=";"+p+".prototype."+g+"="+h.prototype[g].toString()}else e+=d}else n[p]=h}return e},Ai=[],vl=function(t){var e=[];for(var n in t)t[n].buffer&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},gl=function(t,e,n,i){if(!Ai[n]){for(var o="",a={},c=t.length-1,h=0;h<c;++h)o=Wa(t[h],o,a);Ai[n]={c:Wa(t[c],o,a),e:a}}var p=ao({},Ai[n].e);return yl(Ai[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,p,vl(p),i)},bl=function(){return[xe,tt,mr,qn,Kn,dr,ro,eu,nu,iu,yr,su,vt,Ci,mt,Oi,vr,wn,Pe,Ni,zi,Ri,cu]},wl=function(){return[xe,tt,mr,qn,Kn,dr,Mi,Ys,tu,Bt,ru,Fn,yr,ou,so,vt,Pt,Ln,Pi,Di,Qs,Bn,io,eo,vr,wn,au,oo,uo,Ri]};var Ri=function(t){return postMessage(t,[t.buffer])},cu=function(t){return t&&{out:t.size&&new xe(t.size),dictionary:t.dictionary}},lu=function(t,e,n,i,o,a){var c=gl(n,i,o,function(h,p){c.terminate(),a(h,p)});return c.postMessage([t,e],e.consume?[t.buffer]:[]),function(){c.terminate()}};var Mt=function(t,e){return t[e]|t[e+1]<<8},_t=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Js=function(t,e){return _t(t,e)+_t(t,e+4)*4294967296},Fe=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},xl=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:e.level==9?2:0,t[9]=3,e.mtime!=0&&Fe(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var i=0;i<=n.length;++i)t[i+10]=n.charCodeAt(i)}},_l=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Pe(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=(t[10]|t[11]<<8)+2);for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[n++]);return n+(e&2)},El=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},kl=function(t){return 10+(t.filename?t.filename.length+1:0)};var Sl=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Pe(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&Pe(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Il(t,e,n){return n||(n=e,e={}),typeof n!="function"&&Pe(7),lu(t,e,[wl],function(i){return Ri(uo(i.data[0],i.data[1]))},0,n)}function uo(t,e){return oo(t,e||{},0,0)}function Al(t,e,n){return n||(n=e,e={}),typeof n!="function"&&Pe(7),lu(t,e,[bl],function(i){return Ri(zi(i.data[0],cu(i.data[1])))},1,n)}function zi(t,e){return Ni(t,{i:2},e&&e.out,e&&e.dictionary)}function fu(t,e){e||(e={});var n=uu(),i=t.length;n.p(t);var o=oo(t,e,kl(e),8),a=o.length;return xl(o,e),Fe(o,a-8,n.d()),Fe(o,a-4,i),o}function Cl(t,e){var n=_l(t);return n+8>t.length&&Pe(6,"invalid gzip data"),Ni(t.subarray(n,-8),{i:2},e&&e.out||new xe(El(t)),e&&e.dictionary)}function Ol(t,e){return Ni(t.subarray(Sl(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function hu(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Cl(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?zi(t,e):Ol(t,e)}var pu=function(t,e,n,i){for(var o in t){var a=t[o],c=e+o,h=i;Array.isArray(a)&&(h=ao(i,a[1]),a=a[0]),a instanceof xe?n[c]=[a,h]:(n[c+="/"]=[new xe(0),h],pu(a,c,n,i))}},Xa=typeof TextEncoder<"u"&&new TextEncoder,to=typeof TextDecoder<"u"&&new TextDecoder,Pl=0;try{to.decode(so,{stream:!0}),Pl=1}catch{}var Ml=function(t){for(var e="",n=0;;){var i=t[n++],o=(i>127)+(i>223)+(i>239);if(n+o>t.length)return{s:e,r:wn(t,n-1)};o?o==3?(i=((i&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|i>>10,56320|i&1023)):o&1?e+=String.fromCharCode((i&31)<<6|t[n++]&63):e+=String.fromCharCode((i&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(i)}};function gt(t,e){if(e){for(var n=new xe(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n}if(Xa)return Xa.encode(t);for(var o=t.length,a=new xe(t.length+(t.length>>1)),c=0,h=function(m){a[c++]=m},i=0;i<o;++i){if(c+5>a.length){var p=new xe(c+8+(o-i<<1));p.set(a),a=p}var d=t.charCodeAt(i);d<128||e?h(d):d<2048?(h(192|d>>6),h(128|d&63)):d>55295&&d<57344?(d=65536+(d&1047552)|t.charCodeAt(++i)&1023,h(240|d>>18),h(128|d>>12&63),h(128|d>>6&63),h(128|d&63)):(h(224|d>>12),h(128|d>>6&63),h(128|d&63))}return wn(a,0,c)}function Yt(t,e){if(e){for(var n="",i=0;i<t.length;i+=16384)n+=String.fromCharCode.apply(null,t.subarray(i,i+16384));return n}else{if(to)return to.decode(t);var o=Ml(t),a=o.s,n=o.r;return n.length&&Pe(8),a}}var Dl=function(t,e){return e+30+Mt(t,e+26)+Mt(t,e+28)},Tl=function(t,e,n){var i=Mt(t,e+28),o=Yt(t.subarray(e+46,e+46+i),!(Mt(t,e+8)&2048)),a=e+46+i,c=_t(t,e+20),h=n&&c==4294967295?Nl(t,a):[c,_t(t,e+24),_t(t,e+42)],p=h[0],d=h[1],m=h[2];return[Mt(t,e+10),p,d,o,a+Mt(t,e+30)+Mt(t,e+32),m]},Nl=function(t,e){for(;Mt(t,e)!=1;e+=4+Mt(t,e+2));return[Js(t,e+12),Js(t,e+4),Js(t,e+20)]},no=function(t){var e=0;if(t)for(var n in t){var i=t[n].length;i>65535&&Pe(9),e+=i+4}return e},Za=function(t,e,n,i,o,a,c,h){var p=i.length,d=n.extra,m=h&&h.length,g=no(d);Fe(t,e,c!=null?33639248:67324752),e+=4,c!=null&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(a<0&&8),t[e++]=o&&8,t[e++]=n.compression&255,t[e++]=n.compression>>8;var w=new Date(n.mtime==null?Date.now():n.mtime),O=w.getFullYear()-1980;if((O<0||O>119)&&Pe(10),Fe(t,e,O<<25|w.getMonth()+1<<21|w.getDate()<<16|w.getHours()<<11|w.getMinutes()<<5|w.getSeconds()>>1),e+=4,a!=-1&&(Fe(t,e,n.crc),Fe(t,e+4,a<0?-a-2:a),Fe(t,e+8,n.size)),Fe(t,e+12,p),Fe(t,e+14,g),e+=16,c!=null&&(Fe(t,e,m),Fe(t,e+6,n.attrs),Fe(t,e+10,c),e+=14),t.set(i,e),e+=p,g)for(var T in d){var L=d[T],j=L.length;Fe(t,e,+T),Fe(t,e+2,j),t.set(L,e+4),e+=4+j}return m&&(t.set(h,e),e+=m),e},Rl=function(t,e,n,i,o){Fe(t,e,101010256),Fe(t,e+8,n),Fe(t,e+10,n),Fe(t,e+12,i),Fe(t,e+16,o)};function du(t,e,n){n||(n=e,e={}),typeof n!="function"&&Pe(7);var i={};pu(t,"",i,e);var o=Object.keys(i),a=o.length,c=0,h=0,p=a,d=new Array(a),m=[],g=function(){for(var j=0;j<m.length;++j)m[j]()},w=function(j,F){Ti(function(){n(j,F)})};Ti(function(){w=n});var O=function(){var j=new xe(h+22),F=c,W=h-c;h=0;for(var B=0;B<p;++B){var K=d[B];try{var Y=K.c.length;Za(j,h,K,K.f,K.u,Y);var ce=30+K.f.length+no(K.extra),fe=h+ce;j.set(K.c,fe),Za(j,c,K,K.f,K.u,Y,h,K.m),c+=16+ce+(K.m?K.m.length:0),h=fe+Y}catch(ne){return w(ne,null)}}Rl(j,c,d.length,W,F),w(null,j)};a||O();for(var T=function(j){var F=o[j],W=i[F],B=W[0],K=W[1],Y=uu(),ce=B.length;Y.p(B);var fe=gt(F),ne=fe.length,Q=K.comment,ve=Q&&gt(Q),he=ve&&ve.length,Ae=no(K.extra),Qe=K.level==0?0:8,Me=function(De,be){if(De)g(),w(De,null);else{var ye=be.length;d[j]=ao(K,{size:ce,crc:Y.d(),c:be,f:fe,m:ve,u:ne!=F.length||ve&&Q.length!=he,compression:Qe}),c+=30+ne+Ae+ye,h+=76+2*(ne+Ae)+(he||0)+ye,--a||O()}};if(ne>65535&&Me(Pe(11,0,1),null),!Qe)Me(null,B);else if(ce<16e4)try{Me(null,uo(B,K))}catch(De){Me(De,null)}else m.push(Il(B,K,Me))},L=0;L<p;++L)T(L);return g}var Ti=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(t){t()};function ji(t,e,n){n||(n=e,e={}),typeof n!="function"&&Pe(7);var i=[],o=function(){for(var j=0;j<i.length;++j)i[j]()},a={},c=function(j,F){Ti(function(){n(j,F)})};Ti(function(){c=n});for(var h=t.length-22;_t(t,h)!=101010256;--h)if(!h||t.length-h>65558)return c(Pe(13,0,1),null),o;var p=Mt(t,h+8);if(p){var d=p,m=_t(t,h+16),g=m==4294967295||d==65535;if(g){var w=_t(t,h-12);g=_t(t,w)==101075792,g&&(d=p=_t(t,w+32),m=_t(t,w+48))}for(var O=e&&e.filter,T=function(j){var F=Tl(t,m,g),W=F[0],B=F[1],K=F[2],Y=F[3],ce=F[4],fe=F[5],ne=Dl(t,fe);m=ce;var Q=function(he,Ae){he?(o(),c(he,null)):(Ae&&(a[Y]=Ae),--p||c(null,a))};if(!O||O({name:Y,size:B,originalSize:K,compression:W}))if(!W)Q(null,wn(t,ne,ne+B));else if(W==8){var ve=t.subarray(ne,ne+B);if(K<524288||B>.8*K)try{Q(null,zi(ve,{out:new xe(K)}))}catch(he){Q(he,null)}else i.push(Al(ve,{size:K},Q))}else Q(Pe(14,"unknown compression type "+W,1),null);else Q(null,null)},L=0;L<d;++L)T(L)}else c(null,{});return o}pr();jn();Et();var ze=class{static textEncoder=new TextEncoder;static textDecoder=new TextDecoder("utf-8",{fatal:!0});static MAX_COMPRESSION_RATIO=1e3;static MIN_VALID_SIZE=1;static compressContent(e){if(e.length===0)return new ArrayBuffer(0);try{let n=gt(e);if(n.length>we.MAX_CONTENT_SIZE)throw new Je(`Content size ${n.length} exceeds maximum ${we.MAX_CONTENT_SIZE}`,"compressContent","medium");let i=fu(n,{level:we.COMPRESSION_LEVEL,mem:12});if(i.length>n.length*this.MAX_COMPRESSION_RATIO)throw new Je("Suspicious compression ratio detected","compressContent","high");return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)}catch(n){if(n instanceof Je)throw n;let i=n instanceof Error?n.message:"Unknown compression error";throw new Je(`Compression failed: ${i}`,"compressContent","medium")}}static decompressContent(e){if(e.byteLength===0)return"";if(e.byteLength<this.MIN_VALID_SIZE)throw new Je("Invalid compressed data size","decompressContent","low");try{let n=new Uint8Array(e);if(n.length>we.MAX_CONTENT_SIZE*this.MAX_COMPRESSION_RATIO)throw new Je("Suspicious decompression input size","decompressContent","high");let i=hu(n);if(i.length>we.MAX_CONTENT_SIZE)throw new Je(`Decompressed size ${i.length} exceeds maximum ${we.MAX_CONTENT_SIZE}`,"decompressContent","medium");return Yt(i)}catch(n){if(n instanceof Je)throw n;let i=n instanceof Error?n.message:"Unknown decompression error";throw new Je(`Decompression failed: ${i}`,"decompressContent","medium")}}static async decompressLegacy(e){if(e.byteLength===0)return"";try{let i=new Blob([e]).stream().pipeThrough(new DecompressionStream("gzip")),o=await ct.waitFor(new Response(i).arrayBuffer());if(o.byteLength>we.MAX_CONTENT_SIZE)throw new Je("Legacy decompression exceeded size limit","decompressLegacy","medium");return this.textDecoder.decode(o)}catch(n){let i=n instanceof Error?n.message:"Unknown legacy decompression error";throw new Je(`Legacy decompression failed: ${i}`,"decompressLegacy","medium")}}static async decompress(e){if(e.content.byteLength===0)return"";try{return e.storageType?this.decompressContent(e.content):this.decompressLegacy(e.content)}catch{throw new _e(`Failed to decompress edit ${e.editId}`,{noteId:e.noteId,branchName:e.branchName})}}static getUncompressedSize(e){try{return gt(e).length}catch{throw new Je("Failed to calculate content size","getUncompressedSize","low")}}static verifyCompressionIntegrity(e){try{let n=this.compressContent(e);return this.decompressContent(n)===e}catch{return!1}}};function br(t){let[e,n]=t;return[e,n]}function yu(t,e){let n=t,i=e,o=n.length,a=i.length;if(o===0||a===0)return 0;o>a?n=n.substring(o-a):o<a&&(i=i.substring(0,o));let c=Math.min(o,a);if(n===i)return c;let h=0,p=1;for(let d=0;d!==-1;){let m=n.substring(c-p);if(d=i.indexOf(m),d===-1)return h;p+=d,(d===0||n.substring(c-p)===i.substring(0,p))&&(h=p,p++)}return h}function yo(t,e){if(!t||!e||t[0]!==e[0])return 0;let n=0,i=Math.min(t.length,e.length),o=i,a=0;for(;n<o;)t.substring(a,o)===e.substring(a,o)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o}function Vi(t,e){if(!t||!e||t[t.length-1]!==e[e.length-1])return 0;let n=0,i=Math.min(t.length,e.length),o=i,a=0;for(;n<o;)t.substring(t.length-o,t.length-a)===e.substring(e.length-o,e.length-a)?(n=o,a=n):i=o,o=Math.floor((i-n)/2+n);return o}function zl(t){let e=t.charCodeAt(0);return e>=55296&&e<=56319}function po(t){let e=t.charCodeAt(0);return e>=56320&&e<=57343}function jl(t,e,n){let i=t.length,o=e.length,a=Math.ceil((i+o)/2),c=a,h=2*a,p=new Array(h),d=new Array(h);for(let j=0;j<h;j++)p[j]=-1,d[j]=-1;p[c+1]=0,d[c+1]=0;let m=i-o,g=m%2!==0,w=0,O=0,T=0,L=0;for(let j=0;j<a&&!(Date.now()>n);j++){for(let F=-j+w;F<=j-O;F+=2){let W=c+F,B;F===-j||F!==j&&p[W-1]<p[W+1]?B=p[W+1]:B=p[W-1]+1;let K=B-F;for(;B<i&&K<o&&t.charAt(B)===e.charAt(K);)B++,K++;if(p[W]=B,B>i)O+=2;else if(K>o)w+=2;else if(g){let Y=c+m-F;if(Y>=0&&Y<h&&d[Y]!==-1){let ce=i-d[Y];if(B>=ce)return mu(t,e,B,K,n)}}}for(let F=-j+T;F<=j-L;F+=2){let W=c+F,B;F===-j||F!==j&&d[W-1]<d[W+1]?B=d[W+1]:B=d[W-1]+1;let K=B-F;for(;B<i&&K<o&&t.charAt(i-B-1)===e.charAt(o-K-1);)B++,K++;if(d[W]=B,B>i)L+=2;else if(K>o)T+=2;else if(!g){let Y=c+m-F;if(Y>=0&&Y<h&&p[Y]!==-1){let ce=p[Y],fe=c+ce-Y;if(B=i-B,ce>=B)return mu(t,e,ce,fe,n)}}}}return[[Ee,t],[Ie,e]]}function mu(t,e,n,i,o){let a=t.substring(0,n),c=e.substring(0,i),h=t.substring(n),p=e.substring(i),d=_n(a,c,{checkLines:!1,deadline:o}),m=_n(h,p,{checkLines:!1,deadline:o});return d.concat(m)}function Ll(t,e,n=1){if(n<=0)return null;let i=t.length>e.length?t:e,o=t.length>e.length?e:t;if(i.length<4||o.length*2<i.length)return null;let a=vu(i,o,Math.ceil(i.length/4)),c=vu(i,o,Math.ceil(i.length/2)),h;if(a&&c)h=a[4].length>c[4].length?a:c;else{if(!a&&!c)return null;c?a||(h=c):h=a}if(!h)throw new Error("Unable to find a half match.");let p,d,m,g;t.length>e.length?(p=h[0],d=h[1],m=h[2],g=h[3]):(m=h[0],g=h[1],p=h[2],d=h[3]);let w=h[4];return[p,d,m,g,w]}function vu(t,e,n){let i=t.slice(n,n+Math.floor(t.length/4)),o=-1,a="",c,h,p,d;for(;(o=e.indexOf(i,o+1))!==-1;){let m=yo(t.slice(n),e.slice(o)),g=Vi(t.slice(0,n),e.slice(0,o));a.length<g+m&&(a=e.slice(o-g,o)+e.slice(o,o+m),c=t.slice(0,n-g),h=t.slice(n+m),p=e.slice(0,o-g),d=e.slice(o+m))}return a.length*2>=t.length?[c||"",h||"",p||"",d||"",a||""]:null}function Bl(t,e){for(let n=0;n<t.length;n++){let i=t[n][1],o=[];for(let a=0;a<i.length;a++)o[a]=e[i.charCodeAt(a)];t[n][1]=o.join("")}}function Fl(t,e){let n=[],i={};n[0]="";function o(p){let d="",m=0,g=-1,w=n.length;for(;g<p.length-1;){g=p.indexOf(`\n`,m),g===-1&&(g=p.length-1);let O=p.slice(m,g+1);(i.hasOwnProperty?i.hasOwnProperty(O):i[O]!==void 0)?d+=String.fromCharCode(i[O]):(w===a&&(O=p.slice(m),g=p.length),d+=String.fromCharCode(w),i[O]=w,n[w++]=O),m=g+1}return d}let a=4e4,c=o(t);a=65535;let h=o(e);return{chars1:c,chars2:h,lineArray:n}}function ql(t,e,n){let i=t,o=e,a=Fl(i,o);i=a.chars1,o=a.chars2;let c=a.lineArray,h=_n(i,o,{checkLines:!1,deadline:n.deadline});Bl(h,c),h=Wi(h),h.push([se,""]);let p=0,d=0,m=0,g="",w="";for(;p<h.length;){switch(h[p][0]){case Ie:m++,w+=h[p][1];break;case Ee:d++,g+=h[p][1];break;case se:if(d>=1&&m>=1){h.splice(p-d-m,d+m),p=p-d-m;let O=_n(g,w,{checkLines:!1,deadline:n.deadline});for(let T=O.length-1;T>=0;T--)h.splice(p,0,O[T]);p+=O.length}m=0,d=0,g="",w="";break;default:throw new Error("Unknown diff operation.")}p++}return h.pop(),h}function Kl(t,e,n){let i;if(!t)return[[Ie,e]];if(!e)return[[Ee,t]];let o=t.length>e.length?t:e,a=t.length>e.length?e:t,c=o.indexOf(a);if(c!==-1)return i=[[Ie,o.substring(0,c)],[se,a],[Ie,o.substring(c+a.length)]],t.length>e.length&&(i[0][0]=Ee,i[2][0]=Ee),i;if(a.length===1)return[[Ee,t],[Ie,e]];let h=Ll(t,e);if(h){let p=h[0],d=h[1],m=h[2],g=h[3],w=h[4],O=_n(p,m,n),T=_n(d,g,n);return O.concat([[se,w]],T)}return n.checkLines&&t.length>100&&e.length>100?ql(t,e,n):jl(t,e,n.deadline)}var $l=Object.defineProperty,gu=Object.getOwnPropertySymbols,Hl=Object.prototype.hasOwnProperty,Ul=Object.prototype.propertyIsEnumerable,bu=(t,e,n)=>e in t?$l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vl=(t,e)=>{for(var n in e||(e={}))Hl.call(e,n)&&bu(t,n,e[n]);if(gu)for(var n of gu(e))Ul.call(e,n)&&bu(t,n,e[n]);return t},Ee=-1,Ie=1,se=0;function Gi(t,e,n){if(t===null||e===null)throw new Error("Null input. (diff)");let i=_n(t,e,Wl(n||{}));return Zl(i),i}function _n(t,e,n){let i=t,o=e;if(i===o)return i?[[se,i]]:[];let a=yo(i,o),c=i.substring(0,a);i=i.substring(a),o=o.substring(a),a=Vi(i,o);let h=i.substring(i.length-a);i=i.substring(0,i.length-a),o=o.substring(0,o.length-a);let p=Kl(i,o,n);return c&&p.unshift([se,c]),h&&p.push([se,h]),p=Xi(p),p}function Gl(t){let e=1;return typeof t<"u"&&(e=t<=0?Number.MAX_VALUE:t),Date.now()+e*1e3}function Wl(t){return Vl({checkLines:!0,deadline:Gl(t.timeout||1)},t)}function Ki(t,e,n){return n===1?t+e:e+t}function $i(t,e){return e===1?[t.substring(0,t.length-1),t[t.length-1]]:[t.substring(1),t[0]]}function Xl(t,e,n,i){return i===1?t[e][1][t[e][1].length-1]===t[n][1][t[n][1].length-1]:t[e][1][0]===t[n][1][0]}function wu(t,e,n){let i=n===1?-1:1,o=null,a=null,c=e+n;for(;c>=0&&c<t.length&&(o===null||a===null);c+=n){let[d,m]=t[c];if(m.length!==0){if(d===Ie){o===null&&(o=c);continue}else if(d===Ee){a===null&&(a=c);continue}else if(d===se){if(o===null&&a===null){let[g,w]=$i(t[e][1],n);t[e][1]=g,t[c][1]=Ki(t[c][1],w,i);return}break}}}if(o!==null&&a!==null&&Xl(t,o,a,n)){let[d,m]=$i(t[o][1],i),[g]=$i(t[a][1],i);t[o][1]=d,t[a][1]=g,t[e][1]=Ki(t[e][1],m,n);return}let[h,p]=$i(t[e][1],n);t[e][1]=h,o===null?(t.splice(c,0,[Ie,p]),a!==null&&a>=c&&a++):t[o][1]=Ki(t[o][1],p,i),a===null?t.splice(c,0,[Ee,p]):t[a][1]=Ki(t[a][1],p,i)}function Zl(t){for(let e=0;e<t.length;e++){let[n,i]=t[e];if(i.length===0)continue;let o=i[0],a=i[i.length-1];zl(a)&&n===se&&wu(t,e,1),po(o)&&n===se&&wu(t,e,-1)}for(let e=0;e<t.length;e++)t[e][1].length===0&&t.splice(e,1)}function Wi(t){let e=t.map(g=>br(g)),n=!1,i=[],o=0,a=null,c=0,h=0,p=0,d=0,m=0;for(;c<e.length;)e[c][0]===se?(i[o++]=c,h=d,p=m,d=0,m=0,a=e[c][1]):(e[c][0]===Ie?d+=e[c][1].length:m+=e[c][1].length,a&&a.length<=Math.max(h,p)&&a.length<=Math.max(d,m)&&(e.splice(i[o-1],0,[Ee,a]),e[i[o-1]+1][0]=Ie,o--,o--,c=o>0?i[o-1]:-1,h=0,p=0,d=0,m=0,a=null,n=!0)),c++;for(n&&(e=Xi(e)),e=Du(e),c=1;c<e.length;){if(e[c-1][0]===Ee&&e[c][0]===Ie){let g=e[c-1][1],w=e[c][1],O=yu(g,w),T=yu(w,g);O>=T?(O>=g.length/2||O>=w.length/2)&&(e.splice(c,0,[se,w.substring(0,O)]),e[c-1][1]=g.substring(0,g.length-O),e[c+1][1]=w.substring(O),c++):(T>=g.length/2||T>=w.length/2)&&(e.splice(c,0,[se,g.substring(0,T)]),e[c-1][0]=Ie,e[c-1][1]=w.substring(0,w.length-T),e[c+1][0]=Ee,e[c+1][1]=g.substring(T),c++),c++}c++}return e}var xu=/[^a-zA-Z0-9]/,_u=/\\s/,Eu=/[\\r\\n]/,Jl=/\\n\\r?\\n$/,Yl=/^\\r?\\n\\r?\\n/;function Du(t){let e=t.map(o=>br(o));function n(o,a){if(!o||!a)return 6;let c=o.charAt(o.length-1),h=a.charAt(0),p=c.match(xu),d=h.match(xu),m=p&&c.match(_u),g=d&&h.match(_u),w=m&&c.match(Eu),O=g&&h.match(Eu),T=w&&o.match(Jl),L=O&&a.match(Yl);return T||L?5:w||O?4:p&&!m&&g?3:m||g?2:p||d?1:0}let i=1;for(;i<e.length-1;){if(e[i-1][0]===se&&e[i+1][0]===se){let o=e[i-1][1],a=e[i][1],c=e[i+1][1],h=Vi(o,a);if(h){let w=a.substring(a.length-h);o=o.substring(0,o.length-h),a=w+a.substring(0,a.length-h),c=w+c}let p=o,d=a,m=c,g=n(o,a)+n(a,c);for(;a.charAt(0)===c.charAt(0);){o+=a.charAt(0),a=a.substring(1)+c.charAt(0),c=c.substring(1);let w=n(o,a)+n(a,c);w>=g&&(g=w,p=o,d=a,m=c)}e[i-1][1]!==p&&(p?e[i-1][1]=p:(e.splice(i-1,1),i--),e[i][1]=d,m?e[i+1][1]=m:(e.splice(i+1,1),i--))}i++}return e}function Xi(t){let e=t.map(d=>br(d));e.push([se,""]);let n=0,i=0,o=0,a="",c="",h;for(;n<e.length;)switch(e[n][0]){case Ie:o++,c+=e[n][1],n++;break;case Ee:i++,a+=e[n][1],n++;break;case se:i+o>1?(i!==0&&o!==0&&(h=yo(c,a),h!==0&&(n-i-o>0&&e[n-i-o-1][0]===se?e[n-i-o-1][1]+=c.substring(0,h):(e.splice(0,0,[se,c.substring(0,h)]),n++),c=c.substring(h),a=a.substring(h)),h=Vi(c,a),h!==0&&(e[n][1]=c.substring(c.length-h)+e[n][1],c=c.substring(0,c.length-h),a=a.substring(0,a.length-h))),n-=i+o,e.splice(n,i+o),a.length&&(e.splice(n,0,[Ee,a]),n++),c.length&&(e.splice(n,0,[Ie,c]),n++),n++):n!==0&&e[n-1][0]===se?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,o=0,i=0,a="",c="";break;default:throw new Error("Unknown diff operation")}e[e.length-1][1]===""&&e.pop();let p=!1;for(n=1;n<e.length-1;)e[n-1][0]===se&&e[n+1][0]===se&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)===e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),p=!0):e[n][1].substring(0,e[n+1][1].length)===e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),p=!0)),n++;return p&&(e=Xi(e)),e}function Ql(...t){return t.reduce((e,n)=>e+(n?1:0),0)}function ef(t,e=4){let n=t.map(w=>br(w)),i=!1,o=[],a=0,c=null,h=0,p=!1,d=!1,m=!1,g=!1;for(;h<n.length;)n[h][0]===se?(n[h][1].length<e&&(m||g)?(o[a++]=h,p=m,d=g,c=n[h][1]):(a=0,c=null),m=!1,g=!1):(n[h][0]===Ee?g=!0:m=!0,c&&(p&&d&&m&&g||c.length<e/2&&Ql(p,d,m,g)===3)&&(n.splice(o[a-1],0,[Ee,c]),n[o[a-1]+1][0]=Ie,a--,c=null,p&&d?(m=!0,g=!0,a=0):(a--,h=a>0?o[a-1]:-1,m=!1,g=!1),i=!0)),h++;return i&&(n=Xi(n)),n}var tf=Object.defineProperty,ku=Object.getOwnPropertySymbols,nf=Object.prototype.hasOwnProperty,rf=Object.prototype.propertyIsEnumerable,Su=(t,e,n)=>e in t?tf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Iu=(t,e)=>{for(var n in e||(e={}))nf.call(e,n)&&Su(t,n,e[n]);if(ku)for(var n of ku(e))rf.call(e,n)&&Su(t,n,e[n]);return t},sf={threshold:.5,distance:1e3};function of(t){return Iu(Iu({},sf),t)}var af=32;function uf(t,e,n,i={}){if(e.length>af)throw new Error("Pattern too long for this browser.");let o=of(i),a=cf(e);function c(T,L){let j=T/e.length,F=Math.abs(n-L);return o.distance?j+F/o.distance:F?1:j}let h=o.threshold,p=t.indexOf(e,n);p!==-1&&(h=Math.min(c(0,p),h),p=t.lastIndexOf(e,n+e.length),p!==-1&&(h=Math.min(c(0,p),h)));let d=1<<e.length-1;p=-1;let m,g,w=e.length+t.length,O=[];for(let T=0;T<e.length;T++){for(m=0,g=w;m<g;)c(T,n+g)<=h?m=g:w=g,g=Math.floor((w-m)/2+m);w=g;let L=Math.max(1,n-g+1),j=Math.min(n+g,t.length)+e.length,F=new Array(j+2);F[j+1]=(1<<T)-1;for(let W=j;W>=L;W--){let B=a[t.charAt(W-1)];if(T===0?F[W]=(F[W+1]<<1|1)&B:F[W]=(F[W+1]<<1|1)&B|((O[W+1]|O[W])<<1|1)|O[W+1],F[W]&d){let K=c(T,W-1);if(K<=h)if(h=K,p=W-1,p>n)L=Math.max(1,2*n-p);else break}}if(c(T+1,n)>h)break;O=F}return p}function cf(t){let e={};for(let n=0;n<t.length;n++)e[t.charAt(n)]=0;for(let n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e}function lo(t,e,n,i={}){if(t===null||e===null||n===null)throw new Error("Null input. (match())");let o=Math.max(0,Math.min(n,t.length));if(t===e)return 0;if(t.length){if(t.substring(o,o+e.length)===e)return o}else return-1;return uf(t,e,o,i)}function mo(t){let e=[];for(let n=0;n<t.length;n++)t[n][0]!==Ie&&(e[n]=t[n][1]);return e.join("")}function Tu(t){let e=[];for(let n=0;n<t.length;n++)t[n][0]!==Ee&&(e[n]=t[n][1]);return e.join("")}function lf(t){let e=0,n=0,i=0;for(let o=0;o<t.length;o++){let a=t[o][0],c=t[o][1];switch(a){case Ie:n+=c.length;break;case Ee:i+=c.length;break;case se:e+=Math.max(n,i),n=0,i=0;break;default:throw new Error("Unknown diff operation.")}}return e+=Math.max(n,i),e}function Au(t,e){let n=0,i=0,o=0,a=0,c;for(c=0;c<t.length&&(t[c][0]!==Ie&&(n+=t[c][1].length),t[c][0]!==Ee&&(i+=t[c][1].length),!(n>e));c++)o=n,a=i;return t.length!==c&&t[c][0]===Ee?a:a+(e-o)}function tn(t){let e=0;for(let n=0;n<t.length;n++){let i=t.codePointAt(n);if(typeof i>"u")throw new Error("Failed to get codepoint");e+=Nu(i)}return e}function ff(t,e,n={}){let i=0,o=0;function a(h){for(;i<h;){let p=e.codePointAt(o);if(typeof p>"u")return o;i+=Nu(p),p>65535?o+=2:o+=1}if(!n.allowExceedingIndices&&i!==h)throw new Error("Failed to determine byte offset");return o}let c=[];for(let h of t)c.push({diffs:h.diffs.map(p=>br(p)),start1:a(h.start1),start2:a(h.start2),utf8Start1:h.utf8Start1,utf8Start2:h.utf8Start2,length1:h.length1,length2:h.length2,utf8Length1:h.utf8Length1,utf8Length2:h.utf8Length2});return c}function Nu(t){return t<=127?1:t<=2047?2:t<=65535?3:4}var en=32,vo=4;function hf(t,e=vo){let n=e,i="";for(let c=1;c<=n;c++)i+=String.fromCharCode(c);for(let c of t)c.start1+=n,c.start2+=n,c.utf8Start1+=n,c.utf8Start2+=n;let o=t[0],a=o.diffs;if(a.length===0||a[0][0]!==se)a.unshift([se,i]),o.start1-=n,o.start2-=n,o.utf8Start1-=n,o.utf8Start2-=n,o.length1+=n,o.length2+=n,o.utf8Length1+=n,o.utf8Length2+=n;else if(n>a[0][1].length){let c=a[0][1].length,h=n-c;a[0][1]=i.substring(c)+a[0][1],o.start1-=h,o.start2-=h,o.utf8Start1-=h,o.utf8Start2-=h,o.length1+=h,o.length2+=h,o.utf8Length1+=h,o.utf8Length2+=h}if(o=t[t.length-1],a=o.diffs,a.length===0||a[a.length-1][0]!==se)a.push([se,i]),o.length1+=n,o.length2+=n,o.utf8Length1+=n,o.utf8Length2+=n;else if(n>a[a.length-1][1].length){let c=n-a[a.length-1][1].length;a[a.length-1][1]+=i.substring(0,c),o.length1+=c,o.length2+=c,o.utf8Length1+=c,o.utf8Length2+=c}return i}function Ui(t,e){return{diffs:[],start1:t,start2:e,utf8Start1:t,utf8Start2:e,length1:0,length2:0,utf8Length1:0,utf8Length2:0}}function pf(t,e=vo){let n=en;for(let i=0;i<t.length;i++){if(t[i].length1<=n)continue;let o=t[i];t.splice(i--,1);let a=o.start1,c=o.start2,h="";for(;o.diffs.length!==0;){let p=Ui(a-h.length,c-h.length),d=!0;if(h!==""){let w=tn(h);p.length1=h.length,p.utf8Length1=w,p.length2=h.length,p.utf8Length2=w,p.diffs.push([se,h])}for(;o.diffs.length!==0&&p.length1<n-e;){let w=o.diffs[0][0],O=o.diffs[0][1],T=tn(O);if(w===Ie){p.length2+=O.length,p.utf8Length2+=T,c+=O.length;let L=o.diffs.shift();L&&p.diffs.push(L),d=!1}else w===Ee&&p.diffs.length===1&&p.diffs[0][0]===se&&O.length>2*n?(p.length1+=O.length,p.utf8Length1+=T,a+=O.length,d=!1,p.diffs.push([w,O]),o.diffs.shift()):(O=O.substring(0,n-p.length1-e),T=tn(O),p.length1+=O.length,p.utf8Length1+=T,a+=O.length,w===se?(p.length2+=O.length,p.utf8Length2+=T,c+=O.length):d=!1,p.diffs.push([w,O]),O===o.diffs[0][1]?o.diffs.shift():o.diffs[0][1]=o.diffs[0][1].substring(O.length))}h=Tu(p.diffs),h=h.substring(h.length-e);let m=mo(o.diffs).substring(0,e),g=tn(m);m!==""&&(p.length1+=m.length,p.length2+=m.length,p.utf8Length1+=g,p.utf8Length2+=g,p.diffs.length!==0&&p.diffs[p.diffs.length-1][0]===se?p.diffs[p.diffs.length-1][1]+=m:p.diffs.push([se,m])),d||t.splice(++i,0,p)}}}function Zi(t,e,n={}){if(typeof t=="string")throw new Error("Patches must be an array - pass the patch to `parsePatch()` first");let i=e;if(t.length===0)return[i,[]];let o=ff(t,i,{allowExceedingIndices:n.allowExceedingIndices}),a=n.margin||vo,c=n.deleteThreshold||.4,h=hf(o,a);i=h+i+h,pf(o,a);let p=0,d=[];for(let m=0;m<o.length;m++){let g=o[m].start2+p,w=mo(o[m].diffs),O,T=-1;if(w.length>en?(O=lo(i,w.substring(0,en),g),O!==-1&&(T=lo(i,w.substring(w.length-en),g+w.length-en),(T===-1||O>=T)&&(O=-1))):O=lo(i,w,g),O===-1)d[m]=!1,p-=o[m].length2-o[m].length1;else{d[m]=!0,p=O-g;let L;if(T===-1?L=i.substring(O,O+w.length):L=i.substring(O,T+en),w===L)i=i.substring(0,O)+Tu(o[m].diffs)+i.substring(O+w.length);else{let j=Gi(w,L,{checkLines:!1});if(w.length>en&&lf(j)/w.length>c)d[m]=!1;else{j=Du(j);let F=0,W=0;for(let B=0;B<o[m].diffs.length;B++){let K=o[m].diffs[B];K[0]!==se&&(W=Au(j,F)),K[0]===Ie?i=i.substring(0,O+W)+K[1]+i.substring(O+W):K[0]===Ee&&(i=i.substring(0,O+W)+i.substring(O+Au(j,F+K[1].length))),K[0]!==Ee&&(F+=K[1].length)}}}}}return i=i.substring(h.length,i.length-h.length),[i,d]}var df=Object.defineProperty,Cu=Object.getOwnPropertySymbols,yf=Object.prototype.hasOwnProperty,mf=Object.prototype.propertyIsEnumerable,Ou=(t,e,n)=>e in t?df(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pu=(t,e)=>{for(var n in e||(e={}))yf.call(e,n)&&Ou(t,n,e[n]);if(Cu)for(var n of Cu(e))mf.call(e,n)&&Ou(t,n,e[n]);return t},vf={margin:4};function fo(t={}){return Pu(Pu({},vf),t)}function Ru(t,e,n){if(typeof t=="string"&&typeof e=="string"){let i=Gi(t,e,{checkLines:!0});return i.length>2&&(i=Wi(i),i=ef(i)),ho(t,i,fo(n))}if(t&&Array.isArray(t)&&typeof e>"u")return ho(mo(t),t,fo(n));if(typeof t=="string"&&e&&Array.isArray(e))return ho(t,e,fo(n));throw new Error("Unknown call format to make()")}function ho(t,e,n){if(e.length===0)return[];let i=[],o=Ui(0,0),a=0,c=0,h=0,p=0,d=0,m=t,g=t;for(let w=0;w<e.length;w++){let O=e[w],[T,L]=O,j=L.length,F=tn(L);switch(!a&&T!==se&&(o.start1=c,o.start2=h,o.utf8Start1=p,o.utf8Start2=d),T){case Ie:o.diffs[a++]=O,o.length2+=j,o.utf8Length2+=F,g=g.substring(0,h)+L+g.substring(h);break;case Ee:o.length1+=j,o.utf8Length1+=F,o.diffs[a++]=O,g=g.substring(0,h)+g.substring(h+j);break;case se:j<=2*n.margin&&a&&e.length!==w+1?(o.diffs[a++]=O,o.length1+=j,o.length2+=j,o.utf8Length1+=F,o.utf8Length2+=F):j>=2*n.margin&&a&&(Mu(o,m,n),i.push(o),o=Ui(-1,-1),a=0,m=g,c=h,p=d);break;default:throw new Error("Unknown diff type")}T!==Ie&&(c+=j,p+=F),T!==Ee&&(h+=j,d+=F)}return a&&(Mu(o,m,n),i.push(o)),i}function Mu(t,e,n){if(e.length===0)return;let i=e.substring(t.start2,t.start2+t.length1),o=0;for(;e.indexOf(i)!==e.lastIndexOf(i)&&i.length<en-n.margin-n.margin;)o+=n.margin,i=e.substring(t.start2-o,t.start2+t.length1+o);o+=n.margin;let a=t.start2-o;a>=1&&po(e[a])&&a--;let c=e.substring(a,t.start2);c&&t.diffs.unshift([se,c]);let h=c.length,p=tn(c),d=t.start2+t.length1+o;d<e.length&&po(e[d])&&d++;let m=e.substring(t.start2+t.length1,d);m&&t.diffs.push([se,m]);let g=m.length,w=tn(m);t.start1-=h,t.start2-=h,t.utf8Start1-=p,t.utf8Start2-=p,t.length1+=h+g,t.length2+=h+g,t.utf8Length1+=p+w,t.utf8Length2+=p+w}var gf=/^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/;function wr(t){if(!t)return[];let e=[],n=t.split(`\n`),i=0;for(;i<n.length;){let o=n[i].match(gf);if(!o)throw new Error(`Invalid patch string: ${n[i]}`);let a=Ui(Hi(o[1]),Hi(o[3]));for(e.push(a),o[2]===""?(a.start1--,a.utf8Start1--,a.length1=1,a.utf8Length1=1):o[2]==="0"?(a.length1=0,a.utf8Length1=0):(a.start1--,a.utf8Start1--,a.utf8Length1=Hi(o[2]),a.length1=a.utf8Length1),o[4]===""?(a.start2--,a.utf8Start2--,a.length2=1,a.utf8Length2=1):o[4]==="0"?(a.length2=0,a.utf8Length2=0):(a.start2--,a.utf8Start2--,a.utf8Length2=Hi(o[4]),a.length2=a.utf8Length2),i++;i<n.length;){let c=n[i],h=c.charAt(0);if(h==="@")break;if(h===""){i++;continue}let p;try{p=decodeURI(c.slice(1))}catch{throw new Error(`Illegal escape in parse: ${c}`)}let d=tn(p)-p.length;if(h==="-")a.diffs.push([Ee,p]),a.length1-=d;else if(h==="+")a.diffs.push([Ie,p]),a.length2-=d;else if(h===" ")a.diffs.push([se,p]),a.length1-=d,a.length2-=d;else throw new Error(`Invalid patch mode "${h}" in: ${p}`);i++}}return e}function Hi(t){return parseInt(t,10)}function go(t){return t.map(bf).join("")}function bf(t){let{utf8Length1:e,utf8Length2:n,utf8Start1:i,utf8Start2:o,diffs:a}=t,c;e===0?c=`${i},0`:e===1?c=`${i+1}`:c=`${i+1},${e}`;let h;n===0?h=`${o},0`:n===1?h=`${o+1}`:h=`${o+1},${n}`;let p=[`@@ -${c} +${h} @@\n`],d;for(let m=0;m<a.length;m++){switch(a[m][0]){case Ie:d="+";break;case Ee:d="-";break;case se:d=" ";break;default:throw new Error("Unknown patch operation.")}p[m+1]=`${d+encodeURI(a[m][1])}\n`}return p.join("").replace(/%20/g," ")}function zu(t){return t.includes(`\\r\n`)&&!t.startsWith(`\n`)&&!t.match(/[^\\r]\\n/)}function ju(t){return!t.includes(`\\r\n`)&&t.includes(`\n`)}function bo(t){return Array.isArray(t)?t.map(e=>bo(e)):Object.assign(Object.assign({},t),{hunks:t.hunks.map(e=>Object.assign(Object.assign({},e),{lines:e.lines.map((n,i)=>{var o;return n.startsWith("\\\\")||n.endsWith("\\r")||!((o=e.lines[i+1])===null||o===void 0)&&o.startsWith("\\\\")?n:n+"\\r"})}))})}function wo(t){return Array.isArray(t)?t.map(e=>wo(e)):Object.assign(Object.assign({},t),{hunks:t.hunks.map(e=>Object.assign(Object.assign({},e),{lines:e.lines.map(n=>n.endsWith("\\r")?n.substring(0,n.length-1):n)}))})}function Lu(t){return Array.isArray(t)||(t=[t]),!t.some(e=>e.hunks.some(n=>n.lines.some(i=>!i.startsWith("\\\\")&&i.endsWith("\\r"))))}function Bu(t){return Array.isArray(t)||(t=[t]),t.some(e=>e.hunks.some(n=>n.lines.some(i=>i.endsWith("\\r"))))&&t.every(e=>e.hunks.every(n=>n.lines.every((i,o)=>{var a;return i.startsWith("\\\\")||i.endsWith("\\r")||((a=n.lines[o+1])===null||a===void 0?void 0:a.startsWith("\\\\"))})))}function xr(t){let e=t.split(/\\n/),n=[],i=0;function o(){let h={};for(n.push(h);i<e.length;){let p=e[i];if(/^(---|\\+\\+\\+|@@)\\s/.test(p))break;let d=/^(?:Index:|diff(?: -r \\w+)+)\\s+(.+?)\\s*$/.exec(p);d&&(h.index=d[1]),i++}for(a(h),a(h),h.hunks=[];i<e.length;){let p=e[i];if(/^(Index:\\s|diff\\s|---\\s|\\+\\+\\+\\s|===================================================================)/.test(p))break;if(/^@@/.test(p))h.hunks.push(c());else{if(p)throw new Error("Unknown line "+(i+1)+" "+JSON.stringify(p));i++}}}function a(h){let p=/^(---|\\+\\+\\+)\\s+(.*)\\r?$/.exec(e[i]);if(p){let d=p[2].split("	",2),m=(d[1]||"").trim(),g=d[0].replace(/\\\\\\\\/g,"\\\\");/^".*"$/.test(g)&&(g=g.substr(1,g.length-2)),p[1]==="---"?(h.oldFileName=g,h.oldHeader=m):(h.newFileName=g,h.newHeader=m),i++}}function c(){var h;let p=i,d=e[i++],m=d.split(/@@ -(\\d+)(?:,(\\d+))? \\+(\\d+)(?:,(\\d+))? @@/),g={oldStart:+m[1],oldLines:typeof m[2]>"u"?1:+m[2],newStart:+m[3],newLines:typeof m[4]>"u"?1:+m[4],lines:[]};g.oldLines===0&&(g.oldStart+=1),g.newLines===0&&(g.newStart+=1);let w=0,O=0;for(;i<e.length&&(O<g.oldLines||w<g.newLines||!((h=e[i])===null||h===void 0)&&h.startsWith("\\\\"));i++){let T=e[i].length==0&&i!=e.length-1?" ":e[i][0];if(T==="+"||T==="-"||T===" "||T==="\\\\")g.lines.push(e[i]),T==="+"?w++:T==="-"?O++:T===" "&&(w++,O++);else throw new Error(`Hunk at line ${p+1} contained invalid line ${e[i]}`)}if(!w&&g.newLines===1&&(g.newLines=0),!O&&g.oldLines===1&&(g.oldLines=0),w!==g.newLines)throw new Error("Added line count did not match for hunk at line "+(p+1));if(O!==g.oldLines)throw new Error("Removed line count did not match for hunk at line "+(p+1));return g}for(;i<e.length;)o();return n}function Fu(t,e,n){let i=!0,o=!1,a=!1,c=1;return function h(){if(i&&!a){if(o?c++:i=!1,t+c<=n)return t+c;a=!0}if(!o)return a||(i=!0),e<=t-c?t-c++:(o=!0,h())}}function Ji(t,e,n={}){let i;if(typeof e=="string"?i=xr(e):Array.isArray(e)?i=e:i=[e],i.length>1)throw new Error("applyPatch only works with a single input.");return wf(t,i[0],n)}function wf(t,e,n={}){(n.autoConvertLineEndings||n.autoConvertLineEndings==null)&&(zu(t)&&Lu(e)?e=bo(e):ju(t)&&Bu(e)&&(e=wo(e)));let i=t.split(`\n`),o=e.hunks,a=n.compareLine||((T,L,j,F)=>L===F),c=n.fuzzFactor||0,h=0;if(c<0||!Number.isInteger(c))throw new Error("fuzzFactor must be a non-negative integer");if(!o.length)return t;let p="",d=!1,m=!1;for(let T=0;T<o[o.length-1].lines.length;T++){let L=o[o.length-1].lines[T];L[0]=="\\\\"&&(p[0]=="+"?d=!0:p[0]=="-"&&(m=!0)),p=L}if(d){if(m){if(!c&&i[i.length-1]=="")return!1}else if(i[i.length-1]=="")i.pop();else if(!c)return!1}else if(m){if(i[i.length-1]!="")i.push("");else if(!c)return!1}function g(T,L,j,F=0,W=!0,B=[],K=0){let Y=0,ce=!1;for(;F<T.length;F++){let fe=T[F],ne=fe.length>0?fe[0]:" ",Q=fe.length>0?fe.substr(1):fe;if(ne==="-")if(a(L+1,i[L],ne,Q))L++,Y=0;else return!j||i[L]==null?null:(B[K]=i[L],g(T,L+1,j-1,F,!1,B,K+1));if(ne==="+"){if(!W)return null;B[K]=Q,K++,Y=0,ce=!0}if(ne===" ")if(Y++,B[K]=i[L],a(L+1,i[L],ne,Q))K++,W=!0,ce=!1,L++;else return ce||!j?null:i[L]&&(g(T,L+1,j-1,F+1,!1,B,K+1)||g(T,L+1,j-1,F,!1,B,K+1))||g(T,L,j-1,F+1,!1,B,K)}return K-=Y,L-=Y,B.length=K,{patchedLines:B,oldLineLastI:L-1}}let w=[],O=0;for(let T=0;T<o.length;T++){let L=o[T],j,F=i.length-L.oldLines+c,W;for(let B=0;B<=c;B++){W=L.oldStart+O-1;let K=Fu(W,h,F);for(;W!==void 0&&(j=g(L.lines,W,B),!j);W=K());if(j)break}if(!j)return!1;for(let B=h;B<W;B++)w.push(i[B]);for(let B=0;B<j.patchedLines.length;B++){let K=j.patchedLines[B];w.push(K)}h=j.oldLineLastI+1,O=W+1-L.oldStart}for(let T=h;T<i.length;T++)w.push(i[T]);return w.join(`\n`)}Et();var En=class{static MAX_DIFF_SIZE=10*1024*1024;static createDiff(e,n,i){if(e===n)throw new le("Content unchanged","content");let o=gt(e).length,a=gt(n).length;if(o>this.MAX_DIFF_SIZE||a>this.MAX_DIFF_SIZE)throw new le(`Content size exceeds maximum ${this.MAX_DIFF_SIZE}`,"content");try{let c=Ru(e,n);if(c.length===0){if(e===n)return"";throw new _e("Generated patch is empty despite content difference")}let h=go(c);if(!h||h.trim().length===0)throw new _e("Stringified patch is empty");return h}catch(c){if(c instanceof le||c instanceof _e)throw c;let h=c instanceof Error?c.message:"Unknown diff creation error";throw new _e(`Diff creation failed: ${h}`)}}static applyDiff(e,n){if(!n||!n.trim())throw new le("Patch is empty","patch");try{let i=wr(n);if(i.length>0){let o=Zi(i,e);if(o.length===2){let[a,c]=o;if(Array.isArray(c)&&c.every(h=>h===!0))return a}}}catch{}try{let i=Ji(e,n);if(typeof i=="string")return i}catch{}throw new _e("Patch application failed",{reason:"Both @sanity/diff-match-patch and legacy diff strategies failed",baseContentLength:e.length,patchLength:n.length})}static calculateDiffSize(e){return gt(e).length}static validatePatch(e){if(!e||typeof e!="string"||e.trim().length===0)return!1;try{let n=wr(e);if(n&&n.length>0)return!0}catch{}try{let n=xr(e);return n&&n.length>0}catch{return!1}}static canApplyDiff(e,n){try{let i=wr(n);if(i&&i.length>0){let o=Zi(i,e);if(o.length===2){let[a,c]=o;if(Array.isArray(c)&&c.every(h=>h===!0))return!0}}}catch{}try{return typeof Ji(e,n)=="string"}catch{return!1}}static createMinimalDiff(e,n){return this.createDiff(e,n,"minimal")}static createRawDiff(e,n){if(e===n)return[];let i=Gi(e,n);return Wi(i)}static parsePatchString(e){return wr(e)}static stringifyPatches(e){return go(e)}static applyPatchesAdvanced(e,n,i){return Zi(e,n,i)}};it();Et();var kt=class{static MAX_CHAIN_LENGTH=1e3;static cache=new Map;static MAX_CACHE_SIZE=50;static async reconstructFromMap(e,n,i=!0){if(typeof e!="string"||e.trim().length===0)throw new le("targetEditId must be a non-empty string","targetEditId",{value:e,type:typeof e});if(!(n instanceof Map))throw new le("editMap must be a Map instance","editMap",{type:n?.constructor?.name});if(n.size===0)throw new le("editMap cannot be empty","editMap",{size:0});let o=n.get(e);if(!o)throw new le(`Target edit ${e} not found`,"targetEditId",{targetEditId:e,availableIds:Array.from(n.keys()).slice(0,10),totalEdits:n.size});if(o.contentHash){let m=this.cache.get(e);if(m&&m.hash===o.contentHash)return this.cache.delete(e),this.cache.set(e,m),m}let a=this.buildChain(e,n);if(a.length>this.MAX_CHAIN_LENGTH)throw new Bi(`Chain length ${a.length} exceeds maximum ${this.MAX_CHAIN_LENGTH}`,{targetEditId:e,chainLength:a.length,maxLength:this.MAX_CHAIN_LENGTH});let c=await this.applyChain(a),h=await Jt.computeHash(c),p=!0;if(i&&o.contentHash&&o.contentHash.length>0&&(p=h===o.contentHash,!p))throw new Qt(`Content integrity check failed for edit ${e}`,o.contentHash,h,{editId:o.editId,chainLength:a.length});let d=te({content:c,hash:h,verified:p,chainLength:a.length,reconstructionTime:Date.now()});return o.contentHash&&o.contentHash===h&&this.updateCache(e,d),d}static async reconstructBatch(e,n,i=!0){if(!Array.isArray(e))throw new le("editIds must be an array","editIds",{type:typeof e});if(e.length===0)return te([]);if(!(n instanceof Map))throw new le("editMap must be a Map instance","editMap",{type:n?.constructor?.name});let o=[];for(let c of e)n.has(c)||o.push(c);if(o.length>0)throw new le(`Missing edit IDs in batch: ${o.slice(0,5).join(", ")}${o.length>5?"...":""}`,"editIds",{missingIds:o.slice(0,10),totalMissing:o.length});let a=[];for(let c=0;c<e.length;c++){let h=e[c];if(h!==void 0)try{let p=await this.reconstructFromMap(h,n,i);a.push(p)}catch(p){throw new _e(`Failed to reconstruct edit at index ${c}: ${h}`,{index:c,editId:h,successfulReconstructions:a.length,totalInBatch:e.length,originalError:p instanceof Error?p:new Error(String(p))})}}return te(a)}static async validateChain(e,n){let i=[],o=[],a={};try{if((typeof e!="string"||e.trim().length===0)&&i.push("editId must be a non-empty string"),n instanceof Map||i.push("editMap must be a Map instance"),i.length>0)return te({valid:!1,chainLength:0,hasBase:!1,isComplete:!1,errors:i,warnings:o,diagnostics:te(a)});let c=this.buildChain(e,n),h=c.some(d=>d?.storageType==="full"),p=this.isChainComplete(c);a.chainLength=c.length,a.hasBase=h,a.isComplete=p,a.chainEditIds=c.map(d=>d?.editId).filter(Boolean),h||i.push("Chain missing base (full) edit - cannot reconstruct from diffs only"),c.length>this.MAX_CHAIN_LENGTH&&i.push(`Chain length ${c.length} exceeds maximum ${this.MAX_CHAIN_LENGTH}`),p||i.push("Chain is incomplete - missing intermediate edits");for(let d=0;d<c.length;d++){let m=c[d];if(!m){i.push(`Missing edit at chain position ${d}`);continue}m.storageType==="diff"&&!m.previousEditId&&i.push(`Diff edit ${m.editId} missing previousEditId at position ${d}`),m.storageType==="full"&&m.previousEditId&&d!==c.length-1&&o.push(`Full edit ${m.editId} has previousEditId but is not at chain end (anomaly)`),m.contentHash&&m.contentHash.length!==64&&o.push(`Edit ${m.editId} has non-standard hash length: ${m.contentHash.length}`)}if(c.length>100&&o.push(`Long chain detected (${c.length} edits) - reconstruction may be slow`),i.length===0)try{await this.reconstructFromMap(e,n,!1),a.testReconstruction="success"}catch(d){i.push(`Test reconstruction failed: ${d instanceof Error?d.message:"Unknown error"}`),a.testReconstruction="failed",a.reconstructionError=d instanceof Error?d.message:String(d)}return te({valid:i.length===0,chainLength:c.length,hasBase:h,isComplete:p,errors:te(i),warnings:te(o),diagnostics:te(a)})}catch(c){return i.push(c instanceof Error?c.message:"Unknown chain validation error"),a.validationError=c instanceof Error?c.stack:String(c),te({valid:!1,chainLength:0,hasBase:!1,isComplete:!1,errors:te(i),warnings:te(o),diagnostics:te(a)})}}static clearCache(){this.cache.clear()}static updateCache(e,n){if(this.cache.delete(e),this.cache.size>=this.MAX_CACHE_SIZE){let i=this.cache.keys().next().value;i&&this.cache.delete(i)}this.cache.set(e,n)}static buildChain(e,n){let i=[],o=new Set,a=e;for(;a!==void 0;){if(o.has(a))throw new Li(`Circular reference detected at ${a}`,{currentId:a,visited:Array.from(o)});o.add(a);let c=n.get(a);if(!c)throw new Fi(`Missing edit record in chain: ${a}`,{currentId:a,availableIds:Array.from(n.keys()).slice(0,5)});if(i.push(c),c.storageType==="full")break;if(a=c.previousEditId,a===void 0&&c.storageType==="diff")throw new qi(`Broken chain: diff ${c.editId} missing previousEditId`,{editId:c.editId,storageType:c.storageType})}return te(i)}static async applyChain(e){if(e.length===0)throw new $n("Empty chain - no records to apply",{chainLength:0});let n=[...e].reverse(),i=n[0];if(!i)throw new $n("No base record in chain",{chainLength:e.length});if(i.storageType!=="full")throw new _e(\'Base record must be of storageType "full"\',{editId:i.editId,storageType:i.storageType});let o=await ze.decompress(i);for(let a=1;a<n.length;a++){let c=n[a];if(c){if(c.storageType==="full"){o=await ze.decompress(c);continue}if(c.storageType==="diff")try{let h=await ze.decompress(c);if(o=En.applyDiff(o,h),c.contentHash){let p=await Jt.computeHash(o);if(p!==c.contentHash)throw new Qt(`Intermediate integrity check failed at position ${a}`,c.contentHash,p,{editId:c.editId,chainPosition:a})}}catch(h){throw new $n(`Failed to apply diff at position ${a}`,{editId:c.editId,chainPosition:a,chainLength:n.length,originalError:h instanceof Error?h:new Error(String(h))})}}}return o}static async attemptRepair(e,n){if(!n.has(e))return null;let i=n.get(e);if(!i)return null;try{return await this.reconstructFromMap(e,n,!0)}catch{let o=i.previousEditId,a=new Set;for(;o&&!a.has(o);){a.add(o);try{let c=await this.reconstructFromMap(o,n,!0);return te({...c,repairedFrom:o,note:"Repaired from nearest valid edit"})}catch{o=n.get(o)?.previousEditId}}try{let h=this.buildChain(e,n).find(p=>p?.storageType==="full");if(h){let p=await this.reconstructFromMap(h.editId,n,!0);return te({...p,repairedFrom:h.editId,note:"Reconstructed from base only - diffs may be missing"})}}catch{}return null}}static isChainComplete(e){if(e.length===0)return!1;for(let i=0;i<e.length-1;i++){let o=e[i],a=e[i+1];if(o?.storageType==="diff"&&o.previousEditId!==a?.editId)return!1}return e[e.length-1]?.storageType==="full"}};it();function qu(t,e,n){return t<e?n==="asc"?-1:1:t>e?n==="asc"?1:-1:0}function Ku(t,e,n){return t.slice().sort((i,o)=>{let a=n.length;for(let c=0;c<e.length;c++){let h=a>c?n[c]:n[a-1],p=e[c],d=typeof p=="function",m=d?p(i):i[p],g=d?p(o):o[p],w=qu(m,g,h);if(w!==0)return w}return 0})}function xo(t,e){return Ku(t,e,["asc"])}pr();nn();var St=class{static contextCache=new Map;static MAX_CACHE_SIZE=50;static async getPreviousEditContext(e,n,i=!0){return R.execute(async()=>{let o=await R.edits.where("[noteId+branchName+createdAt]").between([e,n,ct.minKey],[e,n,ct.maxKey]).reverse().first(),a=`${e}:${n}`;if(!o)return this.contextCache.delete(a),null;if(i){let O=this.contextCache.get(a);if(O){if(O.editId===o.editId&&O.contentHash===o.contentHash)return this.contextCache.delete(a),this.contextCache.set(a,O),O;this.contextCache.delete(a)}}let c=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray();if(c.length===0)return null;let h=xo(c,[O=>O.createdAt]),p=h[h.length-1];if(!p)return null;let d=new Map(h.map(O=>[O.editId,O])),m=await kt.reconstructFromMap(p.editId,d,!1),g=p.baseEditId;if(p.storageType==="full")g=p.editId;else if(!g)for(let O=h.length-1;O>=0;O--){let T=h[O];if(T&&T.storageType==="full"){g=T.editId;break}}let w=te({editId:p.editId,content:m.content,contentHash:m.hash,baseEditId:g??p.editId,chainLength:p.chainLength,timestamp:p.createdAt});return this.updateCache(a,w),w},"getPreviousEditContext")}static async getEditChain(e,n,i){return R.execute(async()=>{let o=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray(),a=[],c=i,h=new Set;for(;c&&!h.has(c);){h.add(c),a.unshift(c);let p=o.find(d=>d.editId===c);if(!p)break;c=p.previousEditId}return a},"getEditChain")}static async validateChainIntegrity(e,n){return R.execute(async()=>{let i=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray(),o=new Map(i.map(c=>[c.editId,c])),a=new Set;for(let c of i){if(c.storageType==="diff"&&!c.previousEditId||c.previousEditId&&!o.has(c.previousEditId))return!1;let h=c.editId;for(;h&&o.has(h);){if(a.has(h))return!1;a.add(h),h=o.get(h)?.previousEditId}}return!0},"validateChainIntegrity")}static clearCache(e,n){if(e&&n)this.contextCache.delete(`${e}:${n}`);else if(e)for(let i of this.contextCache.keys())i.startsWith(`${e}:`)&&this.contextCache.delete(i);else this.contextCache.clear()}static updateCache(e,n){if(this.contextCache.delete(e),this.contextCache.size>=this.MAX_CACHE_SIZE){let i=this.contextCache.keys().next().value;i&&this.contextCache.delete(i)}this.contextCache.set(e,n)}};it();var It=class{static updateManifestWithEditInfo(e,n,i,o,a,c){return Ue(e,h=>{let p=h.branches[n];if(p){let d=p.versions[i];d&&(d.compressedSize=o,d.uncompressedSize=a,d.contentHash=c)}h.lastModified=new Date().toISOString()})}static updateManifestPath(e,n){return Ue(e,i=>{i.notePath=n,i.lastModified=new Date().toISOString()})}static updateManifestNoteId(e,n,i){return Ue(e,o=>{o.noteId=n,o.notePath=i,o.lastModified=new Date().toISOString()})}static createBranch(e,n,i){return Ue(e,o=>{o.branches[n]||(i&&o.branches[i]?o.branches[n]={versions:{...o.branches[i].versions},totalVersions:o.branches[i].totalVersions,settings:o.branches[i].settings?{...o.branches[i].settings}:void 0,timelineSettings:o.branches[i].timelineSettings?{...o.branches[i].timelineSettings}:void 0}:o.branches[n]={versions:{},totalVersions:0},o.lastModified=new Date().toISOString())})}static setBranchData(e,n,i){return Ue(e,o=>{o.branches||(o.branches={}),o.branches[n]=i,o.lastModified=new Date().toISOString()})}static switchBranch(e,n){return Ue(e,i=>{i.branches[n]&&(i.currentBranch=n,i.lastModified=new Date().toISOString())})}static removeEditFromManifest(e,n,i){return Ue(e,o=>{let a=o.branches[n];a&&(delete a.versions[i],a.totalVersions=Math.max(0,a.totalVersions-1),o.lastModified=new Date().toISOString())})}static addEditToManifest(e,n,i,o){return Ue(e,a=>{let c=a.branches[n];c&&(c.versions[i]=o,c.totalVersions=Object.keys(c.versions).length,a.lastModified=new Date().toISOString())})}static validateManifest(e){if(!e.noteId||!e.notePath||!e.currentBranch||!e.branches||typeof e.branches!="object"||!e.branches[e.currentBranch])return!1;for(let[n,i]of Object.entries(e.branches))if(!i.versions||typeof i.versions!="object"||typeof i.totalVersions!="number"||i.totalVersions<0||i.totalVersions!==Object.keys(i.versions).length)return!1;return!0}static sanitizeManifest(e){return Ue(e,n=>{if(n.branches||(n.branches={}),!n.branches[n.currentBranch]){let i=Object.keys(n.branches)[0];i?n.currentBranch=i:(n.currentBranch="main",n.branches.main={versions:{},totalVersions:0})}for(let[i,o]of Object.entries(n.branches)){o.versions||(o.versions={}),(typeof o.totalVersions!="number"||o.totalVersions<0)&&(o.totalVersions=Object.keys(o.versions).length);for(let[a,c]of Object.entries(o.versions))(!c||typeof c!="object")&&delete o.versions[a]}n.lastModified=new Date().toISOString()})}};it();nn();jn();Et();Si();var Ft=class{static MAX_TRANSACTION_RETRIES=5;static async saveEdit(e,n,i,o,a,c={}){let h=await Jt.computeHash(o),p=ze.getUncompressedSize(o),d=this.calculateMaxChainLength(p);for(let m=0;m<this.MAX_TRANSACTION_RETRIES;m++){if(!c.force){let B=await this.getExistingEdit(e,n,i);if(B)return{size:B.size,contentHash:B.contentHash}}let g=null;try{g=await St.getPreviousEditContext(e,n)}catch(B){console.warn(`[EditStorageService] Failed to retrieve context for ${e}:${n}, forcing full save.`,B)}let{compressedContent:w,storageType:O,baseEditId:T,previousEditId:L,chainLength:j}=await this.determineStorageStrategy(o,p,d,g,i),F=this.createEditRecord({noteId:e,branchName:n,editId:i,content:w,contentHash:h,storageType:O,chainLength:j,uncompressedSize:p,...T!==void 0?{baseEditId:T}:{},...L!==void 0?{previousEditId:L}:{}}),W=It.updateManifestWithEditInfo(a,n,i,w.byteLength,p,h);try{if(await R.execute(async()=>await this.executeSaveTransaction(e,n,i,F,W,g?.editId,c.force),"saveEdit"))return St.clearCache(e,n),{size:w.byteLength,contentHash:h}}catch(B){if(B instanceof xn)console.warn(`[EditStorageService] Concurrency conflict (head moved), retrying... Attempt ${m+1}`);else if(m===this.MAX_TRANSACTION_RETRIES-1)throw B}m<this.MAX_TRANSACTION_RETRIES-1&&await ki(we.RETRY_BASE_DELAY_MS*Math.pow(2,m))}throw new _e("Failed to save edit after maximum retries",{noteId:e,branchName:n,editId:i})}static async getEditContent(e,n,i){return R.execute(async()=>{let o=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray(),a=new Map(o.map(c=>[c.editId,c]));if(!a.has(i))return null;try{let c=await kt.reconstructFromMap(i,a,!0);return ze.textEncoder.encode(c.content).buffer}catch(c){throw new Qt(`Failed to reconstruct edit ${i}`,"",c instanceof Error?c.message:"Unknown error","error")}},"getEditContent")}static async deleteEdit(e,n,i){await R.execute(async()=>{await R.transaction("rw",R.edits,async()=>{let o=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray(),a=new Map(o.map(h=>[h.editId,h])),c=a.get(i);c&&(await this.handleEditDeletion(c,o,a),St.clearCache(e,n))})},"deleteEdit")}static async renameEdit(e,n,i){n!==i&&await R.execute(async()=>{await R.transaction("rw",R.edits,async()=>{if(!await this.checkEditExistsById(e,n))return;if(await this.checkEditExistsById(e,i))throw new le(`Edit ${i} already exists`,"newEditId");await this.renameEditRecords(e,n,i),await this.updateDependentRecords(e,n,i)})},"renameEdit")}static async getExistingEdit(e,n,i){return R.execute(async()=>await R.edits.where("[noteId+branchName+editId]").equals([e,n,i]).first(),"getExistingEdit")}static async checkEditExistsById(e,n){return await R.edits.where({noteId:e,editId:n}).count()>0}static calculateMaxChainLength(e){return e>we.CHAIN_THRESHOLDS.MEDIUM_SIZE_LIMIT?we.CHAIN_THRESHOLDS.LARGE_CHAIN_LENGTH:e>we.CHAIN_THRESHOLDS.SMALL_SIZE_LIMIT?we.CHAIN_THRESHOLDS.MEDIUM_CHAIN_LENGTH:we.CHAIN_THRESHOLDS.SMALL_CHAIN_LENGTH}static async determineStorageStrategy(e,n,i,o,a){let c,h,p,d,m;if(!o)c=ze.compressContent(e),h="full",m=0;else if(o.chainLength>=i)c=ze.compressContent(e),h="full",m=0,d=o.editId;else{let w=En.createDiff(o.content,e,a);En.calculateDiffSize(w)<n*we.DIFF_SIZE_THRESHOLD?(c=ze.compressContent(w),h="diff",p=o.baseEditId,d=o.editId,m=o.chainLength+1):(c=ze.compressContent(e),h="full",m=0,d=o.editId)}return{compressedContent:c,storageType:h,baseEditId:p,previousEditId:d,chainLength:m}}static async executeSaveTransaction(e,n,i,o,a,c,h=!1){let p=!1;return await R.transaction("rw",R.edits,R.manifests,async()=>{let d=await R.edits.where("[noteId+branchName+editId]").equals([e,n,i]).first();if(d){if(!h){p=!0;return}d.id&&(o.id=d.id)}if(!h&&!d){let m=await R.edits.where("[noteId+branchName]").equals([e,n]).last();if(c&&m?.editId!==c)throw new xn("Head moved during save transaction","head_mismatch","edits");if(!c&&m)throw new xn("Head exists but expected none (initialization conflict)","head_mismatch","edits")}await R.edits.put({...o}),await R.manifests.put({noteId:e,manifest:a,updatedAt:Date.now()}),p=!0}),p}static async handleEditDeletion(e,n,i){let o=n.filter(c=>c.previousEditId===e.editId),a=[];for(let c of o){let h=await kt.reconstructFromMap(c.editId,i,!1),p=await Jt.computeHash(h.content),d=ze.compressContent(h.content),m=ze.getUncompressedSize(h.content),g=Ue(c,w=>{w.storageType="full",w.content=d,w.contentHash=p,w.baseEditId=w.editId,w.chainLength=0,w.size=d.byteLength,w.uncompressedSize=m,e.previousEditId!==void 0?w.previousEditId=e.previousEditId:delete w.previousEditId,w.updatedAt=Date.now()});a.push(g),await this.updateDescendants(c,n,a)}a.length>0&&await R.edits.bulkPut(a.map(c=>({...c}))),e.id!==void 0&&await R.edits.delete(e.id)}static async updateDescendants(e,n,i){let o=[e.editId],a=new Set([e.editId]);for(;o.length>0;){let c=o.shift(),h=n.filter(p=>p.previousEditId===c);for(let p of h)if(!a.has(p.editId)){if(p.storageType==="full")continue;a.add(p.editId),o.push(p.editId);let m=i.find(T=>T.editId===p.previousEditId)||n.find(T=>T.editId===p.previousEditId),g=m?m.chainLength+1:1,w=Ue(p,T=>{T.baseEditId=e.editId,T.chainLength=g,T.updatedAt=Date.now()}),O=i.findIndex(T=>T.editId===w.editId);O>=0?i[O]=w:i.push(w)}}}static async renameEditRecords(e,n,i){let o=await R.edits.where("noteId").equals(e).filter(a=>a.editId===n).toArray();for(let a of o)a.id!==void 0&&await R.edits.update(a.id,{editId:i,updatedAt:Date.now()})}static async updateDependentRecords(e,n,i){let o=await R.edits.where("noteId").equals(e).filter(a=>a.baseEditId===n||a.previousEditId===n).toArray();for(let a of o)if(a.id!==void 0){let c={updatedAt:Date.now()};a.baseEditId===n&&(c.baseEditId=i),a.previousEditId===n&&(c.previousEditId=i),Object.keys(c).length>1&&await R.edits.update(a.id,c)}}static createEditRecord(e){let n=e.storageType==="full"?0:e.chainLength;return te({noteId:e.noteId,branchName:e.branchName,editId:e.editId,content:e.content,contentHash:e.contentHash,storageType:e.storageType,chainLength:n,createdAt:Date.now(),updatedAt:Date.now(),size:e.content.byteLength,uncompressedSize:e.uncompressedSize,...e.baseEditId!==void 0&&{baseEditId:e.baseEditId},...e.previousEditId!==void 0&&{previousEditId:e.previousEditId}})}};it();nn();Et();var Ve=class{static MAX_TRANSACTION_ATTEMPTS=3;static async getEditManifest(e){return R.execute(async()=>{let n=await R.manifests.get(e);return n?te(n.manifest):null},"getEditManifest")}static async saveEditManifest(e,n){return R.execute(async()=>{for(let i=0;i<this.MAX_TRANSACTION_ATTEMPTS;i++)try{await R.transaction("rw",R.manifests,async()=>{await R.manifests.put({noteId:e,manifest:n,updatedAt:Date.now()})});return}catch{if(i===this.MAX_TRANSACTION_ATTEMPTS-1)throw new _e("Failed to save manifest after multiple attempts",{noteId:e});await new Promise(a=>setTimeout(a,100*Math.pow(2,i)))}},"saveEditManifest")}static async deleteNoteHistory(e){await R.execute(async()=>{await R.transaction("rw",R.edits,R.manifests,async()=>{await R.edits.where("noteId").equals(e).delete(),await R.manifests.delete(e)})},"deleteNoteHistory"),St.clearCache(e)}static async deleteBranch(e,n){await R.execute(async()=>{await R.transaction("rw",R.edits,R.manifests,async()=>{await R.edits.where("[noteId+branchName]").equals([e,n]).delete();let i=await R.manifests.get(e);if(i){let o=Ue(i.manifest,a=>{if(delete a.branches[n],a.currentBranch===n){let c=Object.keys(a.branches);c.length>0?a.currentBranch=c[0]:a.currentBranch="main"}a.lastModified=new Date().toISOString()});await R.manifests.put({noteId:e,manifest:o,updatedAt:Date.now()})}})},"deleteBranch"),St.clearCache(e,n)}static async renameNote(e,n,i){e!==n&&(await R.execute(async()=>{await R.transaction("rw",R.edits,R.manifests,async()=>{await R.edits.where("noteId").equals(e).count()>0&&await R.edits.where("noteId").equals(e).modify({noteId:n});let a=await R.manifests.get(e);if(a){let c=It.updateManifestNoteId(a.manifest,n,i);await R.manifests.put({noteId:n,manifest:c,updatedAt:Date.now()}),await R.manifests.delete(e)}})},"renameNote"),St.clearCache(e))}static async updateNotePath(e,n){await R.execute(async()=>{await R.transaction("rw",R.manifests,async()=>{let i=await R.manifests.get(e);if(i){let o=It.updateManifestPath(i.manifest,n);await R.manifests.put({noteId:e,manifest:o,updatedAt:Date.now()})}})},"updateNotePath")}static async clearAll(){await R.execute(async()=>{await R.transaction("rw",R.edits,R.manifests,async()=>{await R.edits.clear(),await R.manifests.clear()})},"clearAll"),St.clearCache(),kt.clearCache()}static async getDatabaseCounts(){return R.execute(async()=>{let[e,n]=await Promise.all([R.edits.count(),R.manifests.count()]);return{editCount:e,manifestCount:n}},"getDatabaseCounts")}static async getBranchCounts(e){return R.execute(async()=>{let n=await R.edits.where("noteId").equals(e).toArray(),i={};for(let o of n)i[o.branchName]=(i[o.branchName]||0)+1;return i},"getBranchCounts")}static async validateDatabaseIntegrity(){try{return await R.execute(async()=>{await R.transaction("r",R.edits,R.manifests,async()=>{let e=await R.manifests.toArray();for(let n of e)if(await R.edits.where("noteId").equals(n.noteId).count()===0&&Object.keys(n.manifest.branches).length>0)throw new _e("Orphaned manifest found",{noteId:n.noteId})})},"validateDatabaseIntegrity"),!0}catch{return!1}}};it();nn();Et();var Hn=class{static MAX_ZIP_SIZE=100*1024*1024;static MAX_FILE_COUNT=1e4;static async exportBranchData(e,n){return R.execute(async()=>{let i=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray();if(i.length>this.MAX_FILE_COUNT)throw new le(`Too many edits to export: ${i.length}`,"editCount");let o=[],a={},c=0;for(let g of i){let{content:w,...O}=g;o.push(O);let T=`blobs/${g.editId}.bin`;if(a[T]=[new Uint8Array(w),{level:0}],c+=w.byteLength,c>this.MAX_ZIP_SIZE)throw new le(`Export size exceeds maximum ${this.MAX_ZIP_SIZE} bytes`,"exportSize")}let h=await R.manifests.get(e),p=h?.manifest.branches[n],d=h?.manifest.lastModified||new Date().toISOString(),m=JSON.stringify(o);return a["data.json"]=[gt(m),{level:9}],a["manifest.json"]=[gt(JSON.stringify({noteId:e,branchName:n,editCount:i.length,totalSize:c,version:"1.0",exportedAt:d,branchMetadata:p})),{level:9}],new Promise((g,w)=>{du(a,{level:9},(O,T)=>{O?w(new _e("ZIP creation failed",{originalError:O})):T.length>this.MAX_ZIP_SIZE?w(new le(`Generated ZIP exceeds maximum size: ${T.length} bytes`,"zipSize")):g(T.buffer)})})},"exportBranchData")}static async importBranchData(e,n,i){if(i.byteLength===0)throw new le("Empty ZIP data","zipData");if(i.byteLength>this.MAX_ZIP_SIZE)throw new le(`ZIP size ${i.byteLength} exceeds maximum ${this.MAX_ZIP_SIZE}`,"zipSize");let o=await new Promise((g,w)=>{ji(new Uint8Array(i),(O,T)=>{O?w(new _e("ZIP extraction failed",{originalError:O})):Object.keys(T).length>this.MAX_FILE_COUNT?w(new le("Too many files in ZIP","fileCount")):g(T)})}),a=o["data.json"],c=o["manifest.json"];if(!a)throw new _e("Invalid vctrl file: missing data.json");let h=Yt(a),p=JSON.parse(h);if(p.length>this.MAX_FILE_COUNT)throw new le(`Too many edits in import: ${p.length}`,"editCount");let d=[],m=0;for(let g of p){if(g.noteId!==e||g.branchName!==n)throw new _e("Import data does not match target branch",{expected:{noteId:e,branchName:n},actual:g});let w=o[`blobs/${g.editId}.bin`];if(!w)throw new _e(`Missing blob for edit ${g.editId}`);let O=w;if(m+=O.byteLength,m>this.MAX_ZIP_SIZE)throw new le("Import exceeds maximum size","importSize");let T={...g,storageType:g.storageType||"full",content:O.buffer};T.storageType==="full"&&T.chainLength>0&&(T.chainLength=0),d.push(T)}await R.execute(async()=>{await R.transaction("rw",R.edits,R.manifests,async()=>{await R.edits.where("[noteId+branchName]").equals([e,n]).delete(),d.length>0&&await R.edits.bulkPut(d);let w=(await R.manifests.get(e))?.manifest;w||(w={noteId:e,notePath:"",currentBranch:n,branches:{},createdAt:new Date().toISOString(),lastModified:new Date().toISOString()});let O=null,T=new Date().toISOString();if(c)try{let L=Yt(c),j=JSON.parse(L);j.branchMetadata&&(O=j.branchMetadata),j.exportedAt&&(T=j.exportedAt)}catch(L){console.warn("Failed to parse manifest.json during import",L)}if(!O){let L={};[...d].sort((F,W)=>(F.createdAt||0)-(W.createdAt||0)).forEach((F,W)=>{L[F.editId]={versionNumber:W+1,timestamp:new Date(F.createdAt||Date.now()).toISOString(),size:F.size||0,uncompressedSize:F.uncompressedSize||0,contentHash:F.contentHash||""}}),O={versions:L,totalVersions:d.length}}w=It.setBranchData(w,n,O),w=Ue(w,L=>{L.lastModified=T}),await R.manifests.put({noteId:e,manifest:w,updatedAt:Date.now()})})},"importBranchData")}static async readManifestFromZip(e){return new Promise((n,i)=>{ji(new Uint8Array(e),{filter:o=>o.name==="manifest.json"||o.name==="data.json"},(o,a)=>{if(o){i(new _e("ZIP reading failed",{originalError:o}));return}let c=a["manifest.json"];if(c)try{let p=Yt(c);n(JSON.parse(p));return}catch{}let h=a["data.json"];if(h)try{let p=Yt(h),d=JSON.parse(p);if(Array.isArray(d)&&d.length>0){let m=d.reduce((g,w)=>(w.createdAt||0)>g?w.createdAt||0:g,0);n({noteId:d[0].noteId,branchName:d[0].branchName,editCount:d.length,version:"1.0",exportedAt:new Date(m).toISOString(),generatedFromData:!0});return}else if(Array.isArray(d)&&d.length===0){n({noteId:"unknown",branchName:"unknown",editCount:0,version:"1.0",exportedAt:new Date().toISOString(),generatedFromData:!0});return}}catch{i(new le("Invalid data.json in ZIP","data"));return}i(new _e("No manifest.json or valid data.json found in ZIP"))})})}static async validateZipData(e){try{return await new Promise((n,i)=>{ji(new Uint8Array(e),o=>{o?i(o):n()})}),!0}catch{return!1}}static getZipStats(e){let n=e.byteLength,i=n>0;return{size:n,compressed:i}}};it();nn();Et();var _r=class{static BATCH_SIZE=50;static async verifyEditIntegrity(e,n,i,o={}){return R.execute(async()=>{let a=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray(),c=new Map(a.map(p=>[p.editId,p])),h=c.get(i);if(!h)throw new le(`Edit ${i} not found`,"editId");try{let p=await kt.reconstructFromMap(i,c,!1),d=p.hash,m=h.contentHash||"",g=!1;m===""?g=!1:m.length===64&&(g=d===m);let w=!1;return!g&&o.fix&&(await R.transaction("rw",R.edits,R.manifests,async()=>{let O=await R.edits.get(h.id);if(O){let L={contentHash:d,uncompressedSize:ze.getUncompressedSize(p.content),updatedAt:Date.now()};await R.edits.update(O.id,L)}let T=await R.manifests.get(e);if(T){let L=It.updateManifestWithEditInfo(T.manifest,n,i,h.size,ze.getUncompressedSize(p.content),d);await R.manifests.put({...T,manifest:L,updatedAt:Date.now()})}}),g=!0,w=!0),te({valid:g,expectedHash:m,actualHash:d,editId:i,noteId:e,branchName:n,verifiedAt:new Date().toISOString(),wasHealed:w})}catch(p){return te({valid:!1,expectedHash:h.contentHash||"",actualHash:"",editId:i,noteId:e,branchName:n,verifiedAt:new Date().toISOString(),error:p instanceof Error?p.message:"Unknown error"})}},"verifyEditIntegrity")}static async verifyBranchIntegrity(e,n,i={}){return R.execute(async()=>{let o=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray();if(o.length===0)return te([]);let a=[];for(let c=0;c<o.length;c+=this.BATCH_SIZE){let h=o.slice(c,c+this.BATCH_SIZE);if(i.fix)for(let p of h){let d=await this.verifyEditIntegrity(e,n,p.editId,i);a.push(d)}else{let p=await Promise.all(h.map(d=>this.verifyEditIntegrity(e,n,d.editId,i)));a.push(...p)}}return te(a)},"verifyBranchIntegrity")}static async verifyAllBranches(e,n={}){return R.execute(async()=>{let i=await R.edits.where("noteId").equals(e).toArray(),o=new Set(i.map(c=>c.branchName)),a={};for(let c of o)a[c]=await this.verifyBranchIntegrity(e,c,n);return a},"verifyAllBranches")}static async findCorruptEdits(e,n){return(await this.verifyBranchIntegrity(e,n)).filter(o=>!o.valid).map(o=>o.editId||"")}static async verifyChainConsistency(e,n){return R.execute(async()=>{let i=await R.edits.where("[noteId+branchName]").equals([e,n]).toArray(),o=new Map(i.map(c=>[c.editId,c])),a=new Set;for(let c of i){if(c.storageType==="diff"&&!c.previousEditId||c.previousEditId&&!o.has(c.previousEditId))return!1;let h=c.editId;for(;h&&o.has(h);){if(a.has(h))return!1;a.add(h),h=o.get(h)?.previousEditId}}return!0},"verifyChainConsistency")}static async generateIntegrityReport(e){return R.execute(async()=>{let n=await R.edits.where("noteId").equals(e).toArray(),i=new Set(n.map(c=>c.branchName)),o=[],a=!0;for(let c of i){await this.verifyChainConsistency(e,c)||(a=!1);let p=(await this.verifyBranchIntegrity(e,c)).filter(d=>!d.valid).map(d=>d.editId||"");o.push(...p)}return{noteId:e,branchCount:i.size,editCount:n.length,corruptEdits:o,chainConsistency:a,generatedAt:new Date().toISOString()}},"generateIntegrityReport")}};var So;function Uu(t){return{lang:t?.lang??So?.lang,message:t?.message,abortEarly:t?.abortEarly??So?.abortEarly,abortPipeEarly:t?.abortPipeEarly??So?.abortPipeEarly}}var xf;function _f(t){return xf?.get(t)}var Ef;function kf(t){return Ef?.get(t)}var Sf;function If(t,e){return Sf?.get(t)?.get(e)}function Io(t){let e=typeof t;return e==="string"?`"${t}"`:e==="number"||e==="bigint"||e==="boolean"?`${t}`:e==="object"||e==="function"?(t&&Object.getPrototypeOf(t)?.constructor?.name)??"null":e}function nt(t,e,n,i,o){let a=o&&"input"in o?o.input:n.value,c=o?.expected??t.expects??null,h=o?.received??Io(a),p={kind:t.kind,type:t.type,input:a,expected:c,received:h,message:`Invalid ${e}: ${c?`Expected ${c} but r`:"R"}eceived ${h}`,requirement:t.requirement,path:o?.path,issues:o?.issues,lang:i.lang,abortEarly:i.abortEarly,abortPipeEarly:i.abortPipeEarly},d=t.kind==="schema",m=o?.message??t.message??If(t.reference,p.lang)??(d?kf(p.lang):null)??i.message??_f(p.lang);m!==void 0&&(p.message=typeof m=="function"?m(p):m),d&&(n.typed=!1),n.issues?n.issues.push(p):n.issues=[p]}function Dt(t){return{version:1,vendor:"valibot",validate(e){return t["~run"]({value:e},Uu())}}}function Af(t,e){return Object.hasOwn(t,e)&&e!=="__proto__"&&e!=="prototype"&&e!=="constructor"}function Cf(t,e){let n=[...new Set(t)];return n.length>1?`(${n.join(` ${e} `)})`:n[0]??"never"}var Of=/^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])[T ](?:0\\d|1\\d|2[0-3])(?::[0-5]\\d){2}(?:\\.\\d{1,9})?(?:Z|[+-](?:0\\d|1\\d|2[0-3])(?::?[0-5]\\d)?)$/u;function Ao(t,e){return{kind:"validation",type:"check",reference:Ao,async:!1,expects:null,requirement:t,message:e,"~run"(n,i){return n.typed&&!this.requirement(n.value)&&nt(this,"input",n,i),n}}}function Er(t){return{kind:"validation",type:"iso_timestamp",reference:Er,async:!1,expects:null,requirement:Of,message:t,"~run"(e,n){return e.typed&&!this.requirement.test(e.value)&&nt(this,"timestamp",e,n),e}}}function kn(t,e){return{kind:"validation",type:"max_length",reference:kn,async:!1,expects:`<=${t}`,requirement:t,message:e,"~run"(n,i){return n.typed&&n.value.length>this.requirement&&nt(this,"length",n,i,{received:`${n.value.length}`}),n}}}function bt(t,e){return{kind:"validation",type:"min_value",reference:bt,async:!1,expects:`>=${t instanceof Date?t.toJSON():Io(t)}`,requirement:t,message:e,"~run"(n,i){return n.typed&&!(n.value>=this.requirement)&&nt(this,"value",n,i,{received:n.value instanceof Date?n.value.toJSON():Io(n.value)}),n}}}function Co(t){return{kind:"validation",type:"non_empty",reference:Co,async:!1,expects:"!0",message:t,"~run"(e,n){return e.typed&&e.value.length===0&&nt(this,"length",e,n,{received:"0"}),e}}}function Oo(t,e){return{kind:"validation",type:"regex",reference:Oo,async:!1,expects:`${t}`,requirement:t,message:e,"~run"(n,i){return n.typed&&!this.requirement.test(n.value)&&nt(this,"format",n,i),n}}}function Yi(t){return{kind:"transformation",type:"transform",reference:Yi,async:!1,operation:t,"~run"(e){return e.value=this.operation(e.value),e}}}function Pf(t,e,n){return typeof t.fallback=="function"?t.fallback(e,n):t.fallback}function Vu(t,e,n){return typeof t.default=="function"?t.default(e,n):t.default}function Po(){return{kind:"schema",type:"any",reference:Po,expects:"any",async:!1,get"~standard"(){return Dt(this)},"~run"(t){return t.typed=!0,t}}}function Un(t){return{kind:"schema",type:"boolean",reference:Un,expects:"boolean",async:!1,message:t,get"~standard"(){return Dt(this)},"~run"(e,n){return typeof e.value=="boolean"?e.typed=!0:nt(this,"type",e,n),e}}}function Mo(t,e){return{kind:"schema",type:"instance",reference:Mo,expects:t.name,async:!1,class:t,message:e,get"~standard"(){return Dt(this)},"~run"(n,i){return n.value instanceof this.class?n.typed=!0:nt(this,"type",n,i),n}}}function Ge(t){return{kind:"schema",type:"number",reference:Ge,expects:"number",async:!1,message:t,get"~standard"(){return Dt(this)},"~run"(e,n){return typeof e.value=="number"&&!isNaN(e.value)?e.typed=!0:nt(this,"type",e,n),e}}}function qt(t,e){return{kind:"schema",type:"object",reference:qt,expects:"Object",async:!1,entries:t,message:e,get"~standard"(){return Dt(this)},"~run"(n,i){let o=n.value;if(o&&typeof o=="object"){n.typed=!0,n.value={};for(let a in this.entries){let c=this.entries[a];if(a in o||(c.type==="exact_optional"||c.type==="optional"||c.type==="nullish")&&c.default!==void 0){let h=a in o?o[a]:Vu(c),p=c["~run"]({value:h},i);if(p.issues){let d={type:"object",origin:"value",input:o,key:a,value:h};for(let m of p.issues)m.path?m.path.unshift(d):m.path=[d],n.issues?.push(m);if(n.issues||(n.issues=p.issues),i.abortEarly){n.typed=!1;break}}p.typed||(n.typed=!1),n.value[a]=p.value}else if(c.fallback!==void 0)n.value[a]=Pf(c);else if(c.type!=="exact_optional"&&c.type!=="optional"&&c.type!=="nullish"&&(nt(this,"key",n,i,{input:void 0,expected:`"${a}"`,path:[{type:"object",origin:"key",input:o,key:a,value:o[a]}]}),i.abortEarly))break}}else nt(this,"type",n,i);return n}}}function Ye(t,e){return{kind:"schema",type:"optional",reference:Ye,expects:`(${t.expects} | undefined)`,async:!1,wrapped:t,default:e,get"~standard"(){return Dt(this)},"~run"(n,i){return n.value===void 0&&(this.default!==void 0&&(n.value=Vu(this,n,i)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,i)}}}function kr(t,e,n){return{kind:"schema",type:"record",reference:kr,expects:"Object",async:!1,key:t,value:e,message:n,get"~standard"(){return Dt(this)},"~run"(i,o){let a=i.value;if(a&&typeof a=="object"){i.typed=!0,i.value={};for(let c in a)if(Af(a,c)){let h=a[c],p=this.key["~run"]({value:c},o);if(p.issues){let m={type:"object",origin:"key",input:a,key:c,value:h};for(let g of p.issues)g.path=[m],i.issues?.push(g);if(i.issues||(i.issues=p.issues),o.abortEarly){i.typed=!1;break}}let d=this.value["~run"]({value:h},o);if(d.issues){let m={type:"object",origin:"value",input:a,key:c,value:h};for(let g of d.issues)g.path?g.path.unshift(m):g.path=[m],i.issues?.push(g);if(i.issues||(i.issues=d.issues),o.abortEarly){i.typed=!1;break}}(!p.typed||!d.typed)&&(i.typed=!1),p.typed&&(i.value[p.value]=d.value)}}else nt(this,"type",i,o);return i}}}function lt(t){return{kind:"schema",type:"string",reference:lt,expects:"string",async:!1,message:t,get"~standard"(){return Dt(this)},"~run"(e,n){return typeof e.value=="string"?e.typed=!0:nt(this,"type",e,n),e}}}function Hu(t){let e;if(t)for(let n of t)e?e.push(...n.issues):e=n.issues;return e}function Do(t,e){return{kind:"schema",type:"union",reference:Do,expects:Cf(t.map(n=>n.expects),"|"),async:!1,options:t,message:e,get"~standard"(){return Dt(this)},"~run"(n,i){let o,a,c;for(let h of this.options){let p=h["~run"]({value:n.value},i);if(p.typed)if(p.issues)a?a.push(p):a=[p];else{o=p;break}else c?c.push(p):c=[p]}if(o)return o;if(a){if(a.length===1)return a[0];nt(this,"type",n,i,{issues:Hu(a)}),n.typed=!0}else{if(c?.length===1)return c[0];nt(this,"type",n,i,{issues:Hu(c)})}return n}}}function je(...t){return{...t[0],pipe:t,get"~standard"(){return Dt(this)},"~run"(e,n){for(let i of t)if(i.kind!=="metadata"){if(e.issues&&(i.kind==="schema"||i.kind==="transformation")){e.typed=!1;break}(!e.issues||!n.abortEarly&&!n.abortPipeEarly)&&(e=i["~run"](e,n))}return e}}}function Gu(t,e,n){let i=t["~run"]({value:e},Uu(n));return{typed:i.typed,success:!i.issues,output:i.value,issues:i.issues}}it();Et();jn();var Sr=je(lt("id must be a string"),Co("id cannot be empty"),kn(we.MAX_ID_LENGTH,`id cannot exceed ${we.MAX_ID_LENGTH} characters`),Yi(t=>t.trim())),To=Sr,Xu=Sr,Zu=Sr,Qi=Sr,No=Sr,Ro=je(lt("path must be a string"),kn(4096,"path cannot exceed 4096 characters"),Yi(t=>t.trim().replace(/[\\\\\\/]{2,}/g,"/"))),Mf=je(lt("content must be a string"),kn(we.MAX_CONTENT_SIZE,`content cannot exceed ${we.MAX_CONTENT_SIZE} bytes`)),Df=je(Mo(ArrayBuffer,"content must be an ArrayBuffer"),Ao(t=>t.byteLength<=we.MAX_CONTENT_SIZE,`content cannot exceed ${we.MAX_CONTENT_SIZE} bytes`)),Ju=Do([Mf,Df]),Tf=qt({versionNumber:Ge("versionNumber must be a number"),timestamp:je(lt("timestamp must be a string"),Er("timestamp must be a valid ISO timestamp")),size:je(Ge("size must be a number"),bt(0,"size cannot be negative")),name:Ye(je(lt("name must be a string"),kn(200,"name cannot exceed 200 characters"))),description:Ye(je(lt("description must be a string"),kn(1e3,"description cannot exceed 1000 characters"))),compressedSize:Ye(je(Ge("compressedSize must be a number"),bt(0,"compressedSize cannot be negative"))),uncompressedSize:Ye(je(Ge("uncompressedSize must be a number"),bt(0,"uncompressedSize cannot be negative"))),contentHash:Ye(je(lt("contentHash must be a string"),Oo(/^[a-f0-9]{64}$|^$/,"contentHash must be a 64-character hex string or empty"))),wordCount:Ye(je(Ge("wordCount must be a number"),bt(0,"wordCount cannot be negative"))),wordCountWithMd:Ye(je(Ge("wordCountWithMd must be a number"),bt(0,"wordCountWithMd cannot be negative"))),charCount:Ye(je(Ge("charCount must be a number"),bt(0,"charCount cannot be negative"))),charCountWithMd:Ye(je(Ge("charCountWithMd must be a number"),bt(0,"charCountWithMd cannot be negative"))),lineCount:Ye(je(Ge("lineCount must be a number"),bt(0,"lineCount cannot be negative"))),lineCountWithoutMd:Ye(je(Ge("lineCountWithoutMd must be a number"),bt(0,"lineCountWithoutMd cannot be negative")))}),Nf=qt({showDescription:Un("showDescription must be a boolean"),showName:Un("showName must be a boolean"),showVersionNumber:Un("showVersionNumber must be a boolean"),expandByDefault:Un("expandByDefault must be a boolean")}),Rf=qt({versions:kr(No,Tf,"versions must be a record of edit IDs to version info"),totalVersions:je(Ge("totalVersions must be a number"),bt(0,"totalVersions cannot be negative")),settings:Ye(kr(lt(),Po())),state:Ye(qt({content:lt("content must be a string"),cursor:qt({line:Ge("line must be a number"),ch:Ge("ch must be a number")}),scroll:qt({left:Ge("left must be a number"),top:Ge("top must be a number")})})),timelineSettings:Ye(Nf)}),Yu=qt({noteId:To,notePath:Ro,currentBranch:Qi,branches:kr(Qi,Rf,"branches must be a record of branch names to branch info"),createdAt:je(lt("createdAt must be a string"),Er("createdAt must be a valid ISO timestamp")),lastModified:je(lt("lastModified must be a string"),Er("lastModified must be a valid ISO timestamp"))});function rn(t,e,n){try{let i=Gu(t,e);if(!i.success){let o=i.issues,a=o.map(c=>`${n}: ${c.message} at ${c.path?.map(h=>h.key).join(".")||"root"}`);throw new le(a.join(", "),n,te(o,!0))}return i.output}catch(i){throw i instanceof le?i:new le(`Validation failed for ${n}: ${i instanceof Error?i.message:"Unknown error"}`,n)}}function st(t){return rn(To,t,"noteId")}function Qu(t){return rn(Xu,t,"oldNoteId")}function ec(t){return rn(Zu,t,"newNoteId")}function Kt(t){return rn(Qi,t,"branchName")}function Sn(t,e="editId"){return rn(No,t,e)}function zo(t,e="path"){return rn(Ro,t,e)}function tc(t){return rn(Ju,t,"content")}function jo(t){return rn(Yu,t,"manifest")}function Lo(t,e){if(!(t instanceof ArrayBuffer))throw new le(`${e} must be an ArrayBuffer`,e);if(t.byteLength===0)throw new le(`${e} must not be empty`,e);return t}var zf=3e4,Ir=new Ei(zf);async function ft(t,e,n){let i=n?`${t}:${n}`:t;return Ir.run(i,e)}var nc={async saveEdit(t,e,n,i,o){let a=st(t),c=Kt(e),h=Sn(n),p=tc(i),d=jo(o);return ft(a,async()=>{let m=typeof p=="string"?p:ze.textDecoder.decode(p),g=!1;try{let w=await Ft.getEditContent(a,c,h);if(w!==null){let O=ze.textDecoder.decode(w)}}catch(w){console.warn(`[EditHistoryApi] Failed to check existing edit ${h}, forcing overwrite.`,w),g=!0}return await Ft.saveEdit(a,c,h,m,d,{force:g})},c)},async getEditContent(t,e,n){let i=st(t),o=Kt(e),a=Sn(n);return ft(i,async()=>{let c=await Ft.getEditContent(i,o,a);if(c===null)return null;let h=c.slice(0);return si(h,[h])},o)},async getEditManifest(t){let e=st(t);return ft(e,async()=>{let n=await Ve.getEditManifest(e);return n!==null?te(n,!0):null})},async saveEditManifest(t,e){let n=st(t),i=jo(e);return ft(n,async()=>{let o=await Ve.getEditManifest(n);o&&JSON.stringify(o)===JSON.stringify(i)||await Ve.saveEditManifest(n,i)})},async deleteEdit(t,e,n){let i=st(t),o=Kt(e),a=Sn(n);return ft(i,async()=>{await Ft.getEditContent(i,o,a)!==null&&await Ft.deleteEdit(i,o,a)},o)},async deleteNoteHistory(t){let e=st(t);return ft(e,async()=>{await Ve.getEditManifest(e)!==null&&await Ve.deleteNoteHistory(e)})},async deleteBranch(t,e){let n=st(t),i=Kt(e);return ft(n,async()=>{let o=await Ve.getEditManifest(n);o===null||!o.branches[i]||await Ve.deleteBranch(n,i)},i)},async renameEdit(t,e,n){let i=st(t),o=Sn(e,"oldEditId"),a=Sn(n,"newEditId");if(o!==a)return ft(i,async()=>{let c=await Ve.getEditManifest(i);if(c===null)return;let h=null;for(let[p,d]of Object.entries(c.branches))if(d.versions[o]){h=p;break}h&&await Ft.renameEdit(i,o,a)})},async renameNote(t,e,n){let i=Qu(t),o=ec(e),a=zo(n,"newPath");if(i!==o)return Ir.runMultiple([i,o],async()=>{await Ve.getEditManifest(i)!==null&&await Ve.renameNote(i,o,a)})},async updateNotePath(t,e){let n=st(t),i=zo(e,"newPath");return ft(n,async()=>{let o=await Ve.getEditManifest(n);o===null||o.notePath===i||await Ve.updateNotePath(n,i)})},async getDatabaseStats(){let{editCount:t,manifestCount:e}=await Ve.getDatabaseCounts();return te({editCount:t,manifestCount:e,activeKeys:Ir.activeKeys,queueLength:Ir.queueLength},!0)},async verifyEditIntegrity(t,e,n,i=!1){let o=st(t),a=Kt(e),c=Sn(n),h=typeof i=="boolean"?i:!1;return ft(o,async()=>{let p=await _r.verifyEditIntegrity(o,a,c,{fix:h});return te(p,!0)},a)},async verifyBranchIntegrity(t,e,n=!1){let i=st(t),o=Kt(e),a=typeof n=="boolean"?n:!1;return ft(i,async()=>{let c=await _r.verifyBranchIntegrity(i,o,{fix:a});return te(c,!0)},o)},async exportBranchData(t,e){let n=st(t),i=Kt(e);return ft(n,async()=>{let a=(await Hn.exportBranchData(n,i)).slice(0);return si(a,[a])},i)},async importBranchData(t,e,n){let i=st(t),o=Kt(e),a=Lo(n,"zipData");return ft(i,async()=>{await Hn.importBranchData(i,o,a)},o)},async readManifestFromZip(t){let e=Lo(t,"zipData");return Hn.readManifestFromZip(e)},async clearAll(){await Ir.run("*",async()=>{await Ve.clearAll()})},async healthCheck(){try{let t=await this.getDatabaseStats(),e=[];return t.editCount<0&&e.push("Invalid edit count"),t.manifestCount<0&&e.push("Invalid manifest count"),{healthy:e.length===0,errors:e}}catch(t){return{healthy:!1,errors:[t instanceof Error?t.message:"Unknown error"]}}}};nn();Et();$a();Eo().catch(t=>{console.error("VC: Failed to initialize database in worker:",t)});self.addEventListener("unload",()=>{ko().catch(()=>{})});self.addEventListener("error",t=>{console.error("VC: Uncaught error in worker:",t.error),t.preventDefault()});self.addEventListener("unhandledrejection",t=>{console.error("VC: Unhandled promise rejection in worker:",t.reason),t.preventDefault()});ii(nc);var ld={isAlive:()=>!0,getStats:async()=>{try{let t=(await Promise.resolve().then(()=>(nn(),$u))).db;return{databaseOpen:t.isOpen(),databaseName:t.name,databaseVersion:t.verno}}catch(t){return{databaseOpen:!1,error:t instanceof Error?t.message:"Unknown error"}}}};})();\n/*! Bundled license information:\n\ncomlink/dist/esm/comlink.mjs:\n  (**\n   * @license\n   * Copyright 2019 Google LLC\n   * SPDX-License-Identifier: Apache-2.0\n   *)\n*/\n',workerName:"Edit History Worker",validateOnInit:!1,maxConsecutiveErrors:3,errorResetTime:6e4})}async initializeAsync(){try{await super.initializeAsync()}catch(t){throw this.wrapError(t)}}async execute(t,n={}){try{return await super.execute(t,n)}catch(r){throw this.wrapError(r)}}wrapError(t){if(t instanceof Mx)return t;let n=t instanceof Error?t.message:String(t),r="WORKER_UNAVAILABLE";return t instanceof Vn&&(t.code==="OPERATION_TIMEOUT"?r="OPERATION_TIMEOUT":t.code==="INIT_FAILED"&&(r="WORKER_UNAVAILABLE")),new Mx(n,r,void 0,t)}isAvailable(){return this.isActive()}},Mx=class e extends Error{constructor(n,r,i={},o){super(n);this.code=r;this.metadata=i;this.cause=o;P(this,"timestamp");P(this,"operationId");this.name="EditHistoryWorkerError",this.timestamp=Date.now(),i.id!==void 0&&(this.operationId=i.id),Object.freeze(this)}static isRetryable(n){if(!(n instanceof e))return!1;switch(n.code){case"OPERATION_TIMEOUT":case"DISK_WRITE_FAILED":case"DISK_READ_FAILED":return!0;default:return!1}}};var hc=class e extends Error{constructor(n,r,i={},o){super(n);this.code=r;this.metadata=i;this.cause=o;P(this,"timestamp");P(this,"operationId");this.name="EditHistoryError",this.timestamp=Date.now(),i.id!==void 0&&(this.operationId=i.id),Object.freeze(this)}static isRetryable(n){if(!(n instanceof e))return!1;switch(n.code){case"OPERATION_TIMEOUT":case"DISK_WRITE_FAILED":case"DISK_READ_FAILED":return!0;default:return!1}}};async function Dg(e,t=5,n=100,r=()=>!0){let i,o=1;for(;o<=t;)try{return await e()}catch(s){if(i=s,o===t||!r(s,o))throw s;let a=Math.random()*.3+.85,l=n*Math.pow(2,o-1),c=Math.min(l*a,5e3);await new Promise(u=>setTimeout(u,c)),o++}throw i}var cee=5,uee=100,Rx=class{constructor(t,n){this.persistFn=t;this.debounceMs=n;P(this,"scheduled",new Map);P(this,"inProgress",new Set);P(this,"operationQueue",new bs({concurrency:2}))}schedule(t,n){let r=this.makeKey(t,n),i=this.scheduled.get(r);if(i){let o={...i,sequence:i.sequence+1,timestamp:Date.now()};this.scheduled.set(r,o)}else this.scheduled.set(r,{noteId:t,branchName:n,sequence:1,timestamp:Date.now(),retryCount:0});this.debounceFlush(r)}async flushAll(){let t=Array.from(this.scheduled.values());this.scheduled.clear(),await Promise.allSettled(t.map(n=>this.executeWrite(n)))}async flush(t,n){let r=this.makeKey(t,n),i=this.scheduled.get(r);i&&(this.scheduled.delete(r),await this.executeWrite(i))}cancel(t,n){let r=this.makeKey(t,n);this.scheduled.delete(r)}cancelNote(t){let n=`${t}:`;for(let r of this.scheduled.keys())r.startsWith(n)&&this.scheduled.delete(r)}cancelAll(){this.scheduled.clear(),this.operationQueue.clear()}hasPendingWrites(t,n){return this.scheduled.has(this.makeKey(t,n))}getPendingCount(){return this.scheduled.size+this.inProgress.size}debounceFlush(t){setTimeout(async()=>{let n=this.scheduled.get(t);if(!n)return;Date.now()-n.timestamp>=this.debounceMs&&(this.scheduled.delete(t),await this.executeWrite(n))},this.debounceMs)}async executeWrite(t){let n=this.makeKey(t.noteId,t.branchName);if(this.inProgress.has(n)){this.schedule(t.noteId,t.branchName);return}this.inProgress.add(n);try{await this.operationQueue.add(()=>Dg(()=>this.persistFn(t),cee,uee,hc.isRetryable),{priority:t.retryCount>0?0:1})}finally{this.inProgress.delete(n)}}makeKey(t,n){return`${t}:${n}`}};var fee=5e3,aN=5,qB=100,Nx=class{constructor(t,n,r,i){this.app=t;this.pathService=n;this.workerClient=r;this.plugin=i;P(this,"diskWriter");this.diskWriter=new Rx(this.persistBranchToDiskInternal.bind(this),fee)}async loadBranchFromDisk(t,n){await this.diskWriter.flush(t,n);let r=this.workerClient.ensureWorker(),i=await r.getEditManifest(t),o=0;i&&(o=new Date(i.lastModified).getTime());let s=this.pathService.getBranchPath(t,n);if(!await this.app.vault.adapter.exists(s)){o>0&&await this.shouldPersist(t,n)&&(console.log(`VC: .vctrl missing for ${t}/${n}, exporting from DB.`),this.diskWriter.schedule(t,n));return}let c=(await this.app.vault.adapter.list(s)).files.filter(g=>g.endsWith(".vctrl"));if(c.length===0){o>0&&await this.shouldPersist(t,n)&&this.diskWriter.schedule(t,n);return}let u=[],f=/^(\d+)(?:_(.+))?\.vctrl$/,p=c.length>1;for(let g of c){let b=g.split("/").pop()??"";if(!b)continue;let w=b.match(f),S=0,C=!1;if(p||!w)try{let x=await this.app.vault.adapter.readBinary(g),T=(await r.readManifestFromZip(no(x,[x])))?.exportedAt;T?S=new Date(T).getTime():S=(await this.app.vault.adapter.stat(g))?.mtime||0,C=!0}catch(x){console.warn(`VC: Failed to read metadata from potentially corrupt file: ${g}`,x),S=0,C=!0}else S=parseInt(w[1],10);u.push({path:g,timestamp:S,isLegacyName:C})}u.sort((g,y)=>y.timestamp-g.timestamp);let d=u[0],h=u.slice(1);if(h.length>0){console.log(`VC: Found ${c.length} branch files. Cleaning up ${h.length} obsolete files.`);for(let g of h)try{await this.app.vault.adapter.remove(g.path)}catch(y){console.warn(`VC: Failed to delete obsolete branch file: ${g.path}`,y)}}if(!d)return;let m=d.timestamp,v=m-o;if(v>1e3)try{let g=await Dg(()=>this.app.vault.adapter.readBinary(d.path),aN,qB);await r.importBranchData(t,n,no(g,[g])),console.log(`VC: Imported newer branch data from disk (${m} > ${o})`)}catch(g){console.warn(`VC: Failed to import .vctrl file: ${d.path}`,g)}else v<-1e3&&await this.shouldPersist(t,n)&&(console.log(`VC: DB is newer (${o} > ${m}). Exporting DB.`),this.diskWriter.schedule(t,n))}async persistBranchToDiskInternal(t){let{noteId:n,branchName:r,sequence:i,retryCount:o}=t;if(!this.workerClient.isAvailable())throw new hc("Worker unavailable during persistence","WORKER_UNAVAILABLE");try{let s=this.workerClient.ensureWorker(),a=await s.getEditManifest(n),l=a?new Date(a.lastModified).getTime():Date.now(),c=await s.exportBranchData(n,r);if(c.byteLength===0)return;let u=this.pathService.getBranchPath(n,r);await this.app.vault.adapter.exists(u)||await this.app.vault.adapter.mkdir(u);let p=Math.random().toString(36).substring(2,8),d=`${l}_${p}.vctrl`,h=`${u}/${d}`;await Dg(()=>this.app.vault.adapter.writeBinary(h,c),aN,qB);let m=await this.app.vault.adapter.readBinary(h);if(m.byteLength!==c.byteLength)throw new hc("File size mismatch during integrity check","INTEGRITY_CHECK_FAILED",{noteId:n,branchName:r,expected:c.byteLength,actual:m.byteLength});let g=(await this.app.vault.adapter.list(u)).files.filter(y=>y.endsWith(".vctrl")&&y!==h);for(let y of g)try{await this.app.vault.adapter.remove(y)}catch(b){console.warn(`VC: Failed to cleanup old branch file: ${y}`,b)}}catch(s){throw o<aN-1?(this.diskWriter.schedule(n,r),s):new hc(`Failed to persist branch ${r} to disk for note ${n}`,"DISK_WRITE_FAILED",{noteId:n,branchName:r,sequence:i},s)}}shutdown(){this.diskWriter.cancelAll()}async shouldPersist(t,n){try{let i=await this.workerClient.ensureWorker().getEditManifest(t),o=this.plugin.settings.editHistorySettings;if(!i)return o.enableDiskPersistence??!0;let a=i.branches[n]?.settings;return a?.isGlobal!==!1?o.enableDiskPersistence??!0:a?.enableDiskPersistence??o.enableDiskPersistence??!0}catch(r){return console.error("VC: Error resolving persistence setting",r),!0}}};var Dx=class{static calculate(t){return Eg(t)}};async function pee(e){let n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")}var Ix=class{constructor(t,n,r,i,o){this.plugin=t;this.workerClient=n;this.persistence=r;this.queueService=i;this.deleteOperation=o;P(this,"encoder",new TextEncoder)}async createEdit(t,n,r,i,o){return this.queueService.add(`edit:${t}`,()=>this._createEditInternal(t,n,r,i,o),{priority:50})}async saveEdit(t,n,r,i,o,s=!1){return this.queueService.add(`edit:${t}`,()=>this._saveEditInternal(t,n,r,i,o,s),{priority:50})}async _createEditInternal(t,n,r,i,o){return this.workerClient.execute(async s=>{let a=await s.getEditManifest(t),l=n,c;if(a){if(c=JSON.parse(JSON.stringify(a)),!c.branches[l])throw new Error(`Cannot save edit: Branch "${l}" does not exist.`);c.currentBranch!==l&&(c.currentBranch=l)}else{let T=new Date().toISOString();c={noteId:t,notePath:i,currentBranch:l,branches:{[l]:{versions:{},totalVersions:0}},createdAt:T,lastModified:T}}let u=c.branches[l];if(!u)throw new Error(`Failed to initialize branch ${l}`);let f=await pee(r),p=Object.entries(u.versions);if(p.length>0){p.sort(([,A],[,M])=>M.versionNumber-A.versionNumber);let T=p[0];if(T){let[,A]=T;if(A.contentHash&&A.contentHash===f)return null}}let d=Object.values(u.versions).map(T=>T.versionNumber),m=(d.length>0?Math.max(...d):0)+1,v=`E${m}_${Date.now()}`,g=Dx.calculate(r),y=new Date().toISOString(),b=new Blob([r]).size;u.versions[v]={versionNumber:m,timestamp:y,size:0,uncompressedSize:b,contentHash:f,wordCount:g.wordCount,wordCountWithMd:g.wordCountWithMd,charCount:g.charCount,charCountWithMd:g.charCountWithMd,lineCount:g.lineCount,lineCountWithoutMd:g.lineCountWithoutMd};let w=[];if(Object.values(u.versions).length>o){let T=Object.entries(u.versions).sort(([,M],[,R])=>M.versionNumber-R.versionNumber),A=T.length-o;if(A>0){let M=T.slice(0,A);for(let[R]of M)delete u.versions[R],w.push(R)}}u.totalVersions=Object.keys(u.versions).length,c.lastModified=y;let C=this.encoder.encode(r),x=C.buffer.slice(C.byteOffset,C.byteOffset+C.byteLength),E=await s.saveEdit(t,l,v,no(x,[x]),c);return u.versions[v]&&(u.versions[v].size=E.size,u.versions[v].compressedSize=E.size,u.versions[v].contentHash=E.contentHash),await this.shouldPersist(c,l)&&this.persistence.diskWriter.schedule(t,l),w.length>0&&Promise.all(w.map(T=>this.deleteOperation.deleteEdit(t,l,T).catch(A=>console.error(`Failed to physically delete edit ${T}`,A)))),{entry:{id:v,noteId:t,notePath:i,branchName:l,versionNumber:m,timestamp:y,size:E.size,compressedSize:E.size,uncompressedSize:b,contentHash:E.contentHash,wordCount:g.wordCount,wordCountWithMd:g.wordCountWithMd,charCount:g.charCount,charCountWithMd:g.charCountWithMd,lineCount:g.lineCount,lineCountWithoutMd:g.lineCountWithoutMd},deletedIds:w}},{timeout:1e4,retry:!0})}async _saveEditInternal(t,n,r,i,o,s=!1){return this.workerClient.execute(async a=>{let l=this.encoder.encode(i),c=l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength),u=await a.saveEdit(t,n,r,no(c,[c]),o);return(s||await this.shouldPersist(o,n))&&this.persistence.diskWriter.schedule(t,n),u},{timeout:1e4,retry:!0})}async shouldPersist(t,n){let r=this.plugin.settings.editHistorySettings,o=t.branches[n]?.settings;return o?.isGlobal!==!1?r.enableDiskPersistence??!0:o?.enableDiskPersistence??r.enableDiskPersistence??!0}};var Ox=class{constructor(t,n){this.workerClient=t;this.queueService=n;P(this,"decoder",new TextDecoder("utf-8",{fatal:!0}))}async getEditContent(t,n,r){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async i=>{let o=r;if(o===void 0){let a=await i.getEditManifest(t);if(a===null)return null;for(let[l,c]of Object.entries(a.branches))if(c.versions[n]!==void 0){o=l;break}}if(o===void 0)return null;let s=await i.getEditContent(t,o,n);return s===null?null:this.decoder.decode(s)},{timeout:5e3,retry:!0}),{priority:0})}async getEditManifest(t){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(n=>n.getEditManifest(t),{timeout:5e3,retry:!0}),{priority:0})}async getEditHistory(t){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async n=>{let r=await n.getEditManifest(t);if(r===null)return[];let i=r.currentBranch,o=r.branches[i];if(o===void 0||o.versions===void 0)return[];let s=wg(o.versions,(a,l)=>({id:l,noteId:t,notePath:r.notePath,branchName:i,versionNumber:a.versionNumber,timestamp:a.timestamp,size:a.size,compressedSize:a.compressedSize,uncompressedSize:a.uncompressedSize,contentHash:a.contentHash,...a.name!==void 0&&{name:a.name},...a.description!==void 0&&{description:a.description},wordCount:a.wordCount,wordCountWithMd:a.wordCountWithMd,charCount:a.charCount,charCountWithMd:a.charCountWithMd,lineCount:a.lineCount,lineCountWithoutMd:a.lineCountWithoutMd}));return mr(s,["versionNumber"],["desc"])},{timeout:5e3,retry:!0}),{priority:0})}};Ti();var Px=class{constructor(t,n,r,i){this.plugin=t;this.workerClient=n;this.persistence=r;this.queueService=i}async updateEditMetadata(t,n,r,i){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async o=>{let s=await o.getEditManifest(t);if(!s)throw new Error("Manifest not found");let a=Wt(s,l=>{let u=l.branches[l.currentBranch]?.versions[n];u&&(r!==void 0&&(r?u.name=r:delete u.name),i!==void 0&&(i?u.description=i:delete u.description),l.lastModified=new Date().toISOString())});a!==s&&(await o.saveEditManifest(t,a),await this.shouldPersist(a,a.currentBranch)&&this.persistence.diskWriter.schedule(t,a.currentBranch))},{timeout:5e3,retry:!0}),{priority:0})}async renameEdit(t,n,r){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async i=>{if(n===r)return;await i.renameEdit(t,n,r);let o=await i.getEditManifest(t);if(o!==null){for(let[s,a]of Object.entries(o.branches))if(a.versions[r]!==void 0){await this.shouldPersist(o,s)&&this.persistence.diskWriter.schedule(t,s);break}}},{timeout:1e4,retry:!0}),{priority:0})}async renameNote(t,n,r){return this.queueService.add([`edit:${t}`,`edit:${n}`],()=>this.workerClient.execute(async i=>{if(t===n)return;await i.renameNote(t,n,r);let o=await i.getEditManifest(n);if(o)for(let s of Object.keys(o.branches))await this.shouldPersist(o,s)&&this.persistence.diskWriter.schedule(n,s)},{timeout:3e4,retry:!0}),{priority:100})}async updateNotePath(t,n){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async r=>{await r.updateNotePath(t,n);let i=await r.getEditManifest(t);if(i)for(let o of Object.keys(i.branches))await this.shouldPersist(i,o)&&this.persistence.diskWriter.schedule(t,o)},{timeout:5e3,retry:!0}),{priority:0})}async saveEditManifest(t,n,r=!1){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async i=>{await i.saveEditManifest(t,n),n.currentBranch&&(r||await this.shouldPersist(n,n.currentBranch))&&this.persistence.diskWriter.schedule(t,n.currentBranch)},{timeout:5e3,retry:!0}),{priority:50})}async shouldPersist(t,n){let r=this.plugin.settings.editHistorySettings,o=t.branches[n]?.settings;return o?.isGlobal!==!1?r.enableDiskPersistence??!0:o?.enableDiskPersistence??r.enableDiskPersistence??!0}};Ti();var kx=class{constructor(t,n,r,i,o,s){this.app=t;this.plugin=n;this.pathService=r;this.workerClient=i;this.persistence=o;this.queueService=s}async deleteEditEntry(t,n){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async r=>{let i=await r.getEditManifest(t);if(!i)throw new Error("Manifest not found");let o=i.currentBranch,s=i.branches[o];if(s&&s.versions[n]){let a=Wt(i,l=>{delete l.branches[o].versions[n],l.lastModified=new Date().toISOString()});await r.saveEditManifest(t,a),await r.deleteEdit(t,o,n),await this.shouldPersist(a,o)&&this.persistence.diskWriter.schedule(t,o)}},{timeout:1e4,retry:!0}),{priority:50})}async deleteEdit(t,n,r){return this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async i=>{await i.deleteEdit(t,n,r);let o=await i.getEditManifest(t);o&&await this.shouldPersist(o,n)&&this.persistence.diskWriter.schedule(t,n)},{timeout:1e4,retry:!0}),{priority:50})}async deleteNoteHistory(t){return this.persistence.diskWriter.cancelNote(t),this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async n=>{await n.deleteNoteHistory(t);let i=`${this.pathService.getNoteDbPath(t)}/branches`;await this.app.vault.adapter.exists(i)&&await this.app.vault.adapter.rmdir(i,!0)},{timeout:2e4,retry:!0}),{priority:100})}async deleteBranch(t,n){return this.persistence.diskWriter.cancel(t,n),this.queueService.add(`edit:${t}`,()=>this.workerClient.execute(async r=>{await r.deleteBranch(t,n);let i=this.pathService.getBranchPath(t,n);await this.app.vault.adapter.exists(i)&&await this.app.vault.adapter.rmdir(i,!0)},{timeout:15e3,retry:!0}),{priority:50})}async shouldPersist(t,n){let r=this.plugin.settings.editHistorySettings,o=t.branches[n]?.settings;return o?.isGlobal!==!1?r.enableDiskPersistence??!0:o?.enableDiskPersistence??r.enableDiskPersistence??!0}};var _x=class{constructor(t,n,r,i){this.plugin=n;this.queueService=i;P(this,"workerClient");P(this,"persistence");P(this,"operationQueue");P(this,"createOp");P(this,"readOp");P(this,"updateOp");P(this,"deleteOp");this.workerClient=new Ax,this.persistence=new Nx(t,r,this.workerClient,this.plugin),this.operationQueue=new bs({concurrency:4}),this.readOp=new Ox(this.workerClient,this.queueService),this.deleteOp=new kx(t,this.plugin,r,this.workerClient,this.persistence,this.queueService),this.createOp=new Ix(this.plugin,this.workerClient,this.persistence,this.queueService,this.deleteOp),this.updateOp=new Px(this.plugin,this.workerClient,this.persistence,this.queueService)}initialize(){this.workerClient.initialize()}async terminate(){this.persistence.shutdown(),this.operationQueue.clear(),this.workerClient.terminate()}getStats(){return{pendingWrites:this.persistence.diskWriter.getPendingCount(),queuedOperations:this.operationQueue.pending,activeOperations:this.operationQueue.size}}async flushAllPendingWrites(){await this.operationQueue.add(async()=>{await this.persistence.diskWriter.flushAll()},{priority:0})}async createEdit(t,n,r,i,o){return this.operationQueue.add(()=>this.createOp.createEdit(t,n,r,i,o),{priority:1})}async saveEdit(t,n,r,i,o,s=!1){return this.operationQueue.add(()=>this.createOp.saveEdit(t,n,r,i,o,s),{priority:1})}async getEditContent(t,n,r){return this.operationQueue.add(()=>this.readOp.getEditContent(t,n,r),{priority:2})}async getEditManifest(t){return this.operationQueue.add(()=>this.readOp.getEditManifest(t),{priority:2})}async getEditHistory(t){return this.operationQueue.add(()=>this.readOp.getEditHistory(t),{priority:2})}async saveEditManifest(t,n,r=!1){return this.operationQueue.add(()=>this.updateOp.saveEditManifest(t,n,r),{priority:1})}async deleteEditEntry(t,n){return this.operationQueue.add(()=>this.deleteOp.deleteEditEntry(t,n),{priority:1})}async deleteEdit(t,n,r){return this.operationQueue.add(()=>this.deleteOp.deleteEdit(t,n,r),{priority:1})}async deleteNoteHistory(t){return this.operationQueue.add(()=>this.deleteOp.deleteNoteHistory(t),{priority:0})}async deleteBranch(t,n){return this.operationQueue.add(()=>this.deleteOp.deleteBranch(t,n),{priority:1})}async updateEditMetadata(t,n,r,i){return this.operationQueue.add(()=>this.updateOp.updateEditMetadata(t,n,r,i),{priority:2})}async renameEdit(t,n,r){return this.operationQueue.add(()=>this.updateOp.renameEdit(t,n,r),{priority:2})}async renameNote(t,n,r){return this.operationQueue.add(()=>this.updateOp.renameNote(t,n,r),{priority:0})}async updateNotePath(t,n){return this.operationQueue.add(()=>this.updateOp.updateNotePath(t,n),{priority:2})}async loadBranchFromDisk(t,n){return this.operationQueue.add(()=>this.persistence.loadBranchFromDisk(t,n),{priority:1})}};var Vx=class{constructor(){P(this,"workerManager");this.workerManager=new Ss({workerString:'(()=>{var Zr=Symbol("Comlink.proxy"),lt=Symbol("Comlink.endpoint"),ht=Symbol("Comlink.releaseProxy"),Er=Symbol("Comlink.finalizer"),cr=Symbol("Comlink.thrown"),Rr=r=>typeof r=="object"&&r!==null||typeof r=="function",ct={canHandle:r=>Rr(r)&&r[Zr],serialize(r){let{port1:t,port2:n}=new MessageChannel;return yr(r,t),[n,[n]]},deserialize(r){return r.start(),yt(r)}},vt={canHandle:r=>Rr(r)&&cr in r,serialize({value:r}){let t;return r instanceof Error?t={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:t={isError:!1,value:r},[t,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},Lr=new Map([["proxy",ct],["throw",vt]]);function pt(r,t){for(let n of r)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function yr(r,t=globalThis,n=["*"]){t.addEventListener("message",function e(i){if(!i||!i.data)return;if(!pt(n,i.origin)){console.warn(`Invalid origin \'${i.origin}\' for comlink proxy`);return}let{id:a,type:f,path:l}=Object.assign({path:[]},i.data),c=(i.data.argumentList||[]).map(Q),u;try{let s=l.slice(0,-1).reduce((h,p)=>h[p],r),o=l.reduce((h,p)=>h[p],r);switch(f){case"GET":u=o;break;case"SET":s[l.slice(-1)[0]]=Q(i.data.value),u=!0;break;case"APPLY":u=o.apply(s,c);break;case"CONSTRUCT":{let h=new o(...c);u=zt(h)}break;case"ENDPOINT":{let{port1:h,port2:p}=new MessageChannel;yr(r,p),u=dr(h,[h])}break;case"RELEASE":u=void 0;break;default:return}}catch(s){u={value:s,[cr]:0}}Promise.resolve(u).catch(s=>({value:s,[cr]:0})).then(s=>{let[o,h]=gr(s);t.postMessage(Object.assign(Object.assign({},o),{id:a}),h),f==="RELEASE"&&(t.removeEventListener("message",e),Gr(t),Er in r&&typeof r[Er]=="function"&&r[Er]())}).catch(s=>{let[o,h]=gr({value:new TypeError("Unserializable return value"),[cr]:0});t.postMessage(Object.assign(Object.assign({},o),{id:a}),h)})}),t.start&&t.start()}function gt(r){return r.constructor.name==="MessagePort"}function Gr(r){gt(r)&&r.close()}function yt(r,t){let n=new Map;return r.addEventListener("message",function(i){let{data:a}=i;if(!a||!a.id)return;let f=n.get(a.id);if(f)try{f(a)}finally{n.delete(a.id)}}),Mr(r,n,[],t)}function hr(r){if(r)throw new Error("Proxy has been released and is not useable")}function Hr(r){return nr(r,new Map,{type:"RELEASE"}).then(()=>{Gr(r)})}var vr=new WeakMap,pr="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{let t=(vr.get(r)||0)-1;vr.set(r,t),t===0&&Hr(r)});function mt(r,t){let n=(vr.get(t)||0)+1;vr.set(t,n),pr&&pr.register(r,t,r)}function wt(r){pr&&pr.unregister(r)}function Mr(r,t,n=[],e=function(){}){let i=!1,a=new Proxy(e,{get(f,l){if(hr(i),l===ht)return()=>{wt(a),Hr(r),t.clear(),i=!0};if(l==="then"){if(n.length===0)return{then:()=>a};let c=nr(r,t,{type:"GET",path:n.map(u=>u.toString())}).then(Q);return c.then.bind(c)}return Mr(r,t,[...n,l])},set(f,l,c){hr(i);let[u,s]=gr(c);return nr(r,t,{type:"SET",path:[...n,l].map(o=>o.toString()),value:u},s).then(Q)},apply(f,l,c){hr(i);let u=n[n.length-1];if(u===lt)return nr(r,t,{type:"ENDPOINT"}).then(Q);if(u==="bind")return Mr(r,t,n.slice(0,-1));let[s,o]=br(c);return nr(r,t,{type:"APPLY",path:n.map(h=>h.toString()),argumentList:s},o).then(Q)},construct(f,l){hr(i);let[c,u]=br(l);return nr(r,t,{type:"CONSTRUCT",path:n.map(s=>s.toString()),argumentList:c},u).then(Q)}});return mt(a,r),a}function xt(r){return Array.prototype.concat.apply([],r)}function br(r){let t=r.map(gr);return[t.map(n=>n[0]),xt(t.map(n=>n[1]))]}var Nr=new WeakMap;function dr(r,t){return Nr.set(r,t),r}function zt(r){return Object.assign(r,{[Zr]:!0})}function gr(r){for(let[t,n]of Lr)if(n.canHandle(r)){let[e,i]=n.serialize(r);return[{type:"HANDLER",name:t,value:e},i]}return[{type:"RAW",value:r},Nr.get(r)||[]]}function Q(r){switch(r.type){case"HANDLER":return Lr.get(r.name).deserialize(r.value);case"RAW":return r.value}}function nr(r,t,n,e){return new Promise(i=>{let a=At();t.set(a,i),r.start&&r.start(),r.postMessage(Object.assign({id:a},n),e)})}function At(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var x=Uint8Array,N=Uint16Array,Br=Int32Array,wr=new x([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xr=new x([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ur=new x([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yr=function(r,t){for(var n=new N(31),e=0;e<31;++e)n[e]=t+=1<<r[e-1];for(var i=new Br(n[30]),e=1;e<30;++e)for(var a=n[e];a<n[e+1];++a)i[a]=a-n[e]<<5|e;return{b:n,r:i}},Xr=Yr(wr,2),Jr=Xr.b,Fr=Xr.r;Jr[28]=258,Fr[258]=28;var Kr=Yr(xr,0),Et=Kr.b,qr=Kr.r,Dr=new N(32768);for(y=0;y<32768;++y)Y=(y&43690)>>1|(y&21845)<<1,Y=(Y&52428)>>2|(Y&13107)<<2,Y=(Y&61680)>>4|(Y&3855)<<4,Dr[y]=((Y&65280)>>8|(Y&255)<<8)>>1;var Y,y,V=(function(r,t,n){for(var e=r.length,i=0,a=new N(t);i<e;++i)r[i]&&++a[r[i]-1];var f=new N(t);for(i=1;i<t;++i)f[i]=f[i-1]+a[i-1]<<1;var l;if(n){l=new N(1<<t);var c=15-t;for(i=0;i<e;++i)if(r[i])for(var u=i<<4|r[i],s=t-r[i],o=f[r[i]-1]++<<s,h=o|(1<<s)-1;o<=h;++o)l[Dr[o]>>c]=u}else for(l=new N(e),i=0;i<e;++i)r[i]&&(l[i]=Dr[f[r[i]-1]++]>>15-r[i]);return l}),K=new x(288);for(y=0;y<144;++y)K[y]=8;var y;for(y=144;y<256;++y)K[y]=9;var y;for(y=256;y<280;++y)K[y]=7;var y;for(y=280;y<288;++y)K[y]=8;var y,fr=new x(32);for(y=0;y<32;++y)fr[y]=5;var y,Mt=V(K,9,0),dt=V(K,9,1),St=V(fr,5,0),Tt=V(fr,5,1),Sr=function(r){for(var t=r[0],n=1;n<r.length;++n)r[n]>t&&(t=r[n]);return t},W=function(r,t,n){var e=t/8|0;return(r[e]|r[e+1]<<8)>>(t&7)&n},Tr=function(r,t){var n=t/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(t&7)},kr=function(r){return(r+7)/8|0},zr=function(r,t,n){return(t==null||t<0)&&(t=0),(n==null||n>r.length)&&(n=r.length),new x(r.subarray(t,n))};var Ct=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(r,t,n){var e=new Error(t||Ct[r]);if(e.code=r,Error.captureStackTrace&&Error.captureStackTrace(e,k),!n)throw e;return e},Ut=function(r,t,n,e){var i=r.length,a=e?e.length:0;if(!i||t.f&&!t.l)return n||new x(0);var f=!n,l=f||t.i!=2,c=t.i;f&&(n=new x(i*3));var u=function(ir){var ar=n.length;if(ir>ar){var tr=new x(Math.max(ar*2,ir));tr.set(n),n=tr}},s=t.f||0,o=t.p||0,h=t.b||0,p=t.l,w=t.d,m=t.m,S=t.n,b=i*8;do{if(!p){s=W(r,o,1);var O=W(r,o+1,3);if(o+=3,O)if(O==1)p=dt,w=Tt,m=9,S=5;else if(O==2){var F=W(r,o,31)+257,d=W(r,o+10,15)+4,g=F+W(r,o+5,31)+1;o+=14;for(var v=new x(g),D=new x(19),C=0;C<d;++C)D[Ur[C]]=W(r,o+C*3,7);o+=d*3;for(var B=Sr(D),J=(1<<B)-1,L=V(D,B,1),C=0;C<g;){var Z=L[W(r,o,J)];o+=Z&15;var E=Z>>4;if(E<16)v[C++]=E;else{var I=0,z=0;for(E==16?(z=3+W(r,o,3),o+=2,I=v[C-1]):E==17?(z=3+W(r,o,7),o+=3):E==18&&(z=11+W(r,o,127),o+=7);z--;)v[C++]=I}}var R=v.subarray(0,F),P=v.subarray(F);m=Sr(R),S=Sr(P),p=V(R,m,1),w=V(P,S,1)}else k(1);else{var E=kr(o)+4,M=r[E-4]|r[E-3]<<8,U=E+M;if(U>i){c&&k(0);break}l&&u(h+M),n.set(r.subarray(E,U),h),t.b=h+=M,t.p=o=U*8,t.f=s;continue}if(o>b){c&&k(0);break}}l&&u(h+131072);for(var er=(1<<m)-1,q=(1<<S)-1,j=o;;j=o){var I=p[Tr(r,o)&er],G=I>>4;if(o+=I&15,o>b){c&&k(0);break}if(I||k(2),G<256)n[h++]=G;else if(G==256){j=o,p=null;break}else{var H=G-254;if(G>264){var C=G-257,A=wr[C];H=W(r,o,(1<<A)-1)+Jr[C],o+=A}var $=w[Tr(r,o)&q],_=$>>4;$||k(3),o+=$&15;var P=Et[_];if(_>3){var A=xr[_];P+=Tr(r,o)&(1<<A)-1,o+=A}if(o>b){c&&k(0);break}l&&u(h+131072);var rr=h+H;if(h<P){var ur=a-P,lr=Math.min(P,rr);for(ur+h<0&&k(3);h<lr;++h)n[h]=e[ur+h]}for(;h<rr;++h)n[h]=n[h-P]}}t.l=p,t.p=j,t.b=h,t.f=s,p&&(s=1,t.m=m,t.d=w,t.n=S)}while(!s);return h!=n.length&&f?zr(n,0,h):n.subarray(0,h)},X=function(r,t,n){n<<=t&7;var e=t/8|0;r[e]|=n,r[e+1]|=n>>8},or=function(r,t,n){n<<=t&7;var e=t/8|0;r[e]|=n,r[e+1]|=n>>8,r[e+2]|=n>>16},Cr=function(r,t){for(var n=[],e=0;e<r.length;++e)r[e]&&n.push({s:e,f:r[e]});var i=n.length,a=n.slice();if(!i)return{t:_r,l:0};if(i==1){var f=new x(n[0].s+1);return f[n[0].s]=1,{t:f,l:1}}n.sort(function(U,F){return U.f-F.f}),n.push({s:-1,f:25001});var l=n[0],c=n[1],u=0,s=1,o=2;for(n[0]={s:-1,f:l.f+c.f,l,r:c};s!=i-1;)l=n[n[u].f<n[o].f?u++:o++],c=n[u!=s&&n[u].f<n[o].f?u++:o++],n[s++]={s:-1,f:l.f+c.f,l,r:c};for(var h=a[0].s,e=1;e<i;++e)a[e].s>h&&(h=a[e].s);var p=new N(h+1),w=Ir(n[s-1],p,0);if(w>t){var e=0,m=0,S=w-t,b=1<<S;for(a.sort(function(F,d){return p[d.s]-p[F.s]||F.f-d.f});e<i;++e){var O=a[e].s;if(p[O]>t)m+=b-(1<<w-p[O]),p[O]=t;else break}for(m>>=S;m>0;){var E=a[e].s;p[E]<t?m-=1<<t-p[E]++-1:++e}for(;e>=0&&m;--e){var M=a[e].s;p[M]==t&&(--p[M],++m)}w=t}return{t:new x(p),l:w}},Ir=function(r,t,n){return r.s==-1?Math.max(Ir(r.l,t,n+1),Ir(r.r,t,n+1)):t[r.s]=n},Wr=function(r){for(var t=r.length;t&&!r[--t];);for(var n=new N(++t),e=0,i=r[0],a=1,f=function(c){n[e++]=c},l=1;l<=t;++l)if(r[l]==i&&l!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)f(32754);a>2&&(f(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(f(i),--a;a>6;a-=6)f(8304);a>2&&(f(a-3<<5|8208),a=0)}for(;a--;)f(i);a=1,i=r[l]}return{c:n.subarray(0,e),n:t}},sr=function(r,t){for(var n=0,e=0;e<t.length;++e)n+=r[e]*t[e];return n},Qr=function(r,t,n){var e=n.length,i=kr(t+2);r[i]=e&255,r[i+1]=e>>8,r[i+2]=r[i]^255,r[i+3]=r[i+1]^255;for(var a=0;a<e;++a)r[i+a+4]=n[a];return(i+4+e)*8},$r=function(r,t,n,e,i,a,f,l,c,u,s){X(t,s++,n),++i[256];for(var o=Cr(i,15),h=o.t,p=o.l,w=Cr(a,15),m=w.t,S=w.l,b=Wr(h),O=b.c,E=b.n,M=Wr(m),U=M.c,F=M.n,d=new N(19),g=0;g<O.length;++g)++d[O[g]&31];for(var g=0;g<U.length;++g)++d[U[g]&31];for(var v=Cr(d,7),D=v.t,C=v.l,B=19;B>4&&!D[Ur[B-1]];--B);var J=u+5<<3,L=sr(i,K)+sr(a,fr)+f,Z=sr(i,h)+sr(a,m)+f+14+3*B+sr(d,D)+2*d[16]+3*d[17]+7*d[18];if(c>=0&&J<=L&&J<=Z)return Qr(t,s,r.subarray(c,c+u));var I,z,R,P;if(X(t,s,1+(Z<L)),s+=2,Z<L){I=V(h,p,0),z=h,R=V(m,S,0),P=m;var er=V(D,C,0);X(t,s,E-257),X(t,s+5,F-1),X(t,s+10,B-4),s+=14;for(var g=0;g<B;++g)X(t,s+3*g,D[Ur[g]]);s+=3*B;for(var q=[O,U],j=0;j<2;++j)for(var G=q[j],g=0;g<G.length;++g){var H=G[g]&31;X(t,s,er[H]),s+=D[H],H>15&&(X(t,s,G[g]>>5&127),s+=G[g]>>12)}}else I=Mt,z=K,R=St,P=fr;for(var g=0;g<l;++g){var A=e[g];if(A>255){var H=A>>18&31;or(t,s,I[H+257]),s+=z[H+257],H>7&&(X(t,s,A>>23&31),s+=wr[H]);var $=A&31;or(t,s,R[$]),s+=P[$],$>3&&(or(t,s,A>>5&8191),s+=xr[$])}else or(t,s,I[A]),s+=z[A]}return or(t,s,I[256]),s+z[256]},Ft=new Br([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_r=new x(0),Dt=function(r,t,n,e,i,a){var f=a.z||r.length,l=new x(e+f+5*(1+Math.ceil(f/7e3))+i),c=l.subarray(e,l.length-i),u=a.l,s=(a.r||0)&7;if(t){s&&(c[0]=a.r>>3);for(var o=Ft[t-1],h=o>>13,p=o&8191,w=(1<<n)-1,m=a.p||new N(32768),S=a.h||new N(w+1),b=Math.ceil(n/3),O=2*b,E=function(Ar){return(r[Ar]^r[Ar+1]<<b^r[Ar+2]<<O)&w},M=new Br(25e3),U=new N(288),F=new N(32),d=0,g=0,v=a.i||0,D=0,C=a.w||0,B=0;v+2<f;++v){var J=E(v),L=v&32767,Z=S[J];if(m[L]=Z,S[J]=L,C<=v){var I=f-v;if((d>7e3||D>24576)&&(I>423||!u)){s=$r(r,c,0,M,U,F,g,D,B,v-B,s),D=d=g=0,B=v;for(var z=0;z<286;++z)U[z]=0;for(var z=0;z<30;++z)F[z]=0}var R=2,P=0,er=p,q=L-Z&32767;if(I>2&&J==E(v-q))for(var j=Math.min(h,I)-1,G=Math.min(32767,v),H=Math.min(258,I);q<=G&&--er&&L!=Z;){if(r[v+R]==r[v+R-q]){for(var A=0;A<H&&r[v+A]==r[v+A-q];++A);if(A>R){if(R=A,P=q,A>j)break;for(var $=Math.min(q,A-2),_=0,z=0;z<$;++z){var rr=v-q+z&32767,ur=m[rr],lr=rr-ur&32767;lr>_&&(_=lr,Z=rr)}}}L=Z,Z=m[L],q+=L-Z&32767}if(P){M[D++]=268435456|Fr[R]<<18|qr[P];var ir=Fr[R]&31,ar=qr[P]&31;g+=wr[ir]+xr[ar],++U[257+ir],++F[ar],C=v+R,++d}else M[D++]=r[v],++U[r[v]]}}for(v=Math.max(v,C);v<f;++v)M[D++]=r[v],++U[r[v]];s=$r(r,c,u,M,U,F,g,D,B,v-B,s),u||(a.r=s&7|c[s/8|0]<<3,s-=7,a.h=S,a.p=m,a.i=v,a.w=C)}else{for(var v=a.w||0;v<f+u;v+=65535){var tr=v+65535;tr>=f&&(c[s/8|0]=u,tr=f),s=Qr(c,s+1,r.subarray(v,tr))}a.i=f}return zr(l,0,e+kr(s)+i)},It=(function(){for(var r=new Int32Array(256),t=0;t<256;++t){for(var n=t,e=9;--e;)n=(n&1&&-306674912)^n>>>1;r[t]=n}return r})(),rt=function(){var r=-1;return{p:function(t){for(var n=r,e=0;e<t.length;++e)n=It[n&255^t[e]]^n>>>8;r=n},d:function(){return~r}}};var tt=function(r,t,n,e,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),f=new x(a.length+r.length);f.set(a),f.set(r,a.length),r=f,i.w=a.length}return Dt(r,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+t.mem,n,e,i)},nt=function(r,t){var n={};for(var e in r)n[e]=r[e];for(var e in t)n[e]=t[e];return n};var T=function(r,t,n){for(;n;++t)r[t]=n,n>>>=8},Pt=function(r,t){var n=t.filename;if(r[0]=31,r[1]=139,r[2]=8,r[8]=t.level<2?4:t.level==9?2:0,r[9]=3,t.mtime!=0&&T(r,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){r[3]=8;for(var e=0;e<=n.length;++e)r[e+10]=n.charCodeAt(e)}},Ot=function(r){(r[0]!=31||r[1]!=139||r[2]!=8)&&k(6,"invalid gzip data");var t=r[3],n=10;t&4&&(n+=(r[10]|r[11]<<8)+2);for(var e=(t>>3&1)+(t>>4&1);e>0;e-=!r[n++]);return n+(t&2)},Bt=function(r){var t=r.length;return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0},kt=function(r){return 10+(r.filename?r.filename.length+1:0)};function bt(r,t){return tt(r,t||{},0,0)}function et(r,t){t||(t={});var n=rt(),e=r.length;n.p(r);var i=tt(r,t,kt(t),8),a=i.length;return Pt(i,t),T(i,a-8,n.d()),T(i,a-4,e),i}function it(r,t){var n=Ot(r);return n+8>r.length&&k(6,"invalid gzip data"),Ut(r.subarray(n,-8),{i:2},t&&t.out||new x(Bt(r)),t&&t.dictionary)}var at=function(r,t,n,e){for(var i in r){var a=r[i],f=t+i,l=e;Array.isArray(a)&&(l=nt(e,a[1]),a=a[0]),a instanceof x?n[f]=[a,l]:(n[f+="/"]=[new x(0),l],at(a,f,n,e))}},Vr=typeof TextEncoder<"u"&&new TextEncoder,Pr=typeof TextDecoder<"u"&&new TextDecoder,Zt=0;try{Pr.decode(_r,{stream:!0}),Zt=1}catch{}var Rt=function(r){for(var t="",n=0;;){var e=r[n++],i=(e>127)+(e>223)+(e>239);if(n+i>r.length)return{s:t,r:zr(r,n-1)};i?i==3?(e=((e&15)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,t+=String.fromCharCode(55296|e>>10,56320|e&1023)):i&1?t+=String.fromCharCode((e&31)<<6|r[n++]&63):t+=String.fromCharCode((e&15)<<12|(r[n++]&63)<<6|r[n++]&63):t+=String.fromCharCode(e)}};function mr(r,t){if(t){for(var n=new x(r.length),e=0;e<r.length;++e)n[e]=r.charCodeAt(e);return n}if(Vr)return Vr.encode(r);for(var i=r.length,a=new x(r.length+(r.length>>1)),f=0,l=function(s){a[f++]=s},e=0;e<i;++e){if(f+5>a.length){var c=new x(f+8+(i-e<<1));c.set(a),a=c}var u=r.charCodeAt(e);u<128||t?l(u):u<2048?(l(192|u>>6),l(128|u&63)):u>55295&&u<57344?(u=65536+(u&1047552)|r.charCodeAt(++e)&1023,l(240|u>>18),l(128|u>>12&63),l(128|u>>6&63),l(128|u&63)):(l(224|u>>12),l(128|u>>6&63),l(128|u&63))}return zr(a,0,f)}function ot(r,t){if(t){for(var n="",e=0;e<r.length;e+=16384)n+=String.fromCharCode.apply(null,r.subarray(e,e+16384));return n}else{if(Pr)return Pr.decode(r);var i=Rt(r),a=i.s,n=i.r;return n.length&&k(8),a}}var Or=function(r){var t=0;if(r)for(var n in r){var e=r[n].length;e>65535&&k(9),t+=e+4}return t},jr=function(r,t,n,e,i,a,f,l){var c=e.length,u=n.extra,s=l&&l.length,o=Or(u);T(r,t,f!=null?33639248:67324752),t+=4,f!=null&&(r[t++]=20,r[t++]=n.os),r[t]=20,t+=2,r[t++]=n.flag<<1|(a<0&&8),r[t++]=i&&8,r[t++]=n.compression&255,r[t++]=n.compression>>8;var h=new Date(n.mtime==null?Date.now():n.mtime),p=h.getFullYear()-1980;if((p<0||p>119)&&k(10),T(r,t,p<<25|h.getMonth()+1<<21|h.getDate()<<16|h.getHours()<<11|h.getMinutes()<<5|h.getSeconds()>>1),t+=4,a!=-1&&(T(r,t,n.crc),T(r,t+4,a<0?-a-2:a),T(r,t+8,n.size)),T(r,t+12,c),T(r,t+14,o),t+=16,f!=null&&(T(r,t,s),T(r,t+6,n.attrs),T(r,t+10,f),t+=14),r.set(e,t),t+=c,o)for(var w in u){var m=u[w],S=m.length;T(r,t,+w),T(r,t+2,S),r.set(m,t+4),t+=4+S}return s&&(r.set(l,t),t+=s),t},Lt=function(r,t,n,e,i){T(r,t,101010256),T(r,t+8,n),T(r,t+10,n),T(r,t+12,e),T(r,t+16,i)};function st(r,t){t||(t={});var n={},e=[];at(r,"",n,t);var i=0,a=0;for(var f in n){var l=n[f],c=l[0],u=l[1],s=u.level==0?0:8,o=mr(f),h=o.length,p=u.comment,w=p&&mr(p),m=w&&w.length,S=Or(u.extra);h>65535&&k(11);var b=s?bt(c,u):c,O=b.length,E=rt();E.p(c),e.push(nt(u,{size:c.length,crc:E.d(),c:b,f:o,m:w,u:h!=f.length||w&&p.length!=m,o:i,compression:s})),i+=30+h+S+O,a+=76+2*(h+S)+(m||0)+O}for(var M=new x(a+22),U=i,F=a-i,d=0;d<e.length;++d){var o=e[d];jr(M,o.o,o,o.f,o.u,o.c.length);var g=30+o.f.length+Or(o.extra);M.set(o.c,o.o+g),jr(M,i,o,o.f,o.u,o.c.length,o.o,o.m),i+=16+g+(o.m?o.m.length:0)}return Lt(M,i,e.length,F,U),M}var Gt=new Date("2000-01-01T00:00:00Z");function ft(r){return typeof r=="string"?mr(r):new Uint8Array(r)}function ut(r){return dr(r.buffer.slice(0),[r.buffer.slice(0)])}var Ht={compress(r,t=9){try{let n=ft(r),e=Math.min(9,Math.max(0,t)),i=et(n,{mtime:0,level:e});return ut(i)}catch(n){throw console.error("Compression Worker: Failed to compress",n),new Error(`Compression failed: ${n instanceof Error?n.message:String(n)}`)}},decompress(r){try{let t=new Uint8Array(r),n=it(t);return ot(n)}catch(t){throw console.error("Compression Worker: Failed to decompress",t),new Error(`Decompression failed: ${t instanceof Error?t.message:String(t)}`)}},createZip(r,t=9){try{let n={};for(let[a,f]of Object.entries(r))n[a]=ft(f);let e=Math.min(9,Math.max(0,t)),i=st(n,{level:e,mtime:Gt.getTime()});return ut(i)}catch(n){throw console.error("Compression Worker: Failed to create ZIP",n),new Error(`ZIP creation failed: ${n instanceof Error?n.message:String(n)}`)}}};yr(Ht);})();\n/*! Bundled license information:\n\ncomlink/dist/esm/comlink.mjs:\n  (**\n   * @license\n   * Copyright 2019 Google LLC\n   * SPDX-License-Identifier: Apache-2.0\n   *)\n*/\n',workerName:"Compression Worker",validateOnInit:!1,maxConsecutiveErrors:3,errorResetTime:6e4})}initialize(){this.workerManager.initialize()}async compress(t,n=9){return this.workerManager.execute(r=>r.compress(t,n),{timeout:1e4,retry:!0})}async decompress(t){return this.workerManager.execute(n=>n.decompress(t),{timeout:1e4,retry:!0})}async createZip(t,n=9){return this.workerManager.execute(r=>r.createZip(t,n),{timeout:3e4,retry:!0})}terminate(){this.workerManager.terminate()}getStatus(){return this.workerManager.getStatus()}isHealthy(){return this.workerManager.isHealthy()}};var YB=require("obsidian");var GB="system:orphan-cleanup";var KB="cleanup:";var WB=require("obsidian");var Ig=class{constructor(){P(this,"debouncedCleanups",new Map);P(this,"isDestroyed",!1)}createDebouncer(t,n){let r=this.debouncedCleanups.get(t);return r||(r=(0,WB.debounce)(()=>{this.isDestroyed||n()},5e3,!1),this.debouncedCleanups.set(t,r)),r}getDebouncer(t){return this.debouncedCleanups.get(t)}removeDebouncer(t){let n=this.debouncedCleanups.get(t);n&&(n.cancel(),this.debouncedCleanups.delete(t))}destroy(){this.isDestroyed=!0,this.debouncedCleanups.forEach(t=>t.cancel()),this.debouncedCleanups.clear()}get destroyed(){return this.isDestroyed}};async function lN(e,t,n=3){let r=null;for(let i=0;i<n;i++)try{return await e()}catch(o){r=o instanceof Error?o:new Error(String(o)),i<n-1&&await new Promise(s=>setTimeout(s,1e3))}throw console.error(`VC: ${t} after ${n} attempts.`,r),r||new Error(t)}function cN(e){let{maxVersionsPerNote:t=0,autoCleanupOldVersions:n=!1,autoCleanupDays:r=0}=e;return{maxVersionsPerNote:t,autoCleanupOldVersions:n,autoCleanupDays:r}}function uN(e){let t=e.maxVersionsPerNote>0,n=e.autoCleanupOldVersions&&e.autoCleanupDays>0;return t||n}var Lx=require("obsidian");function fN(e,t){let n=Object.entries(e),r=mr(n,[l=>l[1].versionNumber],["desc"]);if(r.length<=1)return new Set;if(typeof Lx.moment!="function")return console.error("VC: moment.js is not available. Cannot perform age-based cleanup."),new Set;let i=new Set,o=(0,Lx.moment)().subtract(t.autoCleanupDays,"days"),s=t.maxVersionsPerNote>0,a=t.autoCleanupOldVersions&&t.autoCleanupDays>0;if(r.forEach(([l,c],u)=>{s&&u>=t.maxVersionsPerNote&&i.add(l),a&&(0,Lx.moment)(c.timestamp).isBefore(o)&&i.add(l)}),i.size===r.length){let l=r[0]?.[0];l&&i.delete(l)}return i}var Og=class{constructor(t,n,r,i,o){this.manifestManager=t;this.editHistoryManager=n;this.versionContentRepo=r;this.eventBus=i;this.plugin=o}async cleanup(t,n){let r=n==="version",i=r?await this.manifestManager.loadNoteManifest(t):await this.editHistoryManager.getEditManifest(t);if(!i)return;let o=i.currentBranch,s=i.branches[o];if(!s?.versions)return;let a=r?this.plugin.settings.versionHistorySettings:this.plugin.settings.editHistorySettings,l=Qu.resolve(a,s.settings),c=cN(l);if(!uN(c))return;let u=fN(s.versions,c);u.size!==0&&(r?await this.deleteVersions(t,o,u):await this.deleteEdits(t,o,u),this.eventBus.trigger("version-deleted",t))}async deleteVersions(t,n,r){let i=this.manifestManager.updateNoteManifest(t,s=>{let a=s.branches[n];if(a)for(let l of r)delete a.versions[l];s.lastModified=new Date().toISOString()}),o=[...r].map(s=>this.versionContentRepo.delete(t,s).catch(a=>console.error(`VC: Failed to delete version file for id ${s}`,a)));await Promise.all([i,...o])}async deleteEdits(t,n,r){let i=await this.editHistoryManager.getEditManifest(t);if(!i)return;let o=i.branches[n];if(!o)return;for(let a of r)delete o.versions[a];i.lastModified=new Date().toISOString(),await this.editHistoryManager.saveEditManifest(t,i);let s=[...r].map(a=>this.editHistoryManager.deleteEdit(t,n,a).catch(l=>console.error(`VC: Failed to delete edit ${a}`,l)));await Promise.all(s)}};var ll=require("obsidian");var Pg=class{constructor(t,n,r,i,o,s,a,l){this.app=t;this.manifestManager=n;this.editHistoryManager=r;this.pathService=i;this.storageService=o;this.eventBus=s;this.plugin=a;this.noteManager=l}async performDeepCleanup(t,n){let r=async(o,s)=>{if(!n())try{await s()}catch(a){let l=`Cleanup Step '${o}' failed: ${a instanceof Error?a.message:String(a)}`;console.error(`VC: ${l}`,a),t.errors=t.errors||[],t.errors.push(l),t.success=!1}};await r("Resolve Duplicates",()=>this.resolvePathDuplicates(t,n));let i=[];await r("Verify & Recover",async()=>{i=await this.verifyAndRecoverNotes(t,n)}),i.length>0&&await r("Delete Orphans",()=>this.deleteTrueOrphans(i,t,n)),await r("Cleanup Folders",()=>this.cleanupUnregisteredFolders(t,n)),await r("Cleanup Version Files",()=>this.cleanupOrphanedVersionFiles(t,n))}async resolvePathDuplicates(t,n){let r=await this.manifestManager.loadCentralManifest(!0),i=new Map;for(let[o,s]of Object.entries(r.notes))s&&(i.has(s.notePath)||i.set(s.notePath,[]),i.get(s.notePath).push({id:o,createdAt:s.createdAt}));for(let[o,s]of i){if(n())return;if(s.length>1){s.sort((c,u)=>{let f=new Date(c.createdAt).getTime(),p=new Date(u.createdAt).getTime(),d=!isNaN(f),h=!isNaN(p);return d&&!h?-1:!d&&h?1:!d&&!h?c.id.localeCompare(u.id):f!==p?f-p:c.id.localeCompare(u.id)});let a=s[0],l=s.slice(1);if(a){console.log(`VC: Resolving duplicates for "${o}". Winner: ${a.id}. Losers: ${l.map(c=>c.id).join(", ")}`);for(let c of l){if(n())return;await this.deleteNoteData(c.id);try{let u=this.app.vault.getAbstractFileByPath(o);u instanceof ll.TFile&&u.extension==="md"&&await this.removeIdFromFrontmatter(u,c.id)}catch(u){console.warn(`VC: Failed to remove loser ID ${c.id} from frontmatter of ${o}`,u)}t.deletedDuplicates++}}}}}async verifyAndRecoverNotes(t,n){let r=await this.manifestManager.loadCentralManifest(!0),i=[];for(let[u,f]of Object.entries(r.notes)){if(!f||!f.notePath)continue;this.app.vault.getAbstractFileByPath(f.notePath)||i.push(u)}if(i.length===0)return[];console.log(`VC: Found ${i.length} missing notes. Scanning vault for recovery...`);let o=this.app.vault.getMarkdownFiles(),s=this.plugin.settings.noteIdFrontmatterKey,a=this.plugin.settings.legacyNoteIdFrontmatterKeys||[],l=ll.Platform.isMobile?50:500,c=new Set(i);for(let u=0;u<o.length;u+=l){if(n())return Array.from(c);let f=o.slice(u,u+l);for(let p of f)try{let d=this.app.metadataCache.getFileCache(p);if(!d?.frontmatter)continue;let h=null;if(d.frontmatter[s]&&c.has(d.frontmatter[s]))h=d.frontmatter[s];else for(let m of a)if(d.frontmatter[m]&&c.has(d.frontmatter[m])){h=d.frontmatter[m];break}h&&(console.log(`VC: Recovered missing note ${h} at "${p.path}"`),await this.manifestManager.updateNotePath(h,p.path).catch(m=>console.error(`VC: Failed to update path for ${h}`,m)),await this.editHistoryManager.updateNotePath(h,p.path).catch(m=>console.error(`VC: Failed to update edit history path for ${h}`,m)),c.delete(h),t.recoveredNotes++)}catch(d){console.debug(`VC: Error scanning file ${p.path} for recovery`,d)}await new Promise(p=>setTimeout(p,10))}return Array.from(c)}async deleteTrueOrphans(t,n,r){for(let i of t){if(r())return;try{console.log(`VC: Deleting true orphan note data: ${i}`),await this.deleteNoteData(i),n.deletedOrphans++}catch(o){console.error(`VC: Failed to delete orphan ${i}`,o),n.errors=n.errors||[],n.errors.push(`Failed to delete orphan ${i}: ${o}`)}}}async cleanupUnregisteredFolders(t,n){let r=await this.manifestManager.loadCentralManifest(!0),i=new Set(Object.keys(r.notes)),o=this.pathService.getDbRoot(),s=this.app.vault.getAbstractFileByPath(o);if(!s){await this.app.vault.adapter.exists(o);return}if(!(s instanceof ll.TFolder))return;let a=[...s.children];for(let l of a){if(n())return;if(!(l instanceof ll.TFolder))continue;let c=l.name;if(this.isValidNoteId(c)&&!i.has(c))try{await lN(()=>this.storageService.permanentlyDeleteFolder(l.path),`Failed to delete orphaned note directory: ${l.path}`),t.deletedNoteDirs++}catch(u){console.warn(`VC: Could not delete orphaned folder ${l.path}`,u)}}}async cleanupOrphanedVersionFiles(t,n){let r=await this.manifestManager.loadCentralManifest(!0),i=new Set(Object.keys(r.notes));for(let o of i){if(n())break;try{let s=await this.manifestManager.loadNoteManifest(o);if(!s)continue;let a=new Set;if(s.branches)for(let f in s.branches){let p=s.branches[f];p?.versions&&Object.keys(p.versions).forEach(d=>a.add(d))}let l=this.pathService.getNoteVersionsPath(o),c=this.app.vault.getAbstractFileByPath(l);if(!(c instanceof ll.TFolder))continue;let u=[...c.children];for(let f of u){if(n())break;if(!(f instanceof ll.TFile))continue;let p=f.name;if(p?.endsWith(".md")){let d=p.slice(0,-3);d&&!a.has(d)&&(await this.safeDeleteFile(f.path),t.deletedVersionFiles++)}}}catch(s){console.warn(`VC: Error cleaning up version files for note ${o}`,s)}}}async safeDeleteFile(t){try{if(!await this.app.vault.adapter.exists(t))return;await this.app.vault.adapter.remove(t)}catch(n){if(await this.app.vault.adapter.exists(t))throw n}}async deleteNoteData(t){try{await this.manifestManager.deleteNoteEntry(t),await this.editHistoryManager.deleteNoteHistory(t),this.eventBus.trigger("history-deleted",t),this.manifestManager.invalidateNoteManifestCache(t)}catch(n){throw console.error(`VC: Failed to delete data for note ${t}`,n),n}}async removeIdFromFrontmatter(t,n){let r=this.plugin.settings.noteIdFrontmatterKey,i=this.plugin.settings.legacyNoteIdFrontmatterKeys||[],o=this.app.metadataCache.getFileCache(t),s={},a=!1;o?.frontmatter?.[r]===n&&(s[r]=On,a=!0);for(let l of i)o?.frontmatter?.[l]===n&&(s[l]=On,a=!0);a&&(this.noteManager.registerInternalWrite(t.path),await sl(this.app,t,s))}isValidNoteId(t){return typeof t=="string"&&t.length>0&&!t.includes("/")&&!t.includes("\\")&&!t.includes("..")}};var kg=class extends YB.Component{constructor(n,r,i,o,s,a,l,c,u,f,p){super();this.app=n;this.manifestManager=r;this.editHistoryManager=i;this.eventBus=o;this.pathService=s;this.queueService=a;this.versionContentRepo=l;this.plugin=c;this.storageService=u;this.store=f;this.noteManager=p;P(this,"cleanupPromises",new Map);P(this,"operationLocks",new Map);P(this,"debouncerManager");P(this,"policyCleanupOp");P(this,"orphanCleanupOp");P(this,"periodicCleanupTimer",null);P(this,"isDestroyed",!1);P(this,"handleVersionSaved",n=>{if(!this.isValidNoteId(n)||this.isDestroyed)return;this.debouncerManager.createDebouncer(n,()=>{this.isDestroyed||this.scheduleCleanup(n)})()});P(this,"handleHistoryDeleted",n=>{if(!this.isValidNoteId(n)||this.isDestroyed)return;this.debouncerManager.removeDebouncer(n);let r=this.cleanupPromises.get(n);r&&(r.catch(()=>{}),this.cleanupPromises.delete(n))});this.debouncerManager=new Ig,this.policyCleanupOp=new Og(this.manifestManager,this.editHistoryManager,this.versionContentRepo,this.eventBus,this.plugin),this.orphanCleanupOp=new Pg(this.app,this.manifestManager,this.editHistoryManager,this.pathService,this.storageService,this.eventBus,this.plugin,this.noteManager)}initialize(){this.validateDependencies(),this.eventBus.on("version-saved",this.handleVersionSaved),this.register(()=>this.eventBus.off("version-saved",this.handleVersionSaved)),this.eventBus.on("history-deleted",this.handleHistoryDeleted),this.register(()=>this.eventBus.off("history-deleted",this.handleHistoryDeleted)),this.startPeriodicCleanup(),this.register(()=>{this.isDestroyed=!0,this.stopPeriodicCleanup(),this.debouncerManager.destroy(),this.cleanupPromises.clear(),this.operationLocks.clear()})}validateDependencies(){if(!this.app?.vault)throw new Error("App instance with vault is required");if(!this.manifestManager)throw new Error("ManifestManager is required");if(!this.editHistoryManager)throw new Error("EditHistoryManager is required");if(!this.eventBus)throw new Error("EventBus is required");if(!this.pathService)throw new Error("PathService is required");if(!this.queueService)throw new Error("QueueService is required");if(!this.versionContentRepo)throw new Error("VersionContentRepository is required");if(!this.plugin)throw new Error("Plugin instance is required");if(!this.storageService)throw new Error("StorageService is required");if(!this.store)throw new Error("Store is required");if(!this.noteManager)throw new Error("NoteManager is required")}getQueueKey(n){return`${KB}${n}`}startPeriodicCleanup(){this.periodicCleanupTimer===null&&(window.setTimeout(()=>this.performPeriodicCheck(),1e4),this.periodicCleanupTimer=window.setInterval(()=>{this.performPeriodicCheck()},9e5))}stopPeriodicCleanup(){this.periodicCleanupTimer!==null&&(window.clearInterval(this.periodicCleanupTimer),this.periodicCleanupTimer=null)}performPeriodicCheck(){if(this.isDestroyed)return;let r=this.store.getState().app.noteId;r&&this.isValidNoteId(r)&&this.scheduleCleanup(r)}isValidNoteId(n){return typeof n=="string"&&n.length>0&&!n.includes("..")}scheduleCleanup(n){if(!this.isValidNoteId(n)||this.isDestroyed||this.cleanupPromises.has(n))return;let r=this.queueService.enqueue(this.getQueueKey(n),()=>this.performPerNoteCleanup(n)).catch(i=>{throw console.error(`VC: Error during scheduled cleanup for note ${n}.`,i),i}).finally(()=>{this.cleanupPromises.delete(n)});this.cleanupPromises.set(n,r)}async performPerNoteCleanup(n){if(this.isDestroyed)return;let r=this.operationLocks.get(n);if(r){await r;return}let i=(async()=>{try{await this.policyCleanupOp.cleanup(n,"version"),await this.policyCleanupOp.cleanup(n,"edit")}finally{this.operationLocks.delete(n)}})();this.operationLocks.set(n,i),await i}cleanupOrphanedVersions(){return this.queueService.enqueue(GB,async()=>{if(this.isDestroyed)return{deletedNoteDirs:0,deletedVersionFiles:0,deletedDuplicates:0,deletedOrphans:0,recoveredNotes:0,success:!1};let n={deletedNoteDirs:0,deletedVersionFiles:0,deletedDuplicates:0,deletedOrphans:0,recoveredNotes:0,success:!0,errors:[]};try{await this.orphanCleanupOp.performDeepCleanup(n,()=>this.isDestroyed)}catch(r){n.success=!1;let i=r instanceof Error?r.message:String(r);n.errors=n.errors||[],n.errors.push(`Catastrophic cleanup failure: ${i}`),console.error("VC: Catastrophic error during orphan data cleanup.",r)}return n})}async completePendingCleanups(){let n=[...this.cleanupPromises.values()];n.length&&await Promise.allSettled(n),this.cleanupPromises.clear()}};var QB=require("obsidian");var _g=class extends QB.Component{constructor(n,r){super();this.store=n;this.plugin=r;P(this,"timerId",null);P(this,"activeNoteId",null);P(this,"nextVersionSaveTime",null);P(this,"nextEditSaveTime",null);P(this,"versionInterval",null);P(this,"editInterval",null)}onunload(){this.stopTimer()}async syncWatchMode(){let n=this.store.getState().app,r=n.noteId;if(!r||n.status!=="READY"){this.stopTimer(),this.activeNoteId=null,this.store.dispatch(H.actions.setWatchModeCountdown(null));return}this.activeNoteId!==r&&(this.activeNoteId=r,this.nextVersionSaveTime=null,this.nextEditSaveTime=null);let i=await this.resolveSettings(r,"version"),o=await this.resolveSettings(r,"edit");i.enableWatchMode?(this.versionInterval=i.watchModeInterval*1e3,this.nextVersionSaveTime===null&&(this.nextVersionSaveTime=Date.now()+this.versionInterval)):(this.versionInterval=null,this.nextVersionSaveTime=null),o.enableWatchMode?(this.editInterval=o.watchModeInterval*1e3,this.nextEditSaveTime===null&&(this.nextEditSaveTime=Date.now()+this.editInterval)):(this.editInterval=null,this.nextEditSaveTime=null),this.versionInterval!==null||this.editInterval!==null?(this.startTimer(),this.tick()):(this.stopTimer(),this.store.dispatch(H.actions.setWatchModeCountdown(null)))}resetTimer(n){let r=Date.now();n==="version"?this.versionInterval!==null&&(this.nextVersionSaveTime=r+this.versionInterval,this.tick()):this.editInterval!==null&&(this.nextEditSaveTime=r+this.editInterval,this.tick())}startTimer(){this.timerId===null&&(this.timerId=window.setInterval(()=>this.tick(),1e3),this.tick())}stopTimer(){this.timerId!==null&&(window.clearInterval(this.timerId),this.timerId=null)}tick(){let n=Date.now(),r=this.store.getState().app;if(r.noteId!==this.activeNoteId||r.status!=="READY"){this.stopTimer();return}this.nextVersionSaveTime!==null&&n>=this.nextVersionSaveTime&&(this.triggerVersionSave(),this.nextVersionSaveTime=n+(this.versionInterval||6e4)),this.nextEditSaveTime!==null&&n>=this.nextEditSaveTime&&(this.triggerEditSave(),this.nextEditSaveTime=n+(this.editInterval||6e4));let i=null;r.viewMode==="versions"&&this.nextVersionSaveTime!==null?(i=Math.ceil((this.nextVersionSaveTime-n)/1e3),i<0&&(i=0)):r.viewMode==="edits"&&this.nextEditSaveTime!==null&&(i=Math.ceil((this.nextEditSaveTime-n)/1e3),i<0&&(i=0)),r.watchModeCountdown!==i&&this.store.dispatch(H.actions.setWatchModeCountdown(i))}async triggerVersionSave(){if(!this.activeNoteId)return;let n=await this.resolveSettings(this.activeNoteId,"version"),r={...this.plugin.settings,...n};this.store.dispatch(Z.saveNewVersion({isAuto:!0,settings:r}))}async triggerEditSave(){this.activeNoteId&&this.store.dispatch(Z.saveNewEdit({isAuto:!0,allowInit:!1}))}async resolveSettings(n,r){let i=this.store.dispatch(Ne.endpoints.getBranches.initiate(n,{forceRefetch:!0})),o="main";try{let c=await i;c.data&&(o=c.data.currentBranch)}catch(c){console.warn("VC: Failed to resolve branch for settings",c)}finally{i.unsubscribe()}let s=r==="version"?"versions":"edits",a=this.store.dispatch(Ne.endpoints.getEffectiveSettings.initiate({noteId:n,viewMode:s,branchName:o},{forceRefetch:!0}));try{let c=await a;if(c.data)return c.data}catch(c){console.warn("VC: Failed to resolve settings",c)}finally{a.unsubscribe()}return{...r==="version"?this.plugin.settings.versionHistorySettings:this.plugin.settings.editHistorySettings,isGlobal:!0}}};var gc=require("obsidian");var Fx=class{constructor(t,n,r,i){this.app=t;this.versionManager=n;this.editHistoryManager=r;this.compressionManager=i;P(this,"MAX_CONCURRENT_FETCHES",10);P(this,"MAX_EXPORT_SIZE_BYTES",100*1024*1024)}validateNoteId(t){if(typeof t!="string"||t.trim()==="")throw new Error(`Invalid noteId: must be non-empty string, received ${typeof t}`);if(t.length>1024)throw new Error("Invalid noteId: exceeds maximum length of 1024 characters")}validateFolder(t){if(!t||typeof t!="object")throw new Error("Invalid folder: must be a valid TFolder object");if(!(t instanceof gc.TFolder))throw new Error("Invalid folder: not an instance of TFolder");if(typeof t.path!="string")throw new Error("Invalid folder: path property must be a string")}validateFileName(t){if(typeof t!="string"||t.trim()==="")throw new Error(`Invalid fileName: must be non-empty string, received ${typeof t}`);if(/[/\\:*?"<>|]/.test(t)||t.includes("\0"))throw new Error("Invalid fileName: contains illegal characters");if(t.length>255)throw new Error("Invalid fileName: exceeds maximum length of 255 characters")}validateFormat(t){let n=["md","json","ndjson","txt","zip","gzip"];if(typeof t!="string"||!n.includes(t))throw new Error(`Invalid format: must be one of ${n.join(", ")}, received ${t}`)}validateOutputSize(t){if((typeof t=="string"?new TextEncoder().encode(t).length:t.byteLength)>this.MAX_EXPORT_SIZE_BYTES)throw new Error(`Content exceeds maximum allowed size of ${this.MAX_EXPORT_SIZE_BYTES} bytes`)}async getAllVersionsData(t,n){this.validateNoteId(t);try{let r;if(n==="version"?r=await this.versionManager.getVersionHistory(t):r=await this.editHistoryManager.getEditHistory(t),!Array.isArray(r)||r.length===0)return[];let i=[];for(let o=0;o<r.length;o+=this.MAX_CONCURRENT_FETCHES){let a=r.slice(o,o+this.MAX_CONCURRENT_FETCHES).map(async c=>{if(!c||typeof c.id!="string"||c.id.trim()==="")return null;try{let u;n==="version"?u=await this.versionManager.getVersionContent(t,c.id):u=await this.editHistoryManager.getEditContent(t,c.id);let p={...c,content:typeof u=="string"?u:""};return Ue(fM,p),p}catch(u){return console.error(`Version Control: Failed to fetch or validate content for version ${c.id}:`,u),null}}),l=await Promise.allSettled(a);for(let c of l)c.status==="fulfilled"&&c.value!==null&&i.push(c.value)}return i}catch(r){throw console.error(`Version Control: Failed to fetch version history for note ${t}:`,r),new Error(`Failed to fetch version data: ${r instanceof Error?r.message:"Unknown error"}`)}}async generateExport(t,n){this.validateFormat(n);let r=Ue(Ai(fM),t);try{let i="";switch(n){case"md":{i=r.map(o=>{let a=(o.name??"").replace(/"/g,'\\"');return`---
version_id: ${o.id}
version_number: ${o.versionNumber}
timestamp: "${o.timestamp}"
name: "${a}"
size_bytes: ${o.size}
---

${o.content}`}).join(r.length>1?`

<!-- --- VERSION SEPARATOR --->

`:"");break}case"json":{let o=r.length===1?r[0]:r;i=JSON.stringify(o,null,2);break}case"ndjson":{r.length===0?i="":r.length===1?i=JSON.stringify(r[0]):i=r.map(o=>JSON.stringify(o)).join(`
`);break}case"txt":{i=r.map(o=>{let s=o.name??"N/A";return`Version ID: ${o.id}
Version Number: ${o.versionNumber}
Timestamp: ${o.timestamp}
Name: ${s}
Size: ${o.size} bytes

${o.content}`}).join(r.length>1?`

<<<<< VERSION END >>>>>

<<<<< NEW VERSION START >>>>>

`:"");break}case"zip":{let o={};for(let s of r){let a=s.name?mc(s.name):`V${s.versionNumber}`,l=s.timestamp.replace(/[:.]/g,"-"),c=`${a}_${l}.md`;o[c]=s.content}i=await this.compressionManager.createZip(o,9);break}case"gzip":{let o=r[0];if(r.length!==1||!o)throw new Error("GZIP export is only supported for single version export.");i=await this.compressionManager.compress(o.content,9);break}default:throw new Error(`Unknown export format: ${n}`)}return this.validateOutputSize(i),i}catch(i){throw console.error("Version Control: Failed to format export data:",i),new Error(`Formatting failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async writeFile(t,n,r){this.validateFolder(t),this.validateFileName(n),this.validateOutputSize(r);try{let i=t.isRoot()?"":t.path,o=(0,gc.normalizePath)(`${i}/${n}`);if(o.includes("../")||o.includes("..\\"))throw new Error("Invalid file path: contains directory traversal");if(o.startsWith(".git/")||o.startsWith(".obsidian/"))throw new Error("Cannot write to protected system directories");let s;try{let a=this.app.vault.getAbstractFileByPath(o);if(a instanceof gc.TFile)console.warn(`VC: File "${n}" already exists. Overwriting.`),typeof r=="string"?await this.app.vault.modify(a,r):await this.app.vault.modifyBinary(a,r),s=o;else{if(a instanceof gc.TFolder)throw new Error(`Cannot write file: path "${o}" is a directory`);typeof r=="string"?await this.app.vault.create(o,r):await this.app.vault.createBinary(o,r),s=o}}catch(a){console.warn("VC: Direct file creation failed, attempting with unique filename:",a);let l=new Date().toISOString().replace(/[:.]/g,"-"),c=n.split("."),u="",f=n;if(c.length>1){let d=c.pop();u=d!==void 0?d:"",f=c.join("."),f.endsWith(".tar")&&u==="gz"&&(u="tar.gz",f=f.substring(0,f.length-4))}let p=u?`${f}-${l}.${u}`:`${f}-${l}`;o=(0,gc.normalizePath)(`${i}/${p}`),typeof r=="string"?await this.app.vault.create(o,r):await this.app.vault.createBinary(o,r),s=o,console.info(`VC: Created file with unique name: ${p}`)}return s}catch(i){throw console.error("Version Control: Failed to write export file:",i),new Error(`File write failed: ${i instanceof Error?i.message:"Unknown error"}`)}}};var fd=require("obsidian");var Vg=class extends Ss{constructor(){super({workerString:`(()=>{var G=Symbol("Comlink.proxy"),dt=Symbol("Comlink.endpoint"),pt=Symbol("Comlink.releaseProxy"),F=Symbol("Comlink.finalizer"),x=Symbol("Comlink.thrown"),Q=n=>typeof n=="object"&&n!==null||typeof n=="function",mt={canHandle:n=>Q(n)&&n[G],serialize(n){let{port1:t,port2:e}=new MessageChannel;return v(n,t),[e,[e]]},deserialize(n){return n.start(),Lt(n)}},bt={canHandle:n=>Q(n)&&x in n,serialize({value:n}){let t;return n instanceof Error?t={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:t={isError:!1,value:n},[t,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},Y=new Map([["proxy",mt],["throw",bt]]);function yt(n,t){for(let e of n)if(t===e||e==="*"||e instanceof RegExp&&e.test(t))return!0;return!1}function v(n,t=globalThis,e=["*"]){t.addEventListener("message",function s(r){if(!r||!r.data)return;if(!yt(e,r.origin)){console.warn(\`Invalid origin '\${r.origin}' for comlink proxy\`);return}let{id:i,type:o,path:l}=Object.assign({path:[]},r.data),f=(r.data.argumentList||[]).map(A),a;try{let c=l.slice(0,-1).reduce((h,g)=>h[g],n),u=l.reduce((h,g)=>h[g],n);switch(o){case"GET":a=u;break;case"SET":c[l.slice(-1)[0]]=A(r.data.value),a=!0;break;case"APPLY":a=u.apply(c,f);break;case"CONSTRUCT":{let h=new u(...f);a=At(h)}break;case"ENDPOINT":{let{port1:h,port2:g}=new MessageChannel;v(n,g),a=H(h,[h])}break;case"RELEASE":a=void 0;break;default:return}}catch(c){a={value:c,[x]:0}}Promise.resolve(a).catch(c=>({value:c,[x]:0})).then(c=>{let[u,h]=I(c);t.postMessage(Object.assign(Object.assign({},u),{id:i}),h),o==="RELEASE"&&(t.removeEventListener("message",s),J(t),F in n&&typeof n[F]=="function"&&n[F]())}).catch(c=>{let[u,h]=I({value:new TypeError("Unserializable return value"),[x]:0});t.postMessage(Object.assign(Object.assign({},u),{id:i}),h)})}),t.start&&t.start()}function wt(n){return n.constructor.name==="MessagePort"}function J(n){wt(n)&&n.close()}function Lt(n,t){let e=new Map;return n.addEventListener("message",function(r){let{data:i}=r;if(!i||!i.id)return;let o=e.get(i.id);if(o)try{o(i)}finally{e.delete(i.id)}}),B(n,e,[],t)}function P(n){if(n)throw new Error("Proxy has been released and is not useable")}function K(n){return M(n,new Map,{type:"RELEASE"}).then(()=>{J(n)})}var T=new WeakMap,_="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{let t=(T.get(n)||0)-1;T.set(n,t),t===0&&K(n)});function Et(n,t){let e=(T.get(t)||0)+1;T.set(t,e),_&&_.register(n,t,n)}function Ct(n){_&&_.unregister(n)}function B(n,t,e=[],s=function(){}){let r=!1,i=new Proxy(s,{get(o,l){if(P(r),l===pt)return()=>{Ct(i),K(n),t.clear(),r=!0};if(l==="then"){if(e.length===0)return{then:()=>i};let f=M(n,t,{type:"GET",path:e.map(a=>a.toString())}).then(A);return f.then.bind(f)}return B(n,t,[...e,l])},set(o,l,f){P(r);let[a,c]=I(f);return M(n,t,{type:"SET",path:[...e,l].map(u=>u.toString()),value:a},c).then(A)},apply(o,l,f){P(r);let a=e[e.length-1];if(a===dt)return M(n,t,{type:"ENDPOINT"}).then(A);if(a==="bind")return B(n,t,e.slice(0,-1));let[c,u]=X(f);return M(n,t,{type:"APPLY",path:e.map(h=>h.toString()),argumentList:c},u).then(A)},construct(o,l){P(r);let[f,a]=X(l);return M(n,t,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:f},a).then(A)}});return Et(i,n),i}function St(n){return Array.prototype.concat.apply([],n)}function X(n){let t=n.map(I);return[t.map(e=>e[0]),St(t.map(e=>e[1]))]}var Z=new WeakMap;function H(n,t){return Z.set(n,t),n}function At(n){return Object.assign(n,{[G]:!0})}function I(n){for(let[t,e]of Y)if(e.canHandle(n)){let[s,r]=e.serialize(n);return[{type:"HANDLER",name:t,value:s},r]}return[{type:"RAW",value:n},Z.get(n)||[]]}function A(n){switch(n.type){case"HANDLER":return Y.get(n.name).deserialize(n.value);case"RAW":return n.value}}function M(n,t,e,s){return new Promise(r=>{let i=kt();t.set(i,r),n.start&&n.start(),n.postMessage(Object.assign({id:i},e),s)})}function kt(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function z(n){let[t,e]=n;return[t,e]}function tt(n,t){let e=n,s=t,r=e.length,i=s.length;if(r===0||i===0)return 0;r>i?e=e.substring(r-i):r<i&&(s=s.substring(0,r));let o=Math.min(r,i);if(e===s)return o;let l=0,f=1;for(let a=0;a!==-1;){let c=e.substring(o-f);if(a=s.indexOf(c),a===-1)return l;f+=a,(a===0||e.substring(o-f)===s.substring(0,f))&&(l=f,f++)}return l}function V(n,t){if(!n||!t||n[0]!==t[0])return 0;let e=0,s=Math.min(n.length,t.length),r=s,i=0;for(;e<r;)n.substring(i,r)===t.substring(i,r)?(e=r,i=e):s=r,r=Math.floor((s-e)/2+e);return r}function j(n,t){if(!n||!t||n[n.length-1]!==t[t.length-1])return 0;let e=0,s=Math.min(n.length,t.length),r=s,i=0;for(;e<r;)n.substring(n.length-r,n.length-i)===t.substring(t.length-r,t.length-i)?(e=r,i=e):s=r,r=Math.floor((s-e)/2+e);return r}function Ot(n){let t=n.charCodeAt(0);return t>=55296&&t<=56319}function Mt(n){let t=n.charCodeAt(0);return t>=56320&&t<=57343}function Dt(n,t,e){let s=n.length,r=t.length,i=Math.ceil((s+r)/2),o=i,l=2*i,f=new Array(l),a=new Array(l);for(let b=0;b<l;b++)f[b]=-1,a[b]=-1;f[o+1]=0,a[o+1]=0;let c=s-r,u=c%2!==0,h=0,g=0,p=0,O=0;for(let b=0;b<i&&!(Date.now()>e);b++){for(let y=-b+h;y<=b-g;y+=2){let w=o+y,d;y===-b||y!==b&&f[w-1]<f[w+1]?d=f[w+1]:d=f[w-1]+1;let C=d-y;for(;d<s&&C<r&&n.charAt(d)===t.charAt(C);)d++,C++;if(f[w]=d,d>s)g+=2;else if(C>r)h+=2;else if(u){let S=o+c-y;if(S>=0&&S<l&&a[S]!==-1){let D=s-a[S];if(d>=D)return nt(n,t,d,C,e)}}}for(let y=-b+p;y<=b-O;y+=2){let w=o+y,d;y===-b||y!==b&&a[w-1]<a[w+1]?d=a[w+1]:d=a[w-1]+1;let C=d-y;for(;d<s&&C<r&&n.charAt(s-d-1)===t.charAt(r-C-1);)d++,C++;if(a[w]=d,d>s)O+=2;else if(C>r)p+=2;else if(!u){let S=o+c-y;if(S>=0&&S<l&&f[S]!==-1){let D=f[S],gt=o+D-S;if(d=s-d,D>=d)return nt(n,t,D,gt,e)}}}}return[[E,n],[L,t]]}function nt(n,t,e,s,r){let i=n.substring(0,e),o=t.substring(0,s),l=n.substring(e),f=t.substring(s),a=k(i,o,{checkLines:!1,deadline:r}),c=k(l,f,{checkLines:!1,deadline:r});return a.concat(c)}function Pt(n,t,e=1){if(e<=0)return null;let s=n.length>t.length?n:t,r=n.length>t.length?t:n;if(s.length<4||r.length*2<s.length)return null;let i=et(s,r,Math.ceil(s.length/4)),o=et(s,r,Math.ceil(s.length/2)),l;if(i&&o)l=i[4].length>o[4].length?i:o;else{if(!i&&!o)return null;o?i||(l=o):l=i}if(!l)throw new Error("Unable to find a half match.");let f,a,c,u;n.length>t.length?(f=l[0],a=l[1],c=l[2],u=l[3]):(c=l[0],u=l[1],f=l[2],a=l[3]);let h=l[4];return[f,a,c,u,h]}function et(n,t,e){let s=n.slice(e,e+Math.floor(n.length/4)),r=-1,i="",o,l,f,a;for(;(r=t.indexOf(s,r+1))!==-1;){let c=V(n.slice(e),t.slice(r)),u=j(n.slice(0,e),t.slice(0,r));i.length<u+c&&(i=t.slice(r-u,r)+t.slice(r,r+c),o=n.slice(0,e-u),l=n.slice(e+c),f=t.slice(0,r-u),a=t.slice(r+c))}return i.length*2>=n.length?[o||"",l||"",f||"",a||"",i||""]:null}function xt(n,t){for(let e=0;e<n.length;e++){let s=n[e][1],r=[];for(let i=0;i<s.length;i++)r[i]=t[s.charCodeAt(i)];n[e][1]=r.join("")}}function Tt(n,t){let e=[],s={};e[0]="";function r(f){let a="",c=0,u=-1,h=e.length;for(;u<f.length-1;){u=f.indexOf(\`
\`,c),u===-1&&(u=f.length-1);let g=f.slice(c,u+1);(s.hasOwnProperty?s.hasOwnProperty(g):s[g]!==void 0)?a+=String.fromCharCode(s[g]):(h===i&&(g=f.slice(c),u=f.length),a+=String.fromCharCode(h),s[g]=h,e[h++]=g),c=u+1}return a}let i=4e4,o=r(n);i=65535;let l=r(t);return{chars1:o,chars2:l,lineArray:e}}function _t(n,t,e){let s=n,r=t,i=Tt(s,r);s=i.chars1,r=i.chars2;let o=i.lineArray,l=k(s,r,{checkLines:!1,deadline:e.deadline});xt(l,o),l=U(l),l.push([m,""]);let f=0,a=0,c=0,u="",h="";for(;f<l.length;){switch(l[f][0]){case L:c++,h+=l[f][1];break;case E:a++,u+=l[f][1];break;case m:if(a>=1&&c>=1){l.splice(f-a-c,a+c),f=f-a-c;let g=k(u,h,{checkLines:!1,deadline:e.deadline});for(let p=g.length-1;p>=0;p--)l.splice(f,0,g[p]);f+=g.length}c=0,a=0,u="",h="";break;default:throw new Error("Unknown diff operation.")}f++}return l.pop(),l}function It(n,t,e){let s;if(!n)return[[L,t]];if(!t)return[[E,n]];let r=n.length>t.length?n:t,i=n.length>t.length?t:n,o=r.indexOf(i);if(o!==-1)return s=[[L,r.substring(0,o)],[m,i],[L,r.substring(o+i.length)]],n.length>t.length&&(s[0][0]=E,s[2][0]=E),s;if(i.length===1)return[[E,n],[L,t]];let l=Pt(n,t);if(l){let f=l[0],a=l[1],c=l[2],u=l[3],h=l[4],g=k(f,c,e),p=k(a,u,e);return g.concat([[m,h]],p)}return e.checkLines&&n.length>100&&t.length>100?_t(n,t,e):Dt(n,t,e.deadline)}var vt=Object.defineProperty,rt=Object.getOwnPropertySymbols,Rt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable,st=(n,t,e)=>t in n?vt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,jt=(n,t)=>{for(var e in t||(t={}))Rt.call(t,e)&&st(n,e,t[e]);if(rt)for(var e of rt(t))$t.call(t,e)&&st(n,e,t[e]);return n},E=-1,L=1,m=0;function N(n,t,e){if(n===null||t===null)throw new Error("Null input. (diff)");let s=k(n,t,Ut(e||{}));return Bt(s),s}function k(n,t,e){let s=n,r=t;if(s===r)return s?[[m,s]]:[];let i=V(s,r),o=s.substring(0,i);s=s.substring(i),r=r.substring(i),i=j(s,r);let l=s.substring(s.length-i);s=s.substring(0,s.length-i),r=r.substring(0,r.length-i);let f=It(s,r,e);return o&&f.unshift([m,o]),l&&f.push([m,l]),f=q(f),f}function Nt(n){let t=1;return typeof n<"u"&&(t=n<=0?Number.MAX_VALUE:n),Date.now()+t*1e3}function Ut(n){return jt({checkLines:!0,deadline:Nt(n.timeout||1)},n)}function R(n,t,e){return e===1?n+t:t+n}function $(n,t){return t===1?[n.substring(0,n.length-1),n[n.length-1]]:[n.substring(1),n[0]]}function Ft(n,t,e,s){return s===1?n[t][1][n[t][1].length-1]===n[e][1][n[e][1].length-1]:n[t][1][0]===n[e][1][0]}function it(n,t,e){let s=e===1?-1:1,r=null,i=null,o=t+e;for(;o>=0&&o<n.length&&(r===null||i===null);o+=e){let[a,c]=n[o];if(c.length!==0){if(a===L){r===null&&(r=o);continue}else if(a===E){i===null&&(i=o);continue}else if(a===m){if(r===null&&i===null){let[u,h]=$(n[t][1],e);n[t][1]=u,n[o][1]=R(n[o][1],h,s);return}break}}}if(r!==null&&i!==null&&Ft(n,r,i,e)){let[a,c]=$(n[r][1],s),[u]=$(n[i][1],s);n[r][1]=a,n[i][1]=u,n[t][1]=R(n[t][1],c,e);return}let[l,f]=$(n[t][1],e);n[t][1]=l,r===null?(n.splice(o,0,[L,f]),i!==null&&i>=o&&i++):n[r][1]=R(n[r][1],f,s),i===null?n.splice(o,0,[E,f]):n[i][1]=R(n[i][1],f,s)}function Bt(n){for(let t=0;t<n.length;t++){let[e,s]=n[t];if(s.length===0)continue;let r=s[0],i=s[s.length-1];Ot(i)&&e===m&&it(n,t,1),Mt(r)&&e===m&&it(n,t,-1)}for(let t=0;t<n.length;t++)n[t][1].length===0&&n.splice(t,1)}function U(n){let t=n.map(u=>z(u)),e=!1,s=[],r=0,i=null,o=0,l=0,f=0,a=0,c=0;for(;o<t.length;)t[o][0]===m?(s[r++]=o,l=a,f=c,a=0,c=0,i=t[o][1]):(t[o][0]===L?a+=t[o][1].length:c+=t[o][1].length,i&&i.length<=Math.max(l,f)&&i.length<=Math.max(a,c)&&(t.splice(s[r-1],0,[E,i]),t[s[r-1]+1][0]=L,r--,r--,o=r>0?s[r-1]:-1,l=0,f=0,a=0,c=0,i=null,e=!0)),o++;for(e&&(t=q(t)),t=Vt(t),o=1;o<t.length;){if(t[o-1][0]===E&&t[o][0]===L){let u=t[o-1][1],h=t[o][1],g=tt(u,h),p=tt(h,u);g>=p?(g>=u.length/2||g>=h.length/2)&&(t.splice(o,0,[m,h.substring(0,g)]),t[o-1][1]=u.substring(0,u.length-g),t[o+1][1]=h.substring(g),o++):(p>=u.length/2||p>=h.length/2)&&(t.splice(o,0,[m,u.substring(0,p)]),t[o-1][0]=L,t[o-1][1]=h.substring(0,h.length-p),t[o+1][0]=E,t[o+1][1]=u.substring(p),o++),o++}o++}return t}var ot=/[^a-zA-Z0-9]/,lt=/\\s/,ft=/[\\r\\n]/,Ht=/\\n\\r?\\n$/,zt=/^\\r?\\n\\r?\\n/;function Vt(n){let t=n.map(r=>z(r));function e(r,i){if(!r||!i)return 6;let o=r.charAt(r.length-1),l=i.charAt(0),f=o.match(ot),a=l.match(ot),c=f&&o.match(lt),u=a&&l.match(lt),h=c&&o.match(ft),g=u&&l.match(ft),p=h&&r.match(Ht),O=g&&i.match(zt);return p||O?5:h||g?4:f&&!c&&u?3:c||u?2:f||a?1:0}let s=1;for(;s<t.length-1;){if(t[s-1][0]===m&&t[s+1][0]===m){let r=t[s-1][1],i=t[s][1],o=t[s+1][1],l=j(r,i);if(l){let h=i.substring(i.length-l);r=r.substring(0,r.length-l),i=h+i.substring(0,i.length-l),o=h+o}let f=r,a=i,c=o,u=e(r,i)+e(i,o);for(;i.charAt(0)===o.charAt(0);){r+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);let h=e(r,i)+e(i,o);h>=u&&(u=h,f=r,a=i,c=o)}t[s-1][1]!==f&&(f?t[s-1][1]=f:(t.splice(s-1,1),s--),t[s][1]=a,c?t[s+1][1]=c:(t.splice(s+1,1),s--))}s++}return t}function q(n){let t=n.map(a=>z(a));t.push([m,""]);let e=0,s=0,r=0,i="",o="",l;for(;e<t.length;)switch(t[e][0]){case L:r++,o+=t[e][1],e++;break;case E:s++,i+=t[e][1],e++;break;case m:s+r>1?(s!==0&&r!==0&&(l=V(o,i),l!==0&&(e-s-r>0&&t[e-s-r-1][0]===m?t[e-s-r-1][1]+=o.substring(0,l):(t.splice(0,0,[m,o.substring(0,l)]),e++),o=o.substring(l),i=i.substring(l)),l=j(o,i),l!==0&&(t[e][1]=o.substring(o.length-l)+t[e][1],o=o.substring(0,o.length-l),i=i.substring(0,i.length-l))),e-=s+r,t.splice(e,s+r),i.length&&(t.splice(e,0,[E,i]),e++),o.length&&(t.splice(e,0,[L,o]),e++),e++):e!==0&&t[e-1][0]===m?(t[e-1][1]+=t[e][1],t.splice(e,1)):e++,r=0,s=0,i="",o="";break;default:throw new Error("Unknown diff operation")}t[t.length-1][1]===""&&t.pop();let f=!1;for(e=1;e<t.length-1;)t[e-1][0]===m&&t[e+1][0]===m&&(t[e][1].substring(t[e][1].length-t[e-1][1].length)===t[e-1][1]?(t[e][1]=t[e-1][1]+t[e][1].substring(0,t[e][1].length-t[e-1][1].length),t[e+1][1]=t[e-1][1]+t[e+1][1],t.splice(e-1,1),f=!0):t[e][1].substring(0,t[e+1][1].length)===t[e+1][1]&&(t[e-1][1]+=t[e+1][1],t[e][1]=t[e][1].substring(t[e+1][1].length)+t[e+1][1],t.splice(e+1,1),f=!0)),e++;return f&&(t=q(t)),t}var W={checkLines:!0,timeout:10},qt=new TextDecoder("utf-8",{fatal:!1}),Wt=new TextEncoder,Xt=/[\\x00-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]/g,Gt=65280;function Qt(n,t){let e=[],s={};e[0]="";function r(l,f){let a="",c=0,u=-1,h=e.length;for(;u<l.length-1;){u=l.indexOf(\`
\`,c),u===-1&&(u=l.length-1);let g=l.slice(c,u+1);if(s.hasOwnProperty?s.hasOwnProperty(g):s[g]!==void 0){let p=s[g];p!==void 0&&(a+=String.fromCharCode(p))}else h===f&&(g=l.slice(c),u=l.length),a+=String.fromCharCode(h),s[g]=h,e[h++]=g;c=u+1}return a}let i=r(n,4e4),o=r(t,65535);return{chars1:i,chars2:o,lineArray:e}}function Yt(n,t){for(let e=0;e<n.length;e++){let s=n[e];if(s===void 0)continue;let r=s[1],i=[];for(let o=0;o<r.length;o++){let l=r.charCodeAt(o),f=t[l];f!==void 0&&(i[o]=f)}s[1]=i.join("")}}function at(n){return n.length===0?n:n.replace(Xt,"")}function ct(n){return typeof n=="string"?n:qt.decode(n)}function Jt(n){return Wt.encode(n)}function Kt(n){if(n.length===0)return 0;let t=1;for(let e=0;e<n.length;e++)n[e]===\`
\`&&t++;return n.endsWith(\`
\`)&&t--,t||1}function ut(n){let t=[];for(let e=0;e<n.length;e++){let s=n[e];if(s===void 0)continue;let[r,i]=s;if(i.length===0)continue;let o={value:i,added:r===L?!0:void 0,removed:r===E?!0:void 0,count:Kt(i)};t.push(o)}return t}function Zt(n,t){let e=[],s=new Map;function r(l){let f="",a=l.match(/\\S+|\\s+/g)||[];for(let c=0;c<a.length;c++){let u=a[c];if(u===void 0)continue;let h=s.get(u);if(h!==void 0)f+=String.fromCharCode(h+256);else{if(e.length>=Gt)return null;let g=e.length;e.push(u),s.set(u,g),f+=String.fromCharCode(g+256)}}return f}let i=r(n);if(i===null)return null;let o=r(t);return o===null?null:{chars1:i,chars2:o,wordArray:e}}function tn(n,t){for(let e=0;e<n.length;e++){let s=n[e];if(s===void 0)continue;let r=s[1],i=[];for(let o=0;o<r.length;o++){let l=r.charCodeAt(o)-256;if(l>=0&&l<t.length){let f=t[l];f!==void 0&&i.push(f)}}n[e]=[s[0],i.join("")]}}function nn(n,t){let e=Qt(n,t),s=N(e.chars1,e.chars2,{checkLines:!1,timeout:W.timeout});return Yt(s,e.lineArray),s}function ht(n,t){let e=N(n,t,{checkLines:!1,timeout:W.timeout});return U(e),e}function en(n,t){let e=Zt(n,t);if(e!==null){let s=N(e.chars1,e.chars2,{checkLines:!1,timeout:W.timeout});return tn(s,e.wordArray),U(s),s}return ht(n,t)}function rn(n){if(n.length===0)return n;let t=n[0];if(t===void 0)return[];let e=[],s=t[0],r=t[1];for(let i=1;i<n.length;i++){let o=n[i];if(o===void 0)continue;let l=o[0],f=o[1];l===s?r+=f:(r.length>0&&e.push([s,r]),s=l,r=f)}return r.length>0&&e.push([s,r]),e}var sn={async computeDiff(n,t,e){let s=ct(t),r=ct(e),i=at(s),o=at(r),l=nn(i,o),f=rn(l),a=ut(f),c=n==="words";if(n!=="lines"){let O=a.length;for(let b=0;b<O-1;b++){let y=a[b],w=a[b+1];if(!(y===void 0||w===void 0)&&y.removed===!0&&w.added===!0){let d;c?d=en(y.value,w.value):d=ht(y.value,w.value);let C=ut(d);y.parts=C,w.parts=C,b++}}}let h=JSON.stringify(a),p=Jt(h).buffer.slice(0);return H(p,[p])}};v(sn);})();
/*! Bundled license information:

comlink/dist/esm/comlink.mjs:
  (**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   *)
*/
`,workerName:"Diff Worker",validateOnInit:!0,maxConsecutiveErrors:3,errorResetTime:6e4});P(this,"decoder",new TextDecoder("utf-8"))}async validateWorker(){let n=this.ensureWorker();try{let o=await n.computeDiff("lines",`test line 1
test line 2`,`test line 1
modified line 2`),s=this.decoder.decode(o),a=JSON.parse(s);if(!Array.isArray(a))throw new Vn("Worker validation failed: returned invalid data type","VALIDATION_FAILED")}catch(r){throw r instanceof Vn?r:new Vn(`Worker validation failed: ${r instanceof Error?r.message:"Unknown error"}`,"VALIDATION_FAILED",{originalError:r})}}getProxy(){return this.ensureWorker()}};var Lg=class{constructor(){P(this,"consecutiveErrors",0);P(this,"lastErrorTime",0);P(this,"operationCount",0);P(this,"totalOperationTime",0);P(this,"maxConsecutiveErrors",3);P(this,"errorResetTime",6e4)}recordOperation(t){this.operationCount++,this.totalOperationTime+=t,Date.now()-this.lastErrorTime>this.errorResetTime&&(this.consecutiveErrors=0)}recordError(){this.consecutiveErrors++,this.lastErrorTime=Date.now()}getAverageOperationTime(){return this.operationCount>0?this.totalOperationTime/this.operationCount:0}isHealthy(){return this.consecutiveErrors<this.maxConsecutiveErrors}getStats(){return{consecutiveErrors:this.consecutiveErrors,operationCount:this.operationCount,averageOperationTime:this.getAverageOperationTime(),isHealthy:this.isHealthy()}}};var Rr=class extends Error{constructor(n,r,i){super(n);this.code=r;this.context=i;this.name="DiffManagerError"}};var Bx=class{constructor(t=100){P(this,"maxSize");P(this,"cache");P(this,"destroyed",!1);if(t<=0||!Number.isFinite(t)||!Number.isInteger(t))throw new Error("Cache maxSize must be a positive integer");this.maxSize=t,this.cache=new Map}get(t){if(this.destroyed)return;let n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(!this.destroyed){if(this.cache.has(t)&&this.cache.delete(t),this.cache.size>=this.maxSize){let r=this.cache.keys().next().value;r!==void 0&&this.cache.delete(r)}this.cache.set(t,n)}}has(t){return this.destroyed?!1:this.cache.has(t)}delete(t){return this.destroyed?!1:this.cache.delete(t)}clear(){this.destroyed||this.cache.clear()}get size(){return this.cache.size}getCapacity(){return this.maxSize}getStats(){return{size:this.cache.size,capacity:this.maxSize,utilization:this.cache.size/this.maxSize,isDestroyed:this.destroyed}}destroy(){this.cache.clear(),this.destroyed=!0}isDestroyed(){return this.destroyed}keys(){return this.cache.keys()}values(){return this.cache.values()}entries(){return this.cache.entries()}forEach(t,n){this.cache.forEach(t,n)}};var Fg=class{constructor(){P(this,"cache");this.cache=new Bx(50)}async has(t){return this.cache.has(t)}async get(t){return this.cache.get(t)}async set(t,n){this.cache.set(t,n)}async delete(t){this.cache.delete(t)}async keys(){return Array.from(this.cache.keys())}async clear(){this.cache.clear()}async getStats(){let t=this.cache.getStats();return{size:t.size,capacity:t.capacity,utilization:t.utilization}}};var cd=class{static generate(t,n,r,i){return`${t}:${n}:${r}:${i}`}static getNotePrefixPattern(t){return`${t}:`}};var Bg=class{constructor(){P(this,"encoder",new TextEncoder);P(this,"decoder",new TextDecoder("utf-8"))}async compute(t,n,r,i,o,s,a,l,c,u){let f=null,p,d;n instanceof ArrayBuffer?p=n.slice(0):p=this.encoder.encode(n).buffer.slice(0),r instanceof ArrayBuffer?d=r.slice(0):d=this.encoder.encode(r).buffer.slice(0);for(let h=1;h<=3;h++){let m,v;try{m=p.slice(0),v=d.slice(0);let g=performance.now(),y=await t.computeDiff(i,no(m,[m]),no(v,[v])),b=performance.now()-g;a(b);let w=this.decoder.decode(y),S=JSON.parse(w);return Ue(Ai(yS),S),o!=="current"&&await u(s,S),S}catch(g){f=g instanceof Error?g:new Error(String(g)),console.warn(`Version Control: Diff operation attempt ${h} failed`,f),h<3&&(await new Promise(y=>setTimeout(y,1e3*h)),(f.message.includes("cloned")||f.message.includes("terminated")||f.message.includes("channel closed"))&&await c())}}throw l(),new Rr(`Diff operation failed after ${3} attempts`,"DIFF_OPERATION_FAILED",{originalError:f})}};var ud=class{static validateParams(t,n,r,i){let o={noteId:t,version1Id:n,version2Id:r,diffType:i};Ue(ke({noteId:ae(te(),Ar(1)),version1Id:ae(te(),Ar(1)),version2Id:ae(te(),Ar(1)),diffType:hs(["lines","words","chars","smart"])}),o)}static validateContentSize(t,n){let r=typeof t=="string"?t.length:t.byteLength,i=typeof n=="string"?n.length:n.byteLength;if(r>10485760||i>10485760)throw new Rr("Content size exceeds maximum allowed size","CONTENT_TOO_LARGE")}};var zx=class extends fd.Component{constructor(n,r,i,o){super();this.app=n;this.versionManager=r;this.contentRepo=i;this.eventBus=o;P(this,"diffCache");P(this,"workerManager");P(this,"workerHealthMonitor");P(this,"diffComputer");P(this,"isInitializing",!1);P(this,"pendingOperations",new Set);P(this,"handleHistoryChange",n=>{if(typeof n!="string"||n.trim()===""){console.warn("Version Control: Received invalid noteId in handleHistoryChange");return}this.invalidateCacheForNote(n)});this.diffCache=new Fg,this.workerManager=new Vg,this.workerHealthMonitor=new Lg,this.diffComputer=new Bg}onload(){try{this.registerEventListeners(),this.initializeWorker(),this.register(()=>this.cleanup())}catch(n){throw console.error("Version Control: Failed to initialize DiffManager",n),this.cleanup(),new Rr(`DiffManager initialization failed: ${n instanceof Error?n.message:"Unknown error"}`,"INIT_FAILED",{originalError:n})}}registerEventListeners(){let n=["version-saved","version-deleted","history-deleted"];for(let r of n)this.eventBus.on(r,this.handleHistoryChange),this.register(()=>this.eventBus.off(r,this.handleHistoryChange))}async initializeWorker(){if(!(this.workerManager.isInitialized()||this.isInitializing)){this.isInitializing=!0;try{await this.workerManager.initializeAsync()}catch(n){throw console.error("Version Control: Failed to initialize the diff worker",n),this.workerManager.terminate(),n}finally{this.isInitializing=!1}}}async getContent(n,r){if(typeof n!="string"||n.trim()==="")throw new Rr("Invalid noteId: must be a non-empty string","INVALID_NOTE_ID");if(!r||typeof r!="object"||typeof r.id!="string"||r.id.trim()==="")throw new Rr("Invalid target or target.id","INVALID_TARGET");if(r.id==="current"){if(!r.notePath||typeof r.notePath!="string")throw new Rr("Current version requires a valid notePath","INVALID_NOTE_PATH");let i=this.app.vault.getAbstractFileByPath(r.notePath);if(!(i instanceof fd.TFile))throw new Rr(`Could not find current note file at path "${r.notePath}"`,"FILE_NOT_FOUND");let o=this.app.workspace.getActiveViewOfType(fd.MarkdownView);if(o?.file?.path===i.path)return o.editor.getValue();if(i.extension==="base")return await this.app.vault.adapter.read(i.path);try{return await this.app.vault.adapter.readBinary(i.path)}catch{return await this.app.vault.adapter.read(i.path)}}else{let i=await this.contentRepo.readBinary(n,r.id);if(i)return i;let o=await this.versionManager.getVersionContent(n,r.id);if(o===null)throw new Rr(`Could not retrieve content for version ${r.id}`,"VERSION_CONTENT_NOT_FOUND");return o}}async computeDiff(n,r,i,o,s,a){ud.validateParams(n,r,i,a),ud.validateContentSize(o,s);let l=cd.generate(n,r,i,a);if(i!=="current"&&await this.diffCache.has(l)){let u=await this.diffCache.get(l);if(u)return u}if(this.workerManager.isActive()||await this.initializeWorker(),!this.workerManager.isActive())throw new Rr("Diff worker unavailable","WORKER_UNAVAILABLE");if(!this.workerManager.isHealthy()&&(console.warn("Version Control: Worker health check failed, restarting worker"),await this.restartWorker(),!this.workerManager.isActive()))throw new Rr("Diff worker unavailable after restart","WORKER_UNAVAILABLE");let c=new Promise((u,f)=>{setTimeout(()=>f(new Rr("Diff operation timed out","OPERATION_TIMEOUT")),3e4)});try{let u=this.diffComputer.compute(this.workerManager.getProxy(),o,s,a,i,l,f=>{this.workerHealthMonitor.recordOperation(f),this.workerManager.recordOperation(f)},()=>{this.workerHealthMonitor.recordError(),this.workerManager.recordError()},()=>this.restartWorker(),(f,p)=>this.diffCache.set(f,p));return await Promise.race([u,c])}catch(u){throw this.workerHealthMonitor.recordError(),this.workerManager.recordError(),u}}async invalidateCacheForNote(n){if(typeof n!="string"||n.trim()==="")return;let r=cd.getNotePrefixPattern(n),i=[];try{let o=await this.diffCache.keys();for(let s of o)typeof s=="string"&&s.startsWith(r)&&i.push(s);for(let s of i)await this.diffCache.delete(s)}catch(o){console.error("Version Control: Error invalidating cache for note",o)}}cleanup(){Promise.allSettled(Array.from(this.pendingOperations)).then(()=>(this.workerManager.terminate(),this.diffCache.clear())).catch(n=>console.error("Version Control: Error during cleanup",n))}async restartWorker(){try{this.workerManager.terminate(),await this.initializeWorker()}catch(n){throw console.error("Version Control: Error restarting worker",n),new Rr("Worker restart failed","WORKER_RESTART_FAILED",{originalError:n})}}getWorkerStatus(){let n=this.workerManager.getStatus();return{isInitialized:n.isInitialized,isActive:n.isActive,isHealthy:n.isHealthy,healthStats:n.healthStats}}async getCacheStats(){try{let n=await this.diffCache.getStats();return{size:n.size,capacity:n.capacity,utilization:n.utilization}}catch(n){return console.error("Version Control: Error getting cache stats",n),{size:0,capacity:50,utilization:0}}}};var Hx=require("obsidian"),zg=class extends Hx.Component{constructor(t,n){super()}showNotice(t,n=5e3){new Hx.Notice(t,n)}};var Ux=class Ux{constructor(t){P(this,"plugin");P(this,"app");P(this,"eventBus");P(this,"queueService");P(this,"pathService");P(this,"storageService");P(this,"centralManifestRepo");P(this,"noteManifestRepo");P(this,"versionContentRepo");P(this,"timelineDatabase");P(this,"manifestManager");P(this,"noteManager");P(this,"versionManager");P(this,"timelineManager");P(this,"editHistoryManager");P(this,"compressionManager");P(this,"cleanupManager");P(this,"backgroundTaskManager");P(this,"exportManager");P(this,"diffManager");P(this,"uiService");P(this,"store");this.plugin=t,this.app=t.app,this.eventBus=new tw,this.queueService=new uw,this.pathService=new fw(t),this.storageService=new pw(this.app),this.compressionManager=new Vx,this.centralManifestRepo=new mw(t,this.queueService),this.noteManifestRepo=new hw(this.app,this.pathService,this.queueService,this.storageService),this.versionContentRepo=new gw(this.app,t,this.pathService,this.queueService,this.compressionManager,this.storageService),this.timelineDatabase=new Ew,this.manifestManager=new Nw(this.pathService,this.storageService,this.centralManifestRepo,this.noteManifestRepo),this.editHistoryManager=new _x(this.app,this.plugin,this.pathService,this.queueService),this.noteManager=new gx(t,this.app,this.manifestManager,this.editHistoryManager,this.eventBus),this.versionManager=new Cx(t,this.app,this.manifestManager,this.noteManager,this.versionContentRepo,this.eventBus,this.queueService,this.editHistoryManager),this.diffManager=new zx(this.app,this.versionManager,this.versionContentRepo,this.eventBus),this.timelineManager=new Tx(this.timelineDatabase,this.diffManager,this.versionManager,this.editHistoryManager,this.versionContentRepo,this.eventBus),this.cleanupManager=new kg(this.app,this.manifestManager,this.editHistoryManager,this.eventBus,this.pathService,this.queueService,this.versionContentRepo,t,this.storageService,{},this.noteManager),this.backgroundTaskManager=new _g({},t),this.exportManager=new Fx(this.app,this.versionManager,this.editHistoryManager,this.compressionManager),this.uiService=new zg(this.app,{})}finalizeInitialization(){this.cleanupManager=new kg(this.app,this.manifestManager,this.editHistoryManager,this.eventBus,this.pathService,this.queueService,this.versionContentRepo,this.plugin,this.storageService,this.store,this.noteManager),this.backgroundTaskManager=new _g(this.store,this.plugin),this.uiService=new zg(this.app,this.store)}getAllServices(){return{store:this.store,cleanupManager:this.cleanupManager,uiService:this.uiService,manifestManager:this.manifestManager,diffManager:this.diffManager,backgroundTaskManager:this.backgroundTaskManager,timelineManager:this.timelineManager,eventBus:this.eventBus,compressionManager:this.compressionManager,versionManager:this.versionManager,noteManager:this.noteManager,editHistoryManager:this.editHistoryManager,pathService:this.pathService,storageService:this.storageService,centralManifestRepo:this.centralManifestRepo,noteManifestRepo:this.noteManifestRepo,versionContentRepo:this.versionContentRepo,timelineDatabase:this.timelineDatabase,queueService:this.queueService,exportManager:this.exportManager,plugin:this.plugin,app:this.app}}async initializeWorkers(){let t=n=>new Promise(r=>setTimeout(r,n));if(!this.plugin.isUnloading){try{this.compressionManager&&this.compressionManager.initialize()}catch(n){console.error("Version Control: Failed to initialize Compression Worker",n)}if(await t(100),!this.plugin.isUnloading){try{this.editHistoryManager&&this.editHistoryManager.initialize()}catch(n){console.error("Version Control: Failed to initialize Edit History Worker",n)}if(await t(100),!this.plugin.isUnloading){try{this.timelineManager&&this.timelineManager.initialize()}catch(n){console.error("Version Control: Failed to initialize Timeline Worker",n)}await t(100)}}}}async initializeAll(){await this.initializeWorkers()}async cleanupAll(){try{this.centralManifestRepo?.invalidateCache(),this.noteManifestRepo?.clearCache(),this.queueService?.clearAll()}catch(t){console.warn("Version Control: Error clearing service caches",t)}try{await this.editHistoryManager?.terminate()}catch{}try{this.compressionManager?.terminate()}catch{}try{this.timelineDatabase?.terminate()}catch{}this.store=null,this.uiService=null,this.cleanupManager=null,this.backgroundTaskManager=null}static getInstance(t){if(!this.instance&&t&&(this.instance=new Ux(t)),!this.instance)throw new Error("ServiceRegistry not initialized. Call getInstance with a plugin first.");return this.instance}static resetInstance(){this.instance=null}};P(Ux,"instance",null);var gr=Ux;function mN(e,t,n){let r=e.branches[n];if(!r||!r.versions)return[];let i=Object.entries(r.versions).map(([o,s])=>({id:o,noteId:t,notePath:e.notePath,branchName:n,versionNumber:s.versionNumber,timestamp:s.timestamp,size:s.size,compressedSize:s.compressedSize,uncompressedSize:s.uncompressedSize,...s.name&&{name:s.name},...s.description&&{description:s.description},wordCount:s.wordCount,wordCountWithMd:s.wordCountWithMd,charCount:s.charCount,charCountWithMd:s.charCountWithMd,lineCount:s.lineCount,lineCountWithoutMd:s.lineCountWithoutMd}));return mr(i,["versionNumber"],["desc"])}function gee(e){let t=Object.values(e).map(r=>r.versionNumber);return(t.length>0?Math.max(...t):0)+1}function yee(e,t){return t===e}function hN(e,t){let n=!1;return e.currentBranch!==t&&(e.currentBranch=t,n=!0),e.branches[t]||(e.branches[t]={versions:{},totalVersions:0},n=!0),{dirty:n,activeBranch:t}}function vee(e,t,n){let r=new Date().toISOString();return{noteId:e,notePath:t,currentBranch:n,branches:{[n]:{versions:{},totalVersions:0}},createdAt:r,lastModified:r}}function bee(e,t){let n=e.branches[t];return n||(n={versions:{},totalVersions:0},e.branches[t]=n),n}var gN={showDescription:!1,showName:!0,showVersionNumber:!0,showPreview:!0,expandByDefault:!1};async function yc(e,t,n=2){let i=gr.getInstance().store;if(!i)return{error:{status:"CUSTOM_ERROR",error:"Store not initialized"}};let o=()=>e?i.getState().app.noteId===e:!0;for(let s=0;s<=n;s++){if(!o())return{error:{status:"CUSTOM_ERROR",error:"Context changed"}};try{let a=await t();return o()?{data:a}:{error:{status:"CUSTOM_ERROR",error:"Context changed"}}}catch(a){let l=String(a);if(!o())return{error:{status:"CUSTOM_ERROR",error:"Context changed"}};if(s===n)return console.error(`RTK Query failed after ${n} retries:`,a),{error:{status:"CUSTOM_ERROR",error:l}};await new Promise(c=>setTimeout(c,50*Math.pow(2,s)))}}return{error:{status:"CUSTOM_ERROR",error:"Unknown error"}}}var Ne=ew({reducerPath:"historyApi",baseQuery:wL(),tagTypes:["VersionHistory","EditHistory","Branches","Settings","Timeline"],keepUnusedDataFor:0,refetchOnMountOrArgChange:!0,endpoints:e=>({getVersionHistory:e.query({queryFn:t=>yc(t,async()=>{let r=await gr.getInstance().versionManager.getVersionHistory(t);return mr(r,["versionNumber"],["desc"])}),providesTags:(t,n,r)=>[{type:"VersionHistory",id:r}]}),getEditHistory:e.query({queryFn:t=>yc(t,async()=>{let n=gr.getInstance(),{editHistoryManager:r,manifestManager:i}=n,o=await i.loadNoteManifest(t);if(!o){let c=(await i.loadCentralManifest()).notes[t];if(c)try{o=await i.recoverMissingNoteManifest(t,c.notePath)}catch(u){console.error(`VC: Failed to recover manifest for note ${t}`,u)}}if(!o)return[];let s=o.currentBranch;await r.loadBranchFromDisk(t,s);let a=await r.getEditManifest(t);return a&&hN(a,s).dirty&&await r.saveEditManifest(t,a),!a||!a.branches[s]?.versions?[]:mN(a,t,s)}),providesTags:(t,n,r)=>[{type:"EditHistory",id:r}]}),getBranches:e.query({queryFn:t=>yc(t,async()=>{let r=await gr.getInstance().manifestManager.loadNoteManifest(t);return r?{currentBranch:r.currentBranch,availableBranches:Object.keys(r.branches)}:{currentBranch:"",availableBranches:[]}}),providesTags:(t,n,r)=>[{type:"Branches",id:r}]}),getEffectiveSettings:e.query({queryFn:t=>yc(t.noteId,async()=>{let n=gr.getInstance(),{noteId:r,viewMode:i}=t,o=i==="versions"?"version":"edit";if(!r){let s=n.plugin;return{...o==="version"?s.settings.versionHistorySettings:s.settings.editHistorySettings,isGlobal:!0}}return await to(r,o,n)}),providesTags:["Settings"]}),getVersionContent:e.query({queryFn:t=>yc(t.noteId,async()=>{let n=gr.getInstance(),{diffManager:r,editHistoryManager:i}=n,{noteId:o,versionId:s,viewMode:a}=t,l=new TextDecoder("utf-8"),c=null;if(a==="versions"?c=await r.getContent(o,{id:s}):c=await i.getEditContent(o,s),c===null)throw new Error("Content not found");return typeof c=="string"?c:l.decode(c)}),keepUnusedDataFor:0}),getDiff:e.query({queryFn:t=>yc(t.noteId,async()=>{let n=gr.getInstance(),{diffManager:r,editHistoryManager:i}=n,{noteId:o,v1:s,v2:a,diffType:l,viewMode:c}=t,u=new TextDecoder("utf-8"),f=async h=>{if(h.id==="current"){let v=await r.getContent(o,h);return typeof v=="string"?v:u.decode(v)}let m=null;if(c==="versions"?m=await r.getContent(o,h):m=await i.getEditContent(o,h.id),m===null)throw new Error(`Failed to fetch content for ${h.id}`);return typeof m=="string"?m:u.decode(m)},[p,d]=await Promise.all([f(s),f(a)]);return await r.computeDiff(o,s.id,a.id,p,d,l)}),keepUnusedDataFor:0}),getTimeline:e.query({queryFn:t=>yc(t.noteId,async()=>{let n=gr.getInstance(),{timelineManager:r,manifestManager:i,editHistoryManager:o}=n,{noteId:s,branchName:a,viewMode:l}=t,c=l==="versions"?"version":"edit",u={...gN};try{if(c==="version"){let p=await i.loadNoteManifest(s);if(p){let d=p.branches[a];d&&d.timelineSettings&&(u={...u,...d.timelineSettings})}}else{let p=await o.getEditManifest(s);if(p){let d=p.branches[a];d&&d.timelineSettings&&(u={...u,...d.timelineSettings})}}}catch(p){console.error("VC: Failed to load timeline settings",p)}return{events:await r.getOrGenerateTimeline(s,a,c),settings:u}}),providesTags:(t,n,{noteId:r})=>[{type:"Timeline",id:r}]}),updateTimelineSettings:e.mutation({queryFn:t=>yc(t.noteId,async()=>{let n=gr.getInstance(),{manifestManager:r,editHistoryManager:i}=n,{noteId:o,branchName:s,viewMode:a,settings:l}=t;if((a==="versions"?"version":"edit")==="version")await r.updateNoteManifest(o,u=>{let f=u.branches[s];f&&(f.timelineSettings={...gN,...f.timelineSettings||{},...l})});else{let u=await i.getEditManifest(o);if(u){let f=u.branches[s];f&&(f.timelineSettings={...gN,...f.timelineSettings||{},...l},await i.saveEditManifest(o,u))}}}),invalidatesTags:(t,n,{noteId:r})=>[{type:"Timeline",id:r}]})})}),{useGetVersionHistoryQuery:vc,useGetEditHistoryQuery:bc,useGetBranchesQuery:$x,useGetVersionContentQuery:ZB,useGetDiffQuery:JB,useGetEffectiveSettingsQuery:ez,useLazyGetDiffQuery:PDe,useGetTimelineQuery:tz,useUpdateTimelineSettingsMutation:nz}=Ne;function Ns(e,t,n=!1){return e.status!=="READY"?(n||(console.warn("Version Control: Manual save attempt while not in Ready state. Aborting.",e.status),t.showNotice("VC: Cannot save version, the view is not ready.",3e3)),!1):!0}function jx(e,t,n=!1){return e?!0:(n||t.showNotice("VC: Cannot save, no active file is selected.",3e3),!1)}function cl(e,t,n){return e?(t.showNotice(`Cannot ${n} while database is being renamed.`),!1):!0}function Ii(e,t){return e!==null&&t!==null}var Xu=Zt("editHistory/saveNewEdit",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=typeof e=="boolean"?{isAuto:e,allowInit:!e}:e||{isAuto:!1,allowInit:!0},{isAuto:s=!1,allowInit:a=!s}=o,l=n().app,c=r.uiService,u=r.app,f=r.editHistoryManager,p=r.noteManager,d=r.manifestManager,h=r.backgroundTaskManager,m=r.eventBus;if(!Ns(l,c,s))return i("Not ready");let v=l.file;if(!jx(v,c,s))return i("No file");if(s&&!a&&(!l.noteId||!await f.getEditManifest(l.noteId)))return null;try{let g=u.vault.getAbstractFileByPath(v.path);if(!(g instanceof rz.TFile))throw new Error("File not found");let y=l.noteId;if(!y){if(y=await p.getOrCreateNoteId(g),!y)throw new Error("Could not generate Note ID");let E=await d.loadNoteManifest(y);E||(E=await d.createNoteEntry(y,g.path)),t(H.actions.updateNoteIdInState({noteId:y})),t(Ne.util.invalidateTags([{type:"EditHistory",id:y}]))}let b=await u.vault.adapter.read(g.path),S=(await to(y,"edit",r)).maxVersionsPerNote,C=l.currentBranch||"main",x=await f.createEdit(y,C,b,v.path,S);if(q(r,n,{noteId:y}))return i("Context changed");if(x){let{entry:E,deletedIds:T}=x;return m.trigger("version-saved",y),s||(c.showNotice(`Edit #${E.versionNumber} saved.`),h.resetTimer("edit")),t(Ne.util.invalidateTags([{type:"EditHistory",id:y},{type:"Timeline",id:y}])),{newEditEntry:E,deletedIds:T}}else return s||c.showNotice("No changes detected since last edit."),null}catch(g){return console.error("VC: Failed to save edit",g),s||c.showNotice("Failed to save edit."),i(String(g))}});var iz=[/\.\.\//,/\.\.\\/,/\0/,/\\\.\./,/\/\.\.\//,/\\\\\.\.\\/],oz=[/\(\?=[^)]*\)/,/\(\?!.*\*.*\)/,/\*\*+/,/\(\?:.*\)\{2,\}/,/\\[pP]\{[^}]*\}/],sz=new Set(["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9",".","..","..."]);function qx(e){if(typeof e!="string")return{isValid:!1,error:`Invalid pattern type: expected string, got ${typeof e}`};let t=e.trim();if(t.length===0)return{isValid:!1,error:"Pattern cannot be empty or whitespace only"};if(t.length>1e4)return{isValid:!1,error:`Pattern too long: ${t.length} characters (max ${1e4})`,sanitized:t.substring(0,100)+"..."};for(let n of oz)if(n.test(t))return{isValid:!1,error:"Pattern contains potentially dangerous regex constructs",sanitized:t};return{isValid:!0,value:t,sanitized:t}}function yN(e){if(typeof e!="string")return{isValid:!1,error:`Invalid path type: expected string, got ${typeof e}`};let t=e.trim();if(t.length===0)return{isValid:!1,error:"Path cannot be empty or whitespace only"};if(t.length>260)return{isValid:!1,error:`Path too long: ${t.length} characters (max ${260})`,sanitized:t.substring(0,100)+"..."};for(let i of iz)if(i.test(t))return{isValid:!1,error:"Path contains traversal patterns",sanitized:t.replace(/\0/g,"").replace(/[\\/]/g,"/")};let n=t.replace(/\\/g,"/");n=n.replace(/\0/g,"");let r=n.split("/");for(let i of r){let o=i.toUpperCase();if(sz.has(o))return{isValid:!1,error:`Path contains reserved name: ${i}`,sanitized:n}}return{isValid:!0,value:n,sanitized:n}}function cz(e){if(e==null)return{isValid:!1,error:"Settings object is null or undefined"};if(typeof e!="object"||Array.isArray(e))return{isValid:!1,error:`Settings must be an object, got ${typeof e}`};let t=e;if(!("pathFilters"in t))return{isValid:!1,error:"Settings missing required property: pathFilters"};let n=t.pathFilters;if(!Array.isArray(n))return{isValid:!1,error:`pathFilters must be an array, got ${typeof n}`};let r=[],i=[];for(let o=0;o<n.length;o++){let s=n[o];if(s==null)continue;let a=qx(s);a.isValid&&a.value?r.push(a.value):a.error&&i.push(`Filter at index ${o}: ${a.error}`)}return i.length>0&&r.length===0?{isValid:!1,error:`All filters invalid: ${i.join("; ")}`}:{isValid:!0,value:Object.freeze([...r])}}var vN=class{constructor(){P(this,"cache",new Map);P(this,"metrics",{cacheHits:0,cacheMisses:0,compilations:0,validationFailures:0,totalProcessed:0})}get(t){this.metrics.totalProcessed++;let n=this.cache.get(t);return n?(this.metrics.cacheHits++,this.cache.delete(t),this.cache.set(t,{...n,timestamp:Date.now(),hitCount:n.hitCount+1}),n.regex):(this.metrics.cacheMisses++,null)}set(t,n){this.metrics.compilations++,this.cleanupExpired(),this.cache.size>=1e3&&this.evictLRU(),this.cache.set(t,{regex:n,timestamp:Date.now(),hitCount:1})}cleanupExpired(){let t=Date.now(),n=[];for(let[r,i]of this.cache)t-i.timestamp>3e5&&n.push(r);n.forEach(r=>this.cache.delete(r))}evictLRU(){if(this.cache.size===0)return;let t=null,n=Date.now();for(let[r,i]of this.cache)i.timestamp<n&&(n=i.timestamp,t=r);t&&this.cache.delete(t)}clear(){this.cache.clear(),this.resetMetrics()}getStats(){let t=this.metrics.cacheHits+this.metrics.cacheMisses,n=t>0?this.metrics.cacheHits/t*100:0;return{size:this.cache.size,hits:this.metrics.cacheHits,misses:this.metrics.cacheMisses,hitRate:parseFloat(n.toFixed(2))}}resetMetrics(){this.metrics={cacheHits:0,cacheMisses:0,compilations:0,validationFailures:0,totalProcessed:0}}},Gx=new vN;function uz(e){let t=qx(e);if(!t.isValid)return console.warn("Version Control: Pattern validation failed:",{pattern:t.sanitized||e.substring(0,50),error:t.error}),null;let n=t.value,r=Gx.get(n);if(r)return r;try{let i=new RegExp(n);return i.test("test-string-for-validation"),Gx.set(n,i),i}catch(i){let o=i instanceof Error?i.message:String(i),s=i instanceof Error?i.name:"UnknownError";return console.warn("Version Control: Regex compilation failed:",{pattern:n.substring(0,100),patternLength:n.length,errorType:s,errorMessage:o,timestamp:new Date().toISOString()}),null}}function fz(e,t){for(let n of t){let r=uz(n);if(r&&r.test(e))return!0}return!1}function Kx(e,t){let n=yN(e);if(!n.isValid)return console.debug("Version Control: Path validation failed",{error:n.error,sanitized:n.sanitized}),!1;let r=n.value,i=cz(t);if(!i.isValid)return console.debug("Version Control: Settings validation failed, defaulting to allow-all",{error:i.error}),!0;let o=i.value;if(o.length===0)return!0;try{return!fz(r,o)}catch(s){let a=s instanceof Error?s.message:String(s);return console.error("Version Control: Critical error in path filtering",{error:a,path:r,filterCount:o.length,timestamp:new Date().toISOString()}),!1}}var Nz=require("obsidian");var pz=ke({name:ie(te()),force:ie($e()),isAuto:ie($e()),settings:ie(Mi)}),dz=ke({name:ae(te(),rc()),description:ae(te(),rc())}),mz=ke({name:ae(te(),rc()),description:ae(te(),rc())}),hz=ae(te(),Ar(1)),cIe=ae(te(),Ar(1)),uIe=ae(te(),rc(),Ar(1)),fIe=ae(te(),rc(),Ar(1)),pIe=ae(te(),Ar(1));function gz(e,t,n,r=!1){let i=e instanceof Error?e.message:"An unexpected error occurred.";return console.error(`Version Control: Error in ${t} thunk.`,e),r||n.showNotice(`An unexpected error occurred while ${t}. Please check the console.`),i}function Hg(e,t,n,r,i=5e3){let o=e instanceof Error?e.message:"An unexpected error occurred.";return console.error(`Version Control: Error in ${t} thunk.`,e),r.showNotice(n,i),o}function yz(e,t,n,r){r!==n&&e(H.actions.updateNoteIdInState({noteId:n})),e(Ne.util.invalidateTags([{type:"VersionHistory",id:n},{type:"Branches",id:n},{type:"Timeline",id:n}]))}function vz(e,t,n){e.showNotice(`Version ${t} saved for "${n.basename}".`)}function bz(e,t,n){e.showNotice(`Version ${t} saved for "${n.basename}" in the background.`,4e3)}function Sz(e){e.showNotice("Content is identical to the latest version. No new version was saved.",4e3)}function wz(e,t,n){e.showNotice(`Successfully restored "${t.basename}" to version ${n.substring(0,6)}...`)}function xz(e){e.showNotice("Restore cancelled because the active note changed during backup.",5e3)}function Ez(e,t){e.showNotice(`Version ${t.substring(0,6)}... deleted successfully.`)}function Cz(e,t){e.showNotice(`Version deleted for "${t}" in the background.`,4e3)}function Tz(e,t){e.showNotice(`All versions for the current branch of "${t}" have been deleted.`)}function Az(e,t){e.showNotice(`All versions for "${t}" have been deleted in the background.`,5e3)}function Mz(e,t){e.showNotice(`Branch "${t}" created.`,3e3)}function Rz(e,t){e.showNotice(`Switched to branch "${t}".`)}var ul=Zt("version/saveNewVersion",async(e={},{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");try{Ue(pz,e)}catch(m){return console.error("Version Control: Invalid SaveVersionOptions",m),i("Invalid options")}let{isAuto:o=!1,allowInit:s=!o,settings:a}=e,l=r.uiService,c=n().app;if(!cl(c.isRenaming,l,"save version"))return i("Renaming in progress");let u=r.versionManager,f=r.manifestManager,p=r.app,d=r.backgroundTaskManager;if(!Ns(c,l,o))return i("Not ready");let h=c.file;if(!jx(h,l,o))return i("No file");if(o&&!s&&(!c.noteId||!await f.loadNoteManifest(c.noteId)))return null;try{let m=p.vault.getAbstractFileByPath(h.path);if(!(m instanceof Nz.TFile))return l.showNotice(`VC: Cannot save because the note "${h.basename}" may have been moved or deleted.`),t(Nr(void 0)),i("File not found");let v;if(a)v=a;else{let b=c.effectiveSettings;v={...c.settings,...b}}let g={isAuto:o,settings:v,...e.name!==void 0?{name:e.name}:{},...e.force!==void 0?{force:e.force}:{}},y=await u.saveNewVersionForFile(m,g);return o||d.resetTimer("version"),q(r,n,{filePath:h.path,status:"READY"})?(y.status==="saved"&&(bz(l,y.displayName,m),y.newNoteId&&t(Ne.util.invalidateTags([{type:"VersionHistory",id:y.newNoteId},{type:"Branches",id:y.newNoteId}]))),i("Context changed")):y.status==="duplicate"||y.status==="skipped_min_lines"?(!o&&y.status==="duplicate"&&Sz(l),null):y.newVersionEntry?(o||vz(l,y.displayName,m),y.newNoteId&&t(Ne.util.invalidateTags([{type:"VersionHistory",id:y.newNoteId},{type:"Branches",id:y.newNoteId}])),y):null}catch(m){return gz(m,"saveNewVersion",l,o),t(Nr(void 0)),i(m instanceof Error?m.message:String(m))}finally{q(r,n)||d.syncWatchMode()}});var Ds=Zt("core/loadEffectiveSettingsForNote",async(e,{getState:t,extra:n,rejectWithValue:r})=>{if(q(n,t))return r("Aborted");if(e)try{Ue(hz,e)}catch(c){return console.error("Invalid Note ID",c),r("Invalid Note ID")}if(!n.plugin?.settings)return console.warn("Version Control: Plugin settings not available in loadEffectiveSettingsForNote"),r("Settings unavailable");let i=n.plugin,a=t().app.viewMode==="versions"?"version":"edit",l;if(e)l=await to(e,a,n);else{let c=i.settings?.versionHistorySettings,u=i.settings?.editHistorySettings;l=a==="version"?{...c||fn.versionHistorySettings,isGlobal:!0}:{...u||fn.editHistorySettings,isGlobal:!0}}return q(n,t,e?{noteId:e}:void 0)?r("Context changed"):l}),Dz=Zt("core/autoRegisterNote",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=r.uiService,s=r.backgroundTaskManager;t(H.actions.initializeView({file:e,noteId:null,source:"none"}));try{let a=await t(ul({name:"Initial Version",isAuto:!0,allowInit:!0,force:!0,settings:n().app.settings}));if(ul.rejected.match(a))throw new Error(a.payload||"Auto-registration failed");let l=a.payload;if(q(r,n,{filePath:e.path}))return i("Context changed");l&&l.status==="saved"&&l.newNoteId&&(o.showNotice(`"${e.basename}" is now under version control.`),t(Ne.util.invalidateTags([{type:"VersionHistory",id:l.newNoteId},{type:"Branches",id:l.newNoteId},"Settings"])));return}catch(a){console.error(`Version Control: Failed to auto-register note "${e.path}".`,a);let l={title:"Auto-registration failed",message:`Could not automatically start version control for "${e.basename}".`,details:a instanceof Error?a.message:String(a)};return t(H.actions.reportError(l)),i(l.message)}finally{q(r,n)||s.syncWatchMode()}}),Nr=Zt("core/initializeView",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=r.app,s=r.noteManager,a=r.plugin,l=r.backgroundTaskManager;try{let c=null;if(e!==void 0)c=e;else{let h=o.workspace.getMostRecentLeaf();if(h?.view instanceof Ug.FileView)c=h;else{let m=o.workspace.getActiveViewOfType(Ug.FileView);if(m)c=m.leaf;else{let v=o.workspace.activeLeaf;v?.view instanceof Ug.FileView&&(c=v)}}}let u=null;if(c?.view instanceof Ug.FileView&&c.view.file&&(u=c.view.file),u||(u=o.workspace.getActiveFile()),u)t(H.actions.initializeView({file:u,noteId:null,source:"none"}));else{t(H.actions.clearActiveNote());return}let f=n().app.contextVersion,p;try{p=await s.getActiveNoteState(c)}catch(h){if(console.warn("Version Control: Failed to get active note state",h),u)p={file:u,noteId:null,source:"none"};else{t(H.actions.clearActiveNote());return}}if(p.file&&s.isPendingDeviation(p.file.path))return i("Pending deviation creation");if(q(r,n,{contextVersion:f}))return i("Context changed");if(p.file&&p.noteId){await s.verifyNoteIdMatchesPath(p.file,p.noteId);let h=await s.getActiveNoteState(c);h.noteId&&(p.noteId=h.noteId)}if(q(r,n,{contextVersion:f}))return i("Context changed");if(p.file&&!p.noteId){let h=a.settings?.versionHistorySettings||fn.versionHistorySettings,m=a.settings?.editHistorySettings||fn.editHistorySettings;if(h.autoRegisterNotes&&Kx(p.file.path,{pathFilters:h.pathFilters})){t(H.actions.setViewMode("versions")),t(Dz(p.file));return}if(m.autoRegisterNotes&&Kx(p.file.path,{pathFilters:m.pathFilters})){t(H.actions.setViewMode("edits")),t(Xu({isAuto:!0,allowInit:!0}));return}}if(q(r,n,{contextVersion:f}))return i("Context changed");t(H.actions.initializeView(p)),p.source==="manifest"&&p.file&&p.noteId&&t(Iz({file:p.file,noteId:p.noteId}));let d=n().app.contextVersion;if(p.file&&n().app.file?.path!==p.file.path)return i("Context changed");q(r,n,{contextVersion:d})||l.syncWatchMode();return}catch(c){console.error("Version Control: CRITICAL: Failed to initialize view.",c);let u={title:"Initialization failed",message:"Could not initialize the version control view.",details:c instanceof Error?c.message:String(c)};return q(r,n)||t(H.actions.reportError(u)),i(u.message)}}),Iz=Zt("core/reconcileNoteId",async({file:e,noteId:t},{getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");if(e.extension==="base")return;let o=r.noteManager,s=r.uiService;try{await o.writeNoteIdToFrontmatter(e,t)&&s.showNotice(`Version control: Restored missing vc-id for "${e.basename}".`,3e3);return}catch(a){console.error(`Version Control: Error during vc-id reconciliation for "${e.path}".`,a),s.showNotice(`VC: Failed to restore vc-id for "${e.basename}". Check the console for details.`,5e3);return}}),xee=Zt("core/cleanupOrphanedVersions",async(e,{getState:t,extra:n,rejectWithValue:r})=>{if(q(n,t))return r("Aborted");let i=t().app,o=n.uiService;if(i.isRenaming)return o.showNotice("Cannot clean up orphans while database is being renamed."),r("Renaming in progress");let s=n.cleanupManager;try{o.showNotice("Starting deep cleanup... this may take a moment.");let a=await s.cleanupOrphanedVersions();if(q(n,t))return r("Aborted");if(a.success){let{deletedNoteDirs:l,deletedVersionFiles:c,deletedDuplicates:u,deletedOrphans:f,recoveredNotes:p}=a,d=l+c+u+f,h=[];u>0&&h.push(`${u} duplicate IDs resolved`),p>0&&h.push(`${p} missing notes recovered`),f>0&&h.push(`${f} orphaned notes deleted`),l>0&&h.push(`${l} orphaned folders removed`),c>0&&h.push(`${c} orphaned version files removed`),d>0||p>0?o.showNotice(`Cleanup complete: ${h.join(", ")}.`,1e4):o.showNotice("Cleanup complete. No issues found.",5e3)}else o.showNotice("Cleanup finished with errors. Check console.",7e3);return}catch(a){return console.error("Version Control: Error during orphan cleanup thunk:",a),o.showNotice("An unexpected error occurred during cleanup. Check the console for details.",7e3),r(String(a))}}),Eee=Zt("core/loadHistory",async(e,{dispatch:t,extra:n,rejectWithValue:r})=>{try{let o=await n.noteManager.getNoteId(e);o&&t(Ne.util.invalidateTags([{type:"VersionHistory",id:o},{type:"EditHistory",id:o},{type:"Branches",id:o},"Settings"]));return}catch(i){return console.error("Failed to reload history",i),r(String(i))}});var Cee=vS(fn),H=Ga({name:"app",initialState:Cee,reducers:{updateSettings(e,t){e.settings={...e.settings,...t.payload}},updateEffectiveSettings(e,t){e.effectiveSettings=t.payload,e.noteId&&e.status==="LOADING"&&(e.status="READY")},reportError(e,t){e.status="ERROR",e.error=t.payload,e.isProcessing=!1},resetToInitializing(e){e.status="INITIALIZING",e.contextVersion+=1,e.currentBranch=null,e.availableBranches=[],e.panel=null,e.diffRequest=null,e.error=null,e.isProcessing=!1,e.isRenaming=!1,e.namingVersionId=null,e.isManualVersionEdit=!1,e.highlightedVersionId=null,e.watchModeCountdown=null,e.lastNoteId=null,e.lastFilePath=null},initializeView(e,t){let{file:n,noteId:r}=t.payload,i=!0;if(r?i=(e.noteId||e.lastNoteId)!==r:n&&(e.lastFilePath&&e.lastFilePath===n.path?i=!1:e.lastNoteId?i=!0:i=e.file?.path!==n.path),i&&(e.viewMode="versions",e.contextVersion+=1,e.effectiveSettings={...fn.versionHistorySettings,isGlobal:!0},e.panel?.type!=="changelog"&&(e.panel=null),e.isRenaming||(e.isProcessing=!1),e.currentBranch=null,e.availableBranches=[],e.diffRequest=null,e.highlightedVersionId=null,e.namingVersionId=null,e.isManualVersionEdit=!1,e.isSearchActive=!1,e.searchQuery="",e.watchModeCountdown=null,e.lastNoteId=null,e.lastFilePath=null),r&&(e.lastNoteId=r),n&&(e.lastFilePath=n.path),!n)e.status="PLACEHOLDER",e.file=null,e.noteId=null,e.currentBranch=null,e.availableBranches=[],e.panel?.type!=="changelog"&&(e.panel=null);else{if(e.status==="READY"&&!i&&!e.isProcessing&&e.noteId===r&&t.payload.source!=="manifest")return;e.file=n,e.noteId=r,e.currentBranch=null,e.availableBranches=[],r?e.status="LOADING":e.status="READY"}},setViewMode(e,t){let n=t.payload;e.viewMode=n,e.contextVersion+=1;let r=n==="versions"?fn.versionHistorySettings:fn.editHistorySettings;e.effectiveSettings={...r,isGlobal:!0},e.panel=null,e.namingVersionId=null,e.isManualVersionEdit=!1,e.highlightedVersionId=null,e.diffRequest=null,e.isSearchActive=!1,e.searchQuery="",e.watchModeCountdown=null},clearActiveNote(e){e.status="PLACEHOLDER",e.contextVersion+=1,e.file=null,e.noteId=null,e.currentBranch=null,e.availableBranches=[],e.panel?.type!=="changelog"&&(e.panel=null),e.isRenaming||(e.isProcessing=!1),e.error=null,e.isManualVersionEdit=!1},setProcessing(e,t){e.isProcessing=t.payload},setStatus(e,t){e.status=t.payload},setRenaming(e,t){e.isRenaming=t.payload},openPanel(e,t){let n=t.payload;if(n.type==="changelog"){(e.status==="INITIALIZING"||e.status==="READY"||e.status==="PLACEHOLDER"||e.status==="LOADING")&&(e.panel=n);return}let r=n.type==="action"||n.type==="confirmation";if(e.panel?.type==="description"&&r){e.panel={type:"stacked",base:e.panel,overlay:n};return}if(e.panel?.type==="stacked"&&r){e.panel.overlay=n;return}e.status==="READY"&&(e.panel=n,e.isProcessing=!1,e.namingVersionId=null,e.isSearchActive=!1,e.searchQuery="")},closePanel(e){if(e.panel?.type==="stacked"){e.panel=e.panel.base;return}(e.status==="INITIALIZING"||e.status==="READY"||e.status==="PLACEHOLDER"||e.status==="LOADING")&&(e.panel=null)},updateNoteIdInState(e,t){e.noteId=t.payload.noteId,e.lastNoteId=t.payload.noteId,e.status!=="READY"&&(e.status="READY")},startVersionEditing(e,t){e.status==="READY"&&(e.namingVersionId=t.payload.versionId,e.isManualVersionEdit=!0)},stopVersionEditing(e){e.status==="READY"&&(e.namingVersionId=null,e.isManualVersionEdit=!1)},toggleSearch(e,t){e.status==="READY"&&(e.isSearchActive=t.payload,t.payload?(e.panel=null,e.isSearchCaseSensitive=!1):(e.searchQuery="",e.isSearchCaseSensitive=!1))},setSearchQuery(e,t){e.status==="READY"&&(e.searchQuery=t.payload)},setSearchCaseSensitivity(e,t){e.status==="READY"&&(e.isSearchCaseSensitive=t.payload)},setSortOrder(e,t){e.status==="READY"&&(e.sortOrder=t.payload)},setHighlightedVersion(e,t){e.status==="READY"&&(e.highlightedVersionId=t.payload.versionId)},setDiffRequest(e,t){e.status==="READY"&&(e.diffRequest=t.payload)},clearDiffRequest(e){e.status==="READY"&&(e.diffRequest=null)},updateDiffPanelParams(e,t){e.panel?.type==="diff"&&(t.payload.diffType&&(e.panel.diffType=t.payload.diffType),t.payload.version1&&(e.panel.version1=t.payload.version1),t.payload.version2&&(e.panel.version2=t.payload.version2))},setWatchModeCountdown(e,t){(e.status==="READY"||e.status==="LOADING")&&(e.watchModeCountdown=t.payload)},setCurrentBranch(e,t){e.currentBranch=t.payload},setAvailableBranches(e,t){e.availableBranches=t.payload}},extraReducers:e=>{e.addCase(Ds.fulfilled,(t,n)=>{t.effectiveSettings=n.payload,t.noteId&&(t.status="READY")}),e.addCase(ul.fulfilled,(t,n)=>{if(t.isProcessing=!1,n.payload&&n.payload.newVersionEntry){n.payload.newNoteId&&t.noteId!==n.payload.newNoteId&&(t.noteId=n.payload.newNoteId,t.lastNoteId=n.payload.newNoteId,t.status="READY");let r=t.effectiveSettings.enableVersionNaming||t.effectiveSettings.enableVersionDescription;t.namingVersionId=r?n.payload.newVersionEntry.id:null,t.isManualVersionEdit=!1}}),e.addCase(Xu.fulfilled,(t,n)=>{if(t.isProcessing=!1,n.payload){let{newEditEntry:r}=n.payload,i=t.effectiveSettings.enableVersionNaming||t.effectiveSettings.enableVersionDescription;t.namingVersionId=i?r.id:null,t.isManualVersionEdit=!1}}),e.addMatcher(t=>t.type.endsWith("/pending")&&!t.type.startsWith("historyApi/")&&!t.type.startsWith("changelogApi/"),t=>{t.isProcessing=!0,t.error=null}),e.addMatcher(t=>t.type.endsWith("/rejected")&&!t.type.startsWith("historyApi/")&&!t.type.startsWith("changelogApi/"),(t,n)=>{if(n.payload==="Context changed"||n.payload==="Aborted"||n.error?.name==="AbortError"||n.error?.message==="Aborted")return;t.isProcessing=!1;let r=typeof n.payload=="string"?n.payload:n.error?.message||"An unexpected error occurred";t.error={title:"Operation Failed",message:r},t.status="ERROR"}),e.addMatcher(t=>t.type.endsWith("/fulfilled")&&!t.type.startsWith("historyApi/")&&!t.type.startsWith("changelogApi/"),t=>{t.isProcessing=!1})}}),{actions:qIe}=H,GIe=H.reducer;var Zu=ew({reducerPath:"changelogApi",baseQuery:cL({baseUrl:"/"}),endpoints:e=>({getChangelog:e.query({query:()=>({url:kV,responseHandler:t=>t.text()}),keepUnusedDataFor:3600})})}),{useGetChangelogQuery:Oz}=Zu;var SN=(e,t)=>xV({reducer:{app:H.reducer,[Zu.reducerPath]:Zu.reducer,[Ne.reducerPath]:Ne.reducer},preloadedState:{app:e},middleware:n=>n({serializableCheck:!1,thunk:{extraArgument:t}}).concat(Zu.middleware,Ne.middleware)});var TN={};Ua(TN,{createBranch:()=>EN,deleteAllVersions:()=>Fz,deleteBranch:()=>zz,deleteVersion:()=>Lz,openVersionPreview:()=>Dee,performAutoSave:()=>wN,requestDelete:()=>Ree,requestDeleteAll:()=>Nee,requestDeleteBranch:()=>CN,requestEditVersion:()=>Iee,requestRestore:()=>Aee,restoreVersion:()=>kz,saveNewVersion:()=>ul,switchBranch:()=>pd,updateVersionDetails:()=>Tee,viewVersionInPanel:()=>Bz});var wN=e=>async(t,n,r)=>{if(q(r,n))return;let i=r.noteManager;if(i.isPendingDeviation(e.path)||n().app.isRenaming)return;let s=r.manifestManager,a=r.plugin,l=await i.getNoteId(e)??await s.getNoteIdByPath(e.path);if(!l)return;let c=await to(l,"version",r),u={...a.settings,...c},f=await t(ul({name:"Auto-save",force:!1,isAuto:!0,settings:u}));if(ul.fulfilled.match(f)){let p=f.payload;if(p&&p.status==="saved"&&p.newVersionEntry){let d=n().app;d.status==="READY"&&d.file?.path===e.path&&d.noteId===l&&yz(t,p.newVersionEntry,p.newNoteId,d.noteId)}}};var Tee=(e,t)=>async(n,r,i)=>{if(q(i,r))return;try{Ue(dz,t)}catch(p){console.error("Version Control: Invalid UpdateVersionDetailsPayload",p);return}let o=i.uiService,s=r().app;if(!cl(s.isRenaming,o,"edit version"))return;let a=i.versionManager;if(s.status!=="READY")return;let l=s.noteId,c=s.file;if(!Ii(l,c))return;let u=l,f={name:t.name.trim(),description:t.description.trim()};try{await a.updateVersionDetails(u,e,f),i.eventBus.trigger("version-updated",u,e,f),n(Ne.util.invalidateTags([{type:"VersionHistory",id:u},{type:"Timeline",id:u}]))}catch(p){console.error(`VC: Failed to save details update for version ${e}.`,p),o.showNotice("VC: Error, could not save version details.",5e3),n(Ne.util.invalidateTags([{type:"VersionHistory",id:u}]))}finally{q(i,r)||n(H.actions.stopVersionEditing())}};var Pz=require("obsidian");var Aee=e=>(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY")return;let o=i.file;if(!o)return;let s=e.name?`"${e.name}" (V${e.versionNumber})`:`Version ${e.versionNumber}`;t(H.actions.openPanel({type:"confirmation",title:"Confirm restore",message:`This will overwrite the current content of "${o.basename}" with ${s}. A backup of the current content will be saved as a new version before restoring. Are you sure?`,onConfirmAction:kz(e.id)}))},kz=Zt("version/restoreVersion",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=r.uiService,s=n().app;if(!cl(s.isRenaming,o,"restore version"))return i("Renaming in progress");let a=r.versionManager,l=r.noteManager,c=r.backgroundTaskManager,u=r.plugin;if(s.status!=="READY")return i("Not ready");let f=s.file,p=s.noteId;if(!Ii(p,f))return i("Invalid context");let d=f,h=p;t(H.actions.closePanel());try{let m=r.app.vault.getAbstractFileByPath(d.path);if(!(m instanceof Pz.TFile))throw new Error(`Restore failed. Note "${d.basename}" may have been deleted or moved.`);let v=await l.getNoteId(m);if(v!==h)throw new Error(`Restore failed. Note's version control ID has changed or was removed. Expected "${h}", found "${v}".`);let g=await to(h,"version",r),y={...u.settings,...g};if(await a.saveNewVersionForFile(m,{name:`Backup before restoring V${e.substring(0,6)}...`,force:!0,isAuto:!1,settings:y}),q(r,n,{noteId:h,status:"READY"}))return xz(o),q(r,n)||t(Nr(void 0)),i("Context changed");await a.restoreVersion(m,h,e)&&wz(o,m,e),t(Ne.util.invalidateTags([{type:"VersionHistory",id:h}]));return}catch(m){let v=m instanceof Error?m.message:"An unexpected error occurred.";return Hg(m,"restoreVersion",`Restore failed: ${v}`,o,7e3),q(r,n)||t(Nr(void 0)),i(v)}finally{q(r,n)||c.syncWatchMode()}});var Vz=require("obsidian");var _z=Zt("editHistory/deleteEdit",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=n().app,s=r.editHistoryManager,a=r.uiService;if(!Ns(o,a))return i("Not ready");if(!Ii(o.noteId,o.file))return i("Invalid context");let l=o.noteId;t(H.actions.closePanel()),t(H.actions.clearDiffRequest());try{if(await s.deleteEditEntry(l,e),q(r,n,{noteId:l}))return i("Context changed");t(Ne.util.invalidateTags([{type:"EditHistory",id:l},{type:"Timeline",id:l}])),a.showNotice("Edit deleted.");return}catch(c){return console.error("VC: Failed to delete edit",c),a.showNotice("Failed to delete edit."),t(Ne.util.invalidateTags([{type:"EditHistory",id:l}])),i(String(c))}}),xN=Zt("editHistory/deleteAllEdits",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=n().app,s=r.editHistoryManager,a=r.uiService;if(!Ns(o,a))return i("Not ready");if(!Ii(o.noteId,o.file))return i("Invalid context");let l=o.noteId;t(H.actions.closePanel()),t(H.actions.clearDiffRequest());try{let c=await s.getEditManifest(l);if(!c)throw new Error("Manifest not found");let u=c.currentBranch,f=c.branches[u];if(!f){a.showNotice("No edits to delete.");return}let p=Object.keys(f.versions);if(p.length===0){a.showNotice("No edits to delete.");return}for(let d of p)await s.deleteEditEntry(l,d);if(q(r,n,{noteId:l}))return i("Context changed");t(Ne.util.invalidateTags([{type:"EditHistory",id:l},{type:"Timeline",id:l}])),a.showNotice("All edits in this branch deleted.");return}catch(c){return console.error("VC: Failed to delete all edits",c),a.showNotice("Failed to delete all edits."),t(Ne.util.invalidateTags([{type:"EditHistory",id:l}])),i(String(c))}}),Mee=e=>(t,n,r)=>{t(H.actions.openPanel({type:"confirmation",title:"Confirm delete edit",message:"Permanently delete this edit?",onConfirmAction:_z(e.id)}))};var Ree=e=>(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status==="READY"){let{file:o}=i;if(!o)return;let a=`Are you sure you want to permanently delete ${e.name?`"${e.name}" (V${e.versionNumber})`:`Version ${e.versionNumber}`} for "${o.basename}"? This action cannot be undone.`;t(H.actions.openPanel({type:"confirmation",title:"Confirm delete",message:a,onConfirmAction:Lz(e.id)}))}},Lz=Zt("version/deleteVersion",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=r.uiService,s=n().app;if(!cl(s.isRenaming,o,"delete version"))return i("Renaming in progress");let a=r.versionManager,l=r.noteManager,c=r.app;if(s.status!=="READY")return i("Not ready");let u=s.file,f=s.noteId;if(!Ii(f,u))return i("Invalid context");let p=u,d=f;t(H.actions.closePanel());try{let h=c.vault.getAbstractFileByPath(p.path);if(h instanceof Vz.TFile){let v=await l.getNoteId(h);if(v!==d&&v!==null)throw new Error(`Delete failed. Note's version control ID has changed. Expected "${d}", found "${v}".`)}let m=await a.deleteVersion(d,e);if(q(r,n,{noteId:d,filePath:p.path}))return m&&(Cz(o,p.basename),t(Ne.util.invalidateTags([{type:"VersionHistory",id:d}]))),i("Context changed");if(m){t(Ne.util.invalidateTags([{type:"VersionHistory",id:d}])),Ez(o,e);return}else throw new Error(`Failed to delete version ${e.substring(0,6)}...`)}catch(h){let m=h instanceof Error?h.message:"An unexpected error occurred.";return Hg(h,"deleteVersion",`Delete failed: ${m}`,o,7e3),q(r,n)||t(Nr(void 0)),i(m)}}),Nee=()=>(e,t,n)=>{if(q(n,t))return;let r=t().app;if(r.status==="READY"){let{file:i,currentBranch:o,viewMode:s}=r;if(!i||!o)return;let a=i.basename,l=s==="versions"?"version history":"edit history",c=s==="versions"?Fz():xN();e(H.actions.openPanel({type:"confirmation",title:`Delete all ${l}?`,message:`This will permanently delete all ${l} for the branch "${o}" of note "${a}". This action cannot be undone. Are you sure?`,onConfirmAction:c}))}},Fz=Zt("version/deleteAllVersions",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=r.uiService,s=n().app;if(!cl(s.isRenaming,o,"delete history"))return i("Renaming in progress");let a=r.versionManager;if(s.status!=="READY")return i("Not ready");let l=s.file,c=s.noteId;if(!Ii(c,l))return i("Invalid context");let u=l,f=c;t(H.actions.closePanel());try{let p=await a.deleteAllVersionsInCurrentBranch(f);if(q(r,n,{noteId:f,filePath:u.path}))return p&&(Az(o,u.basename),t(Ne.util.invalidateTags([{type:"VersionHistory",id:f}]))),i("Context changed");if(p){Tz(o,u.basename),t(Ne.util.invalidateTags([{type:"VersionHistory",id:f}]));return}else throw new Error(`Failed to delete all versions for "${u.basename}".`)}catch(p){let d=p instanceof Error?p.message:"An unexpected error occurred.";return Hg(p,"deleteAllVersions",`Delete all failed: ${d}`,o,7e3),q(r,n)||t(Nr(void 0)),i(d)}});var Bz=e=>async(t,n,r)=>{q(r,n)||t(H.actions.openPanel({type:"preview",version:e}))},Dee=Bz,Iee=e=>async(t,n,r)=>{q(r,n)||(t(H.actions.closePanel()),t(H.actions.startVersionEditing({versionId:e.id})))};var EN=e=>async(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY"||!i.noteId)return;let{noteId:o}=i,s=r.versionManager,a=r.uiService;try{if(await s.createBranch(o,e),q(r,n,{noteId:o}))return;t(H.actions.closePanel()),Mz(a,e),t(pd(e)),t(Ne.util.invalidateTags([{type:"Branches",id:o}]))}catch(l){console.error("VC: Failed to create branch.",l),a.showNotice(`Failed to create branch: ${l instanceof Error?l.message:"Unknown error"}`)}},pd=e=>async(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY"||!i.noteId||!i.file)return;let{noteId:o,file:s}=i,a=r.versionManager,l=r.manifestManager,c=r.uiService;t(H.actions.closePanel());try{await a.switchBranch(o,e),l.invalidateNoteManifestCache(o);let u=await l.loadNoteManifest(o);if(!u||u.currentBranch!==e)throw new Error(`Branch switch verification failed. Expected "${e}", got "${u?.currentBranch}".`);if(q(r,n,{noteId:o,filePath:s.path})||(await t(Ds(o)),q(r,n,{noteId:o,filePath:s.path})))return;t(Ne.util.invalidateTags([{type:"VersionHistory",id:o},{type:"EditHistory",id:o},{type:"Branches",id:o}])),r.backgroundTaskManager.syncWatchMode(),Rz(c,e)}catch(u){console.error("VC: Failed to switch branch.",u),c.showNotice(`Failed to switch branch: ${u instanceof Error?u.message:"Unknown error"}`),t(Ne.util.invalidateTags([{type:"VersionHistory",id:o}]))}};var CN=e=>async(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY"||!i.noteId)return;let s=await r.manifestManager.loadNoteManifest(i.noteId);if(q(r,n,{noteId:i.noteId})||!s)return;let a=Object.keys(s.branches).length<=1,l=i.currentBranch===e,c=i.file?.basename||"this note",u=`Are you sure you want to delete the branch "${e}"? This will permanently delete all versions and edit history associated with it.`;a?u=`WARNING: "${e}" is the only branch for "${c}". Deleting it will completely unregister the note from version control and delete ALL history. This action cannot be undone. Are you sure?`:l&&(u+=" You are currently on this branch."),t(H.actions.openPanel({type:"confirmation",title:a?"Delete Note History?":"Delete Branch?",message:u,onConfirmAction:zz(e)}))},zz=e=>async(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY"||!i.noteId)return;let{noteId:o}=i,s=r.versionManager,a=r.editHistoryManager,l=r.manifestManager,c=r.uiService;t(H.actions.setProcessing(!0)),t(H.actions.closePanel());try{let u=await l.loadNoteManifest(o);if(!u)throw new Error("Manifest not found.");let f=Object.keys(u.branches).length<=1;if(await a.deleteBranch(o,e),await s.deleteBranch(o,e),q(r,n,{noteId:o}))return;if(f)c.showNotice("Note unregistered from version control."),t(Nr(void 0));else if(c.showNotice(`Branch "${e}" deleted.`),t(Ne.util.invalidateTags([{type:"Branches",id:o}])),i.currentBranch===e){let p=await l.loadNoteManifest(o);if(p){let d=Object.keys(p.branches);if(d.length>0){let h=d[0];t(pd(h))}}}}catch(u){console.error("VC: Failed to delete branch.",u),c.showNotice(`Failed to delete branch: ${u instanceof Error?u.message:"Unknown error"}`),t(H.actions.setProcessing(!1))}};var AN={};Ua(AN,{closeSettingsPanelWithNotice:()=>zee,createDeviation:()=>_ee,openDashboard:()=>Hee,openPreview:()=>Uee,processQueuedChangelogRequest:()=>kee,showBranchSwitcher:()=>Fee,showChangelogPanel:()=>Uz,showNotice:()=>Bee,showSortMenu:()=>Lee,showVersionContextMenu:()=>Vee,toggleViewMode:()=>Pee});var Wx=[{id:"restore",title:"Restore this version",icon:"rotate-ccw",tooltip:"Restore current note to this version",actionHandler:(e,t)=>t.dispatch(Z.requestRestore(e))},{id:"diff",title:"Diff this version",icon:"diff",tooltip:"Compare this version with another",actionHandler:(e,t)=>t.dispatch(Z.requestDiff(e))},{id:"edit",title:"Edit Details",icon:"edit-3",tooltip:"Edit the name and description for this version",actionHandler:(e,t)=>t.dispatch(Z.requestEditVersion(e))},{id:"deviation",title:"Create new note from version",icon:"git-branch",tooltip:"Create a new note using this version's content",actionHandler:(e,t)=>t.dispatch(Z.createDeviation(e))},{id:"export-single",title:"Export this version",icon:"download",tooltip:"Export this specific version to a file",actionHandler:(e,t)=>t.dispatch(Z.requestExportSingleVersion(e))},{id:"delete",title:"Delete this version",icon:"trash-2",tooltip:"Permanently delete this version",isDanger:!0,actionHandler:(e,t)=>t.dispatch(Z.requestDelete(e))}];var Yx=[{id:"restore",title:"Restore this edit",icon:"rotate-ccw",tooltip:"Restore current note to this edit",actionHandler:(e,t)=>t.dispatch(Z.requestRestoreEdit(e))},{id:"diff",title:"Diff this edit",icon:"diff",tooltip:"Compare this edit with another",actionHandler:(e,t)=>t.dispatch(Z.requestDiff(e))},{id:"edit",title:"Edit Details",icon:"edit-3",tooltip:"Edit the name and description for this edit",actionHandler:(e,t)=>t.dispatch(Z.requestEditVersion(e))},{id:"deviation",title:"Create new note from edit",icon:"git-branch",tooltip:"Create a new note using this edit's content",actionHandler:(e,t)=>t.dispatch(Z.createDeviation(e))},{id:"export-single",title:"Export this edit",icon:"download",tooltip:"Export this specific edit to a file",actionHandler:(e,t)=>t.dispatch(Z.requestExportSingleVersion(e))},{id:"delete",title:"Delete this edit",icon:"trash-2",tooltip:"Permanently delete this edit",isDanger:!0,actionHandler:(e,t)=>t.dispatch(Z.requestDeleteEdit(e))}];var Oee=async e=>{try{let t=e.plugin,n=t.manifest.version;t.settings.version!==n&&(t.settings.version=n,await t.saveSettings())}catch(t){console.error("Version Control: Failed to save updated version to settings.",t)}},Hz=0,Pee=()=>async(e,t,n)=>{let r=Date.now();if(r-Hz<500||(Hz=r,q(n,t)))return;if(!n.plugin?.settings){console.warn("Version Control: Plugin settings not available in toggleViewMode");return}let i=t().app,o=i.viewMode,s=o==="versions"?"edits":"versions";if(i.file?.extension==="base"&&o==="versions"){let p=i.noteId,d=0;if(p&&(d=Ne.endpoints.getVersionHistory.select(p)(t()).data?.length??0),d===0){n.uiService.showNotice("Cannot access Edit History for base files until a version is saved.",5e3);return}}let a=n.plugin,l=s==="versions"?a.settings.versionHistorySettings:a.settings.editHistorySettings;e(H.actions.updateEffectiveSettings({...l,isGlobal:!0})),e(H.actions.setViewMode(s));let c=t().app.contextVersion,{noteId:u,file:f}=i;if(!(f&&!u)&&u&&f){if(await e(Ds(u)),q(n,t,{contextVersion:c}))return;q(n,t,{contextVersion:c})||n.backgroundTaskManager.syncWatchMode()}},Uz=(e={})=>async(t,n,r)=>{if(q(r,n))return;let{isManualRequest:i=!0}=e,o=r.plugin,s=n().app;if(!i){let a=s.status==="INITIALIZING"||s.status==="READY"||s.status==="PLACEHOLDER"||s.status==="LOADING",l=!s.panel||s.panel.type==="changelog";if(!a||!l){o.queuedChangelogRequest={forceRefresh:e.forceRefresh??!1,isManualRequest:!1};return}}o.queuedChangelogRequest=null,i&&s.panel&&t(H.actions.closePanel()),t(H.actions.openPanel({type:"changelog"})),await Oee(r)},kee=()=>(e,t,n)=>{if(q(n,t))return;let r=n.plugin,i=r.queuedChangelogRequest;i&&(r.queuedChangelogRequest=null,e(Uz(i)))},_ee=e=>async(t,n,r)=>{if(q(r,n))return;let i=r.uiService,o=r.app,s=n().app;if(s.isRenaming){i.showNotice("Cannot create deviation while database is being renamed.");return}if(s.status!=="READY"||!s.noteId||s.noteId!==e.noteId){i.showNotice("VC: Cannot create a deviation from this version/edit because the note context changed.");return}let l=o.vault.getAllFolders().map(u=>({id:u.path,data:u,text:u.isRoot()?"/":u.path})),c=u=>async(f,p,d)=>{if(q(d,p))return;let h=d.versionManager,m=d.editHistoryManager;if(f(H.actions.closePanel()),q(d,p,{noteId:e.noteId,status:"READY"})){i.showNotice("VC: Deviation cancelled because the note context changed during folder selection.");return}try{let v=null;if(p().app.viewMode==="versions")v=await h.createDeviation(e.noteId,e.id,u);else{let y=await m.getEditContent(e.noteId,e.id);if(!y)throw new Error("Could not load edit content.");let b=`(from Edit #${e.versionNumber})`;v=await h.createDeviationFromContent(e.noteId,y,u,b)}v&&(i.showNotice(`Created new note "${v.basename}"...`,5e3),await o.workspace.getLeaf(!0).openFile(v))}catch(v){console.error("Version Control: Error creating deviation.",v),i.showNotice("VC: Failed to create a new note from this version/edit. Check the console for details.")}};t(H.actions.openPanel({type:"action",title:"Create new note in...",items:l,onChooseAction:c,showFilter:!0}))},Vee=e=>(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY"||i.noteId!==e.noteId)return;let o=i.viewMode==="edits",s=o?Yx:Wx,a=o?"Edit #":"V",l=s.map(u=>({id:u.id,data:u.id,text:u.title,subtext:u.tooltip,icon:u.icon})),c=u=>(f,p,d)=>{let h=s.find(m=>m.id===u);if(h){let m=d.store;h.actionHandler(e,m)}};t(H.actions.openPanel({type:"action",title:`Actions for ${a}${e.versionNumber}`,items:l,onChooseAction:c,showFilter:!1}))},Lee=()=>(e,t,n)=>{if(q(n,t))return;let r=t().app;if(r.status!=="READY")return;let o=[{label:"Version (new to old)",property:"versionNumber",direction:"desc"},{label:"Version (old to new)",property:"versionNumber",direction:"asc"},{label:"Timestamp (new to old)",property:"timestamp",direction:"desc"},{label:"Timestamp (old to new)",property:"timestamp",direction:"asc"},{label:"Name (A to Z)",property:"name",direction:"asc"},{label:"Name (Z to A)",property:"name",direction:"desc"},{label:"Size (largest to smallest)",property:"size",direction:"desc"},{label:"Size (smallest to largest)",property:"size",direction:"asc"}].map(a=>{let l=r.sortOrder.property===a.property&&r.sortOrder.direction===a.direction;return{id:`${a.property}-${a.direction}`,data:{property:a.property,direction:a.direction},text:a.label,icon:"blank",isSelected:l}}),s=a=>l=>{l(H.actions.setSortOrder(a)),l(H.actions.closePanel())};e(H.actions.openPanel({type:"action",title:"Sort by",items:o,onChooseAction:s,showFilter:!1}))},Fee=()=>(e,t,n)=>{if(q(n,t))return;let r=t().app;if(r.status!=="READY"||!r.noteId)return;let{availableBranches:i,currentBranch:o}=r,s=i.map(f=>({id:f,data:f,text:f,isSelected:f===o})),a=f=>p=>{p(pd(f))},l=f=>p=>{p(EN(f))},c=f=>f.id==="__create__"?[]:[{id:"delete",data:"delete",text:"Delete Branch",icon:"trash"}],u=(f,p)=>d=>{f==="delete"&&d(CN(p))};e(H.actions.openPanel({type:"action",title:"Switch or create branch",items:s,onChooseAction:a,onCreateAction:l,contextActions:c,onContextAction:u,showFilter:!0}))},Bee=(e,t)=>(n,r,i)=>{if(q(i,r))return;i.uiService.showNotice(e,t)},zee=(e,t)=>(n,r,i)=>{if(q(i,r))return;let o=i.uiService;n(H.actions.closePanel()),o.showNotice(e,t)},Hee=()=>(e,t,n)=>{q(n,t)||t().app.status!=="READY"||e(H.actions.openPanel({type:"dashboard"}))},Uee=e=>(t,n,r)=>{q(r,n)||t(H.actions.openPanel({type:"preview",version:e}))};var MN={};Ua(MN,{generateDiffBackground:()=>$z,recomputeDiff:()=>qee,requestDiff:()=>$ee,scrollToLineInEditor:()=>Gee,viewReadyDiff:()=>jee});var dd=require("obsidian");var $ee=e=>async(t,n,r)=>{if(q(r,n))return;let i=r.uiService,o=n(),s=o.app;if(s.status!=="READY"||!s.noteId||!s.file){i.showNotice("Cannot start diff: view context has changed.",3e3);return}let{viewMode:a,noteId:l}=s,c=[];a==="versions"?c=Ne.endpoints.getVersionHistory.select(l)(o).data||[]:c=Ne.endpoints.getEditHistory.select(l)(o).data||[];let u=c.filter(m=>m.id!==e.id),d=[{id:"current",name:"Current Note State",timestamp:new Date().toISOString(),notePath:s.file.path},...u].map(m=>{if("versionNumber"in m){let v=m,g=v.name?`V${v.versionNumber}: ${v.name}`:`Version ${v.versionNumber}`;return{id:v.id,data:v,text:g,subtext:(0,dd.moment)(v.timestamp).format("LLLL")}}else return{id:m.id,data:m,text:m.name,subtext:"The current, unsaved content of the note."}}),h=m=>v=>{v($z(e,m))};t(H.actions.openPanel({type:"action",title:"Compare with...",items:d,onChooseAction:h,showFilter:!0}))},$z=(e,t)=>async(n,r,i)=>{if(q(i,r))return;n(H.actions.closePanel());let o=r().app;if(o.status!=="READY"||!o.noteId)return;let{noteId:s,viewMode:a}=o;n(H.actions.updateDiffPanelParams({version1:e,version2:t,diffType:"lines"}));let l={status:"generating",version1:e,version2:t,diffType:"lines",diffChanges:null,content1:"",content2:""};n(H.actions.setDiffRequest(l));try{let c=await n(Ne.endpoints.getDiff.initiate({noteId:s,v1:e,v2:t,diffType:"lines",viewMode:a})).unwrap();if(q(i,r,{noteId:s}))return;n(H.actions.setDiffRequest({...l,status:"ready",diffChanges:c})),i.uiService.showNotice("Diff generated. Click the icon in the action bar to view.",3e3)}catch(c){console.error("Diff generation failed",c),i.uiService.showNotice("Failed to generate diff.",4e3),n(H.actions.clearDiffRequest())}},jee=(e="panel")=>(t,n,r)=>{if(q(r,n))return;let i=n().app;if(i.status!=="READY"||!i.diffRequest||i.diffRequest.status!=="ready")return;let{version1:o,version2:s,diffType:a}=i.diffRequest;t(H.actions.openPanel({type:"diff",version1:o,version2:s,diffType:a,renderMode:e}))},qee=e=>async(t,n,r)=>{if(q(r,n))return;t(H.actions.updateDiffPanelParams({diffType:e}));let i=n().app;i.diffRequest&&t(H.actions.setDiffRequest({...i.diffRequest,diffType:e}))},Gee=e=>(t,n,r)=>{if(q(r,n))return;let i=n().app,o=r.uiService,s=r.app;if(i.status!=="READY"||!i.file){o.showNotice("Cannot scroll: no active note in version control view.",4e3);return}if(i.file.extension==="base"||i.panel?.type!=="diff")return;let l=i.file.path,c=null,u=s.workspace.getMostRecentLeaf?.();if(u?.view instanceof dd.FileView&&u.view.file?.path===l?c=u:c=s.workspace.getLeavesOfType("markdown").find(y=>y.view instanceof dd.MarkdownView&&y.view.file?.path===l)||null,!c){let g=l.split("/").pop()??l;o.showNotice(`Note "${g}" is not currently open. Cannot scroll.`,4e3);return}let f=c.view;if(!f.editor){o.showNotice("Cannot scroll: active view is not an editor.",3e3);return}if(f.getMode()!=="source"){o.showNotice("Cannot scroll to line: note is in Reading view.",3e3);return}let p=f.editor;s.workspace.setActiveLeaf(c,{focus:!0});let d=Math.max(0,e-1),h=Math.min(d,Math.max(0,p.lineCount()-1)),v=(p.getLine(h)??"").length;p.setCursor({line:h,ch:v}),p.scrollIntoView({from:{line:h,ch:0},to:{line:h,ch:0}},!0)};var zN={};Ua(zN,{createGlobalSettingsMarker:()=>hd,createIndependentSettingsFromGlobal:()=>md,exportAllVersions:()=>Qx,exportSingleVersion:()=>Xx,mergeEditHistorySettings:()=>Xg,mergeGlobalSettings:()=>Yg,mergeVersionHistorySettings:()=>Qg,renameDatabasePath:()=>PN,requestExportAllVersions:()=>FN,requestExportSingleVersion:()=>BN,requestKeyUpdate:()=>IN,requestUpdateIdFormats:()=>ON,safeValidate:()=>RN,strictValidate:()=>NN,toggleGlobalSettings:()=>kN,updateGlobalSettings:()=>Sc,updateLegacyKeys:()=>Zg,updateSettings:()=>_N,validateDatabasePath:()=>Wg,validateFrontmatterKey:()=>qg,validateGlobalSettings:()=>$g,validateHistorySettingsUpdate:()=>jg,validateNoteIdFormat:()=>Gg,validateVersionIdFormat:()=>Kg});var DN=require("obsidian");Ti();function $g(e){try{return{success:!0,data:Ue(Mi,e)}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Validation failed"}}}function jg(e){let t=un(hS(Ro),e);return t.success?{success:!0,data:t.output}:{success:!1,error:t.issues[0]?.message??"Invalid settings data"}}function qg(e){let t=un(Mi.entries.noteIdFrontmatterKey,e);return t.success?{success:!0,data:t.output}:{success:!1,error:t.issues[0]?.message??"Invalid frontmatter key"}}function Gg(e){let t=un(Mi.entries.noteIdFormat,e);return t.success?{success:!0,data:t.output}:{success:!1,error:t.issues[0]?.message??"Invalid note ID format"}}function Kg(e){let t=un(Mi.entries.versionIdFormat,e);return t.success?{success:!0,data:t.output}:{success:!1,error:t.issues[0]?.message??"Invalid version ID format"}}function Wg(e){let t=un(Mi.entries.databasePath,e);return t.success?{success:!0,data:t.output}:{success:!1,error:t.issues[0]?.message??"Invalid database path"}}function RN(e,t){let n=un(e,t);return n.success?{success:!0,data:n.output}:{success:!1,issues:IV(n.issues).nested}}function NN(e,t){return Ue(e,t)}Ti();function Yg(e,t){return Wt(e,n=>{Object.assign(n,t)})}function Qg(e,t){return Wt(e,n=>{Object.assign(n,t)})}function Xg(e,t){return Wt(e,n=>{Object.assign(n,t)})}function Zg(e,t){let n=e||[];return Array.from(new Set([...n,t]))}function md(e){return{...e,isGlobal:!1}}function hd(){return{isGlobal:!0}}var Sc=e=>async(t,n,r)=>{if(q(r,n))return;let i=r.plugin,o=r.uiService,s=r.backgroundTaskManager;try{let a=Yg(i.settings,e),l=$g(a);if(!l.success)throw new Error(l.error);i.settings=a,await i.saveSettings(),t(H.actions.updateSettings(e)),s.syncWatchMode(),t(Ne.util.invalidateTags(["Settings"]))}catch(a){console.error("VC: Failed to update global settings.",a),o.showNotice("Failed to save global settings due to validation error.",5e3)}},IN=e=>async(t,n,r)=>{if(q(r,n))return;let i=r.plugin,o=r.uiService,s=i.settings.noteIdFrontmatterKey,a=e.trim(),l=qg(a);if(!l.success){o.showNotice(l.error??"Invalid frontmatter key.",3e3);return}if(a===s)return;let c=i.settings.legacyNoteIdFrontmatterKeys,u=Zg(c,s);t(Sc({noteIdFrontmatterKey:a,legacyNoteIdFrontmatterKeys:u})),o.showNotice(`Frontmatter key updated to "${a}". Legacy keys will be migrated lazily.`,4e3)},ON=(e,t)=>(n,r,i)=>{if(q(i,r))return;let o=i.plugin,s=i.uiService,a=o.settings.noteIdFormat,l=o.settings.versionIdFormat;if(e===a&&t===l)return;let c=Gg(e),u=Kg(t);if(!c.success||!u.success){s.showNotice("Invalid ID format settings.",3e3);return}n(H.actions.openPanel({type:"confirmation",title:"Update ID Formats?",message:`You are about to change the ID generation formats. This will affect how new notes and versions are identified. Existing IDs will remain unchanged. 

New Note ID Format: ${e}
New Version ID Format: ${t}

Are you sure you want to apply these changes?`,onConfirmAction:Kee(e,t)}))},Kee=(e,t)=>async(n,r,i)=>{q(i,r)||(n(H.actions.closePanel()),n(Sc({noteIdFormat:e,versionIdFormat:t})))},PN=e=>async(t,n,r)=>{if(q(r,n))return;let i=r.app,o=r.uiService,s=r.manifestManager,a=r.plugin,l=r.storageService;if(n().app.isRenaming){o.showNotice("A rename operation is already in progress.");return}let u=a.settings.databasePath,f=(0,DN.normalizePath)(e.trim()),p=Wg(f);if(!p.success){o.showNotice(p.error??"Invalid database path.",3e3);return}if(u===f)return;if(i.vault.getAbstractFileByPath(f)){o.showNotice(`Cannot move database: an item already exists at "${f}".`,5e3);return}t(H.actions.setRenaming(!0)),o.showNotice(`Renaming database to "${f}"... Please wait.`);try{await l.renameFolder(u,f);let h=a.settings.centralManifest,m=Wt(h,v=>{for(let g in v.notes){let y=v.notes[g];y&&(y.manifestPath=(0,DN.normalizePath)(y.manifestPath.replace(u,f)))}});a.settings.databasePath=f,a.settings.centralManifest=m,await a.saveSettings(),t(H.actions.updateSettings({databasePath:f,centralManifest:m})),s.invalidateCentralManifestCache(),o.showNotice(`Database successfully moved to "${f}".`,5e3),t(Nr(void 0))}catch(h){let m=h instanceof Error?h.message:"Unknown error";if(console.error(`VC: Failed to rename database from "${u}" to "${f}".`,h),o.showNotice(`Failed to move database: ${m}. Attempting to revert.`,7e3),await i.vault.adapter.exists(f))try{await i.vault.adapter.rename(f,u),o.showNotice("Reverted database move. Please check your vault.",5e3)}catch{o.showNotice(`CRITICAL: Failed to revert database move. The database may be at "${f}". Manual correction needed.`,0)}}finally{q(r,n)||t(H.actions.setRenaming(!1))}};var kN=e=>async(t,n,r)=>{if(q(r,n))return;let i=n().app,o=r.uiService,s=r.manifestManager,a=r.editHistoryManager,l=r.plugin;if(i.status!=="READY"||!i.noteId){o.showNotice("A versioned note must be active to change this setting.",4e3);return}let{noteId:c,viewMode:u}=i;try{if(u==="versions")if(e)await s.updateNoteManifest(c,f=>{let p=f.branches[f.currentBranch];p&&(p.settings=hd())}),o.showNotice("Note versions now follow global settings.",3e3);else{let f=l.settings.versionHistorySettings;await s.updateNoteManifest(c,p=>{let d=p.branches[p.currentBranch];d&&(d.settings=md(f))}),o.showNotice("Note versions now have independent settings.",3e3)}else{let f=await a.getEditManifest(c);if(!f){o.showNotice("Edit history not initialized.",3e3);return}if(e)f.branches[f.currentBranch].settings=hd();else{let p=l.settings.editHistorySettings;f.branches[f.currentBranch].settings=md(p)}await a.saveEditManifest(c,f),o.showNotice(`Note edits now ${e?"follow global":"have independent"} settings.`,3e3)}if(q(r,n,{noteId:c,viewMode:u}))return;t(Ne.util.invalidateTags(["Settings"])),t(Ds(c))}catch(f){console.error(`VC: Failed to toggle global settings for note ${c}.`,f),o.showNotice("Failed to update settings. Please try again.",5e3),q(r,n,{noteId:c})||t(Ds(c))}},_N=e=>async(t,n,r)=>{if(q(r,n))return;let i=n().app,o=r.uiService;if(i.isRenaming){o.showNotice("Cannot change settings while database is being renamed.");return}let s=r.manifestManager,a=r.editHistoryManager,l=r.backgroundTaskManager,c=r.plugin,{noteId:u,file:f,viewMode:p}=i,d=i.effectiveSettings.isGlobal,h=jg(e);if(!h.success){console.error("VC: Invalid settings update.",h.error),o.showNotice("Failed to save settings: Invalid data.",5e3);return}f&&(e.hasOwnProperty("autoSaveOnSaveInterval")||e.hasOwnProperty("autoSaveOnSave"))&&(c.autoSaveDebouncers.get(f.path)?.debouncer.cancel(),c.autoSaveDebouncers.delete(f.path)),t(H.actions.updateEffectiveSettings({...i.effectiveSettings,...e})),l.syncWatchMode();try{if(d)if(p==="versions"){let m=Qg(c.settings.versionHistorySettings,e);t(Sc({versionHistorySettings:m}))}else{let m=Xg(c.settings.editHistorySettings,e);t(Sc({editHistorySettings:m}))}else{if(!u)throw new Error("Cannot save per-note settings without an active note ID.");if(p==="versions")await s.updateNoteManifest(u,m=>{let v=m.branches[m.currentBranch];v&&(v.settings||(v.settings={}),v.settings.isGlobal=!1,Object.assign(v.settings,e))});else{let m=await a.getEditManifest(u);if(m){let v=m.branches[m.currentBranch];if(v){v.settings||(v.settings={}),v.settings.isGlobal=!1,Object.assign(v.settings,e);let g=e.hasOwnProperty("enableDiskPersistence");await a.saveEditManifest(u,m,g)}}}}t(Ne.util.invalidateTags(["Settings"]))}catch(m){console.error("VC: Failed to update settings. Reverting UI.",m),o.showNotice("Failed to save settings. Reverting.",5e3),q(r,n,{noteId:u||null})||t(Ds(u))}};var VN={md:"file-text",json:"braces",ndjson:"list-ordered",txt:"file-code",zip:"archive",gzip:"archive"},LN=["md","json","ndjson","txt","zip","gzip"];var jz=(e,t,n,r,i)=>{let o=n.app,s=n.uiService,l=o.vault.getAllFolders().map(u=>({id:u.path,data:u,text:u.isRoot()?"/":u.path})),c=u=>async(f,p)=>{if(f(H.actions.closePanel()),q(n,t,{noteId:r,status:"READY"})){s.showNotice("VC: Export cancelled because the note context changed during folder selection.");return}await i(u)};e(H.actions.openPanel({type:"action",title:"Export to folder...",items:l,onChooseAction:c,showFilter:!0}))},FN=()=>(e,t,n)=>{if(q(n,t))return;let r=t().app,i=n.uiService;if(r.isRenaming){i.showNotice("Cannot export while database is being renamed.");return}if(r.status!=="READY"||!r.noteId){i.showNotice("VC: Cannot export because the note is not ready or is not under version control.",3e3);return}let o=r.noteId,a=LN.filter(c=>c!=="gzip").map(c=>({id:c,data:c,text:`Export all versions as ${c.toUpperCase()}`,icon:VN[c]})),l=c=>u=>{u(Qx(o,c))};e(H.actions.openPanel({type:"action",title:"Choose export format",items:a,onChooseAction:l,showFilter:!1}))},Qx=(e,t)=>async(n,r,i)=>{if(q(i,r))return;let o=r().app,s=i.uiService;if(o.isRenaming){s.showNotice("Cannot export while database is being renamed.");return}let a=i.manifestManager,l=i.exportManager;if(o.status!=="READY"||o.noteId!==e){s.showNotice("VC: Export cancelled because the view context changed.",3e3);return}n(H.actions.setProcessing(!0));try{let c=await a.loadNoteManifest(e);if(!c)throw new Error(`Export failed: Could not find manifest for note ID ${e}.`);let u=c.notePath.split("/").pop()?.replace(/\.md$/,"")||"Untitled",p=o.viewMode==="versions"?"version":"edit";s.showNotice(`Preparing to export all ${p}s for "${u}"...`,3e3);let d=await l.getAllVersionsData(e,p);if(q(i,r,{noteId:e})){s.showNotice("VC: Export cancelled because the note context changed.");return}if(d.length===0){s.showNotice(`No ${p}s found for "${u}" to export.`,3e3);return}let h=await l.generateExport(d,t);jz(n,r,i,e,async m=>{let g=`History - ${mc(u)}.${t}`,y=await l.writeFile(m,g,h);s.showNotice(`Successfully exported to ${y}`,7e3)})}catch(c){let u=c instanceof Error?c.message:"Unknown error";console.error(`Version Control: Export failed for all versions of note ID ${e.substring(0,8)}...`,c),s.showNotice(`Error: Failed to export all versions. ${u}.`,7e3)}finally{q(i,r)||r().app.status==="READY"&&n(H.actions.setProcessing(!1))}},BN=e=>(t,n,r)=>{if(q(r,n))return;let i=n().app,o=r.uiService;if(i.isRenaming){o.showNotice("Cannot export while database is being renamed.");return}if(i.status!=="READY"||i.noteId!==e.noteId){o.showNotice("VC: Cannot export version because the view context is not ready or has changed.",3e3);return}let s=LN.map(l=>({id:l,data:l,text:`Export version as ${l.toUpperCase()}`,icon:VN[l]})),a=l=>c=>{c(Xx(e,l))};t(H.actions.openPanel({type:"action",title:`Export V${e.versionNumber}`,items:s,onChooseAction:a,showFilter:!1}))},Xx=(e,t)=>async(n,r,i)=>{if(q(i,r))return;let o=r().app,s=i.uiService;if(o.isRenaming){s.showNotice("Cannot export while database is being renamed.");return}let a=i.manifestManager,l=i.versionManager,c=i.editHistoryManager,u=i.exportManager;if(o.status!=="READY"||o.noteId!==e.noteId){s.showNotice("VC: Export cancelled because the view context changed.",3e3);return}n(H.actions.setProcessing(!0));try{let f=await a.loadNoteManifest(e.noteId);if(!f)throw new Error(`Manifest for note ID ${e.noteId} not found.`);let p=f.notePath.split("/").pop()?.replace(/\.md$/,"")||"Untitled",d=r().app.viewMode;s.showNotice(`Preparing to export V${e.versionNumber} of "${p}"...`,3e3);let h=null;if(d==="versions"?h=await l.getVersionContent(e.noteId,e.id):h=await c.getEditContent(e.noteId,e.id),h===null)throw new Error(`Could not load content for ${d==="versions"?"version":"edit"}.`);if(q(i,r,{noteId:e.noteId}))return;let m={id:e.id,noteId:e.noteId,notePath:e.notePath,branchName:e.branchName,versionNumber:e.versionNumber,timestamp:e.timestamp,name:e.name??"",size:e.size,content:h},v=await u.generateExport([m],t);jz(n,r,i,e.noteId,async g=>{let y=mc(p),b=d==="versions"?"Version":"Edit",w=d==="versions"?`V${m.versionNumber}`:`Edit ${m.versionNumber}`,S=m.name?mc(m.name):mc(w),x=`${b} - ${y} - ${S}.${t==="gzip"?"md.gz":t}`,E=await u.writeFile(g,x,v);s.showNotice(`Successfully exported to ${E}`,7e3)})}catch(f){let p=f instanceof Error?f.message:"Unknown error";console.error(`Version Control: Export failed for version V${e.versionNumber} of note ID ${e.noteId.substring(0,8)}...`,f),s.showNotice(`Error: Failed to export version. ${p}.`,7e3)}finally{q(i,r)||r().app.status==="READY"&&n(H.actions.setProcessing(!1))}};var HN={};Ua(HN,{openTimeline:()=>Wee});var Wee=()=>async(e,t,n)=>{if(q(n,t))return;let r=t().app,i=n.uiService;if(r.status!=="READY"||!r.noteId||!r.currentBranch){i.showNotice("Cannot open timeline: view context is not ready.");return}e(H.actions.openPanel({type:"timeline"}))};var UN={};Ua(UN,{buildEditHistory:()=>mN,calculateNextVersionNumber:()=>gee,createEditManifest:()=>vee,deleteAllEdits:()=>xN,deleteEdit:()=>_z,ensureBranchExists:()=>bee,isDuplicateContent:()=>yee,requestDeleteEdit:()=>Mee,requestRestoreEdit:()=>Qee,restoreEdit:()=>Gz,saveNewEdit:()=>Xu,syncEditManifest:()=>hN,updateEditDetails:()=>Yee});var Yee=(e,t)=>async(n,r,i)=>{if(q(i,r))return;try{Ue(mz,t)}catch(u){console.error("Version Control: Invalid EditDetails",u);return}let o=r().app,s=i.editHistoryManager,a=i.uiService,l=i.eventBus;if(!Ns(o,a)||!Ii(o.noteId,o.file))return;let c=o.noteId;try{await s.updateEditMetadata(c,e,t.name,t.description),l.trigger("version-updated",c,e,t),n(Ne.util.invalidateTags([{type:"EditHistory",id:c},{type:"Timeline",id:c}]))}catch(u){console.error("VC: Failed to update edit details",u),a.showNotice("Failed to update edit details."),n(Ne.util.invalidateTags([{type:"EditHistory",id:c}]))}finally{q(i,r)||n(H.actions.stopVersionEditing())}};var qz=require("obsidian");var Gz=Zt("editHistory/restoreEdit",async(e,{dispatch:t,getState:n,extra:r,rejectWithValue:i})=>{if(q(r,n))return i("Aborted");let o=n().app,s=r.editHistoryManager,a=r.noteManager,l=r.uiService,c=r.app;if(!Ns(o,l))return i("Not ready");if(!Ii(o.noteId,o.file))return i("Invalid context");let u=o.noteId,{file:f,currentBranch:p}=o;t(H.actions.closePanel());try{let d=await s.getEditContent(u,e,p);if(d===null)throw new Error("Content not found");if(q(r,n,{noteId:u,filePath:f.path}))return i("Context changed");let h=c.vault.getAbstractFileByPath(f.path);h instanceof qz.TFile&&(await c.vault.modify(h,d),h.extension==="md"&&await a.writeNoteIdToFrontmatter(h,u),l.showNotice(`Restored Edit #${e.substring(0,6)}...`));return}catch(d){return console.error("VC: Failed to restore edit",d),l.showNotice("Failed to restore edit."),i(String(d))}}),Qee=e=>(t,n,r)=>{t(H.actions.openPanel({type:"confirmation",title:"Confirm restore edit",message:"Overwrite current note with this edit?",onConfirmAction:Gz(e.id)}))};var $N={};Ua($N,{handleFileDelete:()=>Jee,handleFileRename:()=>Zee,handleMetadataChange:()=>Xee,handleVaultSave:()=>ete});var gd=require("obsidian");var Xee=(e,t)=>async(n,r,i)=>{if(q(i,r)||i.noteManager.isPendingDeviation(e.path)||e.extension!=="md")return;let s=r().app;if(s.status==="READY"&&s.isProcessing&&s.file?.path===e.path||s.status==="LOADING"&&s.file?.path===e.path)return;let a=i.manifestManager,l=i.plugin,c=l.settings.noteIdFrontmatterKey,u=l.settings.legacyNoteIdFrontmatterKeys,f=t,p=f?.frontmatter?.[c]??null,d=await a.getNoteIdByPath(e.path);if(q(i,r))return;let h=!1;if(typeof p=="string"&&p.trim()!=="")h=p!==d;else{let m=!1;if(u&&u.length>0)for(let v of u){let g=f?.frontmatter?.[v];if(typeof g=="string"&&g.trim()!==""&&g===d){m=!0;break}}m?h=!1:h=d!==null}if(h){a.invalidateCentralManifestCache();let m=r().app;(m.status==="READY"||m.status==="LOADING")&&m.file?.path===e.path&&n(Nr(void 0))}},Zee=(e,t)=>async(n,r,i)=>{if(q(i,r)||e.extension!=="md"&&e.extension!=="base")return;let o=i.plugin,s=i.noteManager,a=i.manifestManager,l=o.autoSaveDebouncers.get(t);l&&(l.debouncer.cancel(),o.autoSaveDebouncers.delete(t));let c=await a.getNoteIdByPath(t);await s.handleNoteRename(e,t);let u=r().app;(u.file?.path===t||c&&u.noteId===c)&&n(Nr(void 0))},Jee=e=>async(t,n,r)=>{if(q(r,n)||e.path.split("/").some(f=>f.startsWith(".")))return;let i=r.manifestManager,o=r.editHistoryManager,s=r.uiService,a=r.plugin,l=r.eventBus,c=async(f,p)=>{try{await i.deleteNoteEntry(f),await o.deleteNoteHistory(f),l.trigger("history-deleted",f),console.log(`VC: Deleted version control data for "${p}" (ID: ${f})`)}catch(d){console.error(`VC: Failed to delete data for "${p}"`,d)}},u=0;if(e instanceof gd.TFile){if(e.extension!=="md"&&e.extension!=="base")return;let f=a.autoSaveDebouncers.get(e.path);f&&(f.debouncer.cancel(),a.autoSaveDebouncers.delete(e.path));let p=await i.getNoteIdByPath(e.path);p&&(await c(p,e.path),u++)}else if(e instanceof gd.TFolder){let f=await i.loadCentralManifest(),p=e.path+"/",d=Object.entries(f.notes).filter(([h,m])=>m.notePath.startsWith(p));if(d.length>0){console.log(`VC: Folder "${e.path}" deleted. Cleaning up ${d.length} affected notes.`);for(let[h,m]of d){let v=a.autoSaveDebouncers.get(m.notePath);v&&(v.debouncer.cancel(),a.autoSaveDebouncers.delete(m.notePath)),await c(h,m.notePath),u++}}}if(u>0){u===1?s.showNotice(`Version control data deleted for "${e.name}".`):s.showNotice(`Version control data deleted for ${u} notes in "${e.name}".`);let p=n().app.file?.path;p&&(e.path===p||p.startsWith(e.path+"/"))&&t(H.actions.clearActiveNote()),i.invalidateCentralManifestCache()}},ete=e=>async(t,n,r)=>{if(q(r,n)||e.extension!=="md"&&e.extension!=="base"||e.path.split("/").some(p=>p.startsWith(".")))return;let i=r.noteManager,o=r.manifestManager,s=r.plugin,a=await i.getNoteId(e)??await o.getNoteIdByPath(e.path);if(!a)return;let l=await to(a,"version",r),c=await to(a,"edit",r),u=s.autoSaveDebouncers.get(e.path);if(!l.autoSaveOnSave&&!c.autoSaveOnSave){u&&(u.debouncer.cancel(),s.autoSaveDebouncers.delete(e.path));return}let f=2e3;if(l.autoSaveOnSave&&c.autoSaveOnSave?f=Math.min(l.autoSaveOnSaveInterval,c.autoSaveOnSaveInterval)*1e3:l.autoSaveOnSave?f=l.autoSaveOnSaveInterval*1e3:f=c.autoSaveOnSaveInterval*1e3,u&&u.interval===f)u.debouncer(e);else{u?.debouncer.cancel();let p=(0,gd.debounce)(d=>{l.autoSaveOnSave&&t(wN(d)),c.autoSaveOnSave&&t(Xu({isAuto:!0,allowInit:!1}))},f);s.autoSaveDebouncers.set(e.path,{debouncer:p,interval:f}),p(e)}};var Z={...bN,...TN,...AN,...MN,...zN,...HN,...UN,...$N};var Kz=require("obsidian");var Ju=class{constructor(t){this.plugin=t}async loadSettings(){try{let t=await this.plugin.loadData()||{},n;"maxVersionsPerNote"in t&&!("versionHistorySettings"in t)&&this.migrateFlatSettings(t),t.editHistoryManifest&&this.migrateEditHistoryManifest(t);let r=un(Mi,t);if(r.success)n=r.output;else{let o=un(ic,t);o.success?(console.log("Version Control: Migrating settings from old central manifest format."),n={centralManifest:o.output}):(console.warn("Version Control: Unknown or invalid settings format detected, using defaults. Validation errors:",r.issues),n={})}let i={...fn,...n,centralManifest:{...fn.centralManifest,...n.centralManifest||{}},versionHistorySettings:{...fn.versionHistorySettings,...n.versionHistorySettings||{}},editHistorySettings:{...fn.editHistorySettings,...n.editHistorySettings||{}}};this.plugin.settings=Ue(Mi,i),await this.saveSettings()}catch(t){console.error("Version Control: Failed to load and validate settings",t),this.plugin.settings={...fn},await this.saveSettings()}}migrateFlatSettings(t){console.log("Version Control: Migrating settings from legacy flat format.");try{let n=["maxVersionsPerNote","autoCleanupOldVersions","autoCleanupDays","useRelativeTimestamps","enableVersionNaming","enableVersionDescription","showDescriptionInList","isListView","renderMarkdownInPreview","enableWatchMode","watchModeInterval","autoSaveOnSave","autoSaveOnSaveInterval","enableMinLinesChangedCheck","minLinesChanged","enableWordCount","includeMdSyntaxInWordCount","enableCharacterCount","includeMdSyntaxInCharacterCount","enableLineCount","includeMdSyntaxInLineCount","isGlobal","autoRegisterNotes","pathFilters"],r={};for(let i of n)i in t&&(r[i]=t[i],delete t[i]);t.versionHistorySettings={...fn.versionHistorySettings,...r},t.editHistorySettings={...fn.editHistorySettings}}catch(n){console.error("Version Control: Settings migration failed.",n)}}migrateEditHistoryManifest(t){console.log("Version Control: Migrating edit history manifest to central manifest.");try{let n=t.centralManifest?.notes||{},r=t.editHistoryManifest?.notes||{},i=new Map;for(let[a,l]of Object.entries(n))i.set(a,{...l,_source:"version"});for(let[a,l]of Object.entries(r))if(i.has(a)){let c=i.get(a);c._source="both"}else i.set(a,{...l,_source:"edit"});let o=new Map;for(let[a,l]of i.entries()){let c=l.notePath;o.has(c)||o.set(c,[]),o.get(c).push({id:a,entry:l})}let s={};for(let[a,l]of o.entries()){let c=l[0];if(!c)continue;if(l.length===1){let{id:f,entry:p}=c;delete p._source,s[f]=p;continue}l.sort((f,p)=>{let d=f.entry.createdAt?new Date(f.entry.createdAt).getTime():Date.now(),h=p.entry.createdAt?new Date(p.entry.createdAt).getTime():Date.now();if(d!==h)return d-h;let m=v=>v==="version"||v==="both"?0:1;return m(f.entry._source)-m(p.entry._source)});let u=l[0];u&&(console.log(`VC: Migration conflict for path "${a}". Keeping ID ${u.id} (Created: ${u.entry.createdAt}). Discarding ${l.length-1} others.`),delete u.entry._source,s[u.id]=u.entry)}t.centralManifest||(t.centralManifest={version:"1.0.0",notes:{}}),t.centralManifest.notes=s,delete t.editHistoryManifest}catch(n){console.error("Version Control: Failed to migrate edit history manifest.",n)}}async saveSettings(){try{let t=Ue(Mi,this.plugin.settings);await this.plugin.saveData(t)}catch(t){console.error("Version Control: Failed to save settings due to validation error",t),new Kz.Notice("Failed to save settings. Please check the console for details.")}}};var Jg=class{constructor(t){P(this,"plugin");this.plugin=t}initializeServices(){return gr.getInstance(this.plugin)}async initializeDatabase(t){await t.centralManifestRepo.load(!0)}};var c9=require("obsidian");var Zx=require("obsidian");function jN(e,t){let r=gr.getInstance(e).noteManager;e.registerEvent(e.app.workspace.on("file-open",i=>{let o=e.app.workspace.activeLeaf;t.dispatch(Z.initializeView(o))})),e.registerEvent(e.app.metadataCache.on("changed",(i,o,s)=>{r.isInternalWrite(i.path)||r.isPendingDeviation(i.path)||window.requestIdleCallback(()=>{t.dispatch(Z.handleMetadataChange(i,s))},{timeout:1e3})})),e.registerEvent(e.app.vault.on("rename",(i,o)=>{i instanceof Zx.TFile&&t.dispatch(Z.handleFileRename(i,o))})),e.registerEvent(e.app.vault.on("delete",i=>{t.dispatch(Z.handleFileDelete(i))})),e.registerEvent(e.app.vault.on("create",i=>{i instanceof Zx.TFile&&i.extension==="base"&&t.dispatch(Z.handleVaultSave(i))})),e.registerEvent(e.app.vault.on("modify",i=>{if(!(i instanceof Zx.TFile))return;let o=i.extension;(o==="md"||o==="base")&&!r.isInternalWrite(i.path)&&!r.isPendingDeviation(i.path)&&t.dispatch(Z.handleVaultSave(i))}))}var x_=require("obsidian");var uQ=require("obsidian"),fQ=D(RE());var pQ=D(U());function Cj(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=Cj(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Dre(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=Cj(e))&&(r&&(r+=" "),r+=t);return r}var ge=Dre;var fs=D(U(),1);var Tj=D(U(),1),xf=e=>(0,Tj.useCallback)(t=>{t.target===t.currentTarget&&e()},[e]);var Aj=D(U(),1),Ef=(e,t=50,n=!0)=>{(0,Aj.useEffect)(()=>{if(!n)return;let r=setTimeout(()=>{try{e.current?.focus(),e.current instanceof HTMLInputElement&&e.current.select()}catch{}},t);return()=>clearTimeout(r)},[e,t,n])};var Mj=D(U(),1);var Pe=XS,me=ZS;var yo=()=>{let e=Pe();return(0,Mj.useCallback)(()=>e(H.actions.closePanel()),[e])};var _r=D(U(),1),Rj=require("obsidian");var Cf=({onSearch:e,totalMatches:t=0}={})=>{let[n,r]=(0,_r.useState)(!1),[i,o]=(0,_r.useState)(""),[s,a]=(0,_r.useState)(""),[l,c]=(0,_r.useState)(!1),[u,f]=(0,_r.useState)(-1),p=(0,_r.useRef)(null),d=(0,_r.useMemo)(()=>(0,Rj.debounce)(w=>{o(w),e?.(w),f(-1)},300,!0),[e]),h=(0,_r.useCallback)(w=>{let S=w.target.value;a(S),d(S)},[d]),m=(0,_r.useCallback)(w=>{w?.stopPropagation(),r(S=>(S&&(a(""),o(""),f(-1)),!S))},[]),v=(0,_r.useCallback)(w=>{w.stopPropagation(),a(""),o(""),f(-1),p.current?.focus()},[]),g=(0,_r.useCallback)(w=>{t!==0&&f(S=>w==="next"?(S+1)%t:(S-1+t)%t)},[t]),y=(0,_r.useCallback)(w=>{w.key==="Escape"&&m(),w.key==="Enter"&&(w.preventDefault(),g(w.shiftKey?"prev":"next"))},[m,g]),b=(0,_r.useCallback)(w=>{w?.stopPropagation(),c(S=>!S)},[]);return Ef(p,100,n),{isSearchActive:n,searchQuery:i,localSearchQuery:s,isCaseSensitive:l,activeMatchIndex:u,searchInputRef:p,handleSearchInputChange:h,handleToggleSearch:m,handleClearSearch:v,handleSearchKeyDown:y,goToMatch:g,toggleCaseSensitivity:b,setActiveMatchIndex:f}};var Nj=require("obsidian"),NE=D(U(),1),Il=()=>{let e=(0,NE.useRef)(null);return e.current||(e.current=new Nj.Component),(0,NE.useEffect)(()=>{let t=e.current;return t.load(),()=>{t.unload()}},[]),e.current};var j3=require("obsidian");var mn=D(U(),1);var ar=D(U(),1);var h1e=!!(typeof window<"u"&&window.document&&window.document.createElement);function ot(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e?.(i),n===!1||!i.defaultPrevented)return t?.(i)}}var Ij=D(U(),1);function Dj(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Tf(...e){return t=>{let n=!1,r=e.map(i=>{let o=Dj(i,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let i=0;i<r.length;i++){let o=r[i];typeof o=="function"?o():Dj(e[i],null)}}}}function Bn(...e){return Ij.useCallback(Tf(...e),e)}var Ol=D(U(),1),_j=D(j(),1);function Ta(e,t=[]){let n=[];function r(o,s){let a=Ol.createContext(s),l=n.length;n=[...n,s];let c=f=>{let{scope:p,children:d,...h}=f,m=p?.[e]?.[l]||a,v=Ol.useMemo(()=>h,Object.values(h));return(0,_j.jsx)(m.Provider,{value:v,children:d})};c.displayName=o+"Provider";function u(f,p){let d=p?.[e]?.[l]||a,h=Ol.useContext(d);if(h)return h;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[c,u]}let i=()=>{let o=n.map(s=>Ol.createContext(s));return function(a){let l=a?.[e]||o;return Ol.useMemo(()=>({[`__scope${e}`]:{...a,[e]:l}}),[a,l])}};return i.scopeName=e,[r,Pre(i,...t)]}function Pre(...e){let t=e[0];if(e.length===1)return t;let n=()=>{let r=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){let s=r.reduce((a,{useScope:l,scopeName:c})=>{let f=l(o)[`__scope${c}`];return{...a,...f}},{});return Ol.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return n.scopeName=t.scopeName,n}var Go=D(U(),1);var Vj=D(U(),1),Bi=globalThis?.document?Vj.useLayoutEffect:()=>{};var IE=D(U(),1);var kre=Go[" useInsertionEffect ".trim().toString()]||Bi;function tv({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){let[i,o,s]=_re({defaultProp:t,onChange:n}),a=e!==void 0,l=a?e:i;{let u=Go.useRef(e!==void 0);Go.useEffect(()=>{let f=u.current;f!==a&&console.warn(`${r} is changing from ${f?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=a},[a,r])}let c=Go.useCallback(u=>{if(a){let f=Vre(u)?u(e):u;f!==e&&s.current?.(f)}else o(u)},[a,e,o,s]);return[l,c]}function _re({defaultProp:e,onChange:t}){let[n,r]=Go.useState(e),i=Go.useRef(n),o=Go.useRef(t);return kre(()=>{o.current=t},[t]),Go.useEffect(()=>{i.current!==n&&(o.current?.(n),i.current=n)},[n,i]),[n,r,o]}function Vre(e){return typeof e=="function"}var Lj=D(U(),1),Fj=D(ef(),1);var or=D(U(),1);var OE=D(j(),1);function Af(e){let t=Lre(e),n=or.forwardRef((r,i)=>{let{children:o,...s}=r,a=or.Children.toArray(o),l=a.find(Bre);if(l){let c=l.props.children,u=a.map(f=>f===l?or.Children.count(c)>1?or.Children.only(null):or.isValidElement(c)?c.props.children:null:f);return(0,OE.jsx)(t,{...s,ref:i,children:or.isValidElement(c)?or.cloneElement(c,void 0,u):null})}return(0,OE.jsx)(t,{...s,ref:i,children:o})});return n.displayName=`${e}.Slot`,n}function Lre(e){let t=or.forwardRef((n,r)=>{let{children:i,...o}=n;if(or.isValidElement(i)){let s=Hre(i),a=zre(o,i.props);return i.type!==or.Fragment&&(a.ref=r?Tf(r,s):s),or.cloneElement(i,a)}return or.Children.count(i)>1?or.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Fre=Symbol("radix.slottable");function Bre(e){return or.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Fre}function zre(e,t){let n={...t};for(let r in t){let i=e[r],o=t[r];/^on[A-Z]/.test(r)?i&&o?n[r]=(...a)=>{let l=o(...a);return i(...a),l}:i&&(n[r]=i):r==="style"?n[r]={...i,...o}:r==="className"&&(n[r]=[i,o].filter(Boolean).join(" "))}return{...e,...n}}function Hre(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Bj=D(j(),1),Ure=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Tn=Ure.reduce((e,t)=>{let n=Af(`Primitive.${t}`),r=Lj.forwardRef((i,o)=>{let{asChild:s,...a}=i,l=s?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),(0,Bj.jsx)(l,{...a,ref:o})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function PE(e,t){e&&Fj.flushSync(()=>e.dispatchEvent(t))}var Me=D(U(),1);var Yc=D(U(),1);var kE=D(j(),1),$re=D(U(),1);var jre=D(j(),1);function _E(e){let t=e+"CollectionProvider",[n,r]=Ta(t),[i,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),s=m=>{let{scope:v,children:g}=m,y=Yc.default.useRef(null),b=Yc.default.useRef(new Map).current;return(0,kE.jsx)(i,{scope:v,itemMap:b,collectionRef:y,children:g})};s.displayName=t;let a=e+"CollectionSlot",l=Af(a),c=Yc.default.forwardRef((m,v)=>{let{scope:g,children:y}=m,b=o(a,g),w=Bn(v,b.collectionRef);return(0,kE.jsx)(l,{ref:w,children:y})});c.displayName=a;let u=e+"CollectionItemSlot",f="data-radix-collection-item",p=Af(u),d=Yc.default.forwardRef((m,v)=>{let{scope:g,children:y,...b}=m,w=Yc.default.useRef(null),S=Bn(v,w),C=o(u,g);return Yc.default.useEffect(()=>(C.itemMap.set(w,{ref:w,...b}),()=>{C.itemMap.delete(w)})),(0,kE.jsx)(p,{[f]:"",ref:S,children:y})});d.displayName=u;function h(m){let v=o(e+"CollectionConsumer",m);return Yc.default.useCallback(()=>{let y=v.collectionRef.current;if(!y)return[];let b=Array.from(y.querySelectorAll(`[${f}]`));return Array.from(v.itemMap.values()).sort((C,x)=>b.indexOf(C.ref.current)-b.indexOf(x.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:s,Slot:c,ItemSlot:d},h,r]}var VE=D(U(),1),qre=D(j(),1),Gre=VE.createContext(void 0);function LE(e){let t=VE.useContext(Gre);return e||t||"ltr"}var An=D(U(),1);var am=D(U(),1);function Wr(e){let t=am.useRef(e);return am.useEffect(()=>{t.current=e}),am.useMemo(()=>(...n)=>t.current?.(...n),[])}var zj=D(U(),1);function Hj(e,t=globalThis?.document){let n=Wr(e);zj.useEffect(()=>{let r=i=>{i.key==="Escape"&&n(i)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var CO=D(j(),1),Kre="DismissableLayer",EO="dismissableLayer.update",Wre="dismissableLayer.pointerDownOutside",Yre="dismissableLayer.focusOutside",Uj,jj=An.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),TO=An.forwardRef((e,t)=>{let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:a,...l}=e,c=An.useContext(jj),[u,f]=An.useState(null),p=u?.ownerDocument??globalThis?.document,[,d]=An.useState({}),h=Bn(t,x=>f(x)),m=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),g=m.indexOf(v),y=u?m.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,w=y>=g,S=Zre(x=>{let E=x.target,T=[...c.branches].some(A=>A.contains(E));!w||T||(i?.(x),s?.(x),x.defaultPrevented||a?.())},p),C=Jre(x=>{let E=x.target;[...c.branches].some(A=>A.contains(E))||(o?.(x),s?.(x),x.defaultPrevented||a?.())},p);return Hj(x=>{y===c.layers.size-1&&(r?.(x),!x.defaultPrevented&&a&&(x.preventDefault(),a()))},p),An.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Uj=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),$j(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=Uj)}},[u,p,n,c]),An.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),$j())},[u,c]),An.useEffect(()=>{let x=()=>d({});return document.addEventListener(EO,x),()=>document.removeEventListener(EO,x)},[]),(0,CO.jsx)(Tn.div,{...l,ref:h,style:{pointerEvents:b?w?"auto":"none":void 0,...e.style},onFocusCapture:ot(e.onFocusCapture,C.onFocusCapture),onBlurCapture:ot(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:ot(e.onPointerDownCapture,S.onPointerDownCapture)})});TO.displayName=Kre;var Qre="DismissableLayerBranch",Xre=An.forwardRef((e,t)=>{let n=An.useContext(jj),r=An.useRef(null),i=Bn(t,r);return An.useEffect(()=>{let o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),(0,CO.jsx)(Tn.div,{...e,ref:i})});Xre.displayName=Qre;function Zre(e,t=globalThis?.document){let n=Wr(e),r=An.useRef(!1),i=An.useRef(()=>{});return An.useEffect(()=>{let o=a=>{if(a.target&&!r.current){let c=function(){qj(Wre,n,u,{discrete:!0})};var l=c;let u={originalEvent:a};a.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}else t.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",o),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Jre(e,t=globalThis?.document){let n=Wr(e),r=An.useRef(!1);return An.useEffect(()=>{let i=o=>{o.target&&!r.current&&qj(Yre,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function $j(){let e=new CustomEvent(EO);document.dispatchEvent(e)}function qj(e,t,n,{discrete:r}){let i=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?PE(i,o):i.dispatchEvent(o)}var Kj=D(U(),1),AO=0;function Wj(){Kj.useEffect(()=>{let e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Gj()),document.body.insertAdjacentElement("beforeend",e[1]??Gj()),AO++,()=>{AO===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),AO--}},[])}function Gj(){let e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Ko=D(U(),1);var Jj=D(j(),1),MO="focusScope.autoFocusOnMount",RO="focusScope.autoFocusOnUnmount",Yj={bubbles:!1,cancelable:!0},eie="FocusScope",NO=Ko.forwardRef((e,t)=>{let{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...s}=e,[a,l]=Ko.useState(null),c=Wr(i),u=Wr(o),f=Ko.useRef(null),p=Bn(t,m=>l(m)),d=Ko.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;Ko.useEffect(()=>{if(r){let y=function(C){if(d.paused||!a)return;let x=C.target;a.contains(x)?f.current=x:Qc(f.current,{select:!0})},b=function(C){if(d.paused||!a)return;let x=C.relatedTarget;x!==null&&(a.contains(x)||Qc(f.current,{select:!0}))},w=function(C){if(document.activeElement===document.body)for(let E of C)E.removedNodes.length>0&&Qc(a)};var m=y,v=b,g=w;document.addEventListener("focusin",y),document.addEventListener("focusout",b);let S=new MutationObserver(w);return a&&S.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",b),S.disconnect()}}},[r,a,d.paused]),Ko.useEffect(()=>{if(a){Xj.add(d);let m=document.activeElement;if(!a.contains(m)){let g=new CustomEvent(MO,Yj);a.addEventListener(MO,c),a.dispatchEvent(g),g.defaultPrevented||(tie(sie(eq(a)),{select:!0}),document.activeElement===m&&Qc(a))}return()=>{a.removeEventListener(MO,c),setTimeout(()=>{let g=new CustomEvent(RO,Yj);a.addEventListener(RO,u),a.dispatchEvent(g),g.defaultPrevented||Qc(m??document.body,{select:!0}),a.removeEventListener(RO,u),Xj.remove(d)},0)}}},[a,c,u,d]);let h=Ko.useCallback(m=>{if(!n&&!r||d.paused)return;let v=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,g=document.activeElement;if(v&&g){let y=m.currentTarget,[b,w]=nie(y);b&&w?!m.shiftKey&&g===w?(m.preventDefault(),n&&Qc(b,{select:!0})):m.shiftKey&&g===b&&(m.preventDefault(),n&&Qc(w,{select:!0})):g===y&&m.preventDefault()}},[n,r,d.paused]);return(0,Jj.jsx)(Tn.div,{tabIndex:-1,...s,ref:p,onKeyDown:h})});NO.displayName=eie;function tie(e,{select:t=!1}={}){let n=document.activeElement;for(let r of e)if(Qc(r,{select:t}),document.activeElement!==n)return}function nie(e){let t=eq(e),n=Qj(t,e),r=Qj(t.reverse(),e);return[n,r]}function eq(e){let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{let i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Qj(e,t){for(let n of e)if(!rie(n,{upTo:t}))return n}function rie(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function iie(e){return e instanceof HTMLInputElement&&"select"in e}function Qc(e,{select:t=!1}={}){if(e&&e.focus){let n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&iie(e)&&t&&e.select()}}var Xj=oie();function oie(){let e=[];return{add(t){let n=e[0];t!==n&&n?.pause(),e=Zj(e,t),e.unshift(t)},remove(t){e=Zj(e,t),e[0]?.resume()}}}function Zj(e,t){let n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function sie(e){return e.filter(t=>t.tagName!=="A")}var DO=D(U(),1);var aie=DO[" useId ".trim().toString()]||(()=>{}),lie=0;function Xc(e){let[t,n]=DO.useState(aie());return Bi(()=>{e||n(r=>r??String(lie++))},[e]),e||(t?`radix-${t}`:"")}var Hi=D(U(),1);var rq=["top","right","bottom","left"];var Aa=Math.min,di=Math.max,rv=Math.round,iv=Math.floor,ks=e=>({x:e,y:e}),cie={left:"right",right:"left",bottom:"top",top:"bottom"},uie={start:"end",end:"start"};function BE(e,t,n){return di(e,Aa(t,n))}function Ma(e,t){return typeof e=="function"?e(t):e}function Ra(e){return e.split("-")[0]}function Mf(e){return e.split("-")[1]}function zE(e){return e==="x"?"y":"x"}function HE(e){return e==="y"?"height":"width"}var fie=new Set(["top","bottom"]);function _s(e){return fie.has(Ra(e))?"y":"x"}function UE(e){return zE(_s(e))}function iq(e,t,n){n===void 0&&(n=!1);let r=Mf(e),i=UE(e),o=HE(i),s=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=nv(s)),[s,nv(s)]}function oq(e){let t=nv(e);return[FE(e),t,FE(t)]}function FE(e){return e.replace(/start|end/g,t=>uie[t])}var tq=["left","right"],nq=["right","left"],pie=["top","bottom"],die=["bottom","top"];function mie(e,t,n){switch(e){case"top":case"bottom":return n?t?nq:tq:t?tq:nq;case"left":case"right":return t?pie:die;default:return[]}}function sq(e,t,n,r){let i=Mf(e),o=mie(Ra(e),n==="start",r);return i&&(o=o.map(s=>s+"-"+i),t&&(o=o.concat(o.map(FE)))),o}function nv(e){return e.replace(/left|right|bottom|top/g,t=>cie[t])}function hie(e){return{top:0,right:0,bottom:0,left:0,...e}}function IO(e){return typeof e!="number"?hie(e):{top:e,right:e,bottom:e,left:e}}function Rf(e){let{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function aq(e,t,n){let{reference:r,floating:i}=e,o=_s(t),s=UE(t),a=HE(s),l=Ra(t),c=o==="y",u=r.x+r.width/2-i.width/2,f=r.y+r.height/2-i.height/2,p=r[a]/2-i[a]/2,d;switch(l){case"top":d={x:u,y:r.y-i.height};break;case"bottom":d={x:u,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:f};break;case"left":d={x:r.x-i.width,y:f};break;default:d={x:r.x,y:r.y}}switch(Mf(t)){case"start":d[s]-=p*(n&&c?-1:1);break;case"end":d[s]+=p*(n&&c?-1:1);break}return d}var uq=async(e,t,n)=>{let{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t)),c=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:f}=aq(c,r,l),p=r,d={},h=0;for(let m=0;m<a.length;m++){let{name:v,fn:g}=a[m],{x:y,y:b,data:w,reset:S}=await g({x:u,y:f,initialPlacement:r,placement:p,strategy:i,middlewareData:d,rects:c,platform:s,elements:{reference:e,floating:t}});u=y??u,f=b??f,d={...d,[v]:{...d[v],...w}},S&&h<=50&&(h++,typeof S=="object"&&(S.placement&&(p=S.placement),S.rects&&(c=S.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):S.rects),{x:u,y:f}=aq(c,p,l)),m=-1)}return{x:u,y:f,placement:p,strategy:i,middlewareData:d}};async function lm(e,t){var n;t===void 0&&(t={});let{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:p=!1,padding:d=0}=Ma(t,e),h=IO(d),v=a[p?f==="floating"?"reference":"floating":f],g=Rf(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(v)))==null||n?v:v.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=f==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),w=await(o.isElement==null?void 0:o.isElement(b))?await(o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},S=Rf(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(g.top-S.top+h.top)/w.y,bottom:(S.bottom-g.bottom+h.bottom)/w.y,left:(g.left-S.left+h.left)/w.x,right:(S.right-g.right+h.right)/w.x}}var fq=e=>({name:"arrow",options:e,async fn(t){let{x:n,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=t,{element:c,padding:u=0}=Ma(e,t)||{};if(c==null)return{};let f=IO(u),p={x:n,y:r},d=UE(i),h=HE(d),m=await s.getDimensions(c),v=d==="y",g=v?"top":"left",y=v?"bottom":"right",b=v?"clientHeight":"clientWidth",w=o.reference[h]+o.reference[d]-p[d]-o.floating[h],S=p[d]-o.reference[d],C=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c)),x=C?C[b]:0;(!x||!await(s.isElement==null?void 0:s.isElement(C)))&&(x=a.floating[b]||o.floating[h]);let E=w/2-S/2,T=x/2-m[h]/2-1,A=Aa(f[g],T),M=Aa(f[y],T),R=A,N=x-m[h]-M,I=x/2-m[h]/2+E,_=BE(R,I,N),z=!l.arrow&&Mf(i)!=null&&I!==_&&o.reference[h]/2-(I<R?A:M)-m[h]/2<0,F=z?I<R?I-R:I-N:0;return{[d]:p[d]+F,data:{[d]:_,centerOffset:I-_-F,...z&&{alignmentOffset:F}},reset:z}}});var pq=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;let{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:m=!0,...v}=Ma(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};let g=Ra(i),y=_s(a),b=Ra(a)===a,w=await(l.isRTL==null?void 0:l.isRTL(c.floating)),S=p||(b||!m?[nv(a)]:oq(a)),C=h!=="none";!p&&C&&S.push(...sq(a,m,h,w));let x=[a,...S],E=await lm(t,v),T=[],A=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&T.push(E[g]),f){let I=iq(i,s,w);T.push(E[I[0]],E[I[1]])}if(A=[...A,{placement:i,overflows:T}],!T.every(I=>I<=0)){var M,R;let I=(((M=o.flip)==null?void 0:M.index)||0)+1,_=x[I];if(_&&(!(f==="alignment"?y!==_s(_):!1)||A.every(L=>_s(L.placement)===y?L.overflows[0]>0:!0)))return{data:{index:I,overflows:A},reset:{placement:_}};let z=(R=A.filter(F=>F.overflows[0]<=0).sort((F,L)=>F.overflows[1]-L.overflows[1])[0])==null?void 0:R.placement;if(!z)switch(d){case"bestFit":{var N;let F=(N=A.filter(L=>{if(C){let k=_s(L.placement);return k===y||k==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(k=>k>0).reduce((k,K)=>k+K,0)]).sort((L,k)=>L[1]-k[1])[0])==null?void 0:N[0];F&&(z=F);break}case"initialPlacement":z=a;break}if(i!==z)return{reset:{placement:z}}}return{}}}};function lq(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function cq(e){return rq.some(t=>e[t]>=0)}var dq=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){let{rects:n}=t,{strategy:r="referenceHidden",...i}=Ma(e,t);switch(r){case"referenceHidden":{let o=await lm(t,{...i,elementContext:"reference"}),s=lq(o,n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:cq(s)}}}case"escaped":{let o=await lm(t,{...i,altBoundary:!0}),s=lq(o,n.floating);return{data:{escapedOffsets:s,escaped:cq(s)}}}default:return{}}}}};var mq=new Set(["left","top"]);async function gie(e,t){let{placement:n,platform:r,elements:i}=e,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=Ra(n),a=Mf(n),l=_s(n)==="y",c=mq.has(s)?-1:1,u=o&&l?-1:1,f=Ma(t,e),{mainAxis:p,crossAxis:d,alignmentAxis:h}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&typeof h=="number"&&(d=a==="end"?h*-1:h),l?{x:d*u,y:p*c}:{x:p*c,y:d*u}}var hq=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;let{x:i,y:o,placement:s,middlewareData:a}=t,l=await gie(t,e);return s===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},gq=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){let{x:n,y:r,placement:i}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:v=>{let{x:g,y}=v;return{x:g,y}}},...l}=Ma(e,t),c={x:n,y:r},u=await lm(t,l),f=_s(Ra(i)),p=zE(f),d=c[p],h=c[f];if(o){let v=p==="y"?"top":"left",g=p==="y"?"bottom":"right",y=d+u[v],b=d-u[g];d=BE(y,d,b)}if(s){let v=f==="y"?"top":"left",g=f==="y"?"bottom":"right",y=h+u[v],b=h-u[g];h=BE(y,h,b)}let m=a.fn({...t,[p]:d,[f]:h});return{...m,data:{x:m.x-n,y:m.y-r,enabled:{[p]:o,[f]:s}}}}}},yq=function(e){return e===void 0&&(e={}),{options:e,fn(t){let{x:n,y:r,placement:i,rects:o,middlewareData:s}=t,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=Ma(e,t),u={x:n,y:r},f=_s(i),p=zE(f),d=u[p],h=u[f],m=Ma(a,t),v=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){let b=p==="y"?"height":"width",w=o.reference[p]-o.floating[b]+v.mainAxis,S=o.reference[p]+o.reference[b]-v.mainAxis;d<w?d=w:d>S&&(d=S)}if(c){var g,y;let b=p==="y"?"width":"height",w=mq.has(Ra(i)),S=o.reference[f]-o.floating[b]+(w&&((g=s.offset)==null?void 0:g[f])||0)+(w?0:v.crossAxis),C=o.reference[f]+o.reference[b]+(w?0:((y=s.offset)==null?void 0:y[f])||0)-(w?v.crossAxis:0);h<S?h=S:h>C&&(h=C)}return{[p]:d,[f]:h}}}},vq=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;let{placement:i,rects:o,platform:s,elements:a}=t,{apply:l=()=>{},...c}=Ma(e,t),u=await lm(t,c),f=Ra(i),p=Mf(i),d=_s(i)==="y",{width:h,height:m}=o.floating,v,g;f==="top"||f==="bottom"?(v=f,g=p===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(g=f,v=p==="end"?"top":"bottom");let y=m-u.top-u.bottom,b=h-u.left-u.right,w=Aa(m-u[v],y),S=Aa(h-u[g],b),C=!t.middlewareData.shift,x=w,E=S;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(E=b),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(x=y),C&&!p){let A=di(u.left,0),M=di(u.right,0),R=di(u.top,0),N=di(u.bottom,0);d?E=h-2*(A!==0||M!==0?A+M:di(u.left,u.right)):x=m-2*(R!==0||N!==0?R+N:di(u.top,u.bottom))}await l({...t,availableWidth:E,availableHeight:x});let T=await s.getDimensions(a.floating);return h!==T.width||m!==T.height?{reset:{rects:!0}}:{}}}};function $E(){return typeof window<"u"}function Df(e){return Sq(e)?(e.nodeName||"").toLowerCase():"#document"}function zi(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Vs(e){var t;return(t=(Sq(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Sq(e){return $E()?e instanceof Node||e instanceof zi(e).Node:!1}function Wo(e){return $E()?e instanceof Element||e instanceof zi(e).Element:!1}function Ls(e){return $E()?e instanceof HTMLElement||e instanceof zi(e).HTMLElement:!1}function bq(e){return!$E()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof zi(e).ShadowRoot}var yie=new Set(["inline","contents"]);function cm(e){let{overflow:t,overflowX:n,overflowY:r,display:i}=Yo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!yie.has(i)}var vie=new Set(["table","td","th"]);function wq(e){return vie.has(Df(e))}var bie=[":popover-open",":modal"];function ov(e){return bie.some(t=>{try{return e.matches(t)}catch{return!1}})}var Sie=["transform","translate","scale","rotate","perspective"],wie=["transform","translate","scale","rotate","perspective","filter"],xie=["paint","layout","strict","content"];function jE(e){let t=qE(),n=Wo(e)?Yo(e):e;return Sie.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||wie.some(r=>(n.willChange||"").includes(r))||xie.some(r=>(n.contain||"").includes(r))}function xq(e){let t=Pl(e);for(;Ls(t)&&!If(t);){if(jE(t))return t;if(ov(t))return null;t=Pl(t)}return null}function qE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}var Eie=new Set(["html","body","#document"]);function If(e){return Eie.has(Df(e))}function Yo(e){return zi(e).getComputedStyle(e)}function sv(e){return Wo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Pl(e){if(Df(e)==="html")return e;let t=e.assignedSlot||e.parentNode||bq(e)&&e.host||Vs(e);return bq(t)?t.host:t}function Eq(e){let t=Pl(e);return If(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ls(t)&&cm(t)?t:Eq(t)}function Nf(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);let i=Eq(e),o=i===((r=e.ownerDocument)==null?void 0:r.body),s=zi(i);if(o){let a=GE(s);return t.concat(s,s.visualViewport||[],cm(i)?i:[],a&&n?Nf(a):[])}return t.concat(i,Nf(i,[],n))}function GE(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Mq(e){let t=Yo(e),n=parseFloat(t.width)||0,r=parseFloat(t.height)||0,i=Ls(e),o=i?e.offsetWidth:n,s=i?e.offsetHeight:r,a=rv(n)!==o||rv(r)!==s;return a&&(n=o,r=s),{width:n,height:r,$:a}}function PO(e){return Wo(e)?e:e.contextElement}function um(e){let t=PO(e);if(!Ls(t))return ks(1);let n=t.getBoundingClientRect(),{width:r,height:i,$:o}=Mq(t),s=(o?rv(n.width):n.width)/r,a=(o?rv(n.height):n.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}var Cie=ks(0);function Rq(e){let t=zi(e);return!qE()||!t.visualViewport?Cie:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Tie(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==zi(e)?!1:t}function Of(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);let i=e.getBoundingClientRect(),o=PO(e),s=ks(1);t&&(r?Wo(r)&&(s=um(r)):s=um(e));let a=Tie(o,n,r)?Rq(o):ks(0),l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,f=i.height/s.y;if(o){let p=zi(o),d=r&&Wo(r)?zi(r):r,h=p,m=GE(h);for(;m&&r&&d!==h;){let v=um(m),g=m.getBoundingClientRect(),y=Yo(m),b=g.left+(m.clientLeft+parseFloat(y.paddingLeft))*v.x,w=g.top+(m.clientTop+parseFloat(y.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,f*=v.y,l+=b,c+=w,h=zi(m),m=GE(h)}}return Rf({width:u,height:f,x:l,y:c})}function KE(e,t){let n=sv(e).scrollLeft;return t?t.left+n:Of(Vs(e)).left+n}function Nq(e,t){let n=e.getBoundingClientRect(),r=n.left+t.scrollLeft-KE(e,n),i=n.top+t.scrollTop;return{x:r,y:i}}function Aie(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e,o=i==="fixed",s=Vs(r),a=t?ov(t.floating):!1;if(r===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=ks(1),u=ks(0),f=Ls(r);if((f||!f&&!o)&&((Df(r)!=="body"||cm(s))&&(l=sv(r)),Ls(r))){let d=Of(r);c=um(r),u.x=d.x+r.clientLeft,u.y=d.y+r.clientTop}let p=s&&!f&&!o?Nq(s,l):ks(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+p.x,y:n.y*c.y-l.scrollTop*c.y+u.y+p.y}}function Mie(e){return Array.from(e.getClientRects())}function Rie(e){let t=Vs(e),n=sv(e),r=e.ownerDocument.body,i=di(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=di(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight),s=-n.scrollLeft+KE(e),a=-n.scrollTop;return Yo(r).direction==="rtl"&&(s+=di(t.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}var Cq=25;function Nie(e,t){let n=zi(e),r=Vs(e),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;let u=qE();(!u||u&&t==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}let c=KE(r);if(c<=0){let u=r.ownerDocument,f=u.body,p=getComputedStyle(f),d=u.compatMode==="CSS1Compat"&&parseFloat(p.marginLeft)+parseFloat(p.marginRight)||0,h=Math.abs(r.clientWidth-f.clientWidth-d);h<=Cq&&(o-=h)}else c<=Cq&&(o+=c);return{width:o,height:s,x:a,y:l}}var Die=new Set(["absolute","fixed"]);function Iie(e,t){let n=Of(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,o=Ls(e)?um(e):ks(1),s=e.clientWidth*o.x,a=e.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function Tq(e,t,n){let r;if(t==="viewport")r=Nie(e,n);else if(t==="document")r=Rie(Vs(e));else if(Wo(t))r=Iie(t,n);else{let i=Rq(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Rf(r)}function Dq(e,t){let n=Pl(e);return n===t||!Wo(n)||If(n)?!1:Yo(n).position==="fixed"||Dq(n,t)}function Oie(e,t){let n=t.get(e);if(n)return n;let r=Nf(e,[],!1).filter(a=>Wo(a)&&Df(a)!=="body"),i=null,o=Yo(e).position==="fixed",s=o?Pl(e):e;for(;Wo(s)&&!If(s);){let a=Yo(s),l=jE(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&Die.has(i.position)||cm(s)&&!l&&Dq(e,s))?r=r.filter(u=>u!==s):i=a,s=Pl(s)}return t.set(e,r),r}function Pie(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e,s=[...n==="clippingAncestors"?ov(t)?[]:Oie(t,this._c):[].concat(n),r],a=s[0],l=s.reduce((c,u)=>{let f=Tq(t,u,i);return c.top=di(f.top,c.top),c.right=Aa(f.right,c.right),c.bottom=Aa(f.bottom,c.bottom),c.left=di(f.left,c.left),c},Tq(t,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function kie(e){let{width:t,height:n}=Mq(e);return{width:t,height:n}}function _ie(e,t,n){let r=Ls(t),i=Vs(t),o=n==="fixed",s=Of(e,!0,o,t),a={scrollLeft:0,scrollTop:0},l=ks(0);function c(){l.x=KE(i)}if(r||!r&&!o)if((Df(t)!=="body"||cm(i))&&(a=sv(t)),r){let d=Of(t,!0,o,t);l.x=d.x+t.clientLeft,l.y=d.y+t.clientTop}else i&&c();o&&!r&&i&&c();let u=i&&!r&&!o?Nq(i,a):ks(0),f=s.left+a.scrollLeft-l.x-u.x,p=s.top+a.scrollTop-l.y-u.y;return{x:f,y:p,width:s.width,height:s.height}}function OO(e){return Yo(e).position==="static"}function Aq(e,t){if(!Ls(e)||Yo(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Vs(e)===n&&(n=n.ownerDocument.body),n}function Iq(e,t){let n=zi(e);if(ov(e))return n;if(!Ls(e)){let i=Pl(e);for(;i&&!If(i);){if(Wo(i)&&!OO(i))return i;i=Pl(i)}return n}let r=Aq(e,t);for(;r&&wq(r)&&OO(r);)r=Aq(r,t);return r&&If(r)&&OO(r)&&!jE(r)?n:r||xq(e)||n}var Vie=async function(e){let t=this.getOffsetParent||Iq,n=this.getDimensions,r=await n(e.floating);return{reference:_ie(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Lie(e){return Yo(e).direction==="rtl"}var Oq={convertOffsetParentRelativeRectToViewportRelativeRect:Aie,getDocumentElement:Vs,getClippingRect:Pie,getOffsetParent:Iq,getElementRects:Vie,getClientRects:Mie,getDimensions:kie,getScale:um,isElement:Wo,isRTL:Lie};function Pq(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Fie(e,t){let n=null,r,i=Vs(e);function o(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();let c=e.getBoundingClientRect(),{left:u,top:f,width:p,height:d}=c;if(a||t(),!p||!d)return;let h=iv(f),m=iv(i.clientWidth-(u+p)),v=iv(i.clientHeight-(f+d)),g=iv(u),b={rootMargin:-h+"px "+-m+"px "+-v+"px "+-g+"px",threshold:di(0,Aa(1,l))||1},w=!0;function S(C){let x=C[0].intersectionRatio;if(x!==l){if(!w)return s();x?s(!1,x):r=setTimeout(()=>{s(!1,1e-7)},1e3)}x===1&&!Pq(c,e.getBoundingClientRect())&&s(),w=!1}try{n=new IntersectionObserver(S,{...b,root:i.ownerDocument})}catch{n=new IntersectionObserver(S,b)}n.observe(e)}return s(!0),o}function kO(e,t,n,r){r===void 0&&(r={});let{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=PO(e),u=i||o?[...c?Nf(c):[],...Nf(t)]:[];u.forEach(g=>{i&&g.addEventListener("scroll",n,{passive:!0}),o&&g.addEventListener("resize",n)});let f=c&&a?Fie(c,n):null,p=-1,d=null;s&&(d=new ResizeObserver(g=>{let[y]=g;y&&y.target===c&&d&&(d.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(t)})),n()}),c&&!l&&d.observe(c),d.observe(t));let h,m=l?Of(e):null;l&&v();function v(){let g=Of(e);m&&!Pq(m,g)&&n(),m=g,h=requestAnimationFrame(v)}return n(),()=>{var g;u.forEach(y=>{i&&y.removeEventListener("scroll",n),o&&y.removeEventListener("resize",n)}),f?.(),(g=d)==null||g.disconnect(),d=null,l&&cancelAnimationFrame(h)}}var kq=hq;var _q=gq,Vq=pq,Lq=vq,Fq=dq,_O=fq;var Bq=yq,VO=(e,t,n)=>{let r=new Map,i={platform:Oq,...n},o={...i.platform,_c:r};return uq(e,t,{...i,platform:o})};var Kn=D(U(),1),Hq=D(U(),1),Uq=D(ef(),1),Bie=typeof document<"u",zie=function(){},WE=Bie?Hq.useLayoutEffect:zie;function YE(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!YE(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){let o=i[r];if(!(o==="_owner"&&e.$$typeof)&&!YE(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function $q(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function zq(e,t){let n=$q(e);return Math.round(t*n)/n}function LO(e){let t=Kn.useRef(e);return WE(()=>{t.current=e}),t}function jq(e){e===void 0&&(e={});let{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,f]=Kn.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,d]=Kn.useState(r);YE(p,r)||d(r);let[h,m]=Kn.useState(null),[v,g]=Kn.useState(null),y=Kn.useCallback(L=>{L!==C.current&&(C.current=L,m(L))},[]),b=Kn.useCallback(L=>{L!==x.current&&(x.current=L,g(L))},[]),w=o||h,S=s||v,C=Kn.useRef(null),x=Kn.useRef(null),E=Kn.useRef(u),T=l!=null,A=LO(l),M=LO(i),R=LO(c),N=Kn.useCallback(()=>{if(!C.current||!x.current)return;let L={placement:t,strategy:n,middleware:p};M.current&&(L.platform=M.current),VO(C.current,x.current,L).then(k=>{let K={...k,isPositioned:R.current!==!1};I.current&&!YE(E.current,K)&&(E.current=K,Uq.flushSync(()=>{f(K)}))})},[p,t,n,M,R]);WE(()=>{c===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f(L=>({...L,isPositioned:!1})))},[c]);let I=Kn.useRef(!1);WE(()=>(I.current=!0,()=>{I.current=!1}),[]),WE(()=>{if(w&&(C.current=w),S&&(x.current=S),w&&S){if(A.current)return A.current(w,S,N);N()}},[w,S,N,A,T]);let _=Kn.useMemo(()=>({reference:C,floating:x,setReference:y,setFloating:b}),[y,b]),z=Kn.useMemo(()=>({reference:w,floating:S}),[w,S]),F=Kn.useMemo(()=>{let L={position:n,left:0,top:0};if(!z.floating)return L;let k=zq(z.floating,u.x),K=zq(z.floating,u.y);return a?{...L,transform:"translate("+k+"px, "+K+"px)",...$q(z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:k,top:K}},[n,a,z.floating,u.x,u.y]);return Kn.useMemo(()=>({...u,update:N,refs:_,elements:z,floatingStyles:F}),[u,N,_,z,F])}var Hie=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){let{element:r,padding:i}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?_O({element:r.current,padding:i}).fn(n):{}:r?_O({element:r,padding:i}).fn(n):{}}}},qq=(e,t)=>({...kq(e),options:[e,t]}),Gq=(e,t)=>({..._q(e),options:[e,t]}),Kq=(e,t)=>({...Bq(e),options:[e,t]}),Wq=(e,t)=>({...Vq(e),options:[e,t]}),Yq=(e,t)=>({...Lq(e),options:[e,t]});var Qq=(e,t)=>({...Fq(e),options:[e,t]});var Xq=(e,t)=>({...Hie(e),options:[e,t]});var Zq=D(U(),1);var FO=D(j(),1),Uie="Arrow",Jq=Zq.forwardRef((e,t)=>{let{children:n,width:r=10,height:i=5,...o}=e;return(0,FO.jsx)(Tn.svg,{...o,ref:t,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:(0,FO.jsx)("polygon",{points:"0,0 30,0 15,10"})})});Jq.displayName=Uie;var eG=Jq;var tG=D(U(),1);function nG(e){let[t,n]=tG.useState(void 0);return Bi(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;let o=i[0],s,a;if("borderBoxSize"in o){let l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=e.offsetWidth,a=e.offsetHeight;n({width:s,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var Zc=D(j(),1);var BO="Popper",[rG,zO]=Ta(BO),[jie,iG]=rG(BO),oG=e=>{let{__scopePopper:t,children:n}=e,[r,i]=Hi.useState(null);return(0,Zc.jsx)(jie,{scope:t,anchor:r,onAnchorChange:i,children:n})};oG.displayName=BO;var sG="PopperAnchor",aG=Hi.forwardRef((e,t)=>{let{__scopePopper:n,virtualRef:r,...i}=e,o=iG(sG,n),s=Hi.useRef(null),a=Bn(t,s),l=Hi.useRef(null);return Hi.useEffect(()=>{let c=l.current;l.current=r?.current||s.current,c!==l.current&&o.onAnchorChange(l.current)}),r?null:(0,Zc.jsx)(Tn.div,{...i,ref:a})});aG.displayName=sG;var HO="PopperContent",[qie,Gie]=rG(HO),lG=Hi.forwardRef((e,t)=>{let{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:o="center",alignOffset:s=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:d="optimized",onPlaced:h,...m}=e,v=iG(HO,n),[g,y]=Hi.useState(null),b=Bn(t,pe=>y(pe)),[w,S]=Hi.useState(null),C=nG(w),x=C?.width??0,E=C?.height??0,T=r+(o!=="center"?"-"+o:""),A=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},M=Array.isArray(c)?c:[c],R=M.length>0,N={padding:A,boundary:M.filter(Wie),altBoundary:R},{refs:I,floatingStyles:_,placement:z,isPositioned:F,middlewareData:L}=jq({strategy:"fixed",placement:T,whileElementsMounted:(...pe)=>kO(...pe,{animationFrame:d==="always"}),elements:{reference:v.anchor},middleware:[qq({mainAxis:i+E,alignmentAxis:s}),l&&Gq({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?Kq():void 0,...N}),l&&Wq({...N}),Yq({...N,apply:({elements:pe,rects:V,availableWidth:Q,availableHeight:Y})=>{let{width:Ie,height:yt}=V.reference,mt=pe.floating.style;mt.setProperty("--radix-popper-available-width",`${Q}px`),mt.setProperty("--radix-popper-available-height",`${Y}px`),mt.setProperty("--radix-popper-anchor-width",`${Ie}px`),mt.setProperty("--radix-popper-anchor-height",`${yt}px`)}}),w&&Xq({element:w,padding:a}),Yie({arrowWidth:x,arrowHeight:E}),p&&Qq({strategy:"referenceHidden",...N})]}),[k,K]=fG(z),ee=Wr(h);Bi(()=>{F&&ee?.()},[F,ee]);let Se=L.arrow?.x,De=L.arrow?.y,we=L.arrow?.centerOffset!==0,[qe,Fe]=Hi.useState();return Bi(()=>{g&&Fe(window.getComputedStyle(g).zIndex)},[g]),(0,Zc.jsx)("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{..._,transform:F?_.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:qe,"--radix-popper-transform-origin":[L.transformOrigin?.x,L.transformOrigin?.y].join(" "),...L.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:(0,Zc.jsx)(qie,{scope:n,placedSide:k,onArrowChange:S,arrowX:Se,arrowY:De,shouldHideArrow:we,children:(0,Zc.jsx)(Tn.div,{"data-side":k,"data-align":K,...m,ref:b,style:{...m.style,animation:F?void 0:"none"}})})})});lG.displayName=HO;var cG="PopperArrow",Kie={top:"bottom",right:"left",bottom:"top",left:"right"},uG=Hi.forwardRef(function(t,n){let{__scopePopper:r,...i}=t,o=Gie(cG,r),s=Kie[o.placedSide];return(0,Zc.jsx)("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:(0,Zc.jsx)(eG,{...i,ref:n,style:{...i.style,display:"block"}})})});uG.displayName=cG;function Wie(e){return e!==null}var Yie=e=>({name:"transformOrigin",options:e,fn(t){let{placement:n,rects:r,middlewareData:i}=t,s=i.arrow?.centerOffset!==0,a=s?0:e.arrowWidth,l=s?0:e.arrowHeight,[c,u]=fG(n),f={start:"0%",center:"50%",end:"100%"}[u],p=(i.arrow?.x??0)+a/2,d=(i.arrow?.y??0)+l/2,h="",m="";return c==="bottom"?(h=s?f:`${p}px`,m=`${-l}px`):c==="top"?(h=s?f:`${p}px`,m=`${r.floating.height+l}px`):c==="right"?(h=`${-l}px`,m=s?f:`${d}px`):c==="left"&&(h=`${r.floating.width+l}px`,m=s?f:`${d}px`),{data:{x:h,y:m}}}});function fG(e){let[t,n="center"]=e.split("-");return[t,n]}var UO=oG,pG=aG,dG=lG,mG=uG;var QE=D(U(),1),hG=D(ef(),1);var gG=D(j(),1),Xie="Portal",$O=QE.forwardRef((e,t)=>{let{container:n,...r}=e,[i,o]=QE.useState(!1);Bi(()=>o(!0),[]);let s=n||i&&globalThis?.document?.body;return s?hG.default.createPortal((0,gG.jsx)(Tn.div,{...r,ref:t}),s):null});$O.displayName=Xie;var Ui=D(U(),1);var yG=D(U(),1);function Zie(e,t){return yG.useReducer((n,r)=>t[n][r]??n,e)}var fm=e=>{let{present:t,children:n}=e,r=Jie(t),i=typeof n=="function"?n({present:r.isPresent}):Ui.Children.only(n),o=Bn(r.ref,eoe(i));return typeof n=="function"||r.isPresent?Ui.cloneElement(i,{ref:o}):null};fm.displayName="Presence";function Jie(e){let[t,n]=Ui.useState(),r=Ui.useRef(null),i=Ui.useRef(e),o=Ui.useRef("none"),s=e?"mounted":"unmounted",[a,l]=Zie(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Ui.useEffect(()=>{let c=XE(r.current);o.current=a==="mounted"?c:"none"},[a]),Bi(()=>{let c=r.current,u=i.current;if(u!==e){let p=o.current,d=XE(c);e?l("MOUNT"):d==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&p!==d?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),Bi(()=>{if(t){let c,u=t.ownerDocument.defaultView??window,f=d=>{let m=XE(r.current).includes(CSS.escape(d.animationName));if(d.target===t&&m&&(l("ANIMATION_END"),!i.current)){let v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},p=d=>{d.target===t&&(o.current=XE(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:Ui.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function XE(e){return e?.animationName||"none"}function eoe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Sr=D(U(),1);var Jc=D(j(),1),jO="rovingFocusGroup.onEntryFocus",toe={bubbles:!1,cancelable:!0},av="RovingFocusGroup",[qO,vG,noe]=_E(av),[roe,GO]=Ta(av,[noe]),[ioe,ooe]=roe(av),bG=Sr.forwardRef((e,t)=>(0,Jc.jsx)(qO.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,Jc.jsx)(qO.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,Jc.jsx)(soe,{...e,ref:t})})}));bG.displayName=av;var soe=Sr.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...f}=e,p=Sr.useRef(null),d=Bn(t,p),h=LE(o),[m,v]=tv({prop:s,defaultProp:a??null,onChange:l,caller:av}),[g,y]=Sr.useState(!1),b=Wr(c),w=vG(n),S=Sr.useRef(!1),[C,x]=Sr.useState(0);return Sr.useEffect(()=>{let E=p.current;if(E)return E.addEventListener(jO,b),()=>E.removeEventListener(jO,b)},[b]),(0,Jc.jsx)(ioe,{scope:n,orientation:r,dir:h,loop:i,currentTabStopId:m,onItemFocus:Sr.useCallback(E=>v(E),[v]),onItemShiftTab:Sr.useCallback(()=>y(!0),[]),onFocusableItemAdd:Sr.useCallback(()=>x(E=>E+1),[]),onFocusableItemRemove:Sr.useCallback(()=>x(E=>E-1),[]),children:(0,Jc.jsx)(Tn.div,{tabIndex:g||C===0?-1:0,"data-orientation":r,...f,ref:d,style:{outline:"none",...e.style},onMouseDown:ot(e.onMouseDown,()=>{S.current=!0}),onFocus:ot(e.onFocus,E=>{let T=!S.current;if(E.target===E.currentTarget&&T&&!g){let A=new CustomEvent(jO,toe);if(E.currentTarget.dispatchEvent(A),!A.defaultPrevented){let M=w().filter(z=>z.focusable),R=M.find(z=>z.active),N=M.find(z=>z.id===m),_=[R,N,...M].filter(Boolean).map(z=>z.ref.current);xG(_,u)}}S.current=!1}),onBlur:ot(e.onBlur,()=>y(!1))})})}),SG="RovingFocusGroupItem",wG=Sr.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:o,children:s,...a}=e,l=Xc(),c=o||l,u=ooe(SG,n),f=u.currentTabStopId===c,p=vG(n),{onFocusableItemAdd:d,onFocusableItemRemove:h,currentTabStopId:m}=u;return Sr.useEffect(()=>{if(r)return d(),()=>h()},[r,d,h]),(0,Jc.jsx)(qO.ItemSlot,{scope:n,id:c,focusable:r,active:i,children:(0,Jc.jsx)(Tn.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...a,ref:t,onMouseDown:ot(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:ot(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:ot(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;let g=coe(v,u.orientation,u.dir);if(g!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let b=p().filter(w=>w.focusable).map(w=>w.ref.current);if(g==="last")b.reverse();else if(g==="prev"||g==="next"){g==="prev"&&b.reverse();let w=b.indexOf(v.currentTarget);b=u.loop?uoe(b,w+1):b.slice(w+1)}setTimeout(()=>xG(b))}}),children:typeof s=="function"?s({isCurrentTabStop:f,hasTabStop:m!=null}):s})})});wG.displayName=SG;var aoe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function loe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function coe(e,t,n){let r=loe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return aoe[r]}function xG(e,t=!1){let n=document.activeElement;for(let r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function uoe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var EG=bG,CG=wG;var poe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},pm=new WeakMap,ZE=new WeakMap,JE={},KO=0,TG=function(e){return e&&(e.host||TG(e.parentNode))},doe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=TG(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},moe=function(e,t,n,r){var i=doe(t,Array.isArray(e)?e:[e]);JE[n]||(JE[n]=new WeakMap);var o=JE[n],s=[],a=new Set,l=new Set(i),c=function(f){!f||a.has(f)||(a.add(f),c(f.parentNode))};i.forEach(c);var u=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(p){if(a.has(p))u(p);else try{var d=p.getAttribute(r),h=d!==null&&d!=="false",m=(pm.get(p)||0)+1,v=(o.get(p)||0)+1;pm.set(p,m),o.set(p,v),s.push(p),m===1&&h&&ZE.set(p,!0),v===1&&p.setAttribute(n,"true"),h||p.setAttribute(r,"true")}catch(g){console.error("aria-hidden: cannot operate on ",p,g)}})};return u(t),a.clear(),KO++,function(){s.forEach(function(f){var p=pm.get(f)-1,d=o.get(f)-1;pm.set(f,p),o.set(f,d),p||(ZE.has(f)||f.removeAttribute(r),ZE.delete(f)),d||f.removeAttribute(n)}),KO--,KO||(pm=new WeakMap,pm=new WeakMap,ZE=new WeakMap,JE={})}},AG=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=t||poe(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live], script"))),moe(r,i,n,"aria-hidden")):function(){return null}};var $i=function(){return $i=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},$i.apply(this,arguments)};function eC(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function MG(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,o;r<i;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var oC=D(U());var Yr=D(U());var Pf="right-scroll-bar-position",kf="width-before-scroll-bar",WO="with-scroll-bars-hidden",YO="--removed-body-scroll-bar-size";function tC(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}var RG=D(U());function NG(e,t){var n=(0,RG.useState)(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}var nC=D(U());var hoe=typeof window<"u"?nC.useLayoutEffect:nC.useEffect,DG=new WeakMap;function QO(e,t){var n=NG(t||null,function(r){return e.forEach(function(i){return tC(i,r)})});return hoe(function(){var r=DG.get(n);if(r){var i=new Set(r),o=new Set(e),s=n.current;i.forEach(function(a){o.has(a)||tC(a,null)}),o.forEach(function(a){i.has(a)||tC(a,s)})}DG.set(n,e)},[e]),n}function goe(e){return e}function yoe(e,t){t===void 0&&(t=goe);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var s=t(o,r);return n.push(s),function(){n=n.filter(function(a){return a!==s})}},assignSyncMedium:function(o){for(r=!0;n.length;){var s=n;n=[],s.forEach(o)}n={push:function(a){return o(a)},filter:function(){return n}}},assignMedium:function(o){r=!0;var s=[];if(n.length){var a=n;n=[],a.forEach(o),s=n}var l=function(){var u=s;s=[],u.forEach(o)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),n}}}};return i}function XO(e){e===void 0&&(e={});var t=yoe(null);return t.options=$i({async:!0,ssr:!1},e),t}var IG=D(U()),OG=function(e){var t=e.sideCar,n=eC(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return IG.createElement(r,$i({},n))};OG.isSideCarExport=!0;function ZO(e,t){return e.useMedium(t),OG}var rC=XO();var JO=function(){},lv=Yr.forwardRef(function(e,t){var n=Yr.useRef(null),r=Yr.useState({onScrollCapture:JO,onWheelCapture:JO,onTouchMoveCapture:JO}),i=r[0],o=r[1],s=e.forwardProps,a=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,f=e.shards,p=e.sideCar,d=e.noRelative,h=e.noIsolation,m=e.inert,v=e.allowPinchZoom,g=e.as,y=g===void 0?"div":g,b=e.gapMode,w=eC(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,C=QO([n,t]),x=$i($i({},w),i);return Yr.createElement(Yr.Fragment,null,u&&Yr.createElement(S,{sideCar:rC,removeScrollBar:c,shards:f,noRelative:d,noIsolation:h,inert:m,setCallbacks:o,allowPinchZoom:!!v,lockRef:n,gapMode:b}),s?Yr.cloneElement(Yr.Children.only(a),$i($i({},x),{ref:C})):Yr.createElement(y,$i({},x,{className:l,ref:C}),a))});lv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};lv.classNames={fullWidth:kf,zeroRight:Pf};var rn=D(U());var mm=D(U());var _G=D(U());var PG;var kG=function(){if(PG)return PG;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function voe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=kG();return t&&e.setAttribute("nonce",t),e}function boe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Soe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var eP=function(){var e=0,t=null;return{add:function(n){e==0&&(t=voe())&&(boe(t,n),Soe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}};var tP=function(){var e=eP();return function(t,n){_G.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}};var cv=function(){var e=tP(),t=function(n){var r=n.styles,i=n.dynamic;return e(r,i),null};return t};var woe={left:0,top:0,right:0,gap:0},nP=function(e){return parseInt(e||"",10)||0},xoe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[nP(n),nP(r),nP(i)]},rP=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return woe;var t=xoe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}};var Eoe=cv(),dm="data-scroll-locked",Coe=function(e,t,n,r){var i=e.left,o=e.top,s=e.right,a=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(WO,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(dm,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Pf,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(kf,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Pf," .").concat(Pf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(kf," .").concat(kf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(dm,`] {
    `).concat(YO,": ").concat(a,`px;
  }
`)},VG=function(){var e=parseInt(document.body.getAttribute(dm)||"0",10);return isFinite(e)?e:0},Toe=function(){mm.useEffect(function(){return document.body.setAttribute(dm,(VG()+1).toString()),function(){var e=VG()-1;e<=0?document.body.removeAttribute(dm):document.body.setAttribute(dm,e.toString())}},[])},iP=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=r===void 0?"margin":r;Toe();var o=mm.useMemo(function(){return rP(i)},[i]);return mm.createElement(Eoe,{styles:Coe(o,!t,i,n?"":"!important")})};var oP=!1;if(typeof window<"u")try{uv=Object.defineProperty({},"passive",{get:function(){return oP=!0,!0}}),window.addEventListener("test",uv,uv),window.removeEventListener("test",uv,uv)}catch{oP=!1}var uv,_f=oP?{passive:!1}:!1;var Aoe=function(e){return e.tagName==="TEXTAREA"},LG=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Aoe(e)&&n[t]==="visible")},Moe=function(e){return LG(e,"overflowY")},Roe=function(e){return LG(e,"overflowX")},sP=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=FG(e,r);if(i){var o=BG(e,r),s=o[1],a=o[2];if(s>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Noe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Doe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},FG=function(e,t){return e==="v"?Moe(t):Roe(t)},BG=function(e,t){return e==="v"?Noe(t):Doe(t)},Ioe=function(e,t){return e==="h"&&t==="rtl"?-1:1},zG=function(e,t,n,r,i){var o=Ioe(e,window.getComputedStyle(t).direction),s=o*r,a=n.target,l=t.contains(a),c=!1,u=s>0,f=0,p=0;do{if(!a)break;var d=BG(e,a),h=d[0],m=d[1],v=d[2],g=m-v-o*h;(h||g)&&FG(e,a)&&(f+=g,p+=h);var y=a.parentNode;a=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!l&&a!==document.body||l&&(t.contains(a)||t===a));return(u&&(i&&Math.abs(f)<1||!i&&s>f)||!u&&(i&&Math.abs(p)<1||!i&&-s>p))&&(c=!0),c};var iC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},HG=function(e){return[e.deltaX,e.deltaY]},UG=function(e){return e&&"current"in e?e.current:e},Ooe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Poe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},koe=0,hm=[];function $G(e){var t=rn.useRef([]),n=rn.useRef([0,0]),r=rn.useRef(),i=rn.useState(koe++)[0],o=rn.useState(cv)[0],s=rn.useRef(e);rn.useEffect(function(){s.current=e},[e]),rn.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var m=MG([e.lockRef.current],(e.shards||[]).map(UG),!0).filter(Boolean);return m.forEach(function(v){return v.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),m.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var a=rn.useCallback(function(m,v){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!s.current.allowPinchZoom;var g=iC(m),y=n.current,b="deltaX"in m?m.deltaX:y[0]-g[0],w="deltaY"in m?m.deltaY:y[1]-g[1],S,C=m.target,x=Math.abs(b)>Math.abs(w)?"h":"v";if("touches"in m&&x==="h"&&C.type==="range")return!1;var E=window.getSelection(),T=E&&E.anchorNode,A=T?T===C||T.contains(C):!1;if(A)return!1;var M=sP(x,C);if(!M)return!0;if(M?S=x:(S=x==="v"?"h":"v",M=sP(x,C)),!M)return!1;if(!r.current&&"changedTouches"in m&&(b||w)&&(r.current=S),!S)return!0;var R=r.current||S;return zG(R,v,m,R==="h"?b:w,!0)},[]),l=rn.useCallback(function(m){var v=m;if(!(!hm.length||hm[hm.length-1]!==o)){var g="deltaY"in v?HG(v):iC(v),y=t.current.filter(function(S){return S.name===v.type&&(S.target===v.target||v.target===S.shadowParent)&&Ooe(S.delta,g)})[0];if(y&&y.should){v.cancelable&&v.preventDefault();return}if(!y){var b=(s.current.shards||[]).map(UG).filter(Boolean).filter(function(S){return S.contains(v.target)}),w=b.length>0?a(v,b[0]):!s.current.noIsolation;w&&v.cancelable&&v.preventDefault()}}},[]),c=rn.useCallback(function(m,v,g,y){var b={name:m,delta:v,target:g,should:y,shadowParent:_oe(g)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(w){return w!==b})},1)},[]),u=rn.useCallback(function(m){n.current=iC(m),r.current=void 0},[]),f=rn.useCallback(function(m){c(m.type,HG(m),m.target,a(m,e.lockRef.current))},[]),p=rn.useCallback(function(m){c(m.type,iC(m),m.target,a(m,e.lockRef.current))},[]);rn.useEffect(function(){return hm.push(o),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",l,_f),document.addEventListener("touchmove",l,_f),document.addEventListener("touchstart",u,_f),function(){hm=hm.filter(function(m){return m!==o}),document.removeEventListener("wheel",l,_f),document.removeEventListener("touchmove",l,_f),document.removeEventListener("touchstart",u,_f)}},[]);var d=e.removeScrollBar,h=e.inert;return rn.createElement(rn.Fragment,null,h?rn.createElement(o,{styles:Poe(i)}):null,d?rn.createElement(iP,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function _oe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}var jG=ZO(rC,$G);var qG=oC.forwardRef(function(e,t){return oC.createElement(lv,$i({},e,{ref:t,sideCar:jG}))});qG.classNames=lv.classNames;var aP=qG;var ze=D(j(),1),lP=["Enter"," "],Voe=["ArrowDown","PageUp","Home"],KG=["ArrowUp","PageDown","End"],Loe=[...Voe,...KG],Foe={ltr:[...lP,"ArrowRight"],rtl:[...lP,"ArrowLeft"]},Boe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},mv="Menu",[pv,zoe,Hoe]=_E(mv),[Vf,cP]=Ta(mv,[Hoe,zO,GO]),hv=zO(),WG=GO(),[YG,eu]=Vf(mv),[Uoe,gv]=Vf(mv),QG=e=>{let{__scopeMenu:t,open:n=!1,children:r,dir:i,onOpenChange:o,modal:s=!0}=e,a=hv(t),[l,c]=Me.useState(null),u=Me.useRef(!1),f=Wr(o),p=LE(i);return Me.useEffect(()=>{let d=()=>{u.current=!0,document.addEventListener("pointerdown",h,{capture:!0,once:!0}),document.addEventListener("pointermove",h,{capture:!0,once:!0})},h=()=>u.current=!1;return document.addEventListener("keydown",d,{capture:!0}),()=>{document.removeEventListener("keydown",d,{capture:!0}),document.removeEventListener("pointerdown",h,{capture:!0}),document.removeEventListener("pointermove",h,{capture:!0})}},[]),(0,ze.jsx)(UO,{...a,children:(0,ze.jsx)(YG,{scope:t,open:n,onOpenChange:f,content:l,onContentChange:c,children:(0,ze.jsx)(Uoe,{scope:t,onClose:Me.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:p,modal:s,children:r})})})};QG.displayName=mv;var $oe="MenuAnchor",uP=Me.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e,i=hv(n);return(0,ze.jsx)(pG,{...i,...r,ref:t})});uP.displayName=$oe;var fP="MenuPortal",[joe,XG]=Vf(fP,{forceMount:void 0}),ZG=e=>{let{__scopeMenu:t,forceMount:n,children:r,container:i}=e,o=eu(fP,t);return(0,ze.jsx)(joe,{scope:t,forceMount:n,children:(0,ze.jsx)(fm,{present:n||o.open,children:(0,ze.jsx)($O,{asChild:!0,container:i,children:r})})})};ZG.displayName=fP;var Qo="MenuContent",[qoe,pP]=Vf(Qo),JG=Me.forwardRef((e,t)=>{let n=XG(Qo,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,o=eu(Qo,e.__scopeMenu),s=gv(Qo,e.__scopeMenu);return(0,ze.jsx)(pv.Provider,{scope:e.__scopeMenu,children:(0,ze.jsx)(fm,{present:r||o.open,children:(0,ze.jsx)(pv.Slot,{scope:e.__scopeMenu,children:s.modal?(0,ze.jsx)(Goe,{...i,ref:t}):(0,ze.jsx)(Koe,{...i,ref:t})})})})}),Goe=Me.forwardRef((e,t)=>{let n=eu(Qo,e.__scopeMenu),r=Me.useRef(null),i=Bn(t,r);return Me.useEffect(()=>{let o=r.current;if(o)return AG(o)},[]),(0,ze.jsx)(dP,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ot(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Koe=Me.forwardRef((e,t)=>{let n=eu(Qo,e.__scopeMenu);return(0,ze.jsx)(dP,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Woe=Af("MenuContent.ScrollLock"),dP=Me.forwardRef((e,t)=>{let{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:p,onDismiss:d,disableOutsideScroll:h,...m}=e,v=eu(Qo,n),g=gv(Qo,n),y=hv(n),b=WG(n),w=zoe(n),[S,C]=Me.useState(null),x=Me.useRef(null),E=Bn(t,x,v.onContentChange),T=Me.useRef(0),A=Me.useRef(""),M=Me.useRef(0),R=Me.useRef(null),N=Me.useRef("right"),I=Me.useRef(0),_=h?aP:Me.Fragment,z=h?{as:Woe,allowPinchZoom:!0}:void 0,F=k=>{let K=A.current+k,ee=w().filter(pe=>!pe.disabled),Se=document.activeElement,De=ee.find(pe=>pe.ref.current===Se)?.textValue,we=ee.map(pe=>pe.textValue),qe=sse(we,K,De),Fe=ee.find(pe=>pe.textValue===qe)?.ref.current;(function pe(V){A.current=V,window.clearTimeout(T.current),V!==""&&(T.current=window.setTimeout(()=>pe(""),1e3))})(K),Fe&&setTimeout(()=>Fe.focus())};Me.useEffect(()=>()=>window.clearTimeout(T.current),[]),Wj();let L=Me.useCallback(k=>N.current===R.current?.side&&lse(k,R.current?.area),[]);return(0,ze.jsx)(qoe,{scope:n,searchRef:A,onItemEnter:Me.useCallback(k=>{L(k)&&k.preventDefault()},[L]),onItemLeave:Me.useCallback(k=>{L(k)||(x.current?.focus(),C(null))},[L]),onTriggerLeave:Me.useCallback(k=>{L(k)&&k.preventDefault()},[L]),pointerGraceTimerRef:M,onPointerGraceIntentChange:Me.useCallback(k=>{R.current=k},[]),children:(0,ze.jsx)(_,{...z,children:(0,ze.jsx)(NO,{asChild:!0,trapped:i,onMountAutoFocus:ot(o,k=>{k.preventDefault(),x.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:(0,ze.jsx)(TO,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:p,onDismiss:d,children:(0,ze.jsx)(EG,{asChild:!0,...b,dir:g.dir,orientation:"vertical",loop:r,currentTabStopId:S,onCurrentTabStopIdChange:C,onEntryFocus:ot(l,k=>{g.isUsingKeyboardRef.current||k.preventDefault()}),preventScrollOnEntryFocus:!0,children:(0,ze.jsx)(dG,{role:"menu","aria-orientation":"vertical","data-state":g3(v.open),"data-radix-menu-content":"",dir:g.dir,...y,...m,ref:E,style:{outline:"none",...m.style},onKeyDown:ot(m.onKeyDown,k=>{let ee=k.target.closest("[data-radix-menu-content]")===k.currentTarget,Se=k.ctrlKey||k.altKey||k.metaKey,De=k.key.length===1;ee&&(k.key==="Tab"&&k.preventDefault(),!Se&&De&&F(k.key));let we=x.current;if(k.target!==we||!Loe.includes(k.key))return;k.preventDefault();let Fe=w().filter(pe=>!pe.disabled).map(pe=>pe.ref.current);KG.includes(k.key)&&Fe.reverse(),ise(Fe)}),onBlur:ot(e.onBlur,k=>{k.currentTarget.contains(k.target)||(window.clearTimeout(T.current),A.current="")}),onPointerMove:ot(e.onPointerMove,dv(k=>{let K=k.target,ee=I.current!==k.clientX;if(k.currentTarget.contains(K)&&ee){let Se=k.clientX>I.current?"right":"left";N.current=Se,I.current=k.clientX}}))})})})})})})});JG.displayName=Qo;var Yoe="MenuGroup",mP=Me.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,ze.jsx)(Tn.div,{role:"group",...r,ref:t})});mP.displayName=Yoe;var Qoe="MenuLabel",e3=Me.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,ze.jsx)(Tn.div,{...r,ref:t})});e3.displayName=Qoe;var sC="MenuItem",GG="menu.itemSelect",lC=Me.forwardRef((e,t)=>{let{disabled:n=!1,onSelect:r,...i}=e,o=Me.useRef(null),s=gv(sC,e.__scopeMenu),a=pP(sC,e.__scopeMenu),l=Bn(t,o),c=Me.useRef(!1),u=()=>{let f=o.current;if(!n&&f){let p=new CustomEvent(GG,{bubbles:!0,cancelable:!0});f.addEventListener(GG,d=>r?.(d),{once:!0}),PE(f,p),p.defaultPrevented?c.current=!1:s.onClose()}};return(0,ze.jsx)(t3,{...i,ref:l,disabled:n,onClick:ot(e.onClick,u),onPointerDown:f=>{e.onPointerDown?.(f),c.current=!0},onPointerUp:ot(e.onPointerUp,f=>{c.current||f.currentTarget?.click()}),onKeyDown:ot(e.onKeyDown,f=>{let p=a.searchRef.current!=="";n||p&&f.key===" "||lP.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});lC.displayName=sC;var t3=Me.forwardRef((e,t)=>{let{__scopeMenu:n,disabled:r=!1,textValue:i,...o}=e,s=pP(sC,n),a=WG(n),l=Me.useRef(null),c=Bn(t,l),[u,f]=Me.useState(!1),[p,d]=Me.useState("");return Me.useEffect(()=>{let h=l.current;h&&d((h.textContent??"").trim())},[o.children]),(0,ze.jsx)(pv.ItemSlot,{scope:n,disabled:r,textValue:i??p,children:(0,ze.jsx)(CG,{asChild:!0,...a,focusable:!r,children:(0,ze.jsx)(Tn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:c,onPointerMove:ot(e.onPointerMove,dv(h=>{r?s.onItemLeave(h):(s.onItemEnter(h),h.defaultPrevented||h.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ot(e.onPointerLeave,dv(h=>s.onItemLeave(h))),onFocus:ot(e.onFocus,()=>f(!0)),onBlur:ot(e.onBlur,()=>f(!1))})})})}),Xoe="MenuCheckboxItem",n3=Me.forwardRef((e,t)=>{let{checked:n=!1,onCheckedChange:r,...i}=e;return(0,ze.jsx)(a3,{scope:e.__scopeMenu,checked:n,children:(0,ze.jsx)(lC,{role:"menuitemcheckbox","aria-checked":aC(n)?"mixed":n,...i,ref:t,"data-state":yP(n),onSelect:ot(i.onSelect,()=>r?.(aC(n)?!0:!n),{checkForDefaultPrevented:!1})})})});n3.displayName=Xoe;var r3="MenuRadioGroup",[Zoe,Joe]=Vf(r3,{value:void 0,onValueChange:()=>{}}),i3=Me.forwardRef((e,t)=>{let{value:n,onValueChange:r,...i}=e,o=Wr(r);return(0,ze.jsx)(Zoe,{scope:e.__scopeMenu,value:n,onValueChange:o,children:(0,ze.jsx)(mP,{...i,ref:t})})});i3.displayName=r3;var o3="MenuRadioItem",s3=Me.forwardRef((e,t)=>{let{value:n,...r}=e,i=Joe(o3,e.__scopeMenu),o=n===i.value;return(0,ze.jsx)(a3,{scope:e.__scopeMenu,checked:o,children:(0,ze.jsx)(lC,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":yP(o),onSelect:ot(r.onSelect,()=>i.onValueChange?.(n),{checkForDefaultPrevented:!1})})})});s3.displayName=o3;var hP="MenuItemIndicator",[a3,ese]=Vf(hP,{checked:!1}),l3=Me.forwardRef((e,t)=>{let{__scopeMenu:n,forceMount:r,...i}=e,o=ese(hP,n);return(0,ze.jsx)(fm,{present:r||aC(o.checked)||o.checked===!0,children:(0,ze.jsx)(Tn.span,{...i,ref:t,"data-state":yP(o.checked)})})});l3.displayName=hP;var tse="MenuSeparator",c3=Me.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e;return(0,ze.jsx)(Tn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});c3.displayName=tse;var nse="MenuArrow",u3=Me.forwardRef((e,t)=>{let{__scopeMenu:n,...r}=e,i=hv(n);return(0,ze.jsx)(mG,{...i,...r,ref:t})});u3.displayName=nse;var gP="MenuSub",[rse,f3]=Vf(gP),p3=e=>{let{__scopeMenu:t,children:n,open:r=!1,onOpenChange:i}=e,o=eu(gP,t),s=hv(t),[a,l]=Me.useState(null),[c,u]=Me.useState(null),f=Wr(i);return Me.useEffect(()=>(o.open===!1&&f(!1),()=>f(!1)),[o.open,f]),(0,ze.jsx)(UO,{...s,children:(0,ze.jsx)(YG,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:u,children:(0,ze.jsx)(rse,{scope:t,contentId:Xc(),triggerId:Xc(),trigger:a,onTriggerChange:l,children:n})})})};p3.displayName=gP;var fv="MenuSubTrigger",d3=Me.forwardRef((e,t)=>{let n=eu(fv,e.__scopeMenu),r=gv(fv,e.__scopeMenu),i=f3(fv,e.__scopeMenu),o=pP(fv,e.__scopeMenu),s=Me.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=o,c={__scopeMenu:e.__scopeMenu},u=Me.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return Me.useEffect(()=>u,[u]),Me.useEffect(()=>{let f=a.current;return()=>{window.clearTimeout(f),l(null)}},[a,l]),(0,ze.jsx)(uP,{asChild:!0,...c,children:(0,ze.jsx)(t3,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":g3(n.open),...e,ref:Tf(t,i.onTriggerChange),onClick:f=>{e.onClick?.(f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ot(e.onPointerMove,dv(f=>{o.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!n.open&&!s.current&&(o.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ot(e.onPointerLeave,dv(f=>{u();let p=n.content?.getBoundingClientRect();if(p){let d=n.content?.dataset.side,h=d==="right",m=h?-5:5,v=p[h?"left":"right"],g=p[h?"right":"left"];o.onPointerGraceIntentChange({area:[{x:f.clientX+m,y:f.clientY},{x:v,y:p.top},{x:g,y:p.top},{x:g,y:p.bottom},{x:v,y:p.bottom}],side:d}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(f),f.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ot(e.onKeyDown,f=>{let p=o.searchRef.current!=="";e.disabled||p&&f.key===" "||Foe[r.dir].includes(f.key)&&(n.onOpenChange(!0),n.content?.focus(),f.preventDefault())})})})});d3.displayName=fv;var m3="MenuSubContent",h3=Me.forwardRef((e,t)=>{let n=XG(Qo,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,o=eu(Qo,e.__scopeMenu),s=gv(Qo,e.__scopeMenu),a=f3(m3,e.__scopeMenu),l=Me.useRef(null),c=Bn(t,l);return(0,ze.jsx)(pv.Provider,{scope:e.__scopeMenu,children:(0,ze.jsx)(fm,{present:r||o.open,children:(0,ze.jsx)(pv.Slot,{scope:e.__scopeMenu,children:(0,ze.jsx)(dP,{id:a.contentId,"aria-labelledby":a.triggerId,...i,ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{s.isUsingKeyboardRef.current&&l.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ot(e.onFocusOutside,u=>{u.target!==a.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ot(e.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:ot(e.onKeyDown,u=>{let f=u.currentTarget.contains(u.target),p=Boe[s.dir].includes(u.key);f&&p&&(o.onOpenChange(!1),a.trigger?.focus(),u.preventDefault())})})})})})});h3.displayName=m3;function g3(e){return e?"open":"closed"}function aC(e){return e==="indeterminate"}function yP(e){return aC(e)?"indeterminate":e?"checked":"unchecked"}function ise(e){let t=document.activeElement;for(let n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function ose(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function sse(e,t,n){let i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,o=n?e.indexOf(n):-1,s=ose(e,Math.max(o,0));i.length===1&&(s=s.filter(c=>c!==n));let l=s.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function ase(e,t){let{x:n,y:r}=e,i=!1;for(let o=0,s=t.length-1;o<t.length;s=o++){let a=t[o],l=t[s],c=a.x,u=a.y,f=l.x,p=l.y;u>r!=p>r&&n<(f-c)*(r-u)/(p-u)+c&&(i=!i)}return i}function lse(e,t){if(!t)return!1;let n={x:e.clientX,y:e.clientY};return ase(n,t)}function dv(e){return t=>t.pointerType==="mouse"?e(t):void 0}var y3=QG,v3=uP,b3=ZG,S3=JG,w3=mP,x3=e3,E3=lC,C3=n3,T3=i3,A3=s3,M3=l3,R3=c3,N3=u3,D3=p3,I3=d3,O3=h3;var sr=D(j(),1),cC="DropdownMenu",[use,bLe]=Ta(cC,[cP]),Qr=cP(),[fse,P3]=use(cC),k3=e=>{let{__scopeDropdownMenu:t,children:n,dir:r,open:i,defaultOpen:o,onOpenChange:s,modal:a=!0}=e,l=Qr(t),c=ar.useRef(null),[u,f]=tv({prop:i,defaultProp:o??!1,onChange:s,caller:cC});return(0,sr.jsx)(fse,{scope:t,triggerId:Xc(),triggerRef:c,contentId:Xc(),open:u,onOpenChange:f,onOpenToggle:ar.useCallback(()=>f(p=>!p),[f]),modal:a,children:(0,sr.jsx)(y3,{...l,open:u,onOpenChange:f,dir:r,modal:a,children:n})})};k3.displayName=cC;var _3="DropdownMenuTrigger",V3=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,disabled:r=!1,...i}=e,o=P3(_3,n),s=Qr(n);return(0,sr.jsx)(v3,{asChild:!0,...s,children:(0,sr.jsx)(Tn.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:Tf(t,o.triggerRef),onPointerDown:ot(e.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(o.onOpenToggle(),o.open||a.preventDefault())}),onKeyDown:ot(e.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&o.onOpenToggle(),a.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});V3.displayName=_3;var pse="DropdownMenuPortal",L3=e=>{let{__scopeDropdownMenu:t,...n}=e,r=Qr(t);return(0,sr.jsx)(b3,{...r,...n})};L3.displayName=pse;var F3="DropdownMenuContent",B3=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=P3(F3,n),o=Qr(n),s=ar.useRef(!1);return(0,sr.jsx)(S3,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...r,ref:t,onCloseAutoFocus:ot(e.onCloseAutoFocus,a=>{s.current||i.triggerRef.current?.focus(),s.current=!1,a.preventDefault()}),onInteractOutside:ot(e.onInteractOutside,a=>{let l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});B3.displayName=F3;var dse="DropdownMenuGroup",mse=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(w3,{...i,...r,ref:t})});mse.displayName=dse;var hse="DropdownMenuLabel",gse=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(x3,{...i,...r,ref:t})});gse.displayName=hse;var yse="DropdownMenuItem",z3=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(E3,{...i,...r,ref:t})});z3.displayName=yse;var vse="DropdownMenuCheckboxItem",bse=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(C3,{...i,...r,ref:t})});bse.displayName=vse;var Sse="DropdownMenuRadioGroup",wse=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(T3,{...i,...r,ref:t})});wse.displayName=Sse;var xse="DropdownMenuRadioItem",Ese=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(A3,{...i,...r,ref:t})});Ese.displayName=xse;var Cse="DropdownMenuItemIndicator",Tse=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(M3,{...i,...r,ref:t})});Tse.displayName=Cse;var Ase="DropdownMenuSeparator",H3=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(R3,{...i,...r,ref:t})});H3.displayName=Ase;var Mse="DropdownMenuArrow",Rse=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(N3,{...i,...r,ref:t})});Rse.displayName=Mse;var Nse=e=>{let{__scopeDropdownMenu:t,children:n,open:r,onOpenChange:i,defaultOpen:o}=e,s=Qr(t),[a,l]=tv({prop:r,defaultProp:o??!1,onChange:i,caller:"DropdownMenuSub"});return(0,sr.jsx)(D3,{...s,open:a,onOpenChange:l,children:n})},Dse="DropdownMenuSubTrigger",U3=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(I3,{...i,...r,ref:t})});U3.displayName=Dse;var Ise="DropdownMenuSubContent",$3=ar.forwardRef((e,t)=>{let{__scopeDropdownMenu:n,...r}=e,i=Qr(n);return(0,sr.jsx)(O3,{...i,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$3.displayName=Ise;var mi=k3,hi=V3,Vr=L3,gi=B3;var ut=z3;var yv=H3;var uC=Nse,fC=U3,pC=$3;var xe=D(j(),1),q3=()=>{let e=Pe(),{status:t,noteId:n,isSearchActive:r,searchQuery:i,isSearchCaseSensitive:o,isProcessing:s,isRenaming:a,diffRequest:l,settings:c,watchModeCountdown:u,viewMode:f,panel:p}=me(Y=>({status:Y.app.status,noteId:Y.app.noteId,isSearchActive:Y.app.isSearchActive,searchQuery:Y.app.searchQuery,isSearchCaseSensitive:Y.app.isSearchCaseSensitive,isProcessing:Y.app.isProcessing,isRenaming:Y.app.isRenaming,diffRequest:Y.app.diffRequest,settings:Y.app.effectiveSettings,watchModeCountdown:Y.app.watchModeCountdown,viewMode:Y.app.viewMode,panel:Y.app.panel})),d=!n,{data:h}=$x(n,{skip:d}),{data:m}=vc(n,{skip:d}),{data:v}=bc(n,{skip:d}),g=(n&&h?.currentBranch)??"",y=(n&&h?.availableBranches)??[],b=n?m?.length??0:0,w=n?v?.length??0:0,[S,C]=(0,mn.useState)(i),x=(0,mn.useRef)(null);(0,mn.useEffect)(()=>{C(i)},[i]),(0,mn.useEffect)(()=>{n&&h&&(e(H.actions.setCurrentBranch(h.currentBranch)),e(H.actions.setAvailableBranches(h.availableBranches)))},[h,e,n]);let E=s||a||t==="LOADING",T=(0,mn.useCallback)(()=>{l?.status==="ready"&&(e(Z.viewReadyDiff("panel")),e(H.actions.clearDiffRequest()))},[e,l]),A=(0,mn.useCallback)(()=>{l?.status==="ready"&&(e(Z.viewReadyDiff("window")),e(H.actions.clearDiffRequest()))},[e,l]),M=(0,mn.useCallback)(()=>{t==="READY"&&e(H.actions.toggleSearch(!r))},[e,t,r]),R=(0,mn.useCallback)(Y=>{Y.stopPropagation(),t==="READY"&&(p?.type==="settings"?e(H.actions.closePanel()):e(H.actions.openPanel({type:"settings"})))},[e,t,p]),N=(0,mn.useCallback)((0,j3.debounce)(Y=>{e(H.actions.setSearchQuery(Y))},300),[e]),I=(0,mn.useCallback)(Y=>{let Ie=Y.target.value;C(Ie),N(Ie)},[N]),_=(0,mn.useCallback)(Y=>{Y.key==="Escape"&&(C(""),e(H.actions.setSearchQuery("")),e(H.actions.toggleSearch(!1)))},[e]),z=(0,mn.useCallback)(Y=>{Y.preventDefault(),e(H.actions.setSearchCaseSensitivity(!o))},[e,o]),F=(0,mn.useCallback)(Y=>{Y.preventDefault(),C(""),e(H.actions.setSearchQuery("")),x.current?.focus()},[e]),L=(0,mn.useCallback)(Y=>{Y.preventDefault(),Y.stopPropagation(),e(Z.showSortMenu())},[e]),k=(0,mn.useCallback)(()=>{t!=="READY"||E||e(Z.showBranchSwitcher())},[e,t,E]),K=(0,mn.useCallback)(()=>{t!=="READY"||E||e(Z.openTimeline())},[e,t,E]),ee=(0,mn.useCallback)(()=>{t!=="READY"||E||e(Z.openDashboard())},[e,t,E]),Se=(0,mn.useCallback)(()=>{t!=="READY"||E||e(Z.toggleViewMode())},[e,t,E]),De=(0,mn.useCallback)(Y=>{Y.preventDefault(),Y.stopPropagation(),e(Z.showNotice("Please save a version or edit to access advanced features.",6e3))},[e]);if((0,mn.useEffect)(()=>{if(r){if(document.activeElement!==x.current){let Y=setTimeout(()=>x.current?.focus(),100);return()=>clearTimeout(Y)}}else document.activeElement===x.current&&x.current?.blur()},[r]),t!=="READY"&&t!=="LOADING")return null;let we=l?.status==="generating"||l?.status==="re-diffing",qe=ge("clickable-icon","v-diff-indicator",{"is-hidden":!l,"is-generating":we,"is-ready":l?.status==="ready"}),Fe=we?"loader":"diff",pe=we?"Diff is being generated...":"Diff is ready. Click to view.",V=f==="versions"?b>0:w>0,Q=f==="versions"?"Switch to Edit History":"Switch to Version History";return(0,xe.jsxs)("div",{className:ge("v-actions-container",{"is-searching":r}),children:[(0,xe.jsxs)("div",{className:"v-top-actions",children:[(0,xe.jsxs)("div",{className:"v-top-actions-left-group",children:[n?(0,xe.jsxs)(mi,{children:[(0,xe.jsx)(hi,{asChild:!0,children:(0,xe.jsx)("button",{className:"clickable-icon","aria-label":"More options",disabled:E,children:(0,xe.jsx)(J,{name:"menu"})})}),(0,xe.jsx)(Vr,{children:(0,xe.jsxs)(gi,{className:"v-actionbar-dropdown-content",sideOffset:5,collisionPadding:10,children:[(0,xe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:Se,children:[(0,xe.jsx)("span",{children:Q}),(0,xe.jsx)(J,{name:f==="versions"?"file-edit":"history"})]}),(0,xe.jsx)("div",{className:"v-diff-separator"}),(0,xe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:k,children:[(0,xe.jsx)("span",{children:"Branches"}),(0,xe.jsx)(J,{name:"git-branch"})]}),(0,xe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:K,children:[(0,xe.jsx)("span",{children:"Timeline"}),(0,xe.jsx)(J,{name:"history"})]}),(0,xe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:ee,children:[(0,xe.jsx)("span",{children:"Dashboard"}),(0,xe.jsx)(J,{name:"layout-dashboard"})]})]})})]}):(0,xe.jsx)("button",{className:"clickable-icon","aria-label":"More options (Disabled)",onClick:De,disabled:E,children:(0,xe.jsx)(J,{name:"menu"})}),(0,xe.jsxs)("div",{className:"v-branch-switcher-container",children:[y.length>1&&(0,xe.jsxs)("button",{className:"v-branch-switcher-button",onClick:k,disabled:E,children:[(0,xe.jsx)(J,{name:"git-branch"}),(0,xe.jsx)("span",{children:g})]}),c.enableWatchMode&&u!==null&&!s&&t==="READY"&&(0,xe.jsxs)("div",{className:"v-watch-mode-timer",title:"Time until next auto-save",children:["(",u,"s)"]})]})]}),(0,xe.jsxs)("div",{className:"v-top-actions-right-group",children:[l?.status==="ready"?(0,xe.jsxs)(mi,{children:[(0,xe.jsx)(hi,{asChild:!0,children:(0,xe.jsx)("button",{className:qe,"aria-label":pe,disabled:E,children:(0,xe.jsx)(J,{name:Fe})})}),(0,xe.jsx)(Vr,{children:(0,xe.jsxs)(gi,{className:"v-actionbar-dropdown-content",sideOffset:5,collisionPadding:10,children:[(0,xe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:T,children:[(0,xe.jsx)("span",{children:"Open in panel"}),(0,xe.jsx)(J,{name:"layout-sidebar-right"})]}),(0,xe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:A,children:[(0,xe.jsx)("span",{children:"Open in window"}),(0,xe.jsx)(J,{name:"app-window"})]})]})})]}):(0,xe.jsx)("button",{className:qe,"aria-label":pe,disabled:!0,children:(0,xe.jsx)(J,{name:Fe})}),V&&(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)("button",{className:ge("clickable-icon",{"is-active":r}),"aria-label":"Search history",onClick:M,disabled:E,children:(0,xe.jsx)(J,{name:"search"})}),(0,xe.jsx)("button",{className:ge("clickable-icon",{"is-active":p?.type==="settings"}),"aria-label":"Toggle settings",onClick:R,disabled:E,children:(0,xe.jsx)(J,{name:"settings-2"})})]})]})]}),(0,xe.jsxs)("div",{className:ge("v-search-bar-container",{"is-query-active":S.trim().length>0}),children:[(0,xe.jsxs)("div",{className:"v-search-input-wrapper",children:[(0,xe.jsx)("div",{className:"v-search-icon",role:"button","aria-label":"Close search",onMouseDown:Y=>{Y.preventDefault(),M()},children:(0,xe.jsx)(J,{name:"x-circle"})}),(0,xe.jsx)("input",{ref:x,type:"search",placeholder:"Search versions...","aria-label":"Search versions by name, date, or size",value:S,onChange:I,onKeyDown:_}),(0,xe.jsxs)("div",{className:"v-search-input-buttons",children:[(0,xe.jsx)("button",{className:ge("clickable-icon",{"is-active":o}),"aria-label":"Toggle case sensitivity",onMouseDown:z,children:(0,xe.jsx)(J,{name:"case-sensitive"})}),(0,xe.jsx)("button",{className:ge("clickable-icon",{"is-hidden":!S}),"aria-label":"Clear search",onMouseDown:F,children:(0,xe.jsx)(J,{name:"x"})})]})]}),(0,xe.jsx)("button",{className:"clickable-icon v-filter-button","aria-label":"Sort options",onMouseDown:L,children:(0,xe.jsx)(J,{name:"filter"})})]})]})};var G3=D(U(),1);var Fs=D(j(),1),K3=({error:e})=>{let t=Pe(),n=()=>{t(Z.initializeView())};return(0,G3.useEffect)(()=>{let r=setTimeout(()=>{n()},3e3);return()=>clearTimeout(r)},[t]),(0,Fs.jsxs)("div",{className:"v-placeholder v-error-display",children:[(0,Fs.jsx)("div",{className:"v-placeholder-icon",children:(0,Fs.jsx)(J,{name:"alert-triangle"})}),(0,Fs.jsx)("h3",{children:e.title}),(0,Fs.jsx)("p",{className:"v-meta-label",children:e.message}),e.details&&(0,Fs.jsx)("pre",{className:"v-error-details",children:e.details}),(0,Fs.jsxs)("div",{className:"v-error-actions",children:[(0,Fs.jsx)("p",{className:"v-meta-label v-retry-message",children:"Retrying automatically..."}),(0,Fs.jsx)("button",{className:"mod-cta","aria-label":"Retry initializing the version control view",onClick:n,children:"Retry Now"})]})]})};var Wl=D(U(),1);var Qv=D(j(),1),$s=D(U(),1);var W3=D(U(),1),gm=(0,W3.createContext)({});var Y3=D(U(),1);function ym(e){let t=(0,Y3.useRef)(null);return t.current===null&&(t.current=e()),t.current}var dC=D(U(),1);var vm=typeof window<"u";var mC=vm?dC.useLayoutEffect:dC.useEffect;var ek=D(j(),1),nW=D(U(),1),Wv=D(U(),1);var Q3=D(U(),1),tu=(0,Q3.createContext)(null);var eW=D(j(),1);function Ff(e,t){e.indexOf(t)===-1&&e.push(t)}function Bf(e,t){let n=e.indexOf(t);n>-1&&e.splice(n,1)}var Wn=(e,t,n)=>n>t?t:n<e?e:n;var kl=()=>{},Xo=()=>{};var Xr={};var vv=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function bv(e){return typeof e=="object"&&e!==null}var Sv=e=>/^0[^.\s]+$/u.test(e);function zf(e){let t;return()=>(t===void 0&&(t=e()),t)}var Mn=e=>e;var Ose=(e,t)=>n=>t(e(n)),Bs=(...e)=>e.reduce(Ose);var Na=(e,t,n)=>{let r=t-e;return r===0?1:(n-e)/r};var _l=class{constructor(){this.subscriptions=[]}add(t){return Ff(this.subscriptions,t),()=>Bf(this.subscriptions,t)}notify(t,n,r){let i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,n,r);else for(let o=0;o<i;o++){let s=this.subscriptions[o];s&&s(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}};var Lr=e=>e*1e3,lr=e=>e/1e3;function wv(e,t){return t?e*(1e3/t):0}var X3=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Pse=1e-7,kse=12;function _se(e,t,n,r,i){let o,s,a=0;do s=t+(n-t)/2,o=X3(s,r,i)-e,o>0?n=s:t=s;while(Math.abs(o)>Pse&&++a<kse);return s}function nu(e,t,n,r){if(e===t&&n===r)return Mn;let i=o=>_se(o,0,1,e,n);return o=>o===0||o===1?o:X3(i(o),t,r)}var hC=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2;var gC=e=>t=>1-e(1-t);var yC=nu(.33,1.53,.69,.99),bm=gC(yC),xv=hC(bm);var Ev=e=>(e*=2)<1?.5*bm(e):.5*(2-Math.pow(2,-10*(e-1)));var Cv=e=>1-Math.sin(Math.acos(e)),Tv=gC(Cv),Av=hC(Cv);var vP=nu(.42,0,1,1),bP=nu(0,0,.58,1),Mv=nu(.42,0,.58,1);var SP=e=>Array.isArray(e)&&typeof e[0]!="number";var Rv=e=>Array.isArray(e)&&typeof e[0]=="number";var Z3={linear:Mn,easeIn:vP,easeInOut:Mv,easeOut:bP,circIn:Cv,circInOut:Av,circOut:Tv,backIn:bm,backInOut:xv,backOut:yC,anticipate:Ev},Vse=e=>typeof e=="string",vC=e=>{if(Rv(e)){Xo(e.length===4,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[t,n,r,i]=e;return nu(t,n,r,i)}else if(Vse(e))return Xo(Z3[e]!==void 0,`Invalid easing type '${e}'`,"invalid-easing-type"),Z3[e];return e};var Nv=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];var ji={value:null,addProjectionMetrics:null};function J3(e,t){let n=new Set,r=new Set,i=!1,o=!1,s=new WeakSet,a={delta:0,timestamp:0,isProcessing:!1},l=0;function c(f){s.has(f)&&(u.schedule(f),e()),l++,f(a)}let u={schedule:(f,p=!1,d=!1)=>{let m=d&&i?n:r;return p&&s.add(f),m.has(f)||m.add(f),f},cancel:f=>{r.delete(f),s.delete(f)},process:f=>{if(a=f,i){o=!0;return}i=!0,[n,r]=[r,n],n.forEach(c),t&&ji.value&&ji.value.frameloop[t].push(l),l=0,n.clear(),i=!1,o&&(o=!1,u.process(f))}};return u}var Lse=40;function bC(e,t){let n=!1,r=!0,i={delta:0,timestamp:0,isProcessing:!1},o=()=>n=!0,s=Nv.reduce((b,w)=>(b[w]=J3(o,t?w:void 0),b),{}),{setup:a,read:l,resolveKeyframes:c,preUpdate:u,update:f,preRender:p,render:d,postRender:h}=s,m=()=>{let b=Xr.useManualTiming?i.timestamp:performance.now();n=!1,Xr.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(b-i.timestamp,Lse),1)),i.timestamp=b,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),u.process(i),f.process(i),p.process(i),d.process(i),h.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(m))},v=()=>{n=!0,r=!0,i.isProcessing||e(m)};return{schedule:Nv.reduce((b,w)=>{let S=s[w];return b[w]=(C,x=!1,E=!1)=>(n||v(),S.schedule(C,x,E)),b},{}),cancel:b=>{for(let w=0;w<Nv.length;w++)s[Nv[w]].cancel(b)},state:i,steps:s}}var{schedule:it,cancel:qi,state:_n,steps:Dv}=bC(typeof requestAnimationFrame<"u"?requestAnimationFrame:Mn,!0);var SC;function Fse(){SC=void 0}var hn={now:()=>(SC===void 0&&hn.set(_n.isProcessing||Xr.useManualTiming?_n.timestamp:performance.now()),SC),set:e=>{SC=e,queueMicrotask(Fse)}};var zs={layout:0,mainThread:0,waapi:0};var eK=e=>t=>typeof t=="string"&&t.startsWith(e),Iv=eK("--"),Bse=eK("var(--"),Hf=e=>Bse(e)?zse.test(e.split("/*")[0].trim()):!1,zse=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function wC(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}var Da={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Vl={...Da,transform:e=>Wn(0,1,e)},Ov={...Da,default:1};var ru=e=>Math.round(e*1e5)/1e5;var Sm=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function tK(e){return e==null}var nK=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;var wm=(e,t)=>n=>!!(typeof n=="string"&&nK.test(n)&&n.startsWith(e)||t&&!tK(n)&&Object.prototype.hasOwnProperty.call(n,t)),xC=(e,t,n)=>r=>{if(typeof r!="string")return r;let[i,o,s,a]=r.match(Sm);return{[e]:parseFloat(i),[t]:parseFloat(o),[n]:parseFloat(s),alpha:a!==void 0?parseFloat(a):1}};var Hse=e=>Wn(0,255,e),wP={...Da,transform:e=>Math.round(Hse(e))},Ia={test:wm("rgb","red"),parse:xC("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+wP.transform(e)+", "+wP.transform(t)+", "+wP.transform(n)+", "+ru(Vl.transform(r))+")"};function Use(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}var Pv={test:wm("#"),parse:Use,transform:Ia.transform};var kv=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Hs=kv("deg"),Zr=kv("%"),fe=kv("px"),xP=kv("vh"),EP=kv("vw"),EC={...Zr,parse:e=>Zr.parse(e)/100,transform:e=>Zr.transform(e*100)};var iu={test:wm("hsl","hue"),parse:xC("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Zr.transform(ru(t))+", "+Zr.transform(ru(n))+", "+ru(Vl.transform(r))+")"};var gn={test:e=>Ia.test(e)||Pv.test(e)||iu.test(e),parse:e=>Ia.test(e)?Ia.parse(e):iu.test(e)?iu.parse(e):Pv.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ia.transform(e):iu.transform(e),getAnimatableNone:e=>{let t=gn.parse(e);return t.alpha=0,gn.transform(t)}};var rK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function $se(e){return isNaN(e)&&typeof e=="string"&&(e.match(Sm)?.length||0)+(e.match(rK)?.length||0)>0}var oK="number",sK="color",jse="var",qse="var(",iK="${}",Gse=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ou(e){let t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[],o=0,a=t.replace(Gse,l=>(gn.test(l)?(r.color.push(o),i.push(sK),n.push(gn.parse(l))):l.startsWith(qse)?(r.var.push(o),i.push(jse),n.push(l)):(r.number.push(o),i.push(oK),n.push(parseFloat(l))),++o,iK)).split(iK);return{values:n,split:a,indexes:r,types:i}}function aK(e){return ou(e).values}function lK(e){let{split:t,types:n}=ou(e),r=t.length;return i=>{let o="";for(let s=0;s<r;s++)if(o+=t[s],i[s]!==void 0){let a=n[s];a===oK?o+=ru(i[s]):a===sK?o+=gn.transform(i[s]):o+=i[s]}return o}}var Kse=e=>typeof e=="number"?0:gn.test(e)?gn.getAnimatableNone(e):e;function Wse(e){let t=aK(e);return lK(e)(t.map(Kse))}var Jr={test:$se,parse:aK,createTransformer:lK,getAnimatableNone:Wse};function CP(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function cK({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let i=0,o=0,s=0;if(!t)i=o=s=n;else{let a=n<.5?n*(1+t):n+t-n*t,l=2*n-a;i=CP(l,a,e+1/3),o=CP(l,a,e),s=CP(l,a,e-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(s*255),alpha:r}}function xm(e,t){return n=>n>0?t:e}var gt=(e,t,n)=>e+(t-e)*n;var TP=(e,t,n)=>{let r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},Yse=[Pv,Ia,iu],Qse=e=>Yse.find(t=>t.test(e));function uK(e){let t=Qse(e);if(kl(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!t)return!1;let n=t.parse(e);return t===iu&&(n=cK(n)),n}var AP=(e,t)=>{let n=uK(e),r=uK(t);if(!n||!r)return xm(e,t);let i={...n};return o=>(i.red=TP(n.red,r.red,o),i.green=TP(n.green,r.green,o),i.blue=TP(n.blue,r.blue,o),i.alpha=gt(n.alpha,r.alpha,o),Ia.transform(i))};var CC=new Set(["none","hidden"]);function fK(e,t){return CC.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function Xse(e,t){return n=>gt(e,t,n)}function TC(e){return typeof e=="number"?Xse:typeof e=="string"?Hf(e)?xm:gn.test(e)?AP:eae:Array.isArray(e)?pK:typeof e=="object"?gn.test(e)?AP:Zse:xm}function pK(e,t){let n=[...e],r=n.length,i=e.map((o,s)=>TC(o)(o,t[s]));return o=>{for(let s=0;s<r;s++)n[s]=i[s](o);return n}}function Zse(e,t){let n={...e,...t},r={};for(let i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=TC(e[i])(e[i],t[i]));return i=>{for(let o in r)n[o]=r[o](i);return n}}function Jse(e,t){let n=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){let o=t.types[i],s=e.indexes[o][r[o]],a=e.values[s]??0;n[i]=a,r[o]++}return n}var eae=(e,t)=>{let n=Jr.createTransformer(t),r=ou(e),i=ou(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?CC.has(e)&&!i.values.length||CC.has(t)&&!r.values.length?fK(e,t):Bs(pK(Jse(r,i),i.values),n):(kl(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),xm(e,t))};function AC(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?gt(e,t,n):TC(e)(e,t)}var dK=e=>{let t=({timestamp:n})=>e(n);return{start:(n=!0)=>it.update(t,n),stop:()=>qi(t),now:()=>_n.isProcessing?_n.timestamp:hn.now()}};var MC=(e,t,n=10)=>{let r="",i=Math.max(Math.round(t/n),2);for(let o=0;o<i;o++)r+=Math.round(e(o/(i-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`};function Em(e){let t=0,n=50,r=e.next(t);for(;!r.done&&t<2e4;)t+=n,r=e.next(t);return t>=2e4?1/0:t}function mK(e,t=100,n){let r=n({...e,keyframes:[0,t]}),i=Math.min(Em(r),2e4);return{type:"keyframes",ease:o=>r.next(i*o).value/t,duration:lr(i)}}var tae=5;function RC(e,t,n){let r=Math.max(t-tae,0);return wv(n-e(r),t-r)}var on={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1};var RP=.001;function hK({duration:e=on.duration,bounce:t=on.bounce,velocity:n=on.velocity,mass:r=on.mass}){let i,o;kl(e<=Lr(on.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let s=1-t;s=Wn(on.minDamping,on.maxDamping,s),e=Wn(on.minDuration,on.maxDuration,lr(e)),s<1?(i=c=>{let u=c*s,f=u*e,p=u-n,d=NC(c,s),h=Math.exp(-f);return RP-p/d*h},o=c=>{let f=c*s*e,p=f*n+n,d=Math.pow(s,2)*Math.pow(c,2)*e,h=Math.exp(-f),m=NC(Math.pow(c,2),s);return(-i(c)+RP>0?-1:1)*((p-d)*h)/m}):(i=c=>{let u=Math.exp(-c*e),f=(c-n)*e+1;return-RP+u*f},o=c=>{let u=Math.exp(-c*e),f=(n-c)*(e*e);return u*f});let a=5/e,l=rae(i,o,a);if(e=Lr(e),isNaN(l))return{stiffness:on.stiffness,damping:on.damping,duration:e};{let c=Math.pow(l,2)*r;return{stiffness:c,damping:s*2*Math.sqrt(r*c),duration:e}}}var nae=12;function rae(e,t,n){let r=n;for(let i=1;i<nae;i++)r=r-e(r)/t(r);return r}function NC(e,t){return e*Math.sqrt(1-t*t)}var iae=["duration","bounce"],oae=["stiffness","damping","mass"];function gK(e,t){return t.some(n=>e[n]!==void 0)}function sae(e){let t={velocity:on.velocity,stiffness:on.stiffness,damping:on.damping,mass:on.mass,isResolvedFromDuration:!1,...e};if(!gK(e,oae)&&gK(e,iae))if(e.visualDuration){let n=e.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,o=2*Wn(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:on.mass,stiffness:i,damping:o}}else{let n=hK(e);t={...t,...n,mass:on.mass},t.isResolvedFromDuration=!0}return t}function Cm(e=on.visualDuration,t=on.bounce){let n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:r,restDelta:i}=n,o=n.keyframes[0],s=n.keyframes[n.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:c,mass:u,duration:f,velocity:p,isResolvedFromDuration:d}=sae({...n,velocity:-lr(n.velocity||0)}),h=p||0,m=c/(2*Math.sqrt(l*u)),v=s-o,g=lr(Math.sqrt(l/u)),y=Math.abs(v)<5;r||(r=y?on.restSpeed.granular:on.restSpeed.default),i||(i=y?on.restDelta.granular:on.restDelta.default);let b;if(m<1){let S=NC(g,m);b=C=>{let x=Math.exp(-m*g*C);return s-x*((h+m*g*v)/S*Math.sin(S*C)+v*Math.cos(S*C))}}else if(m===1)b=S=>s-Math.exp(-g*S)*(v+(h+g*v)*S);else{let S=g*Math.sqrt(m*m-1);b=C=>{let x=Math.exp(-m*g*C),E=Math.min(S*C,300);return s-x*((h+m*g*v)*Math.sinh(E)+S*v*Math.cosh(E))/S}}let w={calculatedDuration:d&&f||null,next:S=>{let C=b(S);if(d)a.done=S>=f;else{let x=S===0?h:0;m<1&&(x=S===0?Lr(h):RC(b,S,C));let E=Math.abs(x)<=r,T=Math.abs(s-C)<=i;a.done=E&&T}return a.value=a.done?s:C,a},toString:()=>{let S=Math.min(Em(w),2e4),C=MC(x=>w.next(S*x).value,S,30);return S+"ms "+C},toTransition:()=>{}};return w}Cm.applyToOptions=e=>{let t=mK(e,100,Cm);return e.ease=t.ease,e.duration=Lr(t.duration),e.type="keyframes",e};function _v({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:s,min:a,max:l,restDelta:c=.5,restSpeed:u}){let f=e[0],p={done:!1,value:f},d=E=>a!==void 0&&E<a||l!==void 0&&E>l,h=E=>a===void 0?l:l===void 0||Math.abs(a-E)<Math.abs(l-E)?a:l,m=n*t,v=f+m,g=s===void 0?v:s(v);g!==v&&(m=g-f);let y=E=>-m*Math.exp(-E/r),b=E=>g+y(E),w=E=>{let T=y(E),A=b(E);p.done=Math.abs(T)<=c,p.value=p.done?g:A},S,C,x=E=>{d(p.value)&&(S=E,C=Cm({keyframes:[p.value,h(p.value)],velocity:RC(b,E,p.value),damping:i,stiffness:o,restDelta:c,restSpeed:u}))};return x(0),{calculatedDuration:null,next:E=>{let T=!1;return!C&&S===void 0&&(T=!0,w(E),x(E)),S!==void 0&&E>=S?C.next(E-S):(!T&&w(E),p)}}}function aae(e,t,n){let r=[],i=n||Xr.mix||AC,o=e.length-1;for(let s=0;s<o;s++){let a=i(e[s],e[s+1]);if(t){let l=Array.isArray(t)?t[s]||Mn:t;a=Bs(l,a)}r.push(a)}return r}function yK(e,t,{clamp:n=!0,ease:r,mixer:i}={}){let o=e.length;if(Xo(o===t.length,"Both input and output ranges must be the same length","range-length"),o===1)return()=>t[0];if(o===2&&t[0]===t[1])return()=>t[1];let s=e[0]===e[1];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());let a=aae(t,r,i),l=a.length,c=u=>{if(s&&u<e[0])return t[0];let f=0;if(l>1)for(;f<e.length-2&&!(u<e[f+1]);f++);let p=Na(e[f],e[f+1],u);return a[f](p)};return n?u=>c(Wn(e[0],e[o-1],u)):c}function vK(e,t){let n=e[e.length-1];for(let r=1;r<=t;r++){let i=Na(0,t,r);e.push(gt(n,1,i))}}function bK(e){let t=[0];return vK(t,e.length-1),t}function SK(e,t){return e.map(n=>n*t)}function lae(e,t){return e.map(()=>t||Mv).splice(0,e.length-1)}function Uf({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){let i=SP(r)?r.map(vC):vC(r),o={done:!1,value:t[0]},s=SK(n&&n.length===t.length?n:bK(t),e),a=yK(s,t,{ease:Array.isArray(i)?i:lae(t,i)});return{calculatedDuration:e,next:l=>(o.value=a(l),o.done=l>=e,o)}}var cae=e=>e!==null;function Tm(e,{repeat:t,repeatType:n="loop"},r,i=1){let o=e.filter(cae),a=i<0||t&&n!=="loop"&&t%2===1?0:o.length-1;return!a||r===void 0?o[a]:r}var uae={decay:_v,inertia:_v,tween:Uf,keyframes:Uf,spring:Cm};function DC(e){typeof e.type=="string"&&(e.type=uae[e.type])}var su=class{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}};var fae=e=>e/100,Ll=class extends su{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:n}=this.options;n&&n.updatedAt!==hn.now()&&this.tick(hn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},zs.mainThread++,this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){let{options:t}=this;DC(t);let{type:n=Uf,repeat:r=0,repeatDelay:i=0,repeatType:o,velocity:s=0}=t,{keyframes:a}=t,l=n||Uf;l!==Uf&&typeof a[0]!="number"&&(this.mixKeyframes=Bs(fae,AC(a[0],a[1])),a=[0,100]);let c=l({...t,keyframes:a});o==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...a].reverse(),velocity:-s})),c.calculatedDuration===null&&(c.calculatedDuration=Em(c));let{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=c}updateTime(t){let n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){let{generator:r,totalDuration:i,mixKeyframes:o,mirroredGenerator:s,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);let{delay:c=0,keyframes:u,repeat:f,repeatType:p,repeatDelay:d,type:h,onUpdate:m,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);let g=this.currentTime-c*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?g<0:g>i;this.currentTime=Math.max(g,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let b=this.currentTime,w=r;if(f){let E=Math.min(this.currentTime,i)/a,T=Math.floor(E),A=E%1;!A&&E>=1&&(A=1),A===1&&T--,T=Math.min(T,f+1),T%2&&(p==="reverse"?(A=1-A,d&&(A-=d/a)):p==="mirror"&&(w=s)),b=Wn(0,1,A)*a}let S=y?{done:!1,value:u[0]}:w.next(b);o&&(S.value=o(S.value));let{done:C}=S;!y&&l!==null&&(C=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);let x=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return x&&h!==_v&&(S.value=Tm(u,this.options,v,this.speed)),m&&m(S.value),x&&this.finish(),S}then(t,n){return this.finished.then(t,n)}get duration(){return lr(this.calculatedDuration)}get iterationDuration(){let{delay:t=0}=this.options||{};return this.duration+lr(t)}get time(){return lr(this.currentTime)}set time(t){t=Lr(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(hn.now());let n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=lr(this.currentTime))}play(){if(this.isStopped)return;let{driver:t=dK,startTime:n}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),this.options.onPlay?.();let r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(hn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,zs.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}};function wK(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}var $f=e=>e*180/Math.PI,NP=e=>{let t=$f(Math.atan2(e[1],e[0]));return DP(t)},pae={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:NP,rotateZ:NP,skewX:e=>$f(Math.atan(e[1])),skewY:e=>$f(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},DP=e=>(e=e%360,e<0&&(e+=360),e),xK=NP,EK=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),CK=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),dae={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:EK,scaleY:CK,scale:e=>(EK(e)+CK(e))/2,rotateX:e=>DP($f(Math.atan2(e[6],e[5]))),rotateY:e=>DP($f(Math.atan2(-e[2],e[0]))),rotateZ:xK,rotate:xK,skewX:e=>$f(Math.atan(e[4])),skewY:e=>$f(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Vv(e){return e.includes("scale")?1:0}function Lv(e,t){if(!e||e==="none")return Vv(t);let n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u),r,i;if(n)r=dae,i=n;else{let a=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=pae,i=a}if(!i)return Vv(t);let o=r[t],s=i[1].split(",").map(mae);return typeof o=="function"?o(s):s[o]}var IP=(e,t)=>{let{transform:n="none"}=getComputedStyle(e);return Lv(n,t)};function mae(e){return parseFloat(e.trim())}var Us=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],vo=new Set(Us);var OP=e=>e===Da||e===fe,hae=new Set(["x","y","z"]),gae=Us.filter(e=>!hae.has(e));function TK(e){let t=[];return gae.forEach(n=>{let r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}var Fl={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Lv(t,"x"),y:(e,{transform:t})=>Lv(t,"y")};Fl.translateX=Fl.x;Fl.translateY=Fl.y;var jf=new Set,PP=!1,kP=!1,_P=!1;function AK(){if(kP){let e=Array.from(jf).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{let i=TK(r);i.length&&(n.set(r,i),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();let i=n.get(r);i&&i.forEach(([o,s])=>{r.getValue(o)?.set(s)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}kP=!1,PP=!1,jf.forEach(e=>e.complete(_P)),jf.clear()}function MK(){jf.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(kP=!0)})}function VP(){_P=!0,MK(),AK(),_P=!1}var Bl=class{constructor(t,n,r,i,o,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=i,this.element=o,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(jf.add(this),PP||(PP=!0,it.read(MK),it.resolveKeyframes(AK))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:t,name:n,element:r,motionValue:i}=this;if(t[0]===null){let o=i?.get(),s=t[t.length-1];if(o!==void 0)t[0]=o;else if(r&&n){let a=r.readValue(n,s);a!=null&&(t[0]=a)}t[0]===void 0&&(t[0]=s),i&&o===void 0&&i.set(t[0])}wK(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),jf.delete(this)}cancel(){this.state==="scheduled"&&(jf.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}};var RK=e=>e.startsWith("--");function NK(e,t,n){RK(t)?e.style.setProperty(t,n):e.style[t]=n}var DK=zf(()=>window.ScrollTimeline!==void 0);var IK={};function OK(e,t){let n=zf(e);return()=>IK[t]??n()}var IC=OK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing");var qf=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`;var LP={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:qf([0,.65,.55,1]),circOut:qf([.55,0,1,.45]),backIn:qf([.31,.01,.66,-.59]),backOut:qf([.33,1.53,.69,.99])};function FP(e,t){if(e)return typeof e=="function"?IC()?MC(e,t):"ease-out":Rv(e)?qf(e):Array.isArray(e)?e.map(n=>FP(n,t)||LP.easeOut):LP[e]}function PK(e,t,n,{delay:r=0,duration:i=300,repeat:o=0,repeatType:s="loop",ease:a="easeOut",times:l}={},c=void 0){let u={[t]:n};l&&(u.offset=l);let f=FP(a,i);Array.isArray(f)&&(u.easing=f),ji.value&&zs.waapi++;let p={delay:r,duration:i,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:o+1,direction:s==="reverse"?"alternate":"normal"};c&&(p.pseudoElement=c);let d=e.animate(u,p);return ji.value&&d.finished.finally(()=>{zs.waapi--}),d}function OC(e){return typeof e=="function"&&"applyToOptions"in e}function kK({type:e,...t}){return OC(e)&&IC()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}var PC=class extends su{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;let{element:n,name:r,keyframes:i,pseudoElement:o,allowFlatten:s=!1,finalKeyframe:a,onComplete:l}=t;this.isPseudoElement=!!o,this.allowFlatten=s,this.options=t,Xo(typeof t.type!="string",`Mini animate() doesn't support "type" as a string.`,"mini-spring");let c=kK(t);this.animation=PK(n,r,i,c,o),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){let u=Tm(i,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(u):NK(n,r,u),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){let t=this.animation.effect?.getComputedTiming?.().duration||0;return lr(Number(t))}get iterationDuration(){let{delay:t=0}=this.options||{};return this.duration+lr(t)}get time(){return lr(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Lr(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&DK()?(this.animation.timeline=t,Mn):n(this)}};var _K={anticipate:Ev,backInOut:xv,circInOut:Av};function yae(e){return e in _K}function VK(e){typeof e.ease=="string"&&yae(e.ease)&&(e.ease=_K[e.ease])}var BP=10,kC=class extends PC{constructor(t){VK(t),DC(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){let{motionValue:n,onUpdate:r,onComplete:i,element:o,...s}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}let a=new Ll({...s,autoplay:!1}),l=Math.max(BP,hn.now()-this.startTime),c=Wn(0,BP,l-BP);n.setWithVelocity(a.sample(Math.max(0,l-c)).value,a.sample(l).value,c),a.stop()}};var zP=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Jr.test(e)||e==="0")&&!e.startsWith("url("));function vae(e){let t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function LK(e,t,n,r){let i=e[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;let o=e[e.length-1],s=zP(i,t),a=zP(o,t);return kl(s===a,`You are trying to animate ${t} from "${i}" to "${o}". "${s?o:i}" is not an animatable value.`,"value-not-animatable"),!s||!a?!1:vae(e)||(n==="spring"||OC(n))&&r}function Am(e){e.duration=0,e.type="keyframes"}var bae=new Set(["opacity","clipPath","filter","transform"]),Sae=zf(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function FK(e){let{motionValue:t,name:n,repeatDelay:r,repeatType:i,damping:o,type:s}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:l,transformTemplate:c}=t.owner.getProps();return Sae()&&n&&bae.has(n)&&(n!=="transform"||!c)&&!l&&!r&&i!=="mirror"&&o!==0&&s!=="inertia"}var wae=40,Fv=class extends su{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:s="loop",keyframes:a,name:l,motionValue:c,element:u,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=hn.now();let p={autoplay:t,delay:n,type:r,repeat:i,repeatDelay:o,repeatType:s,name:l,motionValue:c,element:u,...f},d=u?.KeyframeResolver||Bl;this.keyframeResolver=new d(a,(h,m,v)=>this.onKeyframesResolved(h,m,p,!v),l,c,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,n,r,i){this.keyframeResolver=void 0;let{name:o,type:s,velocity:a,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=hn.now(),LK(t,o,s,a)||((Xr.instantAnimations||!l)&&u?.(Tm(t,r,n)),t[0]=t[t.length-1],Am(r),r.repeat=0);let p={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>wae?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},d=!c&&FK(p)?new kC({...p,element:p.motionValue.owner.current}):new Ll(p);d.finished.then(()=>this.notifyFinished()).catch(Mn),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),VP()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}};var xae=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Eae(e){let t=xae.exec(e);if(!t)return[,];let[,n,r,i]=t;return[`--${n??r}`,i]}var Cae=4;function HP(e,t,n=1){Xo(n<=Cae,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[r,i]=Eae(e);if(!r)return;let o=window.getComputedStyle(t).getPropertyValue(r);if(o){let s=o.trim();return vv(s)?parseFloat(s):s}return Hf(i)?HP(i,t,n+1):i}function Gf(e,t){return e?.[t]??e?.default??e}var Bv=new Set(["width","height","top","left","right","bottom",...Us]);var BK={test:e=>e==="auto",parse:e=>e};var _C=e=>t=>t.test(e);var UP=[Da,fe,Zr,Hs,EP,xP,BK],$P=e=>UP.find(_C(e));function zK(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Sv(e):!0}var Tae=new Set(["brightness","contrast","saturate","opacity"]);function Aae(e){let[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;let[r]=n.match(Sm)||[];if(!r)return e;let i=n.replace(r,""),o=Tae.has(t)?1:0;return r!==n&&(o*=100),t+"("+o+i+")"}var Mae=/\b([a-z-]*)\(.*?\)/gu,zv={...Jr,getAnimatableNone:e=>{let t=e.match(Mae);return t?t.map(Aae).join(" "):e}};var jP={...Da,transform:Math.round};var HK={rotate:Hs,rotateX:Hs,rotateY:Hs,rotateZ:Hs,scale:Ov,scaleX:Ov,scaleY:Ov,scaleZ:Ov,skew:Hs,skewX:Hs,skewY:Hs,distance:fe,translateX:fe,translateY:fe,translateZ:fe,x:fe,y:fe,z:fe,perspective:fe,transformPerspective:fe,opacity:Vl,originX:EC,originY:EC,originZ:fe};var Kf={borderWidth:fe,borderTopWidth:fe,borderRightWidth:fe,borderBottomWidth:fe,borderLeftWidth:fe,borderRadius:fe,radius:fe,borderTopLeftRadius:fe,borderTopRightRadius:fe,borderBottomRightRadius:fe,borderBottomLeftRadius:fe,width:fe,maxWidth:fe,height:fe,maxHeight:fe,top:fe,right:fe,bottom:fe,left:fe,inset:fe,insetBlock:fe,insetBlockStart:fe,insetBlockEnd:fe,insetInline:fe,insetInlineStart:fe,insetInlineEnd:fe,padding:fe,paddingTop:fe,paddingRight:fe,paddingBottom:fe,paddingLeft:fe,paddingBlock:fe,paddingBlockStart:fe,paddingBlockEnd:fe,paddingInline:fe,paddingInlineStart:fe,paddingInlineEnd:fe,margin:fe,marginTop:fe,marginRight:fe,marginBottom:fe,marginLeft:fe,marginBlock:fe,marginBlockStart:fe,marginBlockEnd:fe,marginInline:fe,marginInlineStart:fe,marginInlineEnd:fe,backgroundPositionX:fe,backgroundPositionY:fe,...HK,zIndex:jP,fillOpacity:Vl,strokeOpacity:Vl,numOctaves:jP};var UK={...Kf,color:gn,backgroundColor:gn,outlineColor:gn,fill:gn,stroke:gn,borderColor:gn,borderTopColor:gn,borderRightColor:gn,borderBottomColor:gn,borderLeftColor:gn,filter:zv,WebkitFilter:zv},Hv=e=>UK[e];function Uv(e,t){let n=Hv(e);return n!==zv&&(n=Jr),n.getAnimatableNone?n.getAnimatableNone(t):void 0}var Rae=new Set(["auto","none","0"]);function $K(e,t,n){let r=0,i;for(;r<e.length&&!i;){let o=e[r];typeof o=="string"&&!Rae.has(o)&&ou(o).values.length&&(i=e[r]),r++}if(i&&n)for(let o of t)e[o]=Uv(n,i)}var $v=class extends Bl{constructor(t,n,r,i,o){super(t,n,r,i,o,!0)}readKeyframes(){let{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let f=t[u];if(typeof f=="string"&&(f=f.trim(),Hf(f))){let p=HP(f,n.current);p!==void 0&&(t[u]=p),u===t.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!Bv.has(r)||t.length!==2)return;let[i,o]=t,s=$P(i),a=$P(o),l=wC(i),c=wC(o);if(l!==c&&Fl[r]){this.needsMeasurement=!0;return}if(s!==a)if(OP(s)&&OP(a))for(let u=0;u<t.length;u++){let f=t[u];typeof f=="string"&&(t[u]=parseFloat(f))}else Fl[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:t,name:n}=this,r=[];for(let i=0;i<t.length;i++)(t[i]===null||zK(t[i]))&&r.push(i);r.length&&$K(t,r,n)}measureInitialState(){let{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Fl[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;let i=n[n.length-1];i!==void 0&&t.getValue(r,i).jump(i,!1)}measureEndState(){let{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;let i=t.getValue(n);i&&i.jump(this.measuredOrigin,!1);let o=r.length-1,s=r[o];r[o]=Fl[n](t.measureViewportBox(),window.getComputedStyle(t.current)),s!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([a,l])=>{t.getValue(a).set(l)}),this.resolveNoneKeyframes()}};function jK(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;t&&(r=t.current);let i=n?.[e]??r.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}var jv=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function qv(e){return bv(e)&&"offsetHeight"in e}var qK=30,Nae=e=>!isNaN(parseFloat(e)),qP={current:void 0},VC=class{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{let i=hn.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=hn.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Nae(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new _l);let r=this.events[t].add(n);return t==="change"?()=>{r(),it.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(let t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return qP.current&&qP.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){let t=hn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>qK)return 0;let n=Math.min(this.updatedAt-this.prevUpdatedAt,qK);return wv(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}};function Zo(e,t){return new VC(e,t)}var{schedule:Wf,cancel:Dae}=bC(queueMicrotask,!1);var Jo={x:!1,y:!1};function LC(){return Jo.x||Jo.y}function GP(e){return e==="x"||e==="y"?Jo[e]?null:(Jo[e]=!0,()=>{Jo[e]=!1}):Jo.x||Jo.y?null:(Jo.x=Jo.y=!0,()=>{Jo.x=Jo.y=!1})}function FC(e,t){let n=jK(e),r=new AbortController,i={passive:!0,...t,signal:r.signal};return[n,i,()=>r.abort()]}function GK(e){return!(e.pointerType==="touch"||LC())}function KP(e,t,n={}){let[r,i,o]=FC(e,n),s=a=>{if(!GK(a))return;let{target:l}=a,c=t(l,a);if(typeof c!="function"||!l)return;let u=f=>{GK(f)&&(c(f),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,i)};return r.forEach(a=>{a.addEventListener("pointerenter",s,i)}),o}var WP=(e,t)=>t?e===t?!0:WP(e,t.parentElement):!1;var Yf=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;var Iae=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Gv(e){return Iae.has(e.tagName)||e.isContentEditable===!0}var Mm=new WeakSet;function KK(e){return t=>{t.key==="Enter"&&e(t)}}function YP(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}var WK=(e,t)=>{let n=e.currentTarget;if(!n)return;let r=KK(()=>{if(Mm.has(n))return;YP(n,"down");let i=KK(()=>{YP(n,"up")}),o=()=>YP(n,"cancel");n.addEventListener("keyup",i,t),n.addEventListener("blur",o,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function YK(e){return Yf(e)&&!LC()}function QP(e,t,n={}){let[r,i,o]=FC(e,n),s=a=>{let l=a.currentTarget;if(!YK(a))return;Mm.add(l);let c=t(l,a),u=(d,h)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",p),Mm.has(l)&&Mm.delete(l),YK(d)&&typeof c=="function"&&c(d,{success:h})},f=d=>{u(d,l===window||l===document||n.useGlobalTarget||WP(l,d.target))},p=d=>{u(d,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",p,i)};return r.forEach(a=>{(n.useGlobalTarget?window:a).addEventListener("pointerdown",s,i),qv(a)&&(a.addEventListener("focus",c=>WK(c,i)),!Gv(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),o}function Kv(e){return bv(e)&&"ownerSVGElement"in e}function XP(e){return Kv(e)&&e.tagName==="svg"}var qt=e=>!!(e&&e.getVelocity);var Oae=[...UP,gn,Jr],ZP=e=>Oae.find(_C(e));var BC=D(U(),1),zl=D(U(),1);var QK=D(U(),1),Rm=(0,QK.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});var ZK=D(U(),1);function XK(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Pae(...e){return t=>{let n=!1,r=e.map(i=>{let o=XK(i,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let i=0;i<r.length;i++){let o=r[i];typeof o=="function"?o():XK(e[i],null)}}}}function JK(...e){return ZK.useCallback(Pae(...e),e)}var JP=class extends BC.Component{getSnapshotBeforeUpdate(t){let n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){let r=n.offsetParent,i=qv(r)&&r.offsetWidth||0,o=this.props.sizeRef.current;o.height=n.offsetHeight||0,o.width=n.offsetWidth||0,o.top=n.offsetTop,o.left=n.offsetLeft,o.right=i-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}};function tW({children:e,isPresent:t,anchorX:n,root:r}){let i=(0,zl.useId)(),o=(0,zl.useRef)(null),s=(0,zl.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=(0,zl.useContext)(Rm),l=e.props?.ref??e?.ref,c=JK(o,l);return(0,zl.useInsertionEffect)(()=>{let{width:u,height:f,top:p,left:d,right:h}=s.current;if(t||!o.current||!u||!f)return;let m=n==="left"?`left: ${d}`:`right: ${h}`;o.current.dataset.motionPopId=i;let v=document.createElement("style");a&&(v.nonce=a);let g=r??document.head;return g.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${f}px !important;
            ${m}px !important;
            top: ${p}px !important;
          }
        `),()=>{g.contains(v)&&g.removeChild(v)}},[t]),(0,eW.jsx)(JP,{isPresent:t,childRef:o,sizeRef:s,children:BC.cloneElement(e,{ref:c})})}var rW=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:o,mode:s,anchorX:a,root:l})=>{let c=ym(kae),u=(0,Wv.useId)(),f=!0,p=(0,Wv.useMemo)(()=>(f=!1,{id:u,initial:t,isPresent:n,custom:i,onExitComplete:d=>{c.set(d,!0);for(let h of c.values())if(!h)return;r&&r()},register:d=>(c.set(d,!1),()=>c.delete(d))}),[n,c,r]);return o&&f&&(p={...p}),(0,Wv.useMemo)(()=>{c.forEach((d,h)=>c.set(h,!1))},[n]),nW.useEffect(()=>{!n&&!c.size&&r&&r()},[n]),s==="popLayout"&&(e=(0,ek.jsx)(tW,{isPresent:n,anchorX:a,root:l,children:e})),(0,ek.jsx)(tu.Provider,{value:p,children:e})};function kae(){return new Map}var au=D(U(),1);function zC(e=!0){let t=(0,au.useContext)(tu);if(t===null)return[!0,null];let{isPresent:n,onExitComplete:r,register:i}=t,o=(0,au.useId)();(0,au.useEffect)(()=>{if(e)return i(o)},[e]);let s=(0,au.useCallback)(()=>e&&r&&r(o),[o,r,e]);return!n&&r?[!1,s]:[!0]}var HC=D(U(),1),Yv=e=>e.key||"";function tk(e){let t=[];return HC.Children.forEach(e,n=>{(0,HC.isValidElement)(n)&&t.push(n)}),t}var Xv=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:o="sync",propagate:s=!1,anchorX:a="left",root:l})=>{let[c,u]=zC(s),f=(0,$s.useMemo)(()=>tk(e),[e]),p=s&&!c?[]:f.map(Yv),d=(0,$s.useRef)(!0),h=(0,$s.useRef)(f),m=ym(()=>new Map),v=(0,$s.useRef)(new Set),[g,y]=(0,$s.useState)(f),[b,w]=(0,$s.useState)(f);mC(()=>{d.current=!1,h.current=f;for(let x=0;x<b.length;x++){let E=Yv(b[x]);p.includes(E)?(m.delete(E),v.current.delete(E)):m.get(E)!==!0&&m.set(E,!1)}},[b,p.length,p.join("-")]);let S=[];if(f!==g){let x=[...f];for(let E=0;E<b.length;E++){let T=b[E],A=Yv(T);p.includes(A)||(x.splice(E,0,T),S.push(T))}return o==="wait"&&S.length&&(x=S),w(tk(x)),y(f),null}let{forceRender:C}=(0,$s.useContext)(gm);return(0,Qv.jsx)(Qv.Fragment,{children:b.map(x=>{let E=Yv(x),T=s&&!c?!1:f===b||p.includes(E),A=()=>{if(v.current.has(E))return;if(v.current.add(E),m.has(E))m.set(E,!0);else return;let M=!0;m.forEach(R=>{R||(M=!1)}),M&&(C?.(),w(h.current),s&&u?.(),r&&r())};return(0,Qv.jsx)(rW,{isPresent:T,initial:!d.current||n?void 0:!1,custom:t,presenceAffectsLayout:i,mode:o,root:l,onExitComplete:T?void 0:A,anchorX:a,children:x},E)})})};var iW=D(U(),1),UC=(0,iW.createContext)({strict:!1});var oW={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Hl={};for(let e in oW)Hl[e]={isEnabled:t=>oW[e].some(n=>!!t[n])};function sW(e){for(let t in e)Hl[t]={...Hl[t],...e[t]}}var _ae=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Zv(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||_ae.has(e)}var aW=e=>!Zv(e);function Vae(e){typeof e=="function"&&(aW=t=>t.startsWith("on")?!Zv(t):e(t))}try{Vae(require("@emotion/is-prop-valid").default)}catch{}function lW(e,t,n){let r={};for(let i in e)i==="values"&&typeof e.values=="object"||(aW(i)||n===!0&&Zv(i)||!t&&!Zv(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}var eT=D(j(),1);var Fm=D(U(),1);var cW=D(U(),1),lu=(0,cW.createContext)({});var qC=D(U(),1);function cu(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Ul(e){return typeof e=="string"||Array.isArray(e)}var $C=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Jv=["initial",...$C];function Qf(e){return cu(e.animate)||Jv.some(t=>Ul(e[t]))}function jC(e){return!!(Qf(e)||e.variants)}function uW(e,t){if(Qf(e)){let{initial:n,animate:r}=e;return{initial:n===!1||Ul(n)?n:void 0,animate:Ul(r)?r:void 0}}return e.inherit!==!1?t:{}}function pW(e){let{initial:t,animate:n}=uW(e,(0,qC.useContext)(lu));return(0,qC.useMemo)(()=>({initial:t,animate:n}),[fW(t),fW(n)])}function fW(e){return Array.isArray(e)?e.join(" "):e}var Pm=D(U(),1);var gW=D(U(),1);function dW(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}var Nm={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(fe.test(e))e=parseFloat(e);else return e;let n=dW(e,t.target.x),r=dW(e,t.target.y);return`${n}% ${r}%`}};var mW={correct:(e,{treeScale:t,projectionDelta:n})=>{let r=e,i=Jr.parse(e);if(i.length>5)return r;let o=Jr.createTransformer(e),s=typeof i[0]!="number"?1:0,a=n.x.scale*t.x,l=n.y.scale*t.y;i[0+s]/=a,i[1+s]/=l;let c=gt(a,l,.5);return typeof i[2+s]=="number"&&(i[2+s]/=c),typeof i[3+s]=="number"&&(i[3+s]/=c),o(i)}};var eb={borderRadius:{...Nm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Nm,borderTopRightRadius:Nm,borderBottomLeftRadius:Nm,borderBottomRightRadius:Nm,boxShadow:mW};function GC(e,{layout:t,layoutId:n}){return vo.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!eb[e]||e==="opacity")}var Lae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Fae=Us.length;function hW(e,t,n){let r="",i=!0;for(let o=0;o<Fae;o++){let s=Us[o],a=e[s];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(s.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){let c=jv(a,Kf[s]);if(!l){i=!1;let u=Lae[s]||s;r+=`${u}(${c}) `}n&&(t[s]=c)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}function Dm(e,t,n){let{style:r,vars:i,transformOrigin:o}=e,s=!1,a=!1;for(let l in t){let c=t[l];if(vo.has(l)){s=!0;continue}else if(Iv(l)){i[l]=c;continue}else{let u=jv(c,Kf[l]);l.startsWith("origin")?(a=!0,o[l]=u):r[l]=u}}if(t.transform||(s||n?r.transform=hW(t,e.transform,n):r.transform&&(r.transform="none")),a){let{originX:l="50%",originY:c="50%",originZ:u=0}=o;r.transformOrigin=`${l} ${c} ${u}`}}var Im=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function nk(e,t,n){for(let r in t)!qt(t[r])&&!GC(r,n)&&(e[r]=t[r])}function Bae({transformTemplate:e},t){return(0,gW.useMemo)(()=>{let n=Im();return Dm(n,t,e),Object.assign({},n.vars,n.style)},[t])}function zae(e,t){let n=e.style||{},r={};return nk(r,n,e),Object.assign(r,Bae(e,t)),r}function yW(e,t){let n={},r=zae(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}var bW=D(U(),1);var Hae={offset:"stroke-dashoffset",array:"stroke-dasharray"},Uae={offset:"strokeDashoffset",array:"strokeDasharray"};function vW(e,t,n=1,r=0,i=!0){e.pathLength=1;let o=i?Hae:Uae;e[o.offset]=fe.transform(-r);let s=fe.transform(t),a=fe.transform(n);e[o.array]=`${s} ${a}`}var $ae=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function KC(e,{attrX:t,attrY:n,attrScale:r,pathLength:i,pathSpacing:o=1,pathOffset:s=0,...a},l,c,u){if(Dm(e,a,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:f,style:p}=e;f.transform&&(p.transform=f.transform,delete f.transform),(p.transform||f.transformOrigin)&&(p.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),p.transform&&(p.transformBox=u?.transformBox??"fill-box",delete f.transformBox);for(let d of $ae)f[d]!==void 0&&(p[d]=f[d],delete f[d]);t!==void 0&&(f.x=t),n!==void 0&&(f.y=n),r!==void 0&&(f.scale=r),i!==void 0&&vW(f,i,o,s,!1)}var WC=()=>({...Im(),attrs:{}});var YC=e=>typeof e=="string"&&e.toLowerCase()==="svg";function SW(e,t,n,r){let i=(0,bW.useMemo)(()=>{let o=WC();return KC(o,t,YC(r),e.transformTemplate,e.style),{...o.attrs,style:{...o.style}}},[t]);if(e.style){let o={};nk(o,e.style,e),i.style={...o,...i.style}}return i}var wW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Om(e){return typeof e!="string"||e.includes("-")?!1:!!(wW.indexOf(e)>-1||/[A-Z]/u.test(e))}function xW(e,t,n,{latestValues:r},i,o=!1,s){let l=(s??Om(e)?SW:yW)(t,r,i,e),c=lW(t,typeof e=="string",o),u=e!==Pm.Fragment?{...c,...l,ref:n}:{},{children:f}=t,p=(0,Pm.useMemo)(()=>qt(f)?f.get():f,[f]);return(0,Pm.createElement)(e,{...u,children:p})}var rk=D(U(),1);function EW(e){let t=[{},{}];return e?.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function km(e,t,n,r){if(typeof t=="function"){let[i,o]=EW(r);t=t(n!==void 0?n:e.custom,i,o)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){let[i,o]=EW(r);t=t(n!==void 0?n:e.custom,i,o)}return t}function _m(e){return qt(e)?e.get():e}function jae({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,i){return{latestValues:qae(n,r,i,e),renderState:t()}}function qae(e,t,n,r){let i={},o=r(e,{});for(let p in o)i[p]=_m(o[p]);let{initial:s,animate:a}=e,l=Qf(e),c=jC(e);t&&c&&!l&&e.inherit!==!1&&(s===void 0&&(s=t.initial),a===void 0&&(a=t.animate));let u=n?n.initial===!1:!1;u=u||s===!1;let f=u?a:s;if(f&&typeof f!="boolean"&&!cu(f)){let p=Array.isArray(f)?f:[f];for(let d=0;d<p.length;d++){let h=km(e,p[d]);if(h){let{transitionEnd:m,transition:v,...g}=h;for(let y in g){let b=g[y];if(Array.isArray(b)){let w=u?b.length-1:0;b=b[w]}b!==null&&(i[y]=b)}for(let y in m)i[y]=m[y]}}}return i}var QC=e=>(t,n)=>{let r=(0,rk.useContext)(lu),i=(0,rk.useContext)(tu),o=()=>jae(e,t,r,i);return n?o():ym(o)};function Vm(e,t,n){let{style:r}=e,i={};for(let o in r)(qt(r[o])||t.style&&qt(t.style[o])||GC(o,e)||n?.getValue(o)?.liveStyle!==void 0)&&(i[o]=r[o]);return i}var CW=QC({scrapeMotionValuesFromProps:Vm,createRenderState:Im});function XC(e,t,n){let r=Vm(e,t,n);for(let i in e)if(qt(e[i])||qt(t[i])){let o=Us.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[o]=e[i]}return r}var TW=QC({scrapeMotionValuesFromProps:XC,createRenderState:WC});var AW=Symbol.for("motionComponentSymbol");var Xf=D(U(),1);function MW(e,t,n){let r=(0,Xf.useRef)(n);(0,Xf.useInsertionEffect)(()=>{r.current=n});let i=(0,Xf.useRef)(null);return(0,Xf.useCallback)(o=>{o&&e.onMount?.(o),t&&(o?t.mount(o):t.unmount());let s=r.current;if(typeof s=="function")if(o){let a=s(o);typeof a=="function"&&(i.current=a)}else i.current?(i.current(),i.current=null):s(o);else s&&(s.current=o)},[t])}var Gi=D(U(),1);var Lm=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase();var Gae="framerAppearId",ZC="data-"+Lm(Gae);var RW=D(U(),1),JC=(0,RW.createContext)({});function Zf(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function NW(e,t,n,r,i,o){let{visualElement:s}=(0,Gi.useContext)(lu),a=(0,Gi.useContext)(UC),l=(0,Gi.useContext)(tu),c=(0,Gi.useContext)(Rm).reducedMotion,u=(0,Gi.useRef)(null);r=r||a.renderer,!u.current&&r&&(u.current=r(e,{visualState:t,parent:s,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c,isSVG:o}));let f=u.current,p=(0,Gi.useContext)(JC);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&Kae(u.current,n,i,p);let d=(0,Gi.useRef)(!1);(0,Gi.useInsertionEffect)(()=>{f&&d.current&&f.update(n,l)});let h=n[ZC],m=(0,Gi.useRef)(!!h&&!window.MotionHandoffIsComplete?.(h)&&window.MotionHasOptimisedAnimation?.(h));return mC(()=>{f&&(d.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),m.current&&f.animationState&&f.animationState.animateChanges())}),(0,Gi.useEffect)(()=>{f&&(!m.current&&f.animationState&&f.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(h)}),m.current=!1),f.enteringChildren=void 0)}),f}function Kae(e,t,n,r){let{layoutId:i,layout:o,drag:s,dragConstraints:a,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:DW(e.parent)),e.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!s||a&&Zf(a),visualElement:e,animationType:typeof o=="string"?o:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function DW(e){if(e)return e.options.allowProjection!==!1?e.projection:DW(e.parent)}function tT(e,{forwardMotionProps:t=!1,type:n}={},r,i){r&&sW(r);let o=n?n==="svg":Om(e),s=o?TW:CW;function a(c,u){let f,p={...(0,Fm.useContext)(Rm),...c,layoutId:Wae(c)},{isStatic:d}=p,h=pW(c),m=s(c,d);if(!d&&vm){Yae(p,r);let v=Qae(p);f=v.MeasureLayout,h.visualElement=NW(e,m,p,i,v.ProjectionNode,o)}return(0,eT.jsxs)(lu.Provider,{value:h,children:[f&&h.visualElement?(0,eT.jsx)(f,{visualElement:h.visualElement,...p}):null,xW(e,c,MW(m,h.visualElement,u),m,d,t,o)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;let l=(0,Fm.forwardRef)(a);return l[AW]=e,l}function Wae({layoutId:e}){let t=(0,Fm.useContext)(gm).id;return t&&e!==void 0?t+"-"+e:e}function Yae(e,t){let n=(0,Fm.useContext)(UC).strict}function Qae(e){let{drag:t,layout:n}=Hl;if(!t&&!n)return{};let r={...t,...n};return{MeasureLayout:t?.isEnabled(e)||n?.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function IW(e,t){if(typeof Proxy>"u")return tT;let n=new Map,r=(o,s)=>tT(o,s,e,t),i=(o,s)=>r(o,s);return new Proxy(i,{get:(o,s)=>s==="create"?r:(n.has(s)||n.set(s,tT(s,void 0,e,t)),n.get(s))})}var WW=D(U(),1);function nT({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function OW({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function PW(e,t){if(!t)return e;let n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function ik(e){return e===void 0||e===1}function rT({scale:e,scaleX:t,scaleY:n}){return!ik(e)||!ik(t)||!ik(n)}function $l(e){return rT(e)||ok(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ok(e){return kW(e.x)||kW(e.y)}function kW(e){return e&&e!=="0%"}function tb(e,t,n){let r=e-n,i=t*r;return n+i}function _W(e,t,n,r,i){return i!==void 0&&(e=tb(e,i,r)),tb(e,n,r)+t}function sk(e,t=0,n=1,r,i){e.min=_W(e.min,t,n,r,i),e.max=_W(e.max,t,n,r,i)}function ak(e,{x:t,y:n}){sk(e.x,t.translate,t.scale,t.originPoint),sk(e.y,n.translate,n.scale,n.originPoint)}var VW=.999999999999,LW=1.0000000000001;function BW(e,t,n,r=!1){let i=n.length;if(!i)return;t.x=t.y=1;let o,s;for(let a=0;a<i;a++){o=n[a],s=o.projectionDelta;let{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Jf(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,ak(e,s)),r&&$l(o.latestValues)&&Jf(e,o.latestValues))}t.x<LW&&t.x>VW&&(t.x=1),t.y<LW&&t.y>VW&&(t.y=1)}function uu(e,t){e.min=e.min+t,e.max=e.max+t}function FW(e,t,n,r,i=.5){let o=gt(e.min,e.max,i);sk(e,t,n,o,r)}function Jf(e,t){FW(e.x,t.x,t.scaleX,t.scale,t.originX),FW(e.y,t.y,t.scaleY,t.scale,t.originY)}function lk(e,t){return nT(PW(e.getBoundingClientRect(),t))}function zW(e,t,n){let r=lk(e,n),{scroll:i}=t;return i&&(uu(r.x,i.offset.x),uu(r.y,i.offset.y)),r}var HW=()=>({translate:0,scale:1,origin:0,originPoint:0}),ep=()=>({x:HW(),y:HW()}),UW=()=>({min:0,max:0}),Rn=()=>({x:UW(),y:UW()});var nb={current:null},iT={current:!1};function $W(){if(iT.current=!0,!!vm)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>nb.current=e.matches;e.addEventListener("change",t),t()}else nb.current=!1}var jW=new WeakMap;function qW(e,t,n){for(let r in t){let i=t[r],o=n[r];if(qt(i))e.addValue(r,i);else if(qt(o))e.addValue(r,Zo(i,{owner:e}));else if(o!==i)if(e.hasValue(r)){let s=e.getValue(r);s.liveStyle===!0?s.jump(i):s.hasAnimated||s.set(i)}else{let s=e.getStaticValue(r);e.addValue(r,Zo(s!==void 0?s:i,{owner:e}))}}for(let r in n)t[r]===void 0&&e.removeValue(r);return t}var GW=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],oT=class{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:o,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Bl,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let p=hn.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,it.render(this.render,!1,!0))};let{latestValues:l,renderState:c}=s;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!o,this.isControllingVariants=Qf(n),this.isVariantNode=jC(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);let{willChange:u,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(let p in f){let d=f[p];l[p]!==void 0&&qt(d)&&d.set(l[p])}}mount(t){this.current=t,jW.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(iT.current||$W(),this.shouldReduceMotion=nb.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),qi(this.notifyUpdate),qi(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(let t in this.events)this.events[t].clear();for(let t in this.features){let n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();let r=vo.has(t);r&&this.onBindTransform&&this.onBindTransform();let i=n.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&it.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()}),o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Hl){let n=Hl[t];if(!n)continue;let{isEnabled:r,Feature:i}=n;if(!this.features[t]&&i&&r(this.props)&&(this.features[t]=new i(this)),this.features[t]){let o=this.features[t];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Rn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<GW.length;r++){let i=GW[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);let o="on"+i,s=t[o];s&&(this.propEventSubscriptions[i]=this.on(i,s))}this.prevMotionValues=qW(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){let n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){let r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);let n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Zo(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(vv(r)||Sv(r))?r=parseFloat(r):!ZP(r)&&Jr.test(n)&&(r=Uv(t,n)),this.setBaseTarget(t,qt(r)?r.get():r)),qt(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){let{initial:n}=this.props,r;if(typeof n=="string"||typeof n=="object"){let o=km(this.props,n,this.presenceContext?.custom);o&&(r=o[t])}if(n&&r!==void 0)return r;let i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!qt(i)?i:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new _l),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){Wf.render(this.render)}};var Bm=class extends oT{constructor(){super(...arguments),this.KeyframeResolver=$v}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:t}=this.props;qt(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}};function sT(e,{style:t,vars:n},r,i){let o=e.style,s;for(s in t)o[s]=t[s];i?.applyProjectionStyles(o,r);for(s in n)o.setProperty(s,n[s])}function Xae(e){return window.getComputedStyle(e)}var aT=class extends Bm{constructor(){super(...arguments),this.type="html",this.renderInstance=sT}readValueFromInstance(t,n){if(vo.has(n))return this.projection?.isProjecting?Vv(n):IP(t,n);{let r=Xae(t),i=(Iv(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:n}){return lk(t,n)}build(t,n,r){Dm(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return Vm(t,n,r)}};var lT=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function KW(e,t,n,r){sT(e,t,void 0,r);for(let i in t.attrs)e.setAttribute(lT.has(i)?i:Lm(i),t.attrs[i])}var cT=class extends Bm{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Rn}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(vo.has(n)){let r=Hv(n);return r&&r.default||0}return n=lT.has(n)?n:Lm(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return XC(t,n,r)}build(t,n,r){KC(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,i){KW(t,n,r,i)}mount(t){this.isSVGTag=YC(t.tagName),super.mount(t)}};var YW=(e,t)=>t.isSVG??Om(e)?new cT(t):new aT(t,{allowProjection:e!==WW.Fragment});function Oa(e,t,n){let r=e.getProps();return km(r,t,n!==void 0?n:r.custom,e)}var rb=e=>Array.isArray(e);function Zae(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Zo(n))}function Jae(e){return rb(e)?e[e.length-1]||0:e}function QW(e,t){let n=Oa(e,t),{transitionEnd:r={},transition:i={},...o}=n||{};o={...o,...r};for(let s in o){let a=Jae(o[s]);Zae(e,s,a)}}function XW(e){return!!(qt(e)&&e.add)}function ib(e,t){let n=e.getValue("willChange");if(XW(n))return n.add(t);if(!n&&Xr.WillChange){let r=new Xr.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function uT(e){return e.props[ZC]}var ele=e=>e!==null;function ZW(e,{repeat:t,repeatType:n="loop"},r){let i=e.filter(ele),o=t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}var tle={type:"spring",stiffness:500,damping:25,restSpeed:10},nle=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),rle={type:"keyframes",duration:.8},ile={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},JW=(e,{keyframes:t})=>t.length>2?rle:vo.has(e)?e.startsWith("scale")?nle(t[1]):tle:ile;function e5({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:o,repeatType:s,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}var zm=(e,t,n,r={},i,o)=>s=>{let a=Gf(r,e)||{},l=a.delay||r.delay||0,{elapsed:c=0}=r;c=c-Lr(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...a,delay:-c,onUpdate:p=>{t.set(p),a.onUpdate&&a.onUpdate(p)},onComplete:()=>{s(),a.onComplete&&a.onComplete()},name:e,motionValue:t,element:o?void 0:i};e5(a)||Object.assign(u,JW(e,u)),u.duration&&(u.duration=Lr(u.duration)),u.repeatDelay&&(u.repeatDelay=Lr(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let f=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(Am(u),u.delay===0&&(f=!0)),(Xr.instantAnimations||Xr.skipAnimations)&&(f=!0,Am(u),u.delay=0),u.allowFlatten=!a.type&&!a.ease,f&&!o&&t.get()!==void 0){let p=ZW(u.keyframes,a);if(p!==void 0){it.update(()=>{u.onUpdate(p),u.onComplete()});return}}return a.isSync?new Ll(u):new Fv(u)};function ole({protectedKeys:e,needsAnimating:t},n){let r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function fT(e,t,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:s,...a}=t;r&&(o=r);let l=[],c=i&&e.animationState&&e.animationState.getState()[i];for(let u in a){let f=e.getValue(u,e.latestValues[u]??null),p=a[u];if(p===void 0||c&&ole(c,u))continue;let d={delay:n,...Gf(o||{},u)},h=f.get();if(h!==void 0&&!f.isAnimating&&!Array.isArray(p)&&p===h&&!d.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){let g=uT(e);if(g){let y=window.MotionHandoffAnimation(g,u,it);y!==null&&(d.startTime=y,m=!0)}}ib(e,u),f.start(zm(u,f,p,e.shouldReduceMotion&&Bv.has(u)?{type:!1}:d,e,m));let v=f.animation;v&&l.push(v)}return s&&Promise.all(l).then(()=>{it.update(()=>{s&&QW(e,s)})}),l}function pT(e,t,n,r=0,i=1){let o=Array.from(e).sort((c,u)=>c.sortNodePosition(u)).indexOf(t),s=e.size,a=(s-1)*r;return typeof n=="function"?n(o,s):i===1?o*r:a-o*r}function dT(e,t,n={}){let r=Oa(e,t,n.type==="exit"?e.presenceContext?.custom:void 0),{transition:i=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);let o=r?()=>Promise.all(fT(e,r,n)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(l=0)=>{let{delayChildren:c=0,staggerChildren:u,staggerDirection:f}=i;return sle(e,t,l,c,u,f,n)}:()=>Promise.resolve(),{when:a}=i;if(a){let[l,c]=a==="beforeChildren"?[o,s]:[s,o];return l().then(()=>c())}else return Promise.all([o(),s(n.delay)])}function sle(e,t,n=0,r=0,i=0,o=1,s){let a=[];for(let l of e.variantChildren)l.notify("AnimationStart",t),a.push(dT(l,t,{...s,delay:n+(typeof r=="function"?0:r)+pT(e.variantChildren,l,r,i,o)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(a)}function t5(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){let i=t.map(o=>dT(e,o,n));r=Promise.all(i)}else if(typeof t=="string")r=dT(e,t,n);else{let i=typeof t=="function"?Oa(e,t,n.custom):t;r=Promise.all(fT(e,i,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function ck(e,t){if(!Array.isArray(t))return!1;let n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var ale=Jv.length;function uk(e){if(!e)return;if(!e.isControllingVariants){let n=e.parent?uk(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}let t={};for(let n=0;n<ale;n++){let r=Jv[n],i=e.props[r];(Ul(i)||i===!1)&&(t[r]=i)}return t}var lle=[...$C].reverse(),cle=$C.length;function ule(e){return t=>Promise.all(t.map(({animation:n,options:r})=>t5(e,n,r)))}function r5(e){let t=ule(e),n=n5(),r=!0,i=l=>(c,u)=>{let f=Oa(e,u,l==="exit"?e.presenceContext?.custom:void 0);if(f){let{transition:p,transitionEnd:d,...h}=f;c={...c,...h,...d}}return c};function o(l){t=l(e)}function s(l){let{props:c}=e,u=uk(e.parent)||{},f=[],p=new Set,d={},h=1/0;for(let v=0;v<cle;v++){let g=lle[v],y=n[g],b=c[g]!==void 0?c[g]:u[g],w=Ul(b),S=g===l?y.isActive:null;S===!1&&(h=v);let C=b===u[g]&&b!==c[g]&&w;if(C&&r&&e.manuallyAnimateOnMount&&(C=!1),y.protectedKeys={...d},!y.isActive&&S===null||!b&&!y.prevProp||cu(b)||typeof b=="boolean")continue;let x=fle(y.prevProp,b),E=x||g===l&&y.isActive&&!C&&w||v>h&&w,T=!1,A=Array.isArray(b)?b:[b],M=A.reduce(i(g),{});S===!1&&(M={});let{prevResolvedValues:R={}}=y,N={...R,...M},I=F=>{E=!0,p.has(F)&&(T=!0,p.delete(F)),y.needsAnimating[F]=!0;let L=e.getValue(F);L&&(L.liveStyle=!1)};for(let F in N){let L=M[F],k=R[F];if(d.hasOwnProperty(F))continue;let K=!1;rb(L)&&rb(k)?K=!ck(L,k):K=L!==k,K?L!=null?I(F):p.add(F):L!==void 0&&p.has(F)?I(F):y.protectedKeys[F]=!0}y.prevProp=b,y.prevResolvedValues=M,y.isActive&&(d={...d,...M}),r&&e.blockInitialAnimation&&(E=!1);let _=C&&x;E&&(!_||T)&&f.push(...A.map(F=>{let L={type:g};if(typeof F=="string"&&r&&!_&&e.manuallyAnimateOnMount&&e.parent){let{parent:k}=e,K=Oa(k,F);if(k.enteringChildren&&K){let{delayChildren:ee}=K.transition||{};L.delay=pT(k.enteringChildren,e,ee)}}return{animation:F,options:L}}))}if(p.size){let v={};if(typeof c.initial!="boolean"){let g=Oa(e,Array.isArray(c.initial)?c.initial[0]:c.initial);g&&g.transition&&(v.transition=g.transition)}p.forEach(g=>{let y=e.getBaseTarget(g),b=e.getValue(g);b&&(b.liveStyle=!0),v[g]=y??null}),f.push({animation:v})}let m=!!f.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(m=!1),r=!1,m?t(f):Promise.resolve()}function a(l,c){if(n[l].isActive===c)return Promise.resolve();e.variantChildren?.forEach(f=>f.animationState?.setActive(l,c)),n[l].isActive=c;let u=s(l);for(let f in n)n[f].protectedKeys={};return u}return{animateChanges:s,setActive:a,setAnimateFunction:o,getState:()=>n,reset:()=>{n=n5()}}}function fle(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!ck(t,e):!1}function tp(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function n5(){return{animate:tp(!0),whileInView:tp(),whileHover:tp(),whileTap:tp(),whileDrag:tp(),whileFocus:tp(),exit:tp()}}var wr=class{constructor(t){this.isMounted=!1,this.node=t}update(){}};var mT=class extends wr{constructor(t){super(t),t.animationState||(t.animationState=r5(t))}updateAnimationControlsSubscription(){let{animate:t}=this.node.getProps();cu(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}};var ple=0,hT=class extends wr{constructor(){super(...arguments),this.id=ple++}update(){if(!this.node.presenceContext)return;let{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;let i=this.node.animationState.setActive("exit",!t);n&&!t&&i.then(()=>{n(this.id)})}mount(){let{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}};var i5={animation:{Feature:mT},exit:{Feature:hT}};function jl(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function ql(e){return{point:{x:e.pageX,y:e.pageY}}}var o5=e=>t=>Yf(t)&&e(t,ql(t));function fu(e,t,n,r){return jl(e,t,o5(n),r)}var c5=1e-4,dle=1-c5,mle=1+c5,u5=.01,hle=0-u5,gle=0+u5;function cr(e){return e.max-e.min}function f5(e,t,n){return Math.abs(e-t)<=n}function s5(e,t,n,r=.5){e.origin=r,e.originPoint=gt(t.min,t.max,e.origin),e.scale=cr(n)/cr(t),e.translate=gt(n.min,n.max,e.origin)-e.originPoint,(e.scale>=dle&&e.scale<=mle||isNaN(e.scale))&&(e.scale=1),(e.translate>=hle&&e.translate<=gle||isNaN(e.translate))&&(e.translate=0)}function Hm(e,t,n,r){s5(e.x,t.x,n.x,r?r.originX:void 0),s5(e.y,t.y,n.y,r?r.originY:void 0)}function a5(e,t,n){e.min=n.min+t.min,e.max=e.min+cr(t)}function p5(e,t,n){a5(e.x,t.x,n.x),a5(e.y,t.y,n.y)}function l5(e,t,n){e.min=t.min-n.min,e.max=e.min+cr(t)}function ob(e,t,n){l5(e.x,t.x,n.x),l5(e.y,t.y,n.y)}function Ki(e){return[e("x"),e("y")]}var gT=({current:e})=>e?e.ownerDocument.defaultView:null;var d5=(e,t)=>Math.abs(e-t);function m5(e,t){let n=d5(e.x,t.x),r=d5(e.y,t.y);return Math.sqrt(n**2+r**2)}var Um=class{constructor(t,n,{transformPagePoint:r,contextWindow:i=window,dragSnapToOrigin:o=!1,distanceThreshold:s=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let p=pk(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,h=m5(p.offset,{x:0,y:0})>=this.distanceThreshold;if(!d&&!h)return;let{point:m}=p,{timestamp:v}=_n;this.history.push({...m,timestamp:v});let{onStart:g,onMove:y}=this.handlers;d||(g&&g(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,p)},this.handlePointerMove=(p,d)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=fk(d,this.transformPagePoint),it.update(this.updatePoint,!0)},this.handlePointerUp=(p,d)=>{this.end();let{onEnd:h,onSessionEnd:m,resumeAnimation:v}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let g=pk(p.type==="pointercancel"?this.lastMoveEventInfo:fk(d,this.transformPagePoint),this.history);this.startEvent&&h&&h(p,g),m&&m(p,g)},!Yf(t))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=s,this.contextWindow=i||window;let a=ql(t),l=fk(a,this.transformPagePoint),{point:c}=l,{timestamp:u}=_n;this.history=[{...c,timestamp:u}];let{onSessionStart:f}=n;f&&f(t,pk(l,this.history)),this.removeListeners=Bs(fu(this.contextWindow,"pointermove",this.handlePointerMove),fu(this.contextWindow,"pointerup",this.handlePointerUp),fu(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),qi(this.updatePoint)}};function fk(e,t){return t?{point:t(e.point)}:e}function h5(e,t){return{x:e.x-t.x,y:e.y-t.y}}function pk({point:e},t){return{point:e,delta:h5(e,g5(t)),offset:h5(e,yle(t)),velocity:vle(t,.1)}}function yle(e){return e[0]}function g5(e){return e[e.length-1]}function vle(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null,i=g5(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>Lr(t)));)n--;if(!r)return{x:0,y:0};let o=lr(i.timestamp-r.timestamp);if(o===0)return{x:0,y:0};let s={x:(i.x-r.x)/o,y:(i.y-r.y)/o};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function w5(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?gt(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?gt(n,e,r.max):Math.min(e,n)),e}function y5(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function x5(e,{top:t,left:n,bottom:r,right:i}){return{x:y5(e.x,n,i),y:y5(e.y,t,r)}}function v5(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function E5(e,t){return{x:v5(e.x,t.x),y:v5(e.y,t.y)}}function C5(e,t){let n=.5,r=cr(e),i=cr(t);return i>r?n=Na(t.min,t.max-r,e.min):r>i&&(n=Na(e.min,e.max-i,t.min)),Wn(0,1,n)}function T5(e,t){let n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}var yT=.35;function A5(e=yT){return e===!1?e=0:e===!0&&(e=yT),{x:b5(e,"left","right"),y:b5(e,"top","bottom")}}function b5(e,t,n){return{min:S5(e,t),max:S5(e,n)}}function S5(e,t){return typeof e=="number"?e:e[t]||0}var ble=new WeakMap,bT=class{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Rn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:r}={}){let{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;let o=f=>{n?(this.stopAnimation(),this.snapToCursor(ql(f).point)):this.pauseAnimation()},s=(f,p)=>{this.stopAnimation();let{drag:d,dragPropagation:h,onDragStart:m}=this.getProps();if(d&&!h&&(this.openDragLock&&this.openDragLock(),this.openDragLock=GP(d),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=p,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ki(g=>{let y=this.getAxisMotionValue(g).get()||0;if(Zr.test(y)){let{projection:b}=this.visualElement;if(b&&b.layout){let w=b.layout.layoutBox[g];w&&(y=cr(w)*(parseFloat(y)/100))}}this.originPoint[g]=y}),m&&it.postRender(()=>m(f,p)),ib(this.visualElement,"transform");let{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(f,p)=>{this.latestPointerEvent=f,this.latestPanInfo=p;let{dragPropagation:d,dragDirectionLock:h,onDirectionLock:m,onDrag:v}=this.getProps();if(!d&&!this.openDragLock)return;let{offset:g}=p;if(h&&this.currentDirection===null){this.currentDirection=Sle(g),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",p.point,g),this.updateAxis("y",p.point,g),this.visualElement.render(),v&&v(f,p)},l=(f,p)=>{this.latestPointerEvent=f,this.latestPanInfo=p,this.stop(f,p),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>Ki(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Um(t,{onSessionStart:o,onStart:s,onMove:a,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:r,contextWindow:gT(this.visualElement)})}stop(t,n){let r=t||this.latestPointerEvent,i=n||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!i||!r)return;let{velocity:s}=i;this.startAnimation(s);let{onDragEnd:a}=this.getProps();a&&it.postRender(()=>a(r,i))}cancel(){this.isDragging=!1;let{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){let{drag:i}=this.getProps();if(!r||!vT(t,i,this.currentDirection))return;let o=this.getAxisMotionValue(t),s=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(s=w5(s,this.constraints[t],this.elastic[t])),o.set(s)}resolveConstraints(){let{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,i=this.constraints;t&&Zf(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=x5(r.layoutBox,t):this.constraints=!1,this.elastic=A5(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ki(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=T5(r.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){let{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Zf(t))return!1;let r=t.current;Xo(r!==null,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:i}=this.visualElement;if(!i||!i.layout)return!1;let o=zW(r,i.root,this.visualElement.getTransformPagePoint()),s=E5(i.layout.layoutBox,o);if(n){let a=n(OW(s));this.hasMutatedConstraints=!!a,a&&(s=nT(a))}return s}startAnimation(t){let{drag:n,dragMomentum:r,dragElastic:i,dragTransition:o,dragSnapToOrigin:s,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Ki(u=>{if(!vT(u,n,this.currentDirection))return;let f=l&&l[u]||{};s&&(f={min:0,max:0});let p=i?200:1e6,d=i?40:1e7,h={type:"inertia",velocity:r?t[u]:0,bounceStiffness:p,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(u,h)});return Promise.all(c).then(a)}startAxisValueAnimation(t,n){let r=this.getAxisMotionValue(t);return ib(this.visualElement,t),r.start(zm(t,r,0,n,this.visualElement,!1))}stopAnimation(){Ki(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ki(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){let n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ki(n=>{let{drag:r}=this.getProps();if(!vT(n,r,this.currentDirection))return;let{projection:i}=this.visualElement,o=this.getAxisMotionValue(n);if(i&&i.layout){let{min:s,max:a}=i.layout.layoutBox[n],l=o.get()||0;o.set(t[n]-gt(s,a,.5)+l)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!Zf(n)||!r||!this.constraints)return;this.stopAnimation();let i={x:0,y:0};Ki(s=>{let a=this.getAxisMotionValue(s);if(a&&this.constraints!==!1){let l=a.get();i[s]=C5({min:l,max:l},this.constraints[s])}});let{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ki(s=>{if(!vT(s,t,null))return;let a=this.getAxisMotionValue(s),{min:l,max:c}=this.constraints[s];a.set(gt(l,c,i[s]))})}addListeners(){if(!this.visualElement.current)return;ble.set(this.visualElement,this);let t=this.visualElement.current,n=fu(t,"pointerdown",l=>{let{drag:c,dragListener:u=!0}=this.getProps();c&&u&&!Gv(l.target)&&this.start(l)}),r=()=>{let{dragConstraints:l}=this.getProps();Zf(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),it.read(r);let s=jl(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ki(u=>{let f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=l[u].translate,f.set(f.get()+l[u].translate))}),this.visualElement.render())}));return()=>{s(),n(),o(),a&&a()}}getProps(){let t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:s=yT,dragMomentum:a=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:o,dragElastic:s,dragMomentum:a}}};function vT(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function Sle(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}var ST=class extends wr{constructor(t){super(t),this.removeGroupControls=Mn,this.removeListeners=Mn,this.controls=new bT(t)}mount(){let{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Mn}update(){let{dragControls:t}=this.node.getProps(),{dragControls:n}=this.node.prevProps||{};t!==n&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners()}};var M5=e=>(t,n)=>{e&&it.postRender(()=>e(t,n))},wT=class extends wr{constructor(){super(...arguments),this.removePointerDownListener=Mn}onPointerDown(t){this.session=new Um(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:gT(this.node)})}createPanHandlers(){let{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:M5(t),onStart:M5(n),onMove:r,onEnd:(o,s)=>{delete this.session,i&&it.postRender(()=>i(o,s))}}}mount(){this.removePointerDownListener=fu(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}};var R5=D(j(),1);var sb=D(U(),1);var $m={hasAnimatedSinceResize:!0,hasEverUpdated:!1};var dk=!1,mk=class extends sb.Component{componentDidMount(){let{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:o}=t;o&&(n.group&&n.group.add(o),r&&r.register&&i&&r.register(o),dk&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),$m.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){let{layoutDependency:n,visualElement:r,drag:i,isPresent:o}=this.props,{projection:s}=r;return s&&(s.isPresent=o,dk=!0,i||t.layoutDependency!==n||n===void 0||t.isPresent!==o?s.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?s.promote():s.relegate()||it.postRender(()=>{let a=s.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){let{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Wf.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=t;dk=!0,i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){let{safeToRemove:t}=this.props;t&&t()}render(){return null}};function xT(e){let[t,n]=zC(),r=(0,sb.useContext)(gm);return(0,R5.jsx)(mk,{...e,layoutGroup:r,switchLayoutGroup:(0,sb.useContext)(JC),isPresent:t,safeToRemove:n})}function N5(e,t,n){let r=qt(e)?e:Zo(e);return r.start(zm("",r,t,n)),r.animation}var D5=(e,t)=>e.depth-t.depth;var ET=class{constructor(){this.children=[],this.isDirty=!1}add(t){Ff(this.children,t),this.isDirty=!0}remove(t){Bf(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(D5),this.isDirty=!1,this.children.forEach(t)}};function I5(e,t){let n=hn.now(),r=({timestamp:i})=>{let o=i-n;o>=t&&(qi(r),e(o-t))};return it.setup(r,!0),()=>qi(r)}var _5=["TopLeft","TopRight","BottomLeft","BottomRight"],wle=_5.length,O5=e=>typeof e=="string"?parseFloat(e):e,P5=e=>typeof e=="number"||fe.test(e);function V5(e,t,n,r,i,o){i?(e.opacity=gt(0,n.opacity??1,xle(r)),e.opacityExit=gt(t.opacity??1,0,Ele(r))):o&&(e.opacity=gt(t.opacity??1,n.opacity??1,r));for(let s=0;s<wle;s++){let a=`border${_5[s]}Radius`,l=k5(t,a),c=k5(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||P5(l)===P5(c)?(e[a]=Math.max(gt(O5(l),O5(c),r),0),(Zr.test(c)||Zr.test(l))&&(e[a]+="%")):e[a]=c}(t.rotate||n.rotate)&&(e.rotate=gt(t.rotate||0,n.rotate||0,r))}function k5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}var xle=L5(0,.5,Tv),Ele=L5(.5,.95,Mn);function L5(e,t,n){return r=>r<e?0:r>t?1:n(Na(e,t,r))}function F5(e,t){e.min=t.min,e.max=t.max}function es(e,t){F5(e.x,t.x),F5(e.y,t.y)}function hk(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function B5(e,t,n,r,i){return e-=t,e=tb(e,1/n,r),i!==void 0&&(e=tb(e,1/i,r)),e}function Cle(e,t=0,n=1,r=.5,i,o=e,s=e){if(Zr.test(t)&&(t=parseFloat(t),t=gt(s.min,s.max,t/100)-s.min),typeof t!="number")return;let a=gt(o.min,o.max,r);e===o&&(a-=t),e.min=B5(e.min,t,n,a,i),e.max=B5(e.max,t,n,a,i)}function z5(e,t,[n,r,i],o,s){Cle(e,t[n],t[r],t[i],t.scale,o,s)}var Tle=["x","scaleX","originX"],Ale=["y","scaleY","originY"];function gk(e,t,n,r){z5(e.x,t,Tle,n?n.x:void 0,r?r.x:void 0),z5(e.y,t,Ale,n?n.y:void 0,r?r.y:void 0)}function H5(e){return e.translate===0&&e.scale===1}function yk(e){return H5(e.x)&&H5(e.y)}function U5(e,t){return e.min===t.min&&e.max===t.max}function j5(e,t){return U5(e.x,t.x)&&U5(e.y,t.y)}function $5(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function vk(e,t){return $5(e.x,t.x)&&$5(e.y,t.y)}function bk(e){return cr(e.x)/cr(e.y)}function Sk(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}var CT=class{constructor(){this.members=[]}add(t){Ff(this.members,t),t.scheduleRender()}remove(t){if(Bf(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){let n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){let n=this.members.findIndex(i=>t===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){let o=this.members[i];if(o.isPresent!==!1){r=o;break}}return r?(this.promote(r),!0):!1}promote(t,n){let r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);let{crossfade:i}=t.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{let{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}};function q5(e,t,n){let r="",i=e.x.translate/t.x,o=e.y.translate/t.y,s=n?.z||0;if((i||o||s)&&(r=`translate3d(${i}px, ${o}px, ${s}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){let{transformPerspective:c,rotate:u,rotateX:f,rotateY:p,skewX:d,skewY:h}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),f&&(r+=`rotateX(${f}deg) `),p&&(r+=`rotateY(${p}deg) `),d&&(r+=`skewX(${d}deg) `),h&&(r+=`skewY(${h}deg) `)}let a=e.x.scale*t.x,l=e.y.scale*t.y;return(a!==1||l!==1)&&(r+=`scale(${a}, ${l})`),r||"none"}var np={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},wk=["","X","Y","Z"],Mle=1e3,Rle=0;function xk(e,t,n,r){let{latestValues:i}=t;i[e]&&(n[e]=i[e],t.setStaticValue(e,0),r&&(r[e]=0))}function e4(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;let{visualElement:t}=e.options;if(!t)return;let n=uT(t);if(window.MotionHasOptimisedAnimation(n,"transform")){let{layout:i,layoutId:o}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",it,!(i||o))}let{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&e4(r)}function TT({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(s={},a=t?.()){this.id=Rle++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ji.value&&(np.nodes=np.calculatedTargetDeltas=np.calculatedProjections=0),this.nodes.forEach(Ile),this.nodes.forEach(_le),this.nodes.forEach(Vle),this.nodes.forEach(Ole),ji.addProjectionMetrics&&ji.addProjectionMetrics(np)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new ET)}addEventListener(s,a){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new _l),this.eventHandlers.get(s).add(a)}notifyListeners(s,...a){let l=this.eventHandlers.get(s);l&&l.notify(...a)}hasListeners(s){return this.eventHandlers.has(s)}mount(s){if(this.instance)return;this.isSVG=Kv(s)&&!XP(s),this.instance=s;let{layoutId:a,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),e){let u,f=0,p=()=>this.root.updateBlockedByResize=!1;it.read(()=>{f=window.innerWidth}),e(s,()=>{let d=window.innerWidth;d!==f&&(f=d,this.root.updateBlockedByResize=!0,u&&u(),u=I5(p,250),$m.hasAnimatedSinceResize&&($m.hasAnimatedSinceResize=!1,this.nodes.forEach(W5)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&c&&(a||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:f,hasRelativeLayoutChanged:p,layout:d})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let h=this.options.transition||c.getDefaultTransition()||Hle,{onLayoutAnimationStart:m,onLayoutAnimationComplete:v}=c.getProps(),g=!this.targetLayout||!vk(this.targetLayout,d),y=!f&&p;if(this.options.layoutRoot||this.resumeFrom||y||f&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let b={...Gf(h,"layout"),onPlay:m,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(u,y)}else f||W5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=d})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),qi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Lle),this.animationId++)}getTransformTemplate(){let{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&e4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){let f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}let{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;let c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(G5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(K5);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(kle),this.nodes.forEach(Nle),this.nodes.forEach(Dle)):this.nodes.forEach(K5),this.clearAllSnapshots();let a=hn.now();_n.delta=Wn(0,1e3/60,a-_n.timestamp),_n.timestamp=a,_n.isProcessing=!0,Dv.update.process(_n),Dv.preRender.process(_n),Dv.render.process(_n),_n.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Wf.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Ple),this.sharedNodes.forEach(Fle)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,it.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){it.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!cr(this.snapshot.measuredBox.x)&&!cr(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();let s=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Rn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(a=!1),a&&this.instance){let l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:s,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;let s=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!yk(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;s&&this.instance&&(a||$l(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){let a=this.measurePageBox(),l=this.removeElementScroll(a);return s&&(l=this.removeTransform(l)),Ule(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:s}=this.options;if(!s)return Rn();let a=s.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some($le))){let{scroll:c}=this.root;c&&(uu(a.x,c.offset.x),uu(a.y,c.offset.y))}return a}removeElementScroll(s){let a=Rn();if(es(a,s),this.scroll?.wasRoot)return a;for(let l=0;l<this.path.length;l++){let c=this.path[l],{scroll:u,options:f}=c;c!==this.root&&u&&f.layoutScroll&&(u.wasRoot&&es(a,s),uu(a.x,u.offset.x),uu(a.y,u.offset.y))}return a}applyTransform(s,a=!1){let l=Rn();es(l,s);for(let c=0;c<this.path.length;c++){let u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Jf(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),$l(u.latestValues)&&Jf(l,u.latestValues)}return $l(this.latestValues)&&Jf(l,this.latestValues),l}removeTransform(s){let a=Rn();es(a,s);for(let l=0;l<this.path.length;l++){let c=this.path[l];if(!c.instance||!$l(c.latestValues))continue;rT(c.latestValues)&&c.updateSnapshot();let u=Rn(),f=c.measurePageBox();es(u,f),gk(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return $l(this.latestValues)&&gk(a,this.latestValues),a}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==_n.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){let a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);let l=!!this.resumingFrom||this!==a;if(!(s||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:u,layoutId:f}=this.options;if(!this.layout||!(u||f))return;this.resolvedRelativeTargetAt=_n.timestamp;let p=this.getClosestProjectingParent();p&&this.linkedParentVersion!==p.layoutVersion&&!p.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(p&&p.layout?this.createRelativeTarget(p,this.layout.layoutBox,p.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Rn(),this.targetWithTransforms=Rn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),p5(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):es(this.target,this.layout.layoutBox),ak(this.target,this.targetDelta)):es(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?this.createRelativeTarget(p,this.target,p.target):this.relativeParent=this.relativeTarget=void 0),ji.value&&np.calculatedTargetDeltas++)}getClosestProjectingParent(){if(!(!this.parent||rT(this.parent.latestValues)||ok(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(s,a,l){this.relativeParent=s,this.linkedParentVersion=s.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rn(),this.relativeTargetOrigin=Rn(),ob(this.relativeTargetOrigin,a,l),es(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){let s=this.getLead(),a=!!this.resumingFrom||this!==s,l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===_n.timestamp&&(l=!1),l)return;let{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;es(this.layoutCorrected,this.layout.layoutBox);let f=this.treeScale.x,p=this.treeScale.y;BW(this.layoutCorrected,this.treeScale,this.path,a),s.layout&&!s.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(s.target=s.layout.layoutBox,s.targetWithTransforms=Rn());let{target:d}=s;if(!d){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(hk(this.prevProjectionDelta.x,this.projectionDelta.x),hk(this.prevProjectionDelta.y,this.projectionDelta.y)),Hm(this.projectionDelta,this.layoutCorrected,d,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==p||!Sk(this.projectionDelta.x,this.prevProjectionDelta.x)||!Sk(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d)),ji.value&&np.calculatedProjections++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.visualElement?.scheduleRender(),s){let a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ep(),this.projectionDelta=ep(),this.projectionDeltaWithTransform=ep()}setAnimationOrigin(s,a=!1){let l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},f=ep();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;let p=Rn(),d=l?l.source:void 0,h=this.layout?this.layout.source:void 0,m=d!==h,v=this.getStack(),g=!v||v.members.length<=1,y=!!(m&&!g&&this.options.crossfade===!0&&!this.path.some(zle));this.animationProgress=0;let b;this.mixTargetDelta=w=>{let S=w/1e3;Y5(f.x,s.x,S),Y5(f.y,s.y,S),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ob(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ble(this.relativeTarget,this.relativeTargetOrigin,p,S),b&&j5(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=Rn()),es(b,this.relativeTarget)),m&&(this.animationValues=u,V5(u,c,this.latestValues,S,y,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(qi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=it.update(()=>{$m.hasAnimatedSinceResize=!0,zs.layout++,this.motionValue||(this.motionValue=Zo(0)),this.currentAnimation=N5(this.motionValue,[0,1e3],{...s,velocity:0,isSync:!0,onUpdate:a=>{this.mixTargetDelta(a),s.onUpdate&&s.onUpdate(a)},onStop:()=>{zs.layout--},onComplete:()=>{zs.layout--,s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Mle),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let s=this.getLead(),{targetWithTransforms:a,target:l,layout:c,latestValues:u}=s;if(!(!a||!l||!c)){if(this!==s&&this.layout&&c&&t4(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Rn();let f=cr(this.layout.layoutBox.x);l.x.min=s.target.x.min,l.x.max=l.x.min+f;let p=cr(this.layout.layoutBox.y);l.y.min=s.target.y.min,l.y.max=l.y.min+p}es(a,l),Jf(a,u),Hm(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(s,a){this.sharedNodes.has(s)||this.sharedNodes.set(s,new CT),this.sharedNodes.get(s).add(a);let c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){let s=this.getStack();return s?s.lead===this:!0}getLead(){let{layoutId:s}=this.options;return s?this.getStack()?.lead||this:this}getPrevLead(){let{layoutId:s}=this.options;return s?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:a,preserveFollowOpacity:l}={}){let c=this.getStack();c&&c.promote(this,l),s&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){let s=this.getStack();return s?s.relegate(this):!1}resetSkewAndRotation(){let{visualElement:s}=this.options;if(!s)return;let a=!1,{latestValues:l}=s;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;let c={};l.z&&xk("z",s,c,this.animationValues);for(let u=0;u<wk.length;u++)xk(`rotate${wk[u]}`,s,c,this.animationValues),xk(`skew${wk[u]}`,s,c,this.animationValues);s.render();for(let u in c)s.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);s.scheduleRender()}applyProjectionStyles(s,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){s.visibility="hidden";return}let l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,s.visibility="",s.opacity="",s.pointerEvents=_m(a?.pointerEvents)||"",s.transform=l?l(this.latestValues,""):"none";return}let c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(s.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,s.pointerEvents=_m(a?.pointerEvents)||""),this.hasProjected&&!$l(this.latestValues)&&(s.transform=l?l({},""):"none",this.hasProjected=!1);return}s.visibility="";let u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let f=q5(this.projectionDeltaWithTransform,this.treeScale,u);l&&(f=l(u,f)),s.transform=f;let{x:p,y:d}=this.projectionDelta;s.transformOrigin=`${p.origin*100}% ${d.origin*100}% 0`,c.animationValues?s.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:s.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(let h in eb){if(u[h]===void 0)continue;let{correct:m,applyTo:v,isCSSVariable:g}=eb[h],y=f==="none"?u[h]:m(u[h],c);if(v){let b=v.length;for(let w=0;w<b;w++)s[v[w]]=y}else g?this.options.visualElement.renderState.vars[h]=y:s[h]=y}this.options.layoutId&&(s.pointerEvents=c===this?_m(a?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>s.currentAnimation?.stop()),this.root.nodes.forEach(G5),this.root.sharedNodes.clear()}}}function Nle(e){e.updateLayout()}function Dle(e){let t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){let{layoutBox:n,measuredBox:r}=e.layout,{animationType:i}=e.options,o=t.source!==e.layout.source;i==="size"?Ki(u=>{let f=o?t.measuredBox[u]:t.layoutBox[u],p=cr(f);f.min=n[u].min,f.max=f.min+p}):t4(i,t.layoutBox,n)&&Ki(u=>{let f=o?t.measuredBox[u]:t.layoutBox[u],p=cr(n[u]);f.max=f.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[u].max=e.relativeTarget[u].min+p)});let s=ep();Hm(s,n,t.layoutBox);let a=ep();o?Hm(a,e.applyTransform(r,!0),t.measuredBox):Hm(a,n,t.layoutBox);let l=!yk(s),c=!1;if(!e.resumeFrom){let u=e.getClosestProjectingParent();if(u&&!u.resumeFrom){let{snapshot:f,layout:p}=u;if(f&&p){let d=Rn();ob(d,t.layoutBox,f.layoutBox);let h=Rn();ob(h,n,p.layoutBox),vk(d,h)||(c=!0),u.options.layoutRoot&&(e.relativeTarget=h,e.relativeTargetOrigin=d,e.relativeParent=u)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:a,layoutDelta:s,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){let{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Ile(e){ji.value&&np.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Ole(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Ple(e){e.clearSnapshot()}function G5(e){e.clearMeasurements()}function K5(e){e.isLayoutDirty=!1}function kle(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function W5(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function _le(e){e.resolveTargetDelta()}function Vle(e){e.calcProjection()}function Lle(e){e.resetSkewAndRotation()}function Fle(e){e.removeLeadSnapshot()}function Y5(e,t,n){e.translate=gt(t.translate,0,n),e.scale=gt(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Q5(e,t,n,r){e.min=gt(t.min,n.min,r),e.max=gt(t.max,n.max,r)}function Ble(e,t,n,r){Q5(e.x,t.x,n.x,r),Q5(e.y,t.y,n.y,r)}function zle(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}var Hle={duration:.45,ease:[.4,0,.1,1]},X5=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Z5=X5("applewebkit/")&&!X5("chrome/")?Math.round:Mn;function J5(e){e.min=Z5(e.min),e.max=Z5(e.max)}function Ule(e){J5(e.x),J5(e.y)}function t4(e,t,n){return e==="position"||e==="preserve-aspect"&&!f5(bk(t),bk(n),.2)}function $le(e){return e!==e.root&&e.scroll?.wasRoot}var n4=TT({attachResizeListener:(e,t)=>jl(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0});var Ek={current:void 0},AT=TT({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ek.current){let e=new n4({});e.mount(window),e.setOptions({layoutScroll:!0}),Ek.current=e}return Ek.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"});var r4={pan:{Feature:wT},drag:{Feature:ST,ProjectionNode:AT,MeasureLayout:xT}};function i4(e,t,n){let{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");let i="onHover"+n,o=r[i];o&&it.postRender(()=>o(t,ql(t)))}var MT=class extends wr{mount(){let{current:t}=this.node;t&&(this.unmount=KP(t,(n,r)=>(i4(this.node,r,"Start"),i=>i4(this.node,i,"End"))))}unmount(){}};var RT=class extends wr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Bs(jl(this.node.current,"focus",()=>this.onFocus()),jl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}};function o4(e,t,n){let{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");let i="onTap"+(n==="End"?"":n),o=r[i];o&&it.postRender(()=>o(t,ql(t)))}var NT=class extends wr{mount(){let{current:t}=this.node;t&&(this.unmount=QP(t,(n,r)=>(o4(this.node,r,"Start"),(i,{success:o})=>o4(this.node,i,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}};var Tk=new WeakMap,Ck=new WeakMap,jle=e=>{let t=Tk.get(e.target);t&&t(e)},qle=e=>{e.forEach(jle)};function Gle({root:e,...t}){let n=e||document;Ck.has(n)||Ck.set(n,{});let r=Ck.get(n),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(qle,{root:e,...t})),r[i]}function s4(e,t,n){let r=Gle(t);return Tk.set(e,n),r.observe(e),()=>{Tk.delete(e),r.unobserve(e)}}var Kle={some:0,all:1},DT=class extends wr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:o}=t,s={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:Kle[i]},a=l=>{let{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,o&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);let{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),p=c?u:f;p&&p(l)};return s4(this.node.current,s,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;let{props:t,prevProps:n}=this.node;["amount","margin","root"].some(Wle(t,n))&&this.startObserver()}unmount(){}};function Wle({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}var a4={inView:{Feature:DT},tap:{Feature:NT},focus:{Feature:RT},hover:{Feature:MT}};var l4={layout:{ProjectionNode:AT,MeasureLayout:xT}};var c4={...i5,...a4,...r4,...l4};var Fr=IW(c4,YW);var Pa=D(U(),1),f4=D(j(),1),Yle=1e3,u4=(0,Pa.createContext)(null),Ak=({children:e})=>{let[t,n]=(0,Pa.useState)(()=>Date.now());(0,Pa.useEffect)(()=>{let i=setInterval(()=>{n(Date.now())},Yle);return()=>{clearInterval(i)}},[]);let r=(0,Pa.useMemo)(()=>({now:t}),[t]);return(0,f4.jsx)(u4.Provider,{value:r,children:e})},Mk=()=>{let e=(0,Pa.useContext)(u4);if(!e)throw new Error("useTime must be used within a TimeProvider");return e};var IT=D(U(),1);var pu=e=>{if(e==null)throw new Error("Input cannot be null or undefined");if(typeof e!="string")throw new TypeError(`Expected a string, but received ${typeof e}`);return hM(e)};var js=D(j(),1),Gt=(0,IT.memo)(({text:e,query:t,caseSensitive:n=!1,activeMatchIndex:r=-1,className:i,ariaLabel:o})=>{if(!t||!t.trim()||!e)return(0,js.jsx)(js.Fragment,{children:e});try{let s=pu(t),a=new RegExp(`(${s})`,n?"g":"gi"),l=e.split(a);return e.match(a)?(0,js.jsx)("span",{"aria-label":o,children:l.map((u,f)=>{if(f%2===1){let d=(f-1)/2===r;return(0,js.jsx)("mark",{className:ge(i,{"is-active-match":d}),children:u},f)}return(0,js.jsx)(IT.Fragment,{children:u},f)})}):(0,js.jsx)(js.Fragment,{children:e})}catch(s){return console.warn("HighlightedText regex error:",s),(0,js.jsx)(js.Fragment,{children:e})}});Gt.displayName="HighlightedText";var p4=D(U(),1);var ts=D(j(),1),Nk=(0,p4.memo)(({version:e,searchQuery:t,isSearchCaseSensitive:n,showNameEditor:r,nameValue:i,setNameValue:o,placeholderName:s,timestampText:a,tooltipTimestamp:l,handleNameInputKeyDown:c,prefix:u,nameInputRef:f})=>(0,ts.jsxs)("div",{className:"v-entry-header",children:[(0,ts.jsx)("span",{className:"v-version-id","aria-hidden":!0,children:(0,ts.jsx)(Gt,{text:`${u}${String(e.versionNumber??"")}`,...t&&{query:t},...n!==void 0&&{caseSensitive:n}})}),r?(0,ts.jsx)("input",{ref:f,type:"text",className:"v-version-name-input",value:i,onChange:p=>o(p.target.value),placeholder:s,"aria-label":"Name input",onKeyDown:c,onClick:p=>p.stopPropagation(),maxLength:256}):(0,ts.jsx)("div",{className:"v-entry-main-info",children:e.name?(0,ts.jsx)("div",{className:"v-version-name",children:(0,ts.jsx)(Gt,{text:e.name,...t&&{query:t},...n!==void 0&&{caseSensitive:n}})}):(0,ts.jsx)("div",{className:"v-version-name is-empty"})}),(0,ts.jsx)("span",{className:"v-version-timestamp",title:l,children:(0,ts.jsx)(Gt,{text:a,...t&&{query:t},...n!==void 0&&{caseSensitive:n}})})]}));Nk.displayName="EntryHeader";var d4=D(U(),1);var Qle=require("obsidian");function OT(e){if(typeof e!="number"||!Number.isFinite(e)||e<0||e===0)return"0 B";let t=[{threshold:1e18,suffix:"EB",divisor:1e18},{threshold:1e15,suffix:"PB",divisor:1e15},{threshold:1e12,suffix:"TB",divisor:1e12},{threshold:1e9,suffix:"GB",divisor:1e9},{threshold:1e6,suffix:"MB",divisor:1e6},{threshold:1e3,suffix:"KB",divisor:1e3}];for(let{threshold:n,suffix:r,divisor:i}of t)if(e>=n){let o=e/i;return`${o>=100?o.toFixed(0):o>=10?o.toFixed(1):o.toFixed(2)} ${r}`}return`${e} B`}var Z4e=300*1e3;var qs=D(j(),1),Dk=(0,d4.memo)(({searchQuery:e,isSearchCaseSensitive:t,displaySize:n,wordCount:r,charCount:i,lineCount:o,enableWordCount:s,enableCharacterCount:a,enableLineCount:l})=>(0,qs.jsxs)("div",{className:"v-version-content","aria-hidden":!0,children:[(0,qs.jsxs)("span",{children:["Size: ",(0,qs.jsx)(Gt,{text:OT(typeof n=="number"?n:0),...e&&{query:e},...t!==void 0&&{caseSensitive:t}})]}),s&&typeof r=="number"&&(0,qs.jsxs)("span",{children:["Words: ",(0,qs.jsx)(Gt,{text:String(r),...e&&{query:e},...t!==void 0&&{caseSensitive:t}})]}),a&&typeof i=="number"&&(0,qs.jsxs)("span",{children:["Chars: ",(0,qs.jsx)(Gt,{text:String(i),...e&&{query:e},...t!==void 0&&{caseSensitive:t}})]}),l&&typeof o=="number"&&(0,qs.jsxs)("span",{children:["Lines: ",(0,qs.jsx)(Gt,{text:String(o),...e&&{query:e},...t!==void 0&&{caseSensitive:t}})]})]}));Dk.displayName="EntryMetadata";var m4=D(U(),1);var Gl=D(j(),1),Ik=(0,m4.memo)(({version:e,showFooterDescription:t,viewMode:n,isEditButtonAction:r})=>{let i=Pe(),o=n==="edits"?Yx:Wx,s=Array.isArray(o)?o:[];return t?null:(0,Gl.jsxs)(Gl.Fragment,{children:[(0,Gl.jsx)("button",{className:"v-action-btn","aria-label":"Preview in panel",onClick:a=>{a.stopPropagation(),i(Z.viewVersionInPanel(e))},onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),i(Z.viewVersionInPanel(e)))},children:(0,Gl.jsx)(J,{name:"eye"})}),s.map(a=>{let l=c=>{c.stopPropagation(),a.id==="edit"&&(r.current=!0);try{typeof a.actionHandler=="function"&&a.actionHandler(e,{dispatch:i})}catch(u){console.error("HistoryEntry: action handler threw",u)}};return(0,Gl.jsx)("button",{className:ge("v-action-btn",{danger:!!a.isDanger}),"aria-label":String(a.tooltip??""),onClick:l,onKeyDown:c=>{c.key==="Enter"&&(c.preventDefault(),l(c))},children:(0,Gl.jsx)(J,{name:String(a.icon??"")})},String(a.id))})]})});Ik.displayName="EntryActions";var h4=D(U(),1);var Ok=D(j(),1),kk=(0,h4.memo)(({isVisible:e,descValue:t,setDescValue:n,placeholderDesc:r,handleDescTextareaKeyDown:i,descTextareaRef:o})=>e?(0,Ok.jsx)("div",{className:"v-entry-description-editor",children:(0,Ok.jsx)("textarea",{ref:o,placeholder:r,"aria-label":"Description input",value:t,onChange:s=>n(s.target.value),onKeyDown:i,onClick:s=>s.stopPropagation(),maxLength:2048})}):null);kk.displayName="EntryEditor";var Kl=D(U(),1);function g4(e,t,n){let[r,i]=(0,Kl.useState)(""),[o,s]=(0,Kl.useState)(""),a=(0,Kl.useRef)(!1);return(0,Kl.useEffect)(()=>{if(e){i(t.name??""),s(t.description??""),a.current=!0;let l=setTimeout(()=>{a.current=!1},150);return()=>clearTimeout(l)}},[e,t.name,t.description]),(0,Kl.useLayoutEffect)(()=>{let l=n.current;if(l&&e){l.style.height="inherit";let c=l.scrollHeight;l.style.height=`${c}px`}},[o,e,n]),{nameValue:r,setNameValue:i,descValue:o,setDescValue:s,ignoreBlurRef:a}}var Wi=D(U(),1);var y4=require("obsidian");function v4(e,t,n){let r=(0,y4.moment)(e);if(!r.isValid())return{timestampText:"Invalid date",tooltipTimestamp:"Invalid date"};let i=t?r.fromNow():r.format("YYYY-MM-DD HH:mm"),o=r.format("LLLL");return{timestampText:i,tooltipTimestamp:o}}function b4(e,t){return e?t.compressedSize??t.uncompressedSize??t.size:t.uncompressedSize??t.size}function S4(e,t){let n=t.includeMdSyntaxInWordCount?e.wordCountWithMd:e.wordCount,r=t.includeMdSyntaxInCharacterCount?e.charCountWithMd:e.charCount,i=t.includeMdSyntaxInLineCount?e.lineCount:e.lineCountWithoutMd;return{wordCount:n,charCount:r,lineCount:i}}function w4(e,t){return e.trim().slice(0,t)}function x4(e){return w4(e,256)}function E4(e){return w4(e,2048)}function _k(e,t){return e!==t}function C4(e,t,n,r,i,o,s,a){let l=Pe(),c=(0,Wi.useRef)(!1),u=(0,Wi.useRef)(!1),f=(0,Wi.useCallback)(()=>{try{let b=x4(i),w=E4(o),S=String(e.name??""),C=String(e.description??"");_k(S,b)||_k(C,w)?l(t==="edits"?Z.updateEditDetails(e.id,{name:b,description:w}):Z.updateVersionDetails(e.id,{name:b,description:w})):l(H.actions.stopVersionEditing())}catch(b){console.error("HistoryEntry.saveDetails error:",b),l(H.actions.stopVersionEditing())}},[l,e.id,e.name,e.description,i,o,t]),p=(0,Wi.useCallback)(b=>{n!==null?u.current=!0:u.current=!1},[n]),d=(0,Wi.useCallback)(b=>{try{b.preventDefault(),b.stopPropagation()}catch{}if(u.current){u.current=!1;return}l(Z.viewVersionInPanel(e))},[l,e]),h=(0,Wi.useCallback)(b=>{if(!(b.target instanceof HTMLElement&&b.target.matches("input, textarea"))){try{b.preventDefault(),b.stopPropagation()}catch{}l(Z.showVersionContextMenu(e))}},[l,e]),m=(0,Wi.useCallback)(b=>{if(b.key==="Enter"||b.key===" "){if(b.target instanceof HTMLElement&&b.target.matches("input, textarea"))return;try{b.preventDefault(),b.stopPropagation()}catch{}l(Z.showVersionContextMenu(e))}},[l,e]),v=(0,Wi.useCallback)(b=>{if(!a.current){if(c.current){c.current=!1;return}b.currentTarget.contains(b.relatedTarget)||f()}},[f,a]),g=(0,Wi.useCallback)(b=>{b.stopPropagation(),b.key==="Enter"?(b.preventDefault(),f()):b.key==="Escape"&&(b.preventDefault(),l(H.actions.stopVersionEditing()))},[l,f]),y=(0,Wi.useCallback)(b=>{b.stopPropagation(),b.key==="Escape"&&(b.preventDefault(),l(H.actions.stopVersionEditing())),b.key==="Enter"&&(b.ctrlKey||b.metaKey)&&(b.preventDefault(),f())},[l,f]);return(0,Wi.useEffect)(()=>{if(!r)return;let b=S=>{s.current&&!s.current.contains(S.target)&&f()},w=setTimeout(()=>{document.addEventListener("mousedown",b)},0);return()=>{clearTimeout(w),document.removeEventListener("mousedown",b)}},[r,f,s]),{isEditButtonAction:c,handleMouseDown:p,handleEntryClick:d,handleContextMenu:h,handleKeyDown:m,handleContainerBlur:v,handleNameInputKeyDown:g,handleDescTextareaKeyDown:y,saveDetails:f}}var T4=D(U(),1);function A4(e,t,n,r,i){(0,T4.useEffect)(()=>{if(e){let o=r||i?t.current:n.current;if(o){let s=window.setTimeout(()=>{try{o.focus(),o instanceof HTMLInputElement&&o.select()}catch{}},50);return()=>window.clearTimeout(s)}}},[e,i,r,t,n])}var ns=D(j(),1),PT=(0,Wl.memo)(({version:e,searchQuery:t,isSearchCaseSensitive:n,viewMode:r="versions"})=>{let{settings:i,enableCompression:o,namingVersionId:s,highlightedVersionId:a,isManualVersionEdit:l,isSearchActive:c}=me(V=>({settings:V.app.effectiveSettings,enableCompression:V.app.settings.enableCompression,namingVersionId:V.app.namingVersionId,highlightedVersionId:V.app.highlightedVersionId,isManualVersionEdit:V.app.isManualVersionEdit,isSearchActive:V.app.isSearchActive})),{now:u}=Mk(),f=(0,Wl.useRef)(null),p=(0,Wl.useRef)(null),d=(0,Wl.useRef)(null),h=e.id===s,{nameValue:m,setNameValue:v,descValue:g,setDescValue:y,ignoreBlurRef:b}=g4(h,e,d),{isEditButtonAction:w,handleMouseDown:S,handleEntryClick:C,handleContextMenu:x,handleKeyDown:E,handleContainerBlur:T,handleNameInputKeyDown:A,handleDescTextareaKeyDown:M}=C4(e,r,s,h,m,g,f,b);A4(h,p,d,l,i.enableVersionNaming);let{timestampText:R,tooltipTimestamp:N}=(0,Wl.useMemo)(()=>v4(e.timestamp,i?.useRelativeTimestamps,u),[e.timestamp,i?.useRelativeTimestamps,u]),I=h&&(l||i.enableVersionNaming),_=h&&(l||i.enableVersionDescription),{wordCount:z,charCount:F,lineCount:L}=S4(e,i),K=!!e.description&&e.description.trim().length>0&&(c||i.showDescriptionInList),ee=K&&!i.isListView,Se=K&&i.isListView,De=r==="edits"?"E":"V",we=r==="edits"?"Edit name...":"Version name...",qe=r==="edits"?"Edit description...":"Version description...",Fe=(0,Wl.useMemo)(()=>b4(o,e),[o,e]),pe=!i.isListView&&!h?{whileHover:{y:-2},whileTap:{y:-1}}:{};return(0,ns.jsxs)(Fr.div,{ref:f,className:ge("v-history-entry",{"is-list-view":i?.isListView,"is-naming":h,"is-highlighted":e.id===a}),role:"listitem",tabIndex:0,onClick:C,onMouseDown:S,onContextMenu:x,onKeyDown:E,onBlur:h?T:void 0,"aria-selected":e.id===a,"data-version-id":String(e.id),...pe,children:[(0,ns.jsx)(Nk,{version:e,searchQuery:t,isSearchCaseSensitive:n,showNameEditor:I,nameValue:m,setNameValue:v,placeholderName:we,timestampText:R,tooltipTimestamp:N,handleNameInputKeyDown:A,prefix:De,nameInputRef:p}),(0,ns.jsx)(Dk,{searchQuery:t,isSearchCaseSensitive:n,displaySize:Fe,wordCount:z,charCount:F,lineCount:L,enableWordCount:i.enableWordCount,enableCharacterCount:i.enableCharacterCount,enableLineCount:i.enableLineCount}),(0,ns.jsx)(kk,{isVisible:_||h&&l,descValue:g,setDescValue:y,placeholderDesc:qe,handleDescTextareaKeyDown:M,descTextareaRef:d}),Se&&!h&&(0,ns.jsx)("div",{className:"v-history-description",children:(0,ns.jsx)(Gt,{text:e.description||"",...t&&{query:t},...n!==void 0&&{caseSensitive:n}})}),!i?.isListView&&(0,ns.jsx)("div",{className:ge("v-entry-footer",{"is-hidden":h}),children:ee?(0,ns.jsx)("div",{className:"v-history-description",children:(0,ns.jsx)(Gt,{text:e.description||"",...t&&{query:t},...n!==void 0&&{caseSensitive:n}})}):(0,ns.jsx)(Ik,{version:e,showFooterDescription:ee,viewMode:r,isEditButtonAction:w})})]})});PT.displayName="HistoryEntry";var f1=require("obsidian");var sp=D(U(),1);var Te=D(j(),1),le=D(U(),1),Y4=D(ef(),1),zT=0,du=1,Gm=2,Q4=4;function M4(e){return()=>e}function Xle(e){e()}function cb(e,t){return n=>e(t(n))}function R4(e,t){return()=>e(t)}function Zle(e,t){return n=>e(t,n)}function Kk(e){return e!==void 0}function Jle(...e){return()=>{e.map(Xle)}}function Km(){}function HT(e,t){return t(e),e}function ece(e,t){return t(e)}function ln(...e){return e}function Ot(e,t){return e(du,t)}function Je(e,t){e(zT,t)}function Wk(e){e(Gm)}function vn(e){return e(Q4)}function Ce(e,t){return Ot(e,Zle(t,zT))}function Gs(e,t){let n=e(du,r=>{n(),t(r)});return n}function N4(e){let t,n;return r=>i=>{t=i,n&&clearTimeout(n),n=setTimeout(()=>{r(t)},e)}}function X4(e,t){return e===t}function sn(e=X4){let t;return n=>r=>{e(t,r)||(t=r,n(r))}}function Le(e){return t=>n=>{e(n)&&t(n)}}function ye(e){return t=>cb(t,e)}function ka(e){return t=>()=>{t(e)}}function X(e,...t){let n=tce(...t);return((r,i)=>{switch(r){case Gm:Wk(e);return;case du:return Ot(e,n(i))}})}function _a(e,t){return n=>r=>{n(t=e(t,r))}}function ip(e){return t=>n=>{e>0?e--:t(n)}}function Yl(e){let t=null,n;return r=>i=>{t=i,!n&&(n=setTimeout(()=>{n=void 0,r(t)},e))}}function rt(...e){let t=new Array(e.length),n=0,r=null,i=Math.pow(2,e.length)-1;return e.forEach((o,s)=>{let a=Math.pow(2,s);Ot(o,l=>{let c=n;n=n|a,t[s]=l,c!==i&&n===i&&r&&(r(),r=null)})}),o=>s=>{let a=()=>{o([s].concat(t))};n===i?a():r=a}}function tce(...e){return t=>e.reduceRight(ece,t)}function nce(e){let t,n,r=()=>t?.();return function(i,o){switch(i){case du:return o?n===o?void 0:(r(),n=o,t=Ot(e,o),t):(r(),Km);case Gm:r(),n=null;return}}}function ne(e){let t=e,n=St();return((r,i)=>{switch(r){case zT:t=i;break;case du:{i(t);break}case Q4:return t}return n(r,i)})}function ei(e,t){return HT(ne(t),n=>Ce(e,n))}function St(){let e=[];return((t,n)=>{switch(t){case zT:e.slice().forEach(r=>{r(n)});return;case Gm:e.splice(0,e.length);return;case du:return e.push(n),()=>{let r=e.indexOf(n);r>-1&&e.splice(r,1)}}})}function So(e){return HT(St(),t=>Ce(e,t))}function At(e,t=[],{singleton:n}={singleton:!0}){return{constructor:e,dependencies:t,id:rce(),singleton:n}}var rce=()=>Symbol();function ice(e){let t=new Map,n=({constructor:r,dependencies:i,id:o,singleton:s})=>{if(s&&t.has(o))return t.get(o);let a=r(i.map(l=>n(l)));return s&&t.set(o,a),a};return n(e)}function Yn(...e){let t=St(),n=new Array(e.length),r=0,i=Math.pow(2,e.length)-1;return e.forEach((o,s)=>{let a=Math.pow(2,s);Ot(o,l=>{n[s]=l,r=r|a,r===i&&Je(t,n)})}),function(o,s){switch(o){case Gm:{Wk(t);return}case du:return r===i&&s(n),Ot(t,s)}}}function Ve(e,t=X4){return X(e,sn(t))}function Hk(...e){return function(t,n){switch(t){case Gm:return;case du:return Jle(...e.map(r=>Ot(r,n)))}}}var Yi=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e))(Yi||{}),oce={0:"debug",3:"error",1:"log",2:"warn"},sce=()=>typeof globalThis>"u"?window:globalThis,mu=At(()=>{let e=ne(3);return{log:ne((t,n,r=1)=>{var i;let o=(i=sce().VIRTUOSO_LOG_LEVEL)!=null?i:vn(e);r>=o&&console[oce[r]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",t,n)}),logLevel:e}},[],{singleton:!0});function Va(e,t,n){return Yk(e,t,n).callbackRef}function Yk(e,t,n){let r=le.default.useRef(null),i=s=>{},o=le.default.useMemo(()=>typeof ResizeObserver<"u"?new ResizeObserver(s=>{let a=()=>{let l=s[0].target;l.offsetParent!==null&&e(l)};n?a():requestAnimationFrame(a)}):null,[e,n]);return i=s=>{s&&t?(o?.observe(s),r.current=s):(r.current&&o?.unobserve(r.current),r.current=null)},{callbackRef:i,ref:r}}function Z4(e,t,n,r,i,o,s,a,l){let c=le.default.useCallback(u=>{let f=ace(u.children,t,a?"offsetWidth":"offsetHeight",i),p=u.parentElement;for(;!p.dataset.virtuosoScroller;)p=p.parentElement;let d=p.lastElementChild.dataset.viewportType==="window",h;d&&(h=p.ownerDocument.defaultView);let m=s?a?s.scrollLeft:s.scrollTop:d?a?h.scrollX||h.document.documentElement.scrollLeft:h.scrollY||h.document.documentElement.scrollTop:a?p.scrollLeft:p.scrollTop,v=s?a?s.scrollWidth:s.scrollHeight:d?a?h.document.documentElement.scrollWidth:h.document.documentElement.scrollHeight:a?p.scrollWidth:p.scrollHeight,g=s?a?s.offsetWidth:s.offsetHeight:d?a?h.innerWidth:h.innerHeight:a?p.offsetWidth:p.offsetHeight;r({scrollHeight:v,scrollTop:Math.max(m,0),viewportHeight:g}),o?.(a?D4("column-gap",getComputedStyle(u).columnGap,i):D4("row-gap",getComputedStyle(u).rowGap,i)),f!==null&&e(f)},[e,t,i,o,s,r,a]);return Yk(c,n,l)}function ace(e,t,n,r){let i=e.length;if(i===0)return null;let o=[];for(let s=0;s<i;s++){let a=e.item(s);if(a.dataset.index===void 0)continue;let l=parseInt(a.dataset.index),c=parseFloat(a.dataset.knownSize),u=t(a,n);if(u===0&&r("Zero-sized element, this should not happen",{child:a},Yi.ERROR),u===c)continue;let f=o[o.length-1];o.length===0||f.size!==u||f.endIndex!==l-1?o.push({endIndex:l,size:u,startIndex:l}):o[o.length-1].endIndex++}return o}function D4(e,t,n){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&n(`${e} was not resolved to pixel value correctly`,t,Yi.WARN),t==="normal"?0:parseInt(t??"0",10)}function Qk(e,t,n){let r=le.default.useRef(null),i=le.default.useCallback(l=>{if(!(l!=null&&l.offsetParent))return;let c=l.getBoundingClientRect(),u=c.width,f,p;if(t){let d=t.getBoundingClientRect(),h=c.top-d.top;p=d.height-Math.max(0,h),f=h+t.scrollTop}else{let d=s.current.ownerDocument.defaultView;p=d.innerHeight-Math.max(0,c.top),f=c.top+d.scrollY}r.current={offsetTop:f,visibleHeight:p,visibleWidth:u},e(r.current)},[e,t]),{callbackRef:o,ref:s}=Yk(i,!0,n),a=le.default.useCallback(()=>{i(s.current)},[i,s]);return le.default.useEffect(()=>{var l;if(t){t.addEventListener("scroll",a);let c=new ResizeObserver(()=>{requestAnimationFrame(a)});return c.observe(t),()=>{t.removeEventListener("scroll",a),c.unobserve(t)}}else{let c=(l=s.current)==null?void 0:l.ownerDocument.defaultView;return c?.addEventListener("scroll",a),c?.addEventListener("resize",a),()=>{c?.removeEventListener("scroll",a),c?.removeEventListener("resize",a)}}},[a,t,s]),o}var yi=At(()=>{let e=St(),t=St(),n=ne(0),r=St(),i=ne(0),o=St(),s=St(),a=ne(0),l=ne(0),c=ne(0),u=ne(0),f=St(),p=St(),d=ne(!1),h=ne(!1),m=ne(!1);return Ce(X(e,ye(({scrollTop:v})=>v)),t),Ce(X(e,ye(({scrollHeight:v})=>v)),s),Ce(t,i),{deviation:n,fixedFooterHeight:c,fixedHeaderHeight:l,footerHeight:u,headerHeight:a,horizontalDirection:h,scrollBy:p,scrollContainerState:e,scrollHeight:s,scrollingInProgress:d,scrollTo:f,scrollTop:t,skipAnimationFrameInResizeObserver:m,smoothScrollTargetReached:r,statefulScrollTop:i,viewportHeight:o}},[],{singleton:!0}),ub={lvl:0};function J4(e,t){let n=e.length;if(n===0)return[];let{index:r,value:i}=t(e[0]),o=[];for(let s=1;s<n;s++){let{index:a,value:l}=t(e[s]);o.push({end:a-1,start:r,value:i}),r=a,i=l}return o.push({end:1/0,start:r,value:i}),o}function zt(e){return e===ub}function fb(e,t){if(!zt(e))return t===e.k?e.v:t<e.k?fb(e.l,t):fb(e.r,t)}function Ws(e,t,n="k"){if(zt(e))return[-1/0,void 0];if(Number(e[n])===t)return[e.k,e.v];if(Number(e[n])<t){let r=Ws(e.r,t,n);return r[0]===-1/0?[e.k,e.v]:r}return Ws(e.l,t,n)}function bo(e,t,n){return zt(e)?nY(t,n,1):t===e.k?ur(e,{k:t,v:n}):t<e.k?I4(ur(e,{l:bo(e.l,t,n)})):I4(ur(e,{r:bo(e.r,t,n)}))}function jm(){return ub}function qm(e,t,n){if(zt(e))return[];let r=Ws(e,t)[0];return lce($k(e,r,n))}function Uk(e,t){if(zt(e))return ub;let{k:n,l:r,r:i}=e;if(t===n){if(zt(r))return i;if(zt(i))return r;{let[o,s]=tY(r);return VT(ur(e,{k:o,l:eY(r),v:s}))}}else return t<n?VT(ur(e,{l:Uk(r,t)})):VT(ur(e,{r:Uk(i,t)}))}function rp(e){return zt(e)?[]:[...rp(e.l),{k:e.k,v:e.v},...rp(e.r)]}function $k(e,t,n){if(zt(e))return[];let{k:r,l:i,r:o,v:s}=e,a=[];return r>t&&(a=a.concat($k(i,t,n))),r>=t&&r<=n&&a.push({k:r,v:s}),r<=n&&(a=a.concat($k(o,t,n))),a}function VT(e){let{l:t,lvl:n,r}=e;if(r.lvl>=n-1&&t.lvl>=n-1)return e;if(n>r.lvl+1){if(Vk(t))return rY(ur(e,{lvl:n-1}));if(!zt(t)&&!zt(t.r))return ur(t.r,{l:ur(t,{r:t.r.l}),lvl:n,r:ur(e,{l:t.r.r,lvl:n-1})});throw new Error("Unexpected empty nodes")}else{if(Vk(e))return jk(ur(e,{lvl:n-1}));if(!zt(r)&&!zt(r.l)){let i=r.l,o=Vk(i)?r.lvl-1:r.lvl;return ur(i,{l:ur(e,{lvl:n-1,r:i.l}),lvl:i.lvl+1,r:jk(ur(r,{l:i.r,lvl:o}))})}else throw new Error("Unexpected empty nodes")}}function ur(e,t){return nY(t.k!==void 0?t.k:e.k,t.v!==void 0?t.v:e.v,t.lvl!==void 0?t.lvl:e.lvl,t.l!==void 0?t.l:e.l,t.r!==void 0?t.r:e.r)}function eY(e){return zt(e.r)?e.l:VT(ur(e,{r:eY(e.r)}))}function Vk(e){return zt(e)||e.lvl>e.r.lvl}function tY(e){return zt(e.r)?[e.k,e.v]:tY(e.r)}function nY(e,t,n,r=ub,i=ub){return{k:e,l:r,lvl:n,r:i,v:t}}function I4(e){return jk(rY(e))}function rY(e){let{l:t}=e;return!zt(t)&&t.lvl===e.lvl?ur(t,{r:ur(e,{l:t.r})}):e}function jk(e){let{lvl:t,r:n}=e;return!zt(n)&&!zt(n.r)&&n.lvl===t&&n.r.lvl===t?ur(n,{l:ur(e,{r:n.l}),lvl:t+1}):e}function lce(e){return J4(e,({k:t,v:n})=>({index:t,value:n}))}function iY(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}function pb(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}var Xk=At(()=>({recalcInProgress:ne(!1)}),[],{singleton:!0});function oY(e,t,n){return e[FT(e,t,n)]}function FT(e,t,n,r=0){let i=e.length-1;for(;r<=i;){let o=Math.floor((r+i)/2),s=e[o],a=n(s,t);if(a===0)return o;if(a===-1){if(i-r<2)return o-1;i=o-1}else{if(i===r)return o;r=o+1}}throw new Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function cce(e,t,n,r){let i=FT(e,t,r),o=FT(e,n,r,i);return e.slice(i,o+1)}function Ys(e,t){return Math.round(e.getBoundingClientRect()[t])}function UT(e){return!zt(e.groupOffsetTree)}function Zk({index:e},t){return t===e?0:t<e?-1:1}function uce(){return{groupIndices:[],groupOffsetTree:jm(),lastIndex:0,lastOffset:0,lastSize:0,offsetTree:[],sizeTree:jm()}}function fce(e,t){let n=zt(e)?0:1/0;for(let r of t){let{endIndex:i,size:o,startIndex:s}=r;if(n=Math.min(n,s),zt(e)){e=bo(e,0,o);continue}let a=qm(e,s-1,i+1);if(a.some(vce(r)))continue;let l=!1,c=!1;for(let{end:u,start:f,value:p}of a)l?(i>=f||o===p)&&(e=Uk(e,f)):(c=p!==o,l=!0),u>i&&i>=f&&p!==o&&(e=bo(e,i+1,p));c&&(e=bo(e,s,o))}return[e,n]}function pce(e){return typeof e.groupIndex<"u"}function dce({offset:e},t){return t===e?0:t<e?-1:1}function db(e,t,n){if(t.length===0)return 0;let{index:r,offset:i,size:o}=oY(t,e,Zk),s=e-r,a=o*s+(s-1)*n+i;return a>0?a+n:a}function sY(e,t){if(!UT(t))return e;let n=0;for(;t.groupIndices[n]<=e+n;)n++;return e+n}function aY(e,t,n){if(pce(e))return t.groupIndices[e.groupIndex]+1;{let r=e.index==="LAST"?n:e.index,i=sY(r,t);return i=Math.max(0,i,Math.min(n,i)),i}}function mce(e,t,n,r=0){return r>0&&(t=Math.max(t,oY(e,r,Zk).offset)),J4(cce(e,t,n,dce),yce)}function hce(e,[t,n,r,i]){t.length>0&&r("received item sizes",t,Yi.DEBUG);let o=e.sizeTree,s=o,a=0;if(n.length>0&&zt(o)&&t.length===2){let p=t[0].size,d=t[1].size;s=n.reduce((h,m)=>bo(bo(h,m,p),m+1,d),s)}else[s,a]=fce(s,t);if(s===o)return e;let{lastIndex:l,lastOffset:c,lastSize:u,offsetTree:f}=qk(e.offsetTree,a,s,i);return{groupIndices:n,groupOffsetTree:n.reduce((p,d)=>bo(p,d,db(d,f,i)),jm()),lastIndex:l,lastOffset:c,lastSize:u,offsetTree:f,sizeTree:s}}function gce(e){return rp(e).map(({k:t,v:n},r,i)=>{let o=i[r+1];return{endIndex:o?o.k-1:1/0,size:n,startIndex:t}})}function O4(e,t){let n=0,r=0;for(;n<e;)n+=t[r+1]-t[r]-1,r++;return r-(n===e?0:1)}function qk(e,t,n,r){let i=e,o=0,s=0,a=0,l=0;if(t!==0){l=FT(i,t-1,Zk),a=i[l].offset;let c=Ws(n,t-1);o=c[0],s=c[1],i.length&&i[l].size===Ws(n,t)[1]&&(l-=1),i=i.slice(0,l+1)}else i=[];for(let{start:c,value:u}of qm(n,t,1/0)){let f=c-o,p=f*s+a+f*r;i.push({index:c,offset:p,size:u}),o=c,a=p,s=u}return{lastIndex:o,lastOffset:a,lastSize:s,offsetTree:i}}function yce(e){return{index:e.index,value:e}}function vce(e){let{endIndex:t,size:n,startIndex:r}=e;return i=>i.start===r&&(i.end===t||i.end===1/0)&&i.value===n}var bce={offsetHeight:"height",offsetWidth:"width"},La=At(([{log:e},{recalcInProgress:t}])=>{let n=St(),r=St(),i=ei(r,0),o=St(),s=St(),a=ne(0),l=ne([]),c=ne(void 0),u=ne(void 0),f=ne(void 0),p=ne(void 0),d=ne((x,E)=>Ys(x,bce[E])),h=ne(void 0),m=ne(0),v=uce(),g=ei(X(n,rt(l,e,m),_a(hce,v),sn()),v),y=ei(X(l,sn(),_a((x,E)=>({current:E,prev:x.current}),{current:[],prev:[]}),ye(({prev:x})=>x)),[]);Ce(X(l,Le(x=>x.length>0),rt(g,m),ye(([x,E,T])=>{let A=x.reduce((M,R,N)=>bo(M,R,db(R,E.offsetTree,T)||N),jm());return{...E,groupIndices:x,groupOffsetTree:A}})),g),Ce(X(r,rt(g),Le(([x,{lastIndex:E}])=>x<E),ye(([x,{lastIndex:E,lastSize:T}])=>[{endIndex:E,size:T,startIndex:x}])),n),Ce(c,u);let b=ei(X(c,ye(x=>x===void 0)),!0);Ce(X(u,Le(x=>x!==void 0&&zt(vn(g).sizeTree)),ye(x=>{let E=vn(f),T=vn(l).length>0;return E?T?[{endIndex:0,size:E,startIndex:0},{endIndex:1,size:x,startIndex:1}]:[]:[{endIndex:0,size:x,startIndex:0}]})),n),Ce(X(p,Le(x=>x!==void 0&&x.length>0&&zt(vn(g).sizeTree)),ye(x=>{let E=[],T=x[0],A=0;for(let M=1;M<x.length;M++){let R=x[M];R!==T&&(E.push({endIndex:M-1,size:T,startIndex:A}),T=R,A=M)}return E.push({endIndex:x.length-1,size:T,startIndex:A}),E})),n),Ce(X(l,rt(f,u),Le(([,x,E])=>x!==void 0&&E!==void 0),ye(([x,E,T])=>{let A=[];for(let M=0;M<x.length;M++){let R=x[M],N=x[M+1];A.push({startIndex:R,endIndex:R,size:E}),N!==void 0&&A.push({startIndex:R+1,endIndex:N-1,size:T})}return A})),n);let w=So(X(n,rt(g),_a(({sizes:x},[E,T])=>({changed:T!==x,sizes:T}),{changed:!1,sizes:v}),ye(x=>x.changed)));Ot(X(a,_a((x,E)=>({diff:x.prev-E,prev:E}),{diff:0,prev:0}),ye(x=>x.diff)),x=>{let{groupIndices:E}=vn(g);if(x>0)Je(t,!0),Je(o,x+O4(x,E));else if(x<0){let T=vn(y);T.length>0&&(x-=O4(-x,T)),Je(s,x)}}),Ot(X(a,rt(e)),([x,E])=>{x<0&&E("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:a},Yi.ERROR)});let S=So(o);Ce(X(o,rt(g),ye(([x,E])=>{let T=E.groupIndices.length>0,A=[],M=E.lastSize;if(T){let R=fb(E.sizeTree,0),N=0,I=0;for(;N<x;){let z=E.groupIndices[I],F=E.groupIndices.length===I+1?1/0:E.groupIndices[I+1]-z-1;A.push({endIndex:z,size:R,startIndex:z}),A.push({endIndex:z+1+F-1,size:M,startIndex:z+1}),I++,N+=F+1}let _=rp(E.sizeTree);return N!==x&&_.shift(),_.reduce((z,{k:F,v:L})=>{let k=z.ranges;return z.prevSize!==0&&(k=[...z.ranges,{endIndex:F+x-1,size:z.prevSize,startIndex:z.prevIndex}]),{prevIndex:F+x,prevSize:L,ranges:k}},{prevIndex:x,prevSize:0,ranges:A}).ranges}return rp(E.sizeTree).reduce((R,{k:N,v:I})=>({prevIndex:N+x,prevSize:I,ranges:[...R.ranges,{endIndex:N+x-1,size:R.prevSize,startIndex:R.prevIndex}]}),{prevIndex:0,prevSize:M,ranges:[]}).ranges})),n);let C=So(X(s,rt(g,m),ye(([x,{offsetTree:E},T])=>{let A=-x;return db(A,E,T)})));return Ce(X(s,rt(g,m),ye(([x,E,T])=>{if(E.groupIndices.length>0){if(zt(E.sizeTree))return E;let A=jm(),M=vn(y),R=0,N=0,I=0;for(;R<-x;){I=M[N];let _=M[N+1]-I-1;N++,R+=_+1}if(A=rp(E.sizeTree).reduce((_,{k:z,v:F})=>bo(_,Math.max(0,z+x),F),A),R!==-x){let _=fb(E.sizeTree,I);A=bo(A,0,_);let z=Ws(E.sizeTree,-x+1)[1];A=bo(A,1,z)}return{...E,sizeTree:A,...qk(E.offsetTree,0,A,T)}}else{let A=rp(E.sizeTree).reduce((M,{k:R,v:N})=>bo(M,Math.max(0,R+x),N),jm());return{...E,sizeTree:A,...qk(E.offsetTree,0,A,T)}}})),g),{beforeUnshiftWith:S,data:h,defaultItemSize:u,firstItemIndex:a,fixedItemSize:c,fixedGroupSize:f,gap:m,groupIndices:l,heightEstimates:p,itemSize:d,listRefresh:w,shiftWith:s,shiftWithOffset:C,sizeRanges:n,sizes:g,statefulTotalCount:i,totalCount:r,trackItemSizes:b,unshiftWith:o}},ln(mu,Xk),{singleton:!0});function Sce(e){return e.reduce((t,n)=>(t.groupIndices.push(t.totalCount),t.totalCount+=n+1,t),{groupIndices:[],totalCount:0})}var lY=At(([{groupIndices:e,sizes:t,totalCount:n},{headerHeight:r,scrollTop:i}])=>{let o=St(),s=St(),a=So(X(o,ye(Sce)));return Ce(X(a,ye(l=>l.totalCount)),n),Ce(X(a,ye(l=>l.groupIndices)),e),Ce(X(Yn(i,t,r),Le(([l,c])=>UT(c)),ye(([l,c,u])=>Ws(c.groupOffsetTree,Math.max(l-u,0),"v")[0]),sn(),ye(l=>[l])),s),{groupCounts:o,topItemsIndexes:s}},ln(La,yi)),hu=At(([{log:e}])=>{let t=ne(!1),n=So(X(t,Le(r=>r),sn()));return Ot(t,r=>{r&&vn(e)("props updated",{},Yi.DEBUG)}),{didMount:n,propsReady:t}},ln(mu),{singleton:!0}),wce=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function cY(e){let t=typeof e=="number"?{index:e}:e;return t.align||(t.align="start"),(!t.behavior||!wce)&&(t.behavior="auto"),t.offset||(t.offset=0),t}var yb=At(([{gap:e,listRefresh:t,sizes:n,totalCount:r},{fixedFooterHeight:i,fixedHeaderHeight:o,footerHeight:s,headerHeight:a,scrollingInProgress:l,scrollTo:c,smoothScrollTargetReached:u,viewportHeight:f},{log:p}])=>{let d=St(),h=St(),m=ne(0),v=null,g=null,y=null;function b(){v&&(v(),v=null),y&&(y(),y=null),g&&(clearTimeout(g),g=null),Je(l,!1)}return Ce(X(d,rt(n,f,r,m,a,s,p),rt(e,o,i),ye(([[w,S,C,x,E,T,A,M],R,N,I])=>{let _=cY(w),{align:z,behavior:F,offset:L}=_,k=x-1,K=aY(_,S,k),ee=db(K,S.offsetTree,R)+T;z==="end"?(ee+=N+Ws(S.sizeTree,K)[1]-C+I,K===k&&(ee+=A)):z==="center"?ee+=(N+Ws(S.sizeTree,K)[1]-C+I)/2:ee-=E,L&&(ee+=L);let Se=De=>{b(),De?(M("retrying to scroll to",{location:w},Yi.DEBUG),Je(d,w)):(Je(h,!0),M("list did not change, scroll successful",{},Yi.DEBUG))};if(b(),F==="smooth"){let De=!1;y=Ot(t,we=>{De=De||we}),v=Gs(u,()=>{Se(De)})}else v=Gs(X(t,xce(150)),Se);return g=setTimeout(()=>{b()},1200),Je(l,!0),M("scrolling from index to",{behavior:F,index:K,top:ee},Yi.DEBUG),{behavior:F,top:ee}})),c),{scrollTargetReached:h,scrollToIndex:d,topListHeight:m}},ln(La,yi,mu),{singleton:!0});function xce(e){return t=>{let n=setTimeout(()=>{t(!1)},e);return r=>{r&&(t(!0),clearTimeout(n))}}}function Jk(e,t){e==0?t():requestAnimationFrame(()=>{Jk(e-1,t)})}function e1(e,t){let n=t-1;return typeof e=="number"?e:e.index==="LAST"?n:e.index}var vb=At(([{defaultItemSize:e,listRefresh:t,sizes:n},{scrollTop:r},{scrollTargetReached:i,scrollToIndex:o},{didMount:s}])=>{let a=ne(!0),l=ne(0),c=ne(!0);return Ce(X(s,rt(l),Le(([u,f])=>!!f),ka(!1)),a),Ce(X(s,rt(l),Le(([u,f])=>!!f),ka(!1)),c),Ot(X(Yn(t,s),rt(a,n,e,c),Le(([[,u],f,{sizeTree:p},d,h])=>u&&(!zt(p)||Kk(d))&&!f&&!h),rt(l)),([,u])=>{Gs(i,()=>{Je(c,!0)}),Jk(4,()=>{Gs(r,()=>{Je(a,!0)}),Je(o,u)})}),{initialItemFinalLocationReached:c,initialTopMostItemIndex:l,scrolledToInitialItem:a}},ln(La,yi,yb,hu),{singleton:!0});function uY(e,t){return Math.abs(e-t)<1.01}var mb="up",ab="down",Ece="none",Cce={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollHeight:0,scrollTop:0,viewportHeight:0}},Tce=0,bb=At(([{footerHeight:e,headerHeight:t,scrollBy:n,scrollContainerState:r,scrollTop:i,viewportHeight:o}])=>{let s=ne(!1),a=ne(!0),l=St(),c=St(),u=ne(4),f=ne(Tce),p=ei(X(Hk(X(Ve(i),ip(1),ka(!0)),X(Ve(i),ip(1),ka(!1),N4(100))),sn()),!1),d=ei(X(Hk(X(n,ka(!0)),X(n,ka(!1),N4(200))),sn()),!1);Ce(X(Yn(Ve(i),Ve(f)),ye(([y,b])=>y<=b),sn()),a),Ce(X(a,Yl(50)),c);let h=So(X(Yn(r,Ve(o),Ve(t),Ve(e),Ve(u)),_a((y,[{scrollHeight:b,scrollTop:w},S,C,x,E])=>{let T=w+S-b>-E,A={scrollHeight:b,scrollTop:w,viewportHeight:S};if(T){let R,N;return w>y.state.scrollTop?(R="SCROLLED_DOWN",N=y.state.scrollTop-w):(R="SIZE_DECREASED",N=y.state.scrollTop-w||y.scrollTopDelta),{atBottom:!0,atBottomBecause:R,scrollTopDelta:N,state:A}}let M;return A.scrollHeight>y.state.scrollHeight?M="SIZE_INCREASED":S<y.state.viewportHeight?M="VIEWPORT_HEIGHT_DECREASING":w<y.state.scrollTop?M="SCROLLING_UPWARDS":M="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:M,state:A}},Cce),sn((y,b)=>y&&y.atBottom===b.atBottom))),m=ei(X(r,_a((y,{scrollHeight:b,scrollTop:w,viewportHeight:S})=>{if(uY(y.scrollHeight,b))return{changed:!1,jump:0,scrollHeight:b,scrollTop:w};{let C=b-(w+S)<1;return y.scrollTop!==w&&C?{changed:!0,jump:y.scrollTop-w,scrollHeight:b,scrollTop:w}:{changed:!0,jump:0,scrollHeight:b,scrollTop:w}}},{changed:!1,jump:0,scrollHeight:0,scrollTop:0}),Le(y=>y.changed),ye(y=>y.jump)),0);Ce(X(h,ye(y=>y.atBottom)),s),Ce(X(s,Yl(50)),l);let v=ne(ab);Ce(X(r,ye(({scrollTop:y})=>y),sn(),_a((y,b)=>vn(d)?{direction:y.direction,prevScrollTop:b}:{direction:b<y.prevScrollTop?mb:ab,prevScrollTop:b},{direction:ab,prevScrollTop:0}),ye(y=>y.direction)),v),Ce(X(r,Yl(50),ka(Ece)),v);let g=ne(0);return Ce(X(p,Le(y=>!y),ka(0)),g),Ce(X(i,Yl(100),rt(p),Le(([y,b])=>b),_a(([y,b],[w])=>[b,w],[0,0]),ye(([y,b])=>b-y)),g),{atBottomState:h,atBottomStateChange:l,atBottomThreshold:u,atTopStateChange:c,atTopThreshold:f,isAtBottom:s,isAtTop:a,isScrolling:p,lastJumpDueToItemResize:m,scrollDirection:v,scrollVelocity:g}},ln(yi)),hb="top",gb="bottom",P4="none";function k4(e,t,n){return typeof e=="number"?n===mb&&t===hb||n===ab&&t===gb?e:0:n===mb?t===hb?e.main:e.reverse:t===gb?e.main:e.reverse}function _4(e,t){var n;return typeof e=="number"?e:(n=e[t])!=null?n:0}var t1=At(([{deviation:e,fixedHeaderHeight:t,headerHeight:n,scrollTop:r,viewportHeight:i}])=>{let o=St(),s=ne(0),a=ne(0),l=ne(0),c=ei(X(Yn(Ve(r),Ve(i),Ve(n),Ve(o,pb),Ve(l),Ve(s),Ve(t),Ve(e),Ve(a)),ye(([u,f,p,[d,h],m,v,g,y,b])=>{let w=u-y,S=v+g,C=Math.max(p-w,0),x=P4,E=_4(b,hb),T=_4(b,gb);return d-=y,d+=p+g,h+=p+g,h-=y,d>u+S-E&&(x=mb),h<u-C+f+T&&(x=ab),x!==P4?[Math.max(w-p-k4(m,hb,x)-E,0),w-C-g+f+k4(m,gb,x)+T]:null}),Le(u=>u!=null),sn(pb)),[0,0]);return{increaseViewportBy:a,listBoundary:o,overscan:l,topListHeight:s,visibleRange:c}},ln(yi),{singleton:!0});function Ace(e,t,n){if(UT(t)){let r=sY(e,t);return[{index:Ws(t.groupOffsetTree,r)[0],offset:0,size:0},{data:n?.[0],index:r,offset:0,size:0}]}return[{data:n?.[0],index:e,offset:0,size:0}]}var Lk={bottom:0,firstItemIndex:0,items:[],offsetBottom:0,offsetTop:0,top:0,topItems:[],topListHeight:0,totalCount:0};function LT(e,t,n,r,i,o){let{lastIndex:s,lastOffset:a,lastSize:l}=i,c=0,u=0;if(e.length>0){c=e[0].offset;let m=e[e.length-1];u=m.offset+m.size}let f=n-s,p=a+f*l+(f-1)*r,d=c,h=p-u;return{bottom:u,firstItemIndex:o,items:V4(e,i,o),offsetBottom:h,offsetTop:c,top:d,topItems:V4(t,i,o),topListHeight:t.reduce((m,v)=>v.size+m,0),totalCount:n}}function fY(e,t,n,r,i,o){let s=0;if(n.groupIndices.length>0)for(let u of n.groupIndices){if(u-s>=e)break;s++}let a=e+s,l=e1(t,a),c=Array.from({length:a}).map((u,f)=>({data:o[f+l],index:f+l,offset:0,size:0}));return LT(c,[],a,i,n,r)}function V4(e,t,n){if(e.length===0)return[];if(!UT(t))return e.map(c=>({...c,index:c.index+n,originalIndex:c.index}));let r=e[0].index,i=e[e.length-1].index,o=[],s=qm(t.groupOffsetTree,r,i),a,l=0;for(let c of e){(!a||a.end<c.index)&&(a=s.shift(),l=t.groupIndices.indexOf(a.start));let u;c.index===a.start?u={index:l,type:"group"}:u={groupIndex:l,index:c.index-(l+1)+n},o.push({...u,data:c.data,offset:c.offset,originalIndex:c.index,size:c.size})}return o}function L4(e,t){var n;return e===void 0?0:typeof e=="number"?e:(n=e[t])!=null?n:0}var op=At(([{data:e,firstItemIndex:t,gap:n,sizes:r,totalCount:i},o,{listBoundary:s,topListHeight:a,visibleRange:l},{initialTopMostItemIndex:c,scrolledToInitialItem:u},{topListHeight:f},p,{didMount:d},{recalcInProgress:h}])=>{let m=ne([]),v=ne(0),g=St(),y=ne(0);Ce(o.topItemsIndexes,m);let b=ei(X(Yn(d,h,Ve(l,pb),Ve(i),Ve(r),Ve(c),u,Ve(m),Ve(t),Ve(n),Ve(y),e),Le(([x,E,,T,,,,,,,,A])=>{let M=A&&A.length!==T;return x&&!E&&!M}),ye(([,,[x,E],T,A,M,R,N,I,_,z,F])=>{var L,k,K,ee;let Se=A,{offsetTree:De,sizeTree:we}=Se,qe=vn(v);if(T===0)return{...Lk,totalCount:T};if(x===0&&E===0)return qe===0?{...Lk,totalCount:T}:fY(qe,M,A,I,_,F||[]);if(zt(we))return qe>0?null:LT(Ace(e1(M,T),Se,F),[],T,_,Se,I);let Fe=[];if(N.length>0){let mt=N[0],st=N[N.length-1],xt=0;for(let Et of qm(we,mt,st)){let at=Et.value,Dt=Math.max(Et.start,mt),oi=Math.min(Et.end,st);for(let wn=Dt;wn<=oi;wn++)Fe.push({data:F?.[wn],index:wn,offset:xt,size:at}),xt+=at}}if(!R)return LT([],Fe,T,_,Se,I);let pe=N.length>0?N[N.length-1]+1:0,V=mce(De,x,E,pe);if(V.length===0)return null;let Q=T-1,Y=HT([],mt=>{for(let st of V){let xt=st.value,Et=xt.offset,at=st.start,Dt=xt.size;if(xt.offset<x){at+=Math.floor((x-xt.offset+_)/(Dt+_));let wn=at-st.start;Et+=wn*Dt+wn*_}at<pe&&(Et+=(pe-at)*Dt,at=pe);let oi=Math.min(st.end,Q);for(let wn=at;wn<=oi&&!(Et>=E);wn++)mt.push({data:F?.[wn],index:wn,offset:Et,size:Dt}),Et+=Dt+_}}),Ie=L4(z,hb),yt=L4(z,gb);if(Y.length>0&&(Ie>0||yt>0)){let mt=Y[0],st=Y[Y.length-1];if(Ie>0&&mt.index>pe){let xt=Math.min(Ie,mt.index-pe),Et=[],at=mt.offset;for(let Dt=mt.index-1;Dt>=mt.index-xt;Dt--){let oi=(k=(L=qm(we,Dt,Dt)[0])==null?void 0:L.value)!=null?k:mt.size;at-=oi+_,Et.unshift({data:F?.[Dt],index:Dt,offset:at,size:oi})}Y.unshift(...Et)}if(yt>0&&st.index<Q){let xt=Math.min(yt,Q-st.index),Et=st.offset+st.size+_;for(let at=st.index+1;at<=st.index+xt;at++){let Dt=(ee=(K=qm(we,at,at)[0])==null?void 0:K.value)!=null?ee:st.size;Y.push({data:F?.[at],index:at,offset:Et,size:Dt}),Et+=Dt+_}}}return LT(Y,Fe,T,_,Se,I)}),Le(x=>x!==null),sn()),Lk);Ce(X(e,Le(Kk),ye(x=>x?.length)),i),Ce(X(b,ye(x=>x.topListHeight)),f),Ce(f,a),Ce(X(b,ye(x=>[x.top,x.bottom])),s),Ce(X(b,ye(x=>x.items)),g);let w=So(X(b,Le(({items:x})=>x.length>0),rt(i,e),Le(([{items:x},E])=>x[x.length-1].originalIndex===E-1),ye(([,x,E])=>[x-1,E]),sn(pb),ye(([x])=>x))),S=So(X(b,Yl(200),Le(({items:x,topItems:E})=>x.length>0&&x[0].originalIndex===E.length),ye(({items:x})=>x[0].index),sn())),C=So(X(b,Le(({items:x})=>x.length>0),ye(({items:x})=>{let E=0,T=x.length-1;for(;x[E].type==="group"&&E<T;)E++;for(;x[T].type==="group"&&T>E;)T--;return{endIndex:x[T].index,startIndex:x[E].index}}),sn(iY)));return{endReached:w,initialItemCount:v,itemsRendered:g,listState:b,minOverscanItemCount:y,rangeChanged:C,startReached:S,topItemsIndexes:m,...p}},ln(La,lY,t1,vb,yb,bb,hu,Xk),{singleton:!0}),pY=At(([{fixedFooterHeight:e,fixedHeaderHeight:t,footerHeight:n,headerHeight:r},{listState:i}])=>{let o=St(),s=ei(X(Yn(n,e,r,t,i),ye(([a,l,c,u,f])=>a+l+c+u+f.offsetBottom+f.bottom)),0);return Ce(Ve(s),o),{totalListHeight:s,totalListHeightChanged:o}},ln(yi,op),{singleton:!0}),Mce=At(([{viewportHeight:e},{totalListHeight:t}])=>{let n=ne(!1),r=ei(X(Yn(n,e,t),Le(([i])=>i),ye(([,i,o])=>Math.max(0,i-o)),Yl(0),sn()),0);return{alignToBottom:n,paddingTopAddition:r}},ln(yi,pY),{singleton:!0}),dY=At(()=>({context:ne(null)})),Rce=({itemBottom:e,itemTop:t,locationParams:{align:n,behavior:r,...i},viewportBottom:o,viewportTop:s})=>t<s?{...i,align:n??"start",behavior:r}:e>o?{...i,align:n??"end",behavior:r}:null,mY=At(([{gap:e,sizes:t,totalCount:n},{fixedFooterHeight:r,fixedHeaderHeight:i,headerHeight:o,scrollingInProgress:s,scrollTop:a,viewportHeight:l},{scrollToIndex:c}])=>{let u=St();return Ce(X(u,rt(t,l,n,o,i,r,a),rt(e),ye(([[f,p,d,h,m,v,g,y],b])=>{let{align:w,behavior:S,calculateViewLocation:C=Rce,done:x,...E}=f,T=aY(f,p,h-1),A=db(T,p.offsetTree,b)+m+v,M=A+Ws(p.sizeTree,T)[1],R=y+v,N=y+d-g,I=C({itemBottom:M,itemTop:A,locationParams:{align:w,behavior:S,...E},viewportBottom:N,viewportTop:R});return I?x&&Gs(X(s,Le(_=>!_),ip(vn(s)?1:2)),x):x?.(),I}),Le(f=>f!==null)),c),{scrollIntoView:u}},ln(La,yi,yb,op,mu),{singleton:!0});function F4(e){return e?e==="smooth"?"smooth":"auto":!1}var Nce=(e,t)=>typeof e=="function"?F4(e(t)):t&&F4(e),Dce=At(([{listRefresh:e,totalCount:t,fixedItemSize:n,data:r},{atBottomState:i,isAtBottom:o},{scrollToIndex:s},{scrolledToInitialItem:a},{didMount:l,propsReady:c},{log:u},{scrollingInProgress:f},{context:p},{scrollIntoView:d}])=>{let h=ne(!1),m=St(),v=null;function g(S){Je(s,{align:"end",behavior:S,index:"LAST"})}Ot(X(Yn(X(Ve(t),ip(1)),l),rt(Ve(h),o,a,f),ye(([[S,C],x,E,T,A])=>{let M=C&&T,R="auto";return M&&(R=Nce(x,E||A),M=M&&!!R),{followOutputBehavior:R,shouldFollow:M,totalCount:S}}),Le(({shouldFollow:S})=>S)),({followOutputBehavior:S,totalCount:C})=>{v&&(v(),v=null),vn(n)?requestAnimationFrame(()=>{vn(u)("following output to ",{totalCount:C},Yi.DEBUG),g(S)}):v=Gs(e,()=>{vn(u)("following output to ",{totalCount:C},Yi.DEBUG),g(S),v=null})});function y(S){let C=Gs(i,x=>{S&&!x.atBottom&&x.notAtBottomBecause==="SIZE_INCREASED"&&!v&&(vn(u)("scrolling to bottom due to increased size",{},Yi.DEBUG),g("auto"))});setTimeout(C,100)}Ot(X(Yn(Ve(h),t,c),Le(([S,,C])=>S&&C),_a(({value:S},[,C])=>({refreshed:S===C,value:C}),{refreshed:!1,value:0}),Le(({refreshed:S})=>S),rt(h,t)),([,S])=>{vn(a)&&y(S!==!1)}),Ot(m,()=>{y(vn(h)!==!1)}),Ot(Yn(Ve(h),i),([S,C])=>{S&&!C.atBottom&&C.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&g("auto")});let b=ne(null),w=St();return Ce(Hk(X(Ve(r),ye(S=>{var C;return(C=S?.length)!=null?C:0})),X(Ve(t))),w),Ot(X(Yn(X(w,ip(1)),l),rt(Ve(b),a,f,p),ye(([[S,C],x,E,T,A])=>C&&E&&x?.({context:A,totalCount:S,scrollingInProgress:T})),Le(S=>!!S),Yl(0)),S=>{v&&(v(),v=null),vn(n)?requestAnimationFrame(()=>{vn(u)("scrolling into view",{}),Je(d,S)}):v=Gs(e,()=>{vn(u)("scrolling into view",{}),Je(d,S),v=null})}),{autoscrollToBottom:m,followOutput:h,scrollIntoViewOnChange:b}},ln(La,bb,yb,vb,hu,mu,yi,dY,mY)),Ice=At(([{data:e,firstItemIndex:t,gap:n,sizes:r},{initialTopMostItemIndex:i},{initialItemCount:o,listState:s},{didMount:a}])=>(Ce(X(a,rt(o),Le(([,l])=>l!==0),rt(i,r,t,n,e),ye(([[,l],c,u,f,p,d=[]])=>fY(l,c,u,f,p,d))),s),{}),ln(La,vb,op,hu),{singleton:!0}),Oce=At(([{didMount:e},{scrollTo:t},{listState:n}])=>{let r=ne(0);return Ot(X(e,rt(r),Le(([,i])=>i!==0),ye(([,i])=>({top:i}))),i=>{Gs(X(n,ip(1),Le(o=>o.items.length>1)),()=>{requestAnimationFrame(()=>{Je(t,i)})})}),{initialScrollTop:r}},ln(hu,yi,op),{singleton:!0}),hY=At(([{scrollVelocity:e}])=>{let t=ne(!1),n=St(),r=ne(!1);return Ce(X(e,rt(r,t,n),Le(([i,o])=>!!o),ye(([i,o,s,a])=>{let{enter:l,exit:c}=o;if(s){if(c(i,a))return!1}else if(l(i,a))return!0;return s}),sn()),t),Ot(X(Yn(t,e,n),rt(r)),([[i,o,s],a])=>{i&&a&&a.change&&a.change(o,s)}),{isSeeking:t,scrollSeekConfiguration:r,scrollSeekRangeChanged:n,scrollVelocity:e}},ln(bb),{singleton:!0}),n1=At(([{scrollContainerState:e,scrollTo:t}])=>{let n=St(),r=St(),i=St(),o=ne(!1),s=ne(void 0);return Ce(X(Yn(n,r),ye(([{scrollHeight:a,scrollTop:l,viewportHeight:c},{offsetTop:u}])=>({scrollHeight:a,scrollTop:Math.max(0,l-u),viewportHeight:c}))),e),Ce(X(t,rt(r),ye(([a,{offsetTop:l}])=>({...a,top:a.top+l}))),i),{customScrollParent:s,useWindowScroll:o,windowScrollContainerState:n,windowScrollTo:i,windowViewportRect:r}},ln(yi)),Pce=At(([{sizeRanges:e,sizes:t},{headerHeight:n,scrollTop:r},{initialTopMostItemIndex:i},{didMount:o},{useWindowScroll:s,windowScrollContainerState:a,windowViewportRect:l}])=>{let c=St(),u=ne(void 0),f=ne(null),p=ne(null);return Ce(a,f),Ce(l,p),Ot(X(c,rt(t,r,s,f,p,n)),([d,h,m,v,g,y,b])=>{let w=gce(h.sizeTree);v&&g!==null&&y!==null&&(m=g.scrollTop-y.offsetTop),m-=b,d({ranges:w,scrollTop:m})}),Ce(X(u,Le(Kk),ye(kce)),i),Ce(X(o,rt(u),Le(([,d])=>d!==void 0),sn(),ye(([,d])=>d.ranges)),e),{getState:c,restoreStateFrom:u}},ln(La,yi,vb,hu,n1));function kce(e){return{align:"start",index:0,offset:e.scrollTop}}var _ce=At(([{topItemsIndexes:e}])=>{let t=ne(0);return Ce(X(t,Le(n=>n>=0),ye(n=>Array.from({length:n}).map((r,i)=>i))),e),{topItemCount:t}},ln(op));function gY(e){let t=!1,n;return(()=>(t||(t=!0,n=e()),n))}var Vce=gY(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),Lce=At(([{deviation:e,scrollBy:t,scrollingInProgress:n,scrollTop:r},{isAtBottom:i,isScrolling:o,lastJumpDueToItemResize:s,scrollDirection:a},{listState:l},{beforeUnshiftWith:c,gap:u,shiftWithOffset:f,sizes:p},{log:d},{recalcInProgress:h}])=>{let m=So(X(l,rt(s),_a(([,g,y,b],[{bottom:w,items:S,offsetBottom:C,totalCount:x},E])=>{let T=w+C,A=0;return y===x&&g.length>0&&S.length>0&&(S[0].originalIndex===0&&g[0].originalIndex===0||(A=T-b,A!==0&&(A+=E))),[A,S,x,T]},[0,[],0,0]),Le(([g])=>g!==0),rt(r,a,n,i,d,h),Le(([,g,y,b,,,w])=>!w&&!b&&g!==0&&y===mb),ye(([[g],,,,,y])=>(y("Upward scrolling compensation",{amount:g},Yi.DEBUG),g))));function v(g){g>0?(Je(t,{behavior:"auto",top:-g}),Je(e,0)):(Je(e,0),Je(t,{behavior:"auto",top:-g}))}return Ot(X(m,rt(e,o)),([g,y,b])=>{b&&Vce()?Je(e,y-g):v(-g)}),Ot(X(Yn(ei(o,!1),e,h),Le(([g,y,b])=>!g&&!b&&y!==0),ye(([g,y])=>y),Yl(1)),v),Ce(X(f,ye(g=>({top:-g}))),t),Ot(X(c,rt(p,u),ye(([g,{groupIndices:y,lastSize:b,sizeTree:w},S])=>{function C(x){return x*(b+S)}if(y.length===0)return C(g);{let x=0,E=fb(w,0),T=0,A=0;for(;T<g;){T++,x+=E;let M=y.length===A+1?1/0:y[A+1]-y[A]-1;T+M>g&&(x-=E,M=g-T+1),T+=M,x+=C(M),A++}return x}})),g=>{Je(e,g),requestAnimationFrame(()=>{Je(t,{top:g}),requestAnimationFrame(()=>{Je(e,0),Je(h,!1)})})}),{deviation:e}},ln(yi,bb,op,La,mu,Xk)),Fce=At(([e,t,n,r,i,o,s,a,l,c,u])=>({...e,...t,...n,...r,...i,...o,...s,...a,...l,...c,...u}),ln(t1,Ice,hu,hY,pY,Oce,Mce,n1,mY,mu,dY)),yY=At(([{data:e,defaultItemSize:t,firstItemIndex:n,fixedItemSize:r,fixedGroupSize:i,gap:o,groupIndices:s,heightEstimates:a,itemSize:l,sizeRanges:c,sizes:u,statefulTotalCount:f,totalCount:p,trackItemSizes:d},{initialItemFinalLocationReached:h,initialTopMostItemIndex:m,scrolledToInitialItem:v},g,y,b,w,{scrollToIndex:S},C,{topItemCount:x},{groupCounts:E},T])=>{let{listState:A,minOverscanItemCount:M,topItemsIndexes:R,rangeChanged:N,...I}=w;return Ce(N,T.scrollSeekRangeChanged),Ce(X(T.windowViewportRect,ye(_=>_.visibleHeight)),g.viewportHeight),{data:e,defaultItemHeight:t,firstItemIndex:n,fixedItemHeight:r,fixedGroupHeight:i,gap:o,groupCounts:E,heightEstimates:a,initialItemFinalLocationReached:h,initialTopMostItemIndex:m,scrolledToInitialItem:v,sizeRanges:c,topItemCount:x,topItemsIndexes:R,totalCount:p,...b,groupIndices:s,itemSize:l,listState:A,minOverscanItemCount:M,scrollToIndex:S,statefulTotalCount:f,trackItemSizes:d,rangeChanged:N,...I,...T,...g,sizes:u,...y}},ln(La,vb,yi,Pce,Dce,op,yb,Lce,_ce,lY,Fce));function Bce(e,t){let n={},r={},i=0,o=e.length;for(;i<o;)r[e[i]]=1,i+=1;for(let s in t)Object.hasOwn(r,s)||(n[s]=t[s]);return n}var kT=typeof document<"u"?le.default.useLayoutEffect:le.default.useEffect;function r1(e,t,n){let r=Object.keys(t.required||{}),i=Object.keys(t.optional||{}),o=Object.keys(t.methods||{}),s=Object.keys(t.events||{}),a=le.default.createContext({});function l(v,g){v.propsReady&&Je(v.propsReady,!1);for(let y of r){let b=v[t.required[y]];Je(b,g[y])}for(let y of i)if(y in g){let b=v[t.optional[y]];Je(b,g[y])}v.propsReady&&Je(v.propsReady,!0)}function c(v){return o.reduce((g,y)=>(g[y]=b=>{let w=v[t.methods[y]];Je(w,b)},g),{})}function u(v){return s.reduce((g,y)=>(g[y]=nce(v[t.events[y]]),g),{})}let f=le.default.forwardRef((v,g)=>{let{children:y,...b}=v,[w]=le.default.useState(()=>HT(ice(e),x=>{l(x,b)})),[S]=le.default.useState(R4(u,w));kT(()=>{for(let x of s)x in b&&Ot(S[x],b[x]);return()=>{Object.values(S).map(Wk)}},[b,S,w]),kT(()=>{l(w,b)}),le.default.useImperativeHandle(g,M4(c(w)));let C=n;return(0,Te.jsx)(a.Provider,{value:w,children:n?(0,Te.jsx)(C,{...Bce([...r,...i,...s],b),children:y}):y})}),p=v=>{let g=le.default.useContext(a);return le.default.useCallback(y=>{Je(g[v],y)},[g,v])},d=v=>{let g=le.default.useContext(a)[v],y=le.default.useCallback(b=>Ot(g,b),[g]);return le.default.useSyncExternalStore(y,()=>vn(g),()=>vn(g))},h=v=>{let g=le.default.useContext(a)[v],[y,b]=le.default.useState(R4(vn,g));return kT(()=>Ot(g,w=>{w!==y&&b(M4(w))}),[g,y]),y},m=le.default.version.startsWith("18")?d:h;return{Component:f,useEmitter:(v,g)=>{let y=le.default.useContext(a)[v];kT(()=>Ot(y,g),[g,y])},useEmitterValue:m,usePublisher:p}}var $T=le.default.createContext(void 0),vY=le.default.createContext(void 0),bY=typeof document<"u"?le.default.useLayoutEffect:le.default.useEffect;function Fk(e){return"self"in e}function zce(e){return"body"in e}function SY(e,t,n,r=Km,i,o){let s=le.default.useRef(null),a=le.default.useRef(null),l=le.default.useRef(null),c=le.default.useCallback(p=>{let d,h,m,v=p.target;if(zce(v)||Fk(v)){let y=Fk(v)?v:v.defaultView;m=o?y.scrollX:y.scrollY,d=o?y.document.documentElement.scrollWidth:y.document.documentElement.scrollHeight,h=o?y.innerWidth:y.innerHeight}else m=o?v.scrollLeft:v.scrollTop,d=o?v.scrollWidth:v.scrollHeight,h=o?v.offsetWidth:v.offsetHeight;let g=()=>{e({scrollHeight:d,scrollTop:Math.max(m,0),viewportHeight:h})};p.suppressFlushSync?g():Y4.default.flushSync(g),a.current!==null&&(m===a.current||m<=0||m===d-h)&&(a.current=null,t(!0),l.current&&(clearTimeout(l.current),l.current=null))},[e,t,o]);le.default.useEffect(()=>{let p=i||s.current;return r(i||s.current),c({suppressFlushSync:!0,target:p}),p.addEventListener("scroll",c,{passive:!0}),()=>{r(null),p.removeEventListener("scroll",c)}},[s,c,n,r,i]);function u(p){let d=s.current;if(!d||(o?"offsetWidth"in d&&d.offsetWidth===0:"offsetHeight"in d&&d.offsetHeight===0))return;let h=p.behavior==="smooth",m,v,g;Fk(d)?(v=Math.max(Ys(d.document.documentElement,o?"width":"height"),o?d.document.documentElement.scrollWidth:d.document.documentElement.scrollHeight),m=o?d.innerWidth:d.innerHeight,g=o?window.scrollX:window.scrollY):(v=d[o?"scrollWidth":"scrollHeight"],m=Ys(d,o?"width":"height"),g=d[o?"scrollLeft":"scrollTop"]);let y=v-m;if(p.top=Math.ceil(Math.max(Math.min(y,p.top),0)),uY(m,v)||p.top===g){e({scrollHeight:v,scrollTop:g,viewportHeight:m}),h&&t(!0);return}h?(a.current=p.top,l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{l.current=null,a.current=null,t(!0)},1e3)):a.current=null,o&&(p={behavior:p.behavior,left:p.top}),d.scrollTo(p)}function f(p){o&&(p={behavior:p.behavior,left:p.top}),s.current.scrollBy(p)}return{scrollByCallback:f,scrollerRef:s,scrollToCallback:u}}var Bk="-webkit-sticky",B4="sticky",i1=gY(()=>{if(typeof document>"u")return B4;let e=document.createElement("div");return e.style.position=Bk,e.style.position===Bk?Bk:B4});function o1(e){return e}var Hce=At(()=>{let e=ne(a=>`Item ${a}`),t=ne(a=>`Group ${a}`),n=ne({}),r=ne(o1),i=ne("div"),o=ne(Km),s=(a,l=null)=>ei(X(n,ye(c=>c[a]),sn()),l);return{components:n,computeItemKey:r,EmptyPlaceholder:s("EmptyPlaceholder"),FooterComponent:s("Footer"),GroupComponent:s("Group","div"),groupContent:t,HeaderComponent:s("Header"),HeaderFooterTag:i,ItemComponent:s("Item","div"),itemContent:e,ListComponent:s("List","div"),ScrollerComponent:s("Scroller","div"),scrollerRef:o,ScrollSeekPlaceholder:s("ScrollSeekPlaceholder"),TopItemListComponent:s("TopItemList")}}),Uce=At(([e,t])=>({...e,...t}),ln(yY,Hce)),$ce=({height:e})=>(0,Te.jsx)("div",{style:{height:e}}),jce={overflowAnchor:"none",position:i1(),zIndex:1},wY={overflowAnchor:"none"},qce={...wY,display:"inline-block",height:"100%"},z4=le.default.memo(function({showTopList:e=!1}){let t=je("listState"),n=rs("sizeRanges"),r=je("useWindowScroll"),i=je("customScrollParent"),o=rs("windowScrollContainerState"),s=rs("scrollContainerState"),a=i||r?o:s,l=je("itemContent"),c=je("context"),u=je("groupContent"),f=je("trackItemSizes"),p=je("itemSize"),d=je("log"),h=rs("gap"),m=je("horizontalDirection"),{callbackRef:v}=Z4(n,p,f,e?Km:a,d,h,i,m,je("skipAnimationFrameInResizeObserver")),[g,y]=le.default.useState(0);l1("deviation",I=>{g!==I&&y(I)});let b=je("EmptyPlaceholder"),w=je("ScrollSeekPlaceholder")||$ce,S=je("ListComponent"),C=je("ItemComponent"),x=je("GroupComponent"),E=je("computeItemKey"),T=je("isSeeking"),A=je("groupIndices").length>0,M=je("alignToBottom"),R=je("initialItemFinalLocationReached"),N=e?{}:{boxSizing:"border-box",...m?{display:"inline-block",height:"100%",marginLeft:g!==0?g:M?"auto":0,paddingLeft:t.offsetTop,paddingRight:t.offsetBottom,whiteSpace:"nowrap"}:{marginTop:g!==0?g:M?"auto":0,paddingBottom:t.offsetBottom,paddingTop:t.offsetTop},...R?{}:{visibility:"hidden"}};return!e&&t.totalCount===0&&b?(0,Te.jsx)(b,{...an(b,c)}):(0,Te.jsx)(S,{...an(S,c),"data-testid":e?"virtuoso-top-item-list":"virtuoso-item-list",ref:v,style:N,children:(e?t.topItems:t.items).map(I=>{let _=I.originalIndex,z=E(_+t.firstItemIndex,I.data,c);return T?(0,le.createElement)(w,{...an(w,c),height:I.size,index:I.index,key:z,type:I.type||"item",...I.type==="group"?{}:{groupIndex:I.groupIndex}}):I.type==="group"?(0,le.createElement)(x,{...an(x,c),"data-index":_,"data-item-index":I.index,"data-known-size":I.size,key:z,style:jce},u(I.index,c)):(0,le.createElement)(C,{...an(C,c),...xY(C,I.data),"data-index":_,"data-item-group-index":I.groupIndex,"data-item-index":I.index,"data-known-size":I.size,key:z,style:m?qce:wY},A?l(I.index,I.groupIndex,I.data,c):l(I.index,I.data,c))})})}),Gce={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},Kce={outline:"none",overflowX:"auto",position:"relative"},Wm=e=>({height:"100%",position:"absolute",top:0,width:"100%",...e?{display:"flex",flexDirection:"column"}:{}}),Wce={position:i1(),top:0,width:"100%",zIndex:1};function an(e,t){if(typeof e!="string")return{context:t}}function xY(e,t){return{item:typeof e=="string"?void 0:t}}var Yce=le.default.memo(function(){let e=je("HeaderComponent"),t=rs("headerHeight"),n=je("HeaderFooterTag"),r=Va(le.default.useMemo(()=>o=>{t(Ys(o,"height"))},[t]),!0,je("skipAnimationFrameInResizeObserver")),i=je("context");return e?(0,Te.jsx)(n,{ref:r,children:(0,Te.jsx)(e,{...an(e,i)})}):null}),Qce=le.default.memo(function(){let e=je("FooterComponent"),t=rs("footerHeight"),n=je("HeaderFooterTag"),r=Va(le.default.useMemo(()=>o=>{t(Ys(o,"height"))},[t]),!0,je("skipAnimationFrameInResizeObserver")),i=je("context");return e?(0,Te.jsx)(n,{ref:r,children:(0,Te.jsx)(e,{...an(e,i)})}):null});function s1({useEmitter:e,useEmitterValue:t,usePublisher:n}){return le.default.memo(function({children:r,style:i,context:o,...s}){let a=n("scrollContainerState"),l=t("ScrollerComponent"),c=n("smoothScrollTargetReached"),u=t("scrollerRef"),f=t("horizontalDirection")||!1,{scrollByCallback:p,scrollerRef:d,scrollToCallback:h}=SY(a,c,l,u,void 0,f);return e("scrollTo",h),e("scrollBy",p),(0,Te.jsx)(l,{"data-testid":"virtuoso-scroller","data-virtuoso-scroller":!0,ref:d,style:{...f?Kce:Gce,...i},tabIndex:0,...s,...an(l,o),children:r})})}function a1({useEmitter:e,useEmitterValue:t,usePublisher:n}){return le.default.memo(function({children:r,style:i,context:o,...s}){let a=n("windowScrollContainerState"),l=t("ScrollerComponent"),c=n("smoothScrollTargetReached"),u=t("totalListHeight"),f=t("deviation"),p=t("customScrollParent"),d=le.default.useRef(null),h=t("scrollerRef"),{scrollByCallback:m,scrollerRef:v,scrollToCallback:g}=SY(a,c,l,h,p);return bY(()=>{var y;return v.current=p||((y=d.current)==null?void 0:y.ownerDocument.defaultView),()=>{v.current=null}},[v,p]),e("windowScrollTo",g),e("scrollBy",m),(0,Te.jsx)(l,{ref:d,"data-virtuoso-scroller":!0,style:{position:"relative",...i,...u!==0?{height:u+f}:{}},...s,...an(l,o),children:r})})}var Xce=({children:e})=>{let t=le.default.useContext($T),n=rs("viewportHeight"),r=rs("fixedItemHeight"),i=je("alignToBottom"),o=je("horizontalDirection"),s=le.default.useMemo(()=>cb(n,l=>Ys(l,o?"width":"height")),[n,o]),a=Va(s,!0,je("skipAnimationFrameInResizeObserver"));return le.default.useEffect(()=>{t&&(n(t.viewportHeight),r(t.itemHeight))},[t,n,r]),(0,Te.jsx)("div",{"data-viewport-type":"element",ref:a,style:Wm(i),children:e})},Zce=({children:e})=>{let t=le.default.useContext($T),n=rs("windowViewportRect"),r=rs("fixedItemHeight"),i=je("customScrollParent"),o=Qk(n,i,je("skipAnimationFrameInResizeObserver")),s=je("alignToBottom");return le.default.useEffect(()=>{t&&(r(t.itemHeight),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,n,r]),(0,Te.jsx)("div",{"data-viewport-type":"window",ref:o,style:Wm(s),children:e})},Jce=({children:e})=>{let t=je("TopItemListComponent")||"div",n=je("headerHeight"),r={...Wce,marginTop:`${n}px`},i=je("context");return(0,Te.jsx)(t,{style:r,...an(t,i),children:e})},eue=le.default.memo(function(e){let t=je("useWindowScroll"),n=je("topItemsIndexes").length>0,r=je("customScrollParent"),i=je("context");return(0,Te.jsxs)(r||t?rue:nue,{...e,context:i,children:[n&&(0,Te.jsx)(Jce,{children:(0,Te.jsx)(z4,{showTopList:!0})}),(0,Te.jsxs)(r||t?Zce:Xce,{children:[(0,Te.jsx)(Yce,{}),(0,Te.jsx)(z4,{}),(0,Te.jsx)(Qce,{})]})]})}),{Component:tue,useEmitter:l1,useEmitterValue:je,usePublisher:rs}=r1(Uce,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",scrollIntoViewOnChange:"scrollIntoViewOnChange",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",heightEstimates:"heightEstimates",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"HeaderFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",horizontalDirection:"horizontalDirection",skipAnimationFrameInResizeObserver:"skipAnimationFrameInResizeObserver"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},eue),nue=s1({useEmitter:l1,useEmitterValue:je,usePublisher:rs}),rue=a1({useEmitter:l1,useEmitterValue:je,usePublisher:rs}),Qs=tue;var iue=At(()=>{let e=ne(c=>(0,Te.jsxs)("td",{children:["Item $",c]})),t=ne(null),n=ne(c=>(0,Te.jsxs)("td",{colSpan:1e3,children:["Group ",c]})),r=ne(null),i=ne(null),o=ne({}),s=ne(o1),a=ne(Km),l=(c,u=null)=>ei(X(o,ye(f=>f[c]),sn()),u);return{components:o,computeItemKey:s,context:t,EmptyPlaceholder:l("EmptyPlaceholder"),FillerRow:l("FillerRow"),fixedFooterContent:i,fixedHeaderContent:r,itemContent:e,groupContent:n,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder"),TableBodyComponent:l("TableBody","tbody"),TableComponent:l("Table","table"),TableFooterComponent:l("TableFoot","tfoot"),TableHeadComponent:l("TableHead","thead"),TableRowComponent:l("TableRow","tr"),GroupComponent:l("Group","tr")}}),oue=At(([e,t])=>({...e,...t}),ln(yY,iue)),sue=({height:e})=>(0,Te.jsx)("tr",{children:(0,Te.jsx)("td",{style:{height:e}})}),aue=({height:e})=>(0,Te.jsx)("tr",{children:(0,Te.jsx)("td",{style:{border:0,height:e,padding:0}})}),lue={overflowAnchor:"none"},H4={position:i1(),zIndex:2,overflowAnchor:"none"},U4=le.default.memo(function({showTopList:e=!1}){let t=Ze("listState"),n=Ze("computeItemKey"),r=Ze("firstItemIndex"),i=Ze("context"),o=Ze("isSeeking"),s=Ze("fixedHeaderHeight"),a=Ze("groupIndices").length>0,l=Ze("itemContent"),c=Ze("groupContent"),u=Ze("ScrollSeekPlaceholder")||sue,f=Ze("GroupComponent"),p=Ze("TableRowComponent"),d=(e?t.topItems:[]).reduce((m,v,g)=>(g===0?m.push(v.size):m.push(m[g-1]+v.size),m),[]),h=(e?t.topItems:t.items).map(m=>{let v=m.originalIndex,g=n(v+r,m.data,i),y=e?v===0?0:d[v-1]:0;return o?(0,le.createElement)(u,{...an(u,i),height:m.size,index:m.index,key:g,type:m.type||"item"}):m.type==="group"?(0,le.createElement)(f,{...an(f,i),"data-index":v,"data-item-index":m.index,"data-known-size":m.size,key:g,style:{...H4,top:s}},c(m.index,i)):(0,le.createElement)(p,{...an(p,i),...xY(p,m.data),"data-index":v,"data-item-index":m.index,"data-known-size":m.size,"data-item-group-index":m.groupIndex,key:g,style:e?{...H4,top:s+y}:lue},a?l(m.index,m.groupIndex,m.data,i):l(m.index,m.data,i))});return(0,Te.jsx)(Te.Fragment,{children:h})}),cue=le.default.memo(function(){let e=Ze("listState"),t=Ze("topItemsIndexes").length>0,n=Ks("sizeRanges"),r=Ze("useWindowScroll"),i=Ze("customScrollParent"),o=Ks("windowScrollContainerState"),s=Ks("scrollContainerState"),a=i||r?o:s,l=Ze("trackItemSizes"),c=Ze("itemSize"),u=Ze("log"),{callbackRef:f,ref:p}=Z4(n,c,l,a,u,void 0,i,!1,Ze("skipAnimationFrameInResizeObserver")),[d,h]=le.default.useState(0);c1("deviation",A=>{d!==A&&(p.current.style.marginTop=`${A}px`,h(A))});let m=Ze("EmptyPlaceholder"),v=Ze("FillerRow")||aue,g=Ze("TableBodyComponent"),y=Ze("paddingTopAddition"),b=Ze("statefulTotalCount"),w=Ze("context");if(b===0&&m)return(0,Te.jsx)(m,{...an(m,w)});let S=(t?e.topItems:[]).reduce((A,M)=>A+M.size,0),C=e.offsetTop+y+d-S,x=e.offsetBottom,E=C>0?(0,Te.jsx)(v,{context:w,height:C},"padding-top"):null,T=x>0?(0,Te.jsx)(v,{context:w,height:x},"padding-bottom"):null;return(0,Te.jsxs)(g,{"data-testid":"virtuoso-item-list",ref:f,...an(g,w),children:[E,t&&(0,Te.jsx)(U4,{showTopList:!0}),(0,Te.jsx)(U4,{}),T]})}),uue=({children:e})=>{let t=le.default.useContext($T),n=Ks("viewportHeight"),r=Ks("fixedItemHeight"),i=Va(le.default.useMemo(()=>cb(n,o=>Ys(o,"height")),[n]),!0,Ze("skipAnimationFrameInResizeObserver"));return le.default.useEffect(()=>{t&&(n(t.viewportHeight),r(t.itemHeight))},[t,n,r]),(0,Te.jsx)("div",{"data-viewport-type":"element",ref:i,style:Wm(!1),children:e})},fue=({children:e})=>{let t=le.default.useContext($T),n=Ks("windowViewportRect"),r=Ks("fixedItemHeight"),i=Ze("customScrollParent"),o=Qk(n,i,Ze("skipAnimationFrameInResizeObserver"));return le.default.useEffect(()=>{t&&(r(t.itemHeight),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,n,r]),(0,Te.jsx)("div",{"data-viewport-type":"window",ref:o,style:Wm(!1),children:e})},pue=le.default.memo(function(e){let t=Ze("useWindowScroll"),n=Ze("customScrollParent"),r=Ks("fixedHeaderHeight"),i=Ks("fixedFooterHeight"),o=Ze("fixedHeaderContent"),s=Ze("fixedFooterContent"),a=Ze("context"),l=Va(le.default.useMemo(()=>cb(r,g=>Ys(g,"height")),[r]),!0,Ze("skipAnimationFrameInResizeObserver")),c=Va(le.default.useMemo(()=>cb(i,g=>Ys(g,"height")),[i]),!0,Ze("skipAnimationFrameInResizeObserver")),u=n||t?mue:due,f=n||t?fue:uue,p=Ze("TableComponent"),d=Ze("TableHeadComponent"),h=Ze("TableFooterComponent"),m=o?(0,Te.jsx)(d,{ref:l,style:{position:"sticky",top:0,zIndex:2},...an(d,a),children:o()},"TableHead"):null,v=s?(0,Te.jsx)(h,{ref:c,style:{bottom:0,position:"sticky",zIndex:1},...an(h,a),children:s()},"TableFoot"):null;return(0,Te.jsx)(u,{...e,...an(u,a),children:(0,Te.jsx)(f,{children:(0,Te.jsxs)(p,{style:{borderSpacing:0,overflowAnchor:"none"},...an(p,a),children:[m,(0,Te.jsx)(cue,{},"TableBody"),v]})})})}),{Component:UYe,useEmitter:c1,useEmitterValue:Ze,usePublisher:Ks}=r1(oue,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",firstItemIndex:"firstItemIndex",itemContent:"itemContent",groupContent:"groupContent",fixedHeaderContent:"fixedHeaderContent",fixedFooterContent:"fixedFooterContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",minOverscanItemCount:"minOverscanItemCount",totalCount:"totalCount",topItemCount:"topItemCount",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",groupCounts:"groupCounts",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedGroupHeight:"fixedGroupHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},pue),due=s1({useEmitter:c1,useEmitterValue:Ze,usePublisher:Ks}),mue=a1({useEmitter:c1,useEmitterValue:Ze,usePublisher:Ks});var $4={bottom:0,itemHeight:0,items:[],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},hue={bottom:0,itemHeight:0,items:[{index:0}],itemWidth:0,offsetBottom:0,offsetTop:0,top:0},{ceil:j4,floor:BT,max:lb,min:zk,round:q4}=Math;function G4(e,t,n){return Array.from({length:t-e+1}).map((r,i)=>({data:n===null?null:n[i+e],index:i+e}))}function gue(e){return{...hue,items:e}}function _T(e,t){return e&&e.width===t.width&&e.height===t.height}function yue(e,t){return e&&e.column===t.column&&e.row===t.row}var vue=At(([{increaseViewportBy:e,listBoundary:t,overscan:n,visibleRange:r},{footerHeight:i,headerHeight:o,scrollBy:s,scrollContainerState:a,scrollTo:l,scrollTop:c,smoothScrollTargetReached:u,viewportHeight:f},p,d,{didMount:h,propsReady:m},{customScrollParent:v,useWindowScroll:g,windowScrollContainerState:y,windowScrollTo:b,windowViewportRect:w},S])=>{let C=ne(0),x=ne(0),E=ne($4),T=ne({height:0,width:0}),A=ne({height:0,width:0}),M=St(),R=St(),N=ne(0),I=ne(null),_=ne({column:0,row:0}),z=St(),F=St(),L=ne(!1),k=ne(0),K=ne(!0),ee=ne(!1),Se=ne(!1);Ot(X(h,rt(k),Le(([V,Q])=>!!Q)),()=>{Je(K,!1)}),Ot(X(Yn(h,K,A,T,k,ee),Le(([V,Q,Y,Ie,,yt])=>V&&!Q&&Y.height!==0&&Ie.height!==0&&!yt)),([,,,,V])=>{Je(ee,!0),Jk(1,()=>{Je(M,V)}),Gs(X(c),()=>{Je(t,[0,0]),Je(K,!0)})}),Ce(X(F,Le(V=>V!=null&&V.scrollTop>0),ka(0)),x),Ot(X(h,rt(F),Le(([,V])=>V!=null)),([,V])=>{V&&(Je(T,V.viewport),Je(A,V.item),Je(_,V.gap),V.scrollTop>0&&(Je(L,!0),Gs(X(c,ip(1)),Q=>{Je(L,!1)}),Je(l,{top:V.scrollTop})))}),Ce(X(T,ye(({height:V})=>V)),f),Ce(X(Yn(Ve(T,_T),Ve(A,_T),Ve(_,(V,Q)=>V&&V.column===Q.column&&V.row===Q.row),Ve(c)),ye(([V,Q,Y,Ie])=>({gap:Y,item:Q,scrollTop:Ie,viewport:V}))),z),Ce(X(Yn(Ve(C),r,Ve(_,yue),Ve(A,_T),Ve(T,_T),Ve(I),Ve(x),Ve(L),Ve(K),Ve(k)),Le(([,,,,,,,V])=>!V),ye(([V,[Q,Y],Ie,yt,mt,st,xt,,Et,at])=>{let{column:Dt,row:oi}=Ie,{height:wn,width:O}=yt,{width:B}=mt;if(xt===0&&(V===0||B===0))return $4;if(O===0){let ta=e1(at,V),na=ta+Math.max(xt-1,0);return gue(G4(ta,na,st))}let $=EY(B,O,Dt),ue,oe;Et?Q===0&&Y===0&&xt>0?(ue=0,oe=xt-1):(ue=$*BT((Q+oi)/(wn+oi)),oe=$*j4((Y+oi)/(wn+oi))-1,oe=zk(V-1,lb(oe,$-1)),ue=zk(oe,lb(0,ue))):(ue=0,oe=-1);let re=G4(ue,oe,st),{bottom:Re,top:Ct}=K4(mt,Ie,yt,re),Tt=j4(V/$),Er=Tt*wn+(Tt-1)*oi-Re;return{bottom:Re,itemHeight:wn,items:re,itemWidth:O,offsetBottom:Er,offsetTop:Ct,top:Ct}})),E),Ce(X(I,Le(V=>V!==null),ye(V=>V.length)),C),Ce(X(Yn(T,A,E,_),Le(([V,Q,{items:Y}])=>Y.length>0&&Q.height!==0&&V.height!==0),ye(([V,Q,{items:Y},Ie])=>{let{bottom:yt,top:mt}=K4(V,Ie,Q,Y);return[mt,yt]}),sn(pb)),t);let De=ne(!1);Ce(X(c,rt(De),ye(([V,Q])=>Q||V!==0)),De);let we=So(X(Yn(E,C),Le(([{items:V}])=>V.length>0),rt(De),Le(([[V,Q],Y])=>{let Ie=V.items[V.items.length-1].index===Q-1;return(Y||V.bottom>0&&V.itemHeight>0&&V.offsetBottom===0&&V.items.length===Q)&&Ie}),ye(([[,V]])=>V-1),sn())),qe=So(X(Ve(E),Le(({items:V})=>V.length>0&&V[0].index===0),ka(0),sn())),Fe=So(X(Ve(E),rt(L),Le(([{items:V},Q])=>V.length>0&&!Q),ye(([{items:V}])=>({endIndex:V[V.length-1].index,startIndex:V[0].index})),sn(iY),Yl(0)));Ce(Fe,d.scrollSeekRangeChanged),Ce(X(M,rt(T,A,C,_),ye(([V,Q,Y,Ie,yt])=>{let mt=cY(V),{align:st,behavior:xt,offset:Et}=mt,at=mt.index;at==="LAST"&&(at=Ie-1),at=lb(0,at,zk(Ie-1,at));let Dt=Gk(Q,yt,Y,at);return st==="end"?Dt=q4(Dt-Q.height+Y.height):st==="center"&&(Dt=q4(Dt-Q.height/2+Y.height/2)),Et&&(Dt+=Et),{behavior:xt,top:Dt}})),l);let pe=ei(X(E,ye(V=>V.offsetBottom+V.bottom)),0);return Ce(X(w,ye(V=>({height:V.visibleHeight,width:V.visibleWidth}))),T),{customScrollParent:v,data:I,deviation:N,footerHeight:i,gap:_,headerHeight:o,increaseViewportBy:e,initialItemCount:x,itemDimensions:A,overscan:n,restoreStateFrom:F,scrollBy:s,scrollContainerState:a,scrollHeight:R,scrollTo:l,scrollToIndex:M,scrollTop:c,smoothScrollTargetReached:u,totalCount:C,useWindowScroll:g,viewportDimensions:T,windowScrollContainerState:y,windowScrollTo:b,windowViewportRect:w,...d,gridState:E,horizontalDirection:Se,initialTopMostItemIndex:k,totalListHeight:pe,...p,endReached:we,propsReady:m,rangeChanged:Fe,startReached:qe,stateChanged:z,stateRestoreInProgress:L,...S}},ln(t1,yi,bb,hY,hu,n1,mu));function EY(e,t,n){return lb(1,BT((e+n)/(BT(t)+n)))}function K4(e,t,n,r){let{height:i}=n;if(i===void 0||r.length===0)return{bottom:0,top:0};let o=Gk(e,t,n,r[0].index);return{bottom:Gk(e,t,n,r[r.length-1].index)+i,top:o}}function Gk(e,t,n,r){let i=EY(e.width,n.width,t.column),o=BT(r/i),s=o*n.height+lb(0,o-1)*t.row;return s>0?s+t.row:s}var bue=At(()=>{let e=ne(f=>`Item ${f}`),t=ne({}),n=ne(null),r=ne("virtuoso-grid-item"),i=ne("virtuoso-grid-list"),o=ne(o1),s=ne("div"),a=ne(Km),l=(f,p=null)=>ei(X(t,ye(d=>d[f]),sn()),p),c=ne(!1),u=ne(!1);return Ce(Ve(u),c),{components:t,computeItemKey:o,context:n,FooterComponent:l("Footer"),HeaderComponent:l("Header"),headerFooterTag:s,itemClassName:r,ItemComponent:l("Item","div"),itemContent:e,listClassName:i,ListComponent:l("List","div"),readyStateChanged:c,reportReadyState:u,ScrollerComponent:l("Scroller","div"),scrollerRef:a,ScrollSeekPlaceholder:l("ScrollSeekPlaceholder","div")}}),Sue=At(([e,t])=>({...e,...t}),ln(vue,bue)),wue=le.default.memo(function(){let e=yn("gridState"),t=yn("listClassName"),n=yn("itemClassName"),r=yn("itemContent"),i=yn("computeItemKey"),o=yn("isSeeking"),s=is("scrollHeight"),a=yn("ItemComponent"),l=yn("ListComponent"),c=yn("ScrollSeekPlaceholder"),u=yn("context"),f=is("itemDimensions"),p=is("gap"),d=yn("log"),h=yn("stateRestoreInProgress"),m=is("reportReadyState"),v=Va(le.default.useMemo(()=>g=>{let y=g.parentElement.parentElement.scrollHeight;s(y);let b=g.firstChild;if(b){let{height:w,width:S}=b.getBoundingClientRect();f({height:w,width:S})}p({column:W4("column-gap",getComputedStyle(g).columnGap,d),row:W4("row-gap",getComputedStyle(g).rowGap,d)})},[s,f,p,d]),!0,!1);return bY(()=>{e.itemHeight>0&&e.itemWidth>0&&m(!0)},[e]),h?null:(0,Te.jsx)(l,{className:t,ref:v,...an(l,u),"data-testid":"virtuoso-item-list",style:{paddingBottom:e.offsetBottom,paddingTop:e.offsetTop},children:e.items.map(g=>{let y=i(g.index,g.data,u);return o?(0,Te.jsx)(c,{...an(c,u),height:e.itemHeight,index:g.index,width:e.itemWidth},y):(0,le.createElement)(a,{...an(a,u),className:n,"data-index":g.index,key:y},r(g.index,g.data,u))})})}),xue=le.default.memo(function(){let e=yn("HeaderComponent"),t=is("headerHeight"),n=yn("headerFooterTag"),r=Va(le.default.useMemo(()=>o=>{t(Ys(o,"height"))},[t]),!0,!1),i=yn("context");return e?(0,Te.jsx)(n,{ref:r,children:(0,Te.jsx)(e,{...an(e,i)})}):null}),Eue=le.default.memo(function(){let e=yn("FooterComponent"),t=is("footerHeight"),n=yn("headerFooterTag"),r=Va(le.default.useMemo(()=>o=>{t(Ys(o,"height"))},[t]),!0,!1),i=yn("context");return e?(0,Te.jsx)(n,{ref:r,children:(0,Te.jsx)(e,{...an(e,i)})}):null}),Cue=({children:e})=>{let t=le.default.useContext(vY),n=is("itemDimensions"),r=is("viewportDimensions"),i=Va(le.default.useMemo(()=>o=>{r(o.getBoundingClientRect())},[r]),!0,!1);return le.default.useEffect(()=>{t&&(r({height:t.viewportHeight,width:t.viewportWidth}),n({height:t.itemHeight,width:t.itemWidth}))},[t,r,n]),(0,Te.jsx)("div",{ref:i,style:Wm(!1),children:e})},Tue=({children:e})=>{let t=le.default.useContext(vY),n=is("windowViewportRect"),r=is("itemDimensions"),i=yn("customScrollParent"),o=Qk(n,i,!1);return le.default.useEffect(()=>{t&&(r({height:t.itemHeight,width:t.itemWidth}),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,n,r]),(0,Te.jsx)("div",{ref:o,style:Wm(!1),children:e})},Aue=le.default.memo(function({...e}){let t=yn("useWindowScroll"),n=yn("customScrollParent"),r=n||t?Rue:Mue,i=n||t?Tue:Cue,o=yn("context");return(0,Te.jsx)(r,{...e,...an(r,o),children:(0,Te.jsxs)(i,{children:[(0,Te.jsx)(xue,{}),(0,Te.jsx)(wue,{}),(0,Te.jsx)(Eue,{})]})})}),{Component:$Ye,useEmitter:CY,useEmitterValue:yn,usePublisher:is}=r1(Sue,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex",increaseViewportBy:"increaseViewportBy"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged",readyStateChanged:"readyStateChanged"}},Aue),Mue=s1({useEmitter:CY,useEmitterValue:yn,usePublisher:is}),Rue=a1({useEmitter:CY,useEmitterValue:yn,usePublisher:is});function W4(e,t,n){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&n(`${e} was not resolved to pixel value correctly`,t,Yi.WARN),t==="normal"?0:parseInt(t??"0",10)}var ft=D(j(),1),TY=(0,sp.memo)(({isListView:e})=>(0,ft.jsx)(Fr.div,{className:ge("v-history-entry","is-skeleton",{"is-list-view":e}),"aria-hidden":!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e?(0,ft.jsxs)(ft.Fragment,{children:[(0,ft.jsxs)("div",{className:"v-entry-header",children:[(0,ft.jsx)("div",{className:"v-version-id v-skeleton-item"}),(0,ft.jsx)("div",{className:"v-entry-main-info",children:(0,ft.jsx)("div",{className:"v-version-name v-skeleton-item"})}),(0,ft.jsx)("div",{className:"v-version-timestamp v-skeleton-item"})]}),(0,ft.jsx)("div",{className:"v-version-content v-skeleton-item"})]}):(0,ft.jsxs)(ft.Fragment,{children:[(0,ft.jsxs)("div",{className:"v-entry-header",children:[(0,ft.jsx)("div",{className:"v-version-id v-skeleton-item"}),(0,ft.jsx)("div",{className:"v-version-name v-skeleton-item"}),(0,ft.jsx)("div",{className:"v-version-timestamp v-skeleton-item"})]}),(0,ft.jsx)("div",{className:"v-version-content v-skeleton-item"})]})}));TY.displayName="SkeletonEntry";var u1=(0,sp.memo)(({icon:e,title:t,subtitle:n})=>(0,ft.jsxs)(Fr.div,{className:"v-empty-state",role:"status","aria-live":"polite",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:[(0,ft.jsx)("div",{className:"v-empty-state-icon",children:(0,ft.jsx)(J,{name:e})}),(0,ft.jsx)("p",{className:"v-empty-state-title",children:t}),n&&(0,ft.jsx)("p",{className:"v-empty-state-subtitle v-meta-label",children:n})]}));u1.displayName="EmptyState";function Nue(e,t="LLLL"){try{return(0,f1.moment)(e).format(t)}catch{try{let n=new Date(String(e));if(!Number.isNaN(n.getTime()))return n.toISOString()}catch{}return""}}var AY=({onCountChange:e})=>{let t=me(S=>S.app.status),n=me(S=>S.app.noteId),r=me(S=>S.app.viewMode),i=me(S=>S.app.searchQuery??""),o=me(S=>S.app.isSearchCaseSensitive),s=me(S=>S.app.sortOrder??{property:"versionNumber",direction:"desc"}),a=me(S=>S.app.effectiveSettings),l=me(S=>S.app.panel!==null),c=!n,u=vc(n,{skip:c||r!=="versions"}),f=bc(n,{skip:c||r!=="edits"}),{data:p,isFetching:d,isLoading:h}=r==="versions"?u:f,m=n?p:void 0,v=a.isListView,g=(0,sp.useMemo)(()=>{if(h||d||!m)return[];let S=Array.isArray(m)?m:[],C=String(i??"").trim();if(C===""){let M=N=>{switch(s?.property??"versionNumber"){case"name":return String(N.name??"").toLowerCase()||"\uFFFF";case"size":return typeof N.size=="number"?N.size:0;case"timestamp":return(()=>{let F=N.timestamp,L=Number(new Date(String(F)));return Number.isFinite(L)?L:0})();default:let _=Number(N.versionNumber);return Number.isFinite(_)?_:0}},R=s?.direction==="asc"?"asc":"desc";return mr(S,[M],[R])}let x=o?C:C.toLowerCase(),T=S.map(M=>{let R=0,N=`V${M.versionNumber??""}`,I=String(M.name??""),_=String(M.description??""),z=OT(typeof M.size=="number"?M.size:0),F=a.useRelativeTimestamps?(()=>{try{return(0,f1.moment)(M.timestamp).fromNow(!0)}catch{return""}})():Nue(M.timestamp,"LLLL"),L=a.enableWordCount?String(a.includeMdSyntaxInWordCount?M.wordCountWithMd:M.wordCount):"",k=a.enableCharacterCount?String(a.includeMdSyntaxInCharacterCount?M.charCountWithMd:M.charCount):"",K=a.enableLineCount?String(a.includeMdSyntaxInLineCount?M.lineCount:M.lineCountWithoutMd):"",ee=De=>o?De:De.toLowerCase(),Se=x;return ee(N)===Se?R+=100:ee(N).includes(Se)&&(R+=80),ee(I).startsWith(Se)?R+=60:ee(I).includes(Se)&&(R+=50),ee(_).includes(Se)&&(R+=40),ee(z).includes(Se)&&(R+=20),ee(F).includes(Se)&&(R+=20),L&&ee(L)===Se&&(R+=15),k&&ee(k)===Se&&(R+=15),K&&ee(K)===Se&&(R+=15),{version:M,score:R}}).filter(M=>M.score>0);return mr(T,["score"],["desc"]).map(M=>M.version)},[m,h,d,i,o,s,a]);(0,sp.useEffect)(()=>{let S=Array.isArray(m)?m.length:0,C=g.length;e(C,S)},[g.length,m,e]);let y=`list-${r}-${v?"list":"card"}`,b=Array.isArray(m)?m.length:0,w=()=>{if(h||d||t==="LOADING")return(0,ft.jsx)(Fr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:ge("v-history-manual-scroll",{"is-list-view":v}),children:Array.from({length:8}).map((S,C)=>(0,ft.jsx)("div",{className:v?"v-history-item-list-wrapper":"v-history-item-card-wrapper",children:(0,ft.jsx)(TY,{isListView:v})},C))},"loading");if(t!=="READY")return null;if(b===0){let S=r==="versions"?"versions":"edits",C=r==="versions"?"track history":"track edits";return(0,ft.jsx)(u1,{icon:"inbox",title:`No ${S} saved yet.`,subtitle:`Click the '+' button to start ${C} for this note.`},"empty")}return g.length===0&&String(i??"").trim()?(0,ft.jsx)(u1,{icon:"search-x",title:"No matching items found.",subtitle:"Try a different search query or change sort options."},"no-results"):(0,ft.jsx)(Fr.div,{className:"v-virtuoso-container",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},style:{height:"100%",width:"100%"},children:(0,ft.jsx)(Qs,{style:{height:"100%"},className:"v-virtuoso-container",data:g,itemContent:(S,C)=>C?(0,ft.jsx)(Fr.div,{className:v?"v-history-item-list-wrapper":"v-history-item-card-wrapper","data-version-id":String(C.id),initial:{opacity:0,y:10,scale:.98},animate:{opacity:1,y:0,scale:1},transition:{type:"spring",stiffness:500,damping:30,mass:1},style:{transformOrigin:"center center"},children:(0,ft.jsx)(PT,{version:C,searchQuery:i,isSearchCaseSensitive:o,viewMode:r})}):null,components:{ScrollSeekPlaceholder:({height:S})=>(0,ft.jsx)("div",{style:{height:S},"aria-hidden":!0})}})},y)};return(0,ft.jsx)("div",{className:ge("v-history-list-container",{"is-panel-active":l}),children:(0,ft.jsx)("div",{className:ge("v-history-list",{"is-list-view":v}),style:{height:"100%",position:"relative"},children:(0,ft.jsx)(Xv,{mode:"wait",children:w()})})})};var jT=D(U(),1);var Sb=D(j(),1),p1=({status:e,filteredCount:t,totalCount:n})=>{let r=Pe(),{viewMode:i}=me(a=>({viewMode:a.app.viewMode})),o=(0,jT.useMemo)(()=>{if(e==="LOADING")return"Loading...";let a=i==="versions"?"version":"edit";return t!==n?`${t} of ${n} ${a}s`:`${n} ${n===1?a:a+"s"}`},[e,t,n,i]),s=(0,jT.useCallback)(()=>{r(Z.toggleViewMode())},[r]);return n===0&&"READY",e!=="READY"?null:(0,Sb.jsxs)("div",{className:"v-history-header",children:[(0,Sb.jsx)("span",{className:ge("v-history-title-toggle","clickable-text"),onClick:s,title:`Switch to ${i==="versions"?"Edit History":"Version History"}`,children:i==="versions"?"Version History":"Edit History"}),(0,Sb.jsx)("span",{className:"v-history-count",children:o})]})};var MY=require("obsidian"),qT=D(U(),1),RY=D(j(),1),J=({name:e,...t})=>{let n=(0,qT.useRef)(null);return(0,qT.useLayoutEffect)(()=>{n.current&&(n.current.empty(),(0,MY.setIcon)(n.current,e))},[e]),(0,RY.jsx)("span",{ref:n,...t})};var ap=D(j(),1),lp=({title:e="Open a markdown note to see its version history.",iconName:t="file-text"})=>(0,ap.jsxs)("div",{className:"v-placeholder",children:[(0,ap.jsx)("div",{className:"v-placeholder-icon",children:(0,ap.jsx)(J,{name:t})}),(0,ap.jsx)("p",{className:"v-placeholder-title",children:e}),e==="Open a markdown note to see its version history."&&(0,ap.jsx)("p",{className:"v-placeholder-subtitle v-meta-label",children:"If the note is already open, try focusing its editor pane. Save a version to begin tracking changes."})]});var NY=require("obsidian"),cp=D(U(),1),DY=D(RE(),1),IY=D(j(),1),bn=({name:e,desc:t,children:n})=>{let r=(0,cp.useRef)(null),i=(0,cp.useRef)(null),o=(0,cp.useRef)(null);return(0,cp.useLayoutEffect)(()=>{let s=r.current;s&&(i.current||(i.current=new NY.Setting(s)),i.current.setName(e).setDesc(t),n?(o.current||(o.current=(0,DY.createRoot)(i.current.controlEl)),o.current.render(n)):o.current&&(o.current.unmount(),o.current=null,i.current.controlEl.empty()))},[e,t,n]),(0,cp.useLayoutEffect)(()=>()=>{o.current?.unmount()},[]),(0,IY.jsx)("div",{ref:r})};var za=D(U(),1);var Fa=D(U(),1);var et=D(U(),1),Cb=e=>e.type==="checkbox",up=e=>e instanceof Date,Qi=e=>e==null,$Y=e=>typeof e=="object",Zn=e=>!Qi(e)&&!Array.isArray(e)&&$Y(e)&&!up(e),jY=e=>Zn(e)&&e.target?Cb(e.target)?e.target.checked:e.target.value:e,Due=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,qY=(e,t)=>e.has(Due(t)),Iue=e=>{let t=e.constructor&&e.constructor.prototype;return Zn(t)&&t.hasOwnProperty("isPrototypeOf")},y1=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Qn(e){if(e instanceof Date)return new Date(e);let t=typeof FileList<"u"&&e instanceof FileList;if(y1&&(e instanceof Blob||t))return e;let n=Array.isArray(e);if(!n&&!(Zn(e)&&Iue(e)))return e;let r=n?[]:Object.create(Object.getPrototypeOf(e));for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=Qn(e[i]));return r}var YT=e=>/^\w*$/.test(e),Sn=e=>e===void 0,v1=e=>Array.isArray(e)?e.filter(Boolean):[],b1=e=>v1(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ce=(e,t,n)=>{if(!t||!Zn(e))return n;let r=(YT(t)?[t]:b1(t)).reduce((i,o)=>Qi(i)?i:i[o],e);return Sn(r)||r===e?Sn(e[t])?n:e[t]:r},wo=e=>typeof e=="boolean",bi=e=>typeof e=="function",Pt=(e,t,n)=>{let r=-1,i=YT(t)?[t]:b1(t),o=i.length,s=o-1;for(;++r<o;){let a=i[r],l=n;if(r!==s){let c=e[a];l=Zn(c)||Array.isArray(c)?c:isNaN(+i[r+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;e[a]=l,e=e[a]}},GT={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Xs={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ql={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},GY=et.default.createContext(null);GY.displayName="HookFormContext";var S1=()=>et.default.useContext(GY);var KY=(e,t,n,r=!0)=>{let i={defaultValues:t._defaultValues};for(let o in e)Object.defineProperty(i,o,{get:()=>{let s=o;return t._proxyFormState[s]!==Xs.all&&(t._proxyFormState[s]=!r||Xs.all),n&&(n[s]=!0),e[s]}});return i},w1=typeof window<"u"?et.default.useLayoutEffect:et.default.useEffect;function Oue(e){let t=S1(),{control:n=t.control,disabled:r,name:i,exact:o}=e||{},[s,a]=et.default.useState(n._formState),l=et.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return w1(()=>n._subscribe({name:i,formState:l.current,exact:o,callback:c=>{!r&&a({...n._formState,...c})}}),[i,r,o]),et.default.useEffect(()=>{l.current.isValid&&n._setValid(!0)},[n]),et.default.useMemo(()=>KY(s,n,l.current,!1),[s,n])}var xo=e=>typeof e=="string",m1=(e,t,n,r,i)=>xo(e)?(r&&t.watch.add(e),ce(n,e,i)):Array.isArray(e)?e.map(o=>(r&&t.watch.add(o),ce(n,o))):(r&&(t.watchAll=!0),n),h1=e=>Qi(e)||!$Y(e);function Zs(e,t,n=new WeakSet){if(h1(e)||h1(t))return Object.is(e,t);if(up(e)&&up(t))return Object.is(e.getTime(),t.getTime());let r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(let o of r){let s=e[o];if(!i.includes(o))return!1;if(o!=="ref"){let a=t[o];if(up(s)&&up(a)||Zn(s)&&Zn(a)||Array.isArray(s)&&Array.isArray(a)?!Zs(s,a,n):!Object.is(s,a))return!1}}return!0}function Pue(e){let t=S1(),{control:n=t.control,name:r,defaultValue:i,disabled:o,exact:s,compute:a}=e||{},l=et.default.useRef(i),c=et.default.useRef(a),u=et.default.useRef(void 0),f=et.default.useRef(n),p=et.default.useRef(r);c.current=a;let[d,h]=et.default.useState(()=>{let w=n._getWatch(r,l.current);return c.current?c.current(w):w}),m=et.default.useCallback(w=>{let S=m1(r,n._names,w||n._formValues,!1,l.current);return c.current?c.current(S):S},[n._formValues,n._names,r]),v=et.default.useCallback(w=>{if(!o){let S=m1(r,n._names,w||n._formValues,!1,l.current);if(c.current){let C=c.current(S);Zs(C,u.current)||(h(C),u.current=C)}else h(S)}},[n._formValues,n._names,o,r]);w1(()=>((f.current!==n||!Zs(p.current,r))&&(f.current=n,p.current=r,v()),n._subscribe({name:r,formState:{values:!0},exact:s,callback:w=>{v(w.values)}})),[n,s,r,v]),et.default.useEffect(()=>n._removeUnmounted());let g=f.current!==n,y=p.current,b=et.default.useMemo(()=>{if(o)return null;let w=!g&&!Zs(y,r);return g||w?m():null},[o,g,r,y,m]);return b!==null?b:d}function x1(e){let t=S1(),{name:n,disabled:r,control:i=t.control,shouldUnregister:o,defaultValue:s,exact:a=!0}=e,l=qY(i._names.array,n),c=et.default.useMemo(()=>ce(i._formValues,n,ce(i._defaultValues,n,s)),[i,n,s]),u=Pue({control:i,name:n,defaultValue:c,exact:a}),f=Oue({control:i,name:n,exact:a}),p=et.default.useRef(e),d=et.default.useRef(void 0),h=et.default.useRef(i.register(n,{...e.rules,value:u,...wo(e.disabled)?{disabled:e.disabled}:{}}));p.current=e;let m=et.default.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ce(f.errors,n)},isDirty:{enumerable:!0,get:()=>!!ce(f.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!ce(f.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!ce(f.validatingFields,n)},error:{enumerable:!0,get:()=>ce(f.errors,n)}}),[f,n]),v=et.default.useCallback(w=>h.current.onChange({target:{value:jY(w),name:n},type:GT.CHANGE}),[n]),g=et.default.useCallback(()=>h.current.onBlur({target:{value:ce(i._formValues,n),name:n},type:GT.BLUR}),[n,i._formValues]),y=et.default.useCallback(w=>{let S=ce(i._fields,n);S&&S._f&&w&&(S._f.ref={focus:()=>bi(w.focus)&&w.focus(),select:()=>bi(w.select)&&w.select(),setCustomValidity:C=>bi(w.setCustomValidity)&&w.setCustomValidity(C),reportValidity:()=>bi(w.reportValidity)&&w.reportValidity()})},[i._fields,n]),b=et.default.useMemo(()=>({name:n,value:u,...wo(r)||f.disabled?{disabled:f.disabled||r}:{},onChange:v,onBlur:g,ref:y}),[n,r,f.disabled,v,g,y,u]);return et.default.useEffect(()=>{let w=i._options.shouldUnregister||o,S=d.current;S&&S!==n&&!l&&i.unregister(S),i.register(n,{...p.current.rules,...wo(p.current.disabled)?{disabled:p.current.disabled}:{}});let C=(x,E)=>{let T=ce(i._fields,x);T&&T._f&&(T._f.mount=E)};if(C(n,!0),w){let x=Qn(ce(i._options.defaultValues,n,p.current.defaultValue));Pt(i._defaultValues,n,x),Sn(ce(i._formValues,n))&&Pt(i._formValues,n,x)}return!l&&i.register(n),d.current=n,()=>{(l?w&&!i._state.action:w)?i.unregister(n):C(n,!1)}},[n,i,l,o]),et.default.useEffect(()=>{i._setDisabledField({disabled:r,name:n})},[r,n,i]),et.default.useMemo(()=>({field:b,formState:f,fieldState:m}),[b,f,m])}var E1=(e,t,n,r,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:i||!0}}:{},xb=e=>Array.isArray(e)?e:[e],OY=()=>{let e=[];return{get observers(){return e},next:i=>{for(let o of e)o.next&&o.next(i)},subscribe:i=>(e.push(i),{unsubscribe:()=>{e=e.filter(o=>o!==i)}}),unsubscribe:()=>{e=[]}}};function WY(e,t){let n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r],o=t[r];if(i&&Zn(i)&&o){let s=WY(i,o);Zn(s)&&(n[r]=s)}else e[r]&&(n[r]=o)}return n}var vi=e=>Zn(e)&&!Object.keys(e).length,C1=e=>e.type==="file",KT=e=>{if(!y1)return!1;let t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},YY=e=>e.type==="select-multiple",T1=e=>e.type==="radio",kue=e=>T1(e)||Cb(e),d1=e=>KT(e)&&e.isConnected;function _ue(e,t){let n=t.slice(0,-1).length,r=0;for(;r<n;)e=Sn(e)?r++:e[t[r++]];return e}function Vue(e){for(let t in e)if(e.hasOwnProperty(t)&&!Sn(e[t]))return!1;return!0}function Xn(e,t){let n=Array.isArray(t)?t:YT(t)?[t]:b1(t),r=n.length===1?e:_ue(e,n),i=n.length-1,o=n[i];return r&&delete r[o],i!==0&&(Zn(r)&&vi(r)||Array.isArray(r)&&Vue(r))&&Xn(e,n.slice(0,-1)),e}var Lue=e=>{for(let t in e)if(bi(e[t]))return!0;return!1};function QY(e){return Array.isArray(e)||Zn(e)&&!Lue(e)}function g1(e,t={}){for(let n in e){let r=e[n];QY(r)?(t[n]=Array.isArray(r)?[]:{},g1(r,t[n])):Sn(r)||(t[n]=!0)}return t}function Qm(e,t,n){n||(n=g1(t));for(let r in e){let i=e[r];if(QY(i))Sn(t)||h1(n[r])?n[r]=g1(i,Array.isArray(i)?[]:{}):Qm(i,Qi(t)?{}:t[r],n[r]);else{let o=t[r];n[r]=!Zs(i,o)}}return n}var PY={value:!1,isValid:!1},kY={value:!0,isValid:!0},XY=e=>{if(Array.isArray(e)){if(e.length>1){let t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Sn(e[0].attributes.value)?Sn(e[0].value)||e[0].value===""?kY:{value:e[0].value,isValid:!0}:kY:PY}return PY},ZY=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>Sn(e)?e:t?e===""?NaN:e&&+e:n&&xo(e)?new Date(e):r?r(e):e,_Y={isValid:!1,value:null},JY=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,_Y):_Y;function VY(e){let t=e.ref;return C1(t)?t.files:T1(t)?JY(e.refs).value:YY(t)?[...t.selectedOptions].map(({value:n})=>n):Cb(t)?XY(e.refs).value:ZY(Sn(t.value)?e.ref.value:t.value,e)}var Fue=(e,t,n,r)=>{let i={};for(let o of e){let s=ce(t,o);s&&Pt(i,o,s._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:r}},WT=e=>e instanceof RegExp,wb=e=>Sn(e)?e:WT(e)?e.source:Zn(e)?WT(e.value)?e.value.source:e.value:e,LY=e=>({isOnSubmit:!e||e===Xs.onSubmit,isOnBlur:e===Xs.onBlur,isOnChange:e===Xs.onChange,isOnAll:e===Xs.all,isOnTouch:e===Xs.onTouched}),FY="AsyncFunction",Bue=e=>!!e&&!!e.validate&&!!(bi(e.validate)&&e.validate.constructor.name===FY||Zn(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===FY)),zue=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),BY=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length)))),Eb=(e,t,n,r)=>{for(let i of n||Object.keys(e)){let o=ce(e,i);if(o){let{_f:s,...a}=o;if(s){if(s.refs&&s.refs[0]&&t(s.refs[0],i)&&!r)return!0;if(s.ref&&t(s.ref,s.name)&&!r)return!0;if(Eb(a,t))break}else if(Zn(a)&&Eb(a,t))break}}};function zY(e,t,n){let r=ce(e,n);if(r||YT(n))return{error:r,name:n};let i=n.split(".");for(;i.length;){let o=i.join("."),s=ce(t,o),a=ce(e,o);if(s&&!Array.isArray(s)&&n!==o)return{name:n};if(a&&a.type)return{name:o,error:a};if(a&&a.root&&a.root.type)return{name:`${o}.root`,error:a.root};i.pop()}return{name:n}}var Hue=(e,t,n,r)=>{n(e);let{name:i,...o}=e;return vi(o)||Object.keys(o).length>=Object.keys(t).length||Object.keys(o).find(s=>t[s]===(!r||Xs.all))},Uue=(e,t,n)=>!e||!t||e===t||xb(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r))),$ue=(e,t,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(t||e):(n?r.isOnBlur:i.isOnBlur)?!e:(n?r.isOnChange:i.isOnChange)?e:!0,jue=(e,t)=>!v1(ce(e,t)).length&&Xn(e,t),que=(e,t,n)=>{let r=xb(ce(e,n));return Pt(r,"root",t[n]),Pt(e,n,r),e};function HY(e,t,n="validate"){if(xo(e)||Array.isArray(e)&&e.every(xo)||wo(e)&&!e)return{type:n,message:xo(e)?e:"",ref:t}}var Ym=e=>Zn(e)&&!WT(e)?e:{value:e,message:""},UY=async(e,t,n,r,i,o)=>{let{ref:s,refs:a,required:l,maxLength:c,minLength:u,min:f,max:p,pattern:d,validate:h,name:m,valueAsNumber:v,mount:g}=e._f,y=ce(n,m);if(!g||t.has(m))return{};let b=a?a[0]:s,w=R=>{i&&b.reportValidity&&(b.setCustomValidity(wo(R)?"":R||""),b.reportValidity())},S={},C=T1(s),x=Cb(s),E=C||x,T=(v||C1(s))&&Sn(s.value)&&Sn(y)||KT(s)&&s.value===""||y===""||Array.isArray(y)&&!y.length,A=E1.bind(null,m,r,S),M=(R,N,I,_=Ql.maxLength,z=Ql.minLength)=>{let F=R?N:I;S[m]={type:R?_:z,message:F,ref:s,...A(R?_:z,F)}};if(o?!Array.isArray(y)||!y.length:l&&(!E&&(T||Qi(y))||wo(y)&&!y||x&&!XY(a).isValid||C&&!JY(a).isValid)){let{value:R,message:N}=xo(l)?{value:!!l,message:l}:Ym(l);if(R&&(S[m]={type:Ql.required,message:N,ref:b,...A(Ql.required,N)},!r))return w(N),S}if(!T&&(!Qi(f)||!Qi(p))){let R,N,I=Ym(p),_=Ym(f);if(!Qi(y)&&!isNaN(y)){let z=s.valueAsNumber||y&&+y;Qi(I.value)||(R=z>I.value),Qi(_.value)||(N=z<_.value)}else{let z=s.valueAsDate||new Date(y),F=K=>new Date(new Date().toDateString()+" "+K),L=s.type=="time",k=s.type=="week";xo(I.value)&&y&&(R=L?F(y)>F(I.value):k?y>I.value:z>new Date(I.value)),xo(_.value)&&y&&(N=L?F(y)<F(_.value):k?y<_.value:z<new Date(_.value))}if((R||N)&&(M(!!R,I.message,_.message,Ql.max,Ql.min),!r))return w(S[m].message),S}if((c||u)&&!T&&(xo(y)||o&&Array.isArray(y))){let R=Ym(c),N=Ym(u),I=!Qi(R.value)&&y.length>+R.value,_=!Qi(N.value)&&y.length<+N.value;if((I||_)&&(M(I,R.message,N.message),!r))return w(S[m].message),S}if(d&&!T&&xo(y)){let{value:R,message:N}=Ym(d);if(WT(R)&&!y.match(R)&&(S[m]={type:Ql.pattern,message:N,ref:s,...A(Ql.pattern,N)},!r))return w(N),S}if(h){if(bi(h)){let R=await h(y,n),N=HY(R,b);if(N&&(S[m]={...N,...A(Ql.validate,N.message)},!r))return w(N.message),S}else if(Zn(h)){let R={};for(let N in h){if(!vi(R)&&!r)break;let I=HY(await h[N](y,n),b,N);I&&(R={...I,...A(N,I.message)},w(I.message),r&&(S[m]=R))}if(!vi(R)&&(S[m]={ref:b,...R},!r))return S}}return w(!0),S},Gue={mode:Xs.onSubmit,reValidateMode:Xs.onChange,shouldFocusError:!0};function Kue(e={}){let t={...Gue,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:bi(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},i=Zn(t.defaultValues)||Zn(t.values)?Qn(t.defaultValues||t.values)||{}:{},o=t.shouldUnregister?{}:Qn(i),s={action:!1,mount:!1,watch:!1,keepIsValid:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0,u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},f={...u},p={...f},d={array:OY(),state:OY()},h=t.criteriaMode===Xs.all,m=O=>B=>{clearTimeout(c),c=setTimeout(O,B)},v=async O=>{if(!s.keepIsValid&&!t.disabled&&(f.isValid||p.isValid||O)){let B;t.resolver?(B=vi((await E()).errors),g()):B=await A(r,!0),B!==n.isValid&&d.state.next({isValid:B})}},g=(O,B)=>{!t.disabled&&(f.isValidating||f.validatingFields||p.isValidating||p.validatingFields)&&((O||Array.from(a.mount)).forEach($=>{$&&(B?Pt(n.validatingFields,$,B):Xn(n.validatingFields,$))}),d.state.next({validatingFields:n.validatingFields,isValidating:!vi(n.validatingFields)}))},y=(O,B=[],$,ue,oe=!0,re=!0)=>{if(ue&&$&&!t.disabled){if(s.action=!0,re&&Array.isArray(ce(r,O))){let Re=$(ce(r,O),ue.argA,ue.argB);oe&&Pt(r,O,Re)}if(re&&Array.isArray(ce(n.errors,O))){let Re=$(ce(n.errors,O),ue.argA,ue.argB);oe&&Pt(n.errors,O,Re),jue(n.errors,O)}if((f.touchedFields||p.touchedFields)&&re&&Array.isArray(ce(n.touchedFields,O))){let Re=$(ce(n.touchedFields,O),ue.argA,ue.argB);oe&&Pt(n.touchedFields,O,Re)}(f.dirtyFields||p.dirtyFields)&&(n.dirtyFields=Qm(i,o)),d.state.next({name:O,isDirty:R(O,B),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Pt(o,O,B)},b=(O,B)=>{Pt(n.errors,O,B),d.state.next({errors:n.errors})},w=O=>{n.errors=O,d.state.next({errors:n.errors,isValid:!1})},S=(O,B,$,ue)=>{let oe=ce(r,O);if(oe){let re=ce(o,O,Sn($)?ce(i,O):$);Sn(re)||ue&&ue.defaultChecked||B?Pt(o,O,B?re:VY(oe._f)):_(O,re),s.mount&&!s.action&&v()}},C=(O,B,$,ue,oe)=>{let re=!1,Re=!1,Ct={name:O};if(!t.disabled){if(!$||ue){(f.isDirty||p.isDirty)&&(Re=n.isDirty,n.isDirty=Ct.isDirty=R(),re=Re!==Ct.isDirty);let Tt=Zs(ce(i,O),B);Re=!!ce(n.dirtyFields,O),Tt?Xn(n.dirtyFields,O):Pt(n.dirtyFields,O,!0),Ct.dirtyFields=n.dirtyFields,re=re||(f.dirtyFields||p.dirtyFields)&&Re!==!Tt}if($){let Tt=ce(n.touchedFields,O);Tt||(Pt(n.touchedFields,O,$),Ct.touchedFields=n.touchedFields,re=re||(f.touchedFields||p.touchedFields)&&Tt!==$)}re&&oe&&d.state.next(Ct)}return re?Ct:{}},x=(O,B,$,ue)=>{let oe=ce(n.errors,O),re=(f.isValid||p.isValid)&&wo(B)&&n.isValid!==B;if(t.delayError&&$?(l=m(()=>b(O,$)),l(t.delayError)):(clearTimeout(c),l=null,$?Pt(n.errors,O,$):Xn(n.errors,O)),($?!Zs(oe,$):oe)||!vi(ue)||re){let Re={...ue,...re&&wo(B)?{isValid:B}:{},errors:n.errors,name:O};n={...n,...Re},d.state.next(Re)}},E=async O=>(g(O,!0),await t.resolver(o,t.context,Fue(O||a.mount,r,t.criteriaMode,t.shouldUseNativeValidation))),T=async O=>{let{errors:B}=await E(O);if(g(O),O)for(let $ of O){let ue=ce(B,$);ue?Pt(n.errors,$,ue):Xn(n.errors,$)}else n.errors=B;return B},A=async(O,B,$={valid:!0})=>{for(let ue in O){let oe=O[ue];if(oe){let{_f:re,...Re}=oe;if(re){let Ct=a.array.has(re.name),Tt=oe._f&&Bue(oe._f);Tt&&f.validatingFields&&g([re.name],!0);let Er=await UY(oe,a.disabled,o,h,t.shouldUseNativeValidation&&!B,Ct);if(Tt&&f.validatingFields&&g([re.name]),Er[re.name]&&($.valid=!1,B||e.shouldUseNativeValidation))break;!B&&(ce(Er,re.name)?Ct?que(n.errors,Er,re.name):Pt(n.errors,re.name,Er[re.name]):Xn(n.errors,re.name))}!vi(Re)&&await A(Re,B,$)}}return $.valid},M=()=>{for(let O of a.unMount){let B=ce(r,O);B&&(B._f.refs?B._f.refs.every($=>!d1($)):!d1(B._f.ref))&&V(O)}a.unMount=new Set},R=(O,B)=>!t.disabled&&(O&&B&&Pt(o,O,B),!Zs(ee(),i)),N=(O,B,$)=>m1(O,a,{...s.mount?o:Sn(B)?i:xo(O)?{[O]:B}:B},$,B),I=O=>v1(ce(s.mount?o:i,O,t.shouldUnregister?ce(i,O,[]):[])),_=(O,B,$={})=>{let ue=ce(r,O),oe=B;if(ue){let re=ue._f;re&&(!re.disabled&&Pt(o,O,ZY(B,re)),oe=KT(re.ref)&&Qi(B)?"":B,YY(re.ref)?[...re.ref.options].forEach(Re=>Re.selected=oe.includes(Re.value)):re.refs?Cb(re.ref)?re.refs.forEach(Re=>{(!Re.defaultChecked||!Re.disabled)&&(Array.isArray(oe)?Re.checked=!!oe.find(Ct=>Ct===Re.value):Re.checked=oe===Re.value||!!oe)}):re.refs.forEach(Re=>Re.checked=Re.value===oe):C1(re.ref)?re.ref.value="":(re.ref.value=oe,re.ref.type||d.state.next({name:O,values:Qn(o)})))}($.shouldDirty||$.shouldTouch)&&C(O,oe,$.shouldTouch,$.shouldDirty,!0),$.shouldValidate&&K(O)},z=(O,B,$)=>{for(let ue in B){if(!B.hasOwnProperty(ue))return;let oe=B[ue],re=O+"."+ue,Re=ce(r,re);(a.array.has(O)||Zn(oe)||Re&&!Re._f)&&!up(oe)?z(re,oe,$):_(re,oe,$)}},F=(O,B,$={})=>{let ue=ce(r,O),oe=a.array.has(O),re=Qn(B);Pt(o,O,re),oe?(d.array.next({name:O,values:Qn(o)}),(f.isDirty||f.dirtyFields||p.isDirty||p.dirtyFields)&&$.shouldDirty&&d.state.next({name:O,dirtyFields:Qm(i,o),isDirty:R(O,re)})):ue&&!ue._f&&!Qi(re)?z(O,re,$):_(O,re,$),BY(O,a)?d.state.next({...n,name:O,values:Qn(o)}):d.state.next({name:s.mount?O:void 0,values:Qn(o)})},L=async O=>{s.mount=!0;let B=O.target,$=B.name,ue=!0,oe=ce(r,$),re=Tt=>{ue=Number.isNaN(Tt)||up(Tt)&&isNaN(Tt.getTime())||Zs(Tt,ce(o,$,Tt))},Re=LY(t.mode),Ct=LY(t.reValidateMode);if(oe){let Tt,Er,ta=B.type?VY(oe._f):jY(O),na=O.type===GT.BLUR||O.type===GT.FOCUS_OUT,p9=!zue(oe._f)&&!t.resolver&&!ce(n.errors,$)&&!oe._f.deps||$ue(na,ce(n.touchedFields,$),n.isSubmitted,Ct,Re),FA=BY($,a,na);Pt(o,$,ta),na?(!B||!B.readOnly)&&(oe._f.onBlur&&oe._f.onBlur(O),l&&l(0)):oe._f.onChange&&oe._f.onChange(O);let BA=C($,ta,na),d9=!vi(BA)||FA;if(!na&&d.state.next({name:$,type:O.type,values:Qn(o)}),p9)return(f.isValid||p.isValid)&&(t.mode==="onBlur"?na&&v():na||v()),d9&&d.state.next({name:$,...FA?{}:BA});if(!na&&FA&&d.state.next({...n}),t.resolver){let{errors:j_}=await E([$]);if(g([$]),re(ta),ue){let m9=zY(n.errors,r,$),q_=zY(j_,r,m9.name||$);Tt=q_.error,$=q_.name,Er=vi(j_)}}else g([$],!0),Tt=(await UY(oe,a.disabled,o,h,t.shouldUseNativeValidation))[$],g([$]),re(ta),ue&&(Tt?Er=!1:(f.isValid||p.isValid)&&(Er=await A(r,!0)));ue&&(oe._f.deps&&(!Array.isArray(oe._f.deps)||oe._f.deps.length>0)&&K(oe._f.deps),x($,Er,Tt,BA))}},k=(O,B)=>{if(ce(n.errors,B)&&O.focus)return O.focus(),1},K=async(O,B={})=>{let $,ue,oe=xb(O);if(t.resolver){let re=await T(Sn(O)?O:oe);$=vi(re),ue=O?!oe.some(Re=>ce(re,Re)):$}else O?(ue=(await Promise.all(oe.map(async re=>{let Re=ce(r,re);return await A(Re&&Re._f?{[re]:Re}:Re)}))).every(Boolean),!(!ue&&!n.isValid)&&v()):ue=$=await A(r);return d.state.next({...!xo(O)||(f.isValid||p.isValid)&&$!==n.isValid?{}:{name:O},...t.resolver||!O?{isValid:$}:{},errors:n.errors}),B.shouldFocus&&!ue&&Eb(r,k,O?oe:a.mount),ue},ee=(O,B)=>{let $={...s.mount?o:i};return B&&($=WY(B.dirtyFields?n.dirtyFields:n.touchedFields,$)),Sn(O)?$:xo(O)?ce($,O):O.map(ue=>ce($,ue))},Se=(O,B)=>({invalid:!!ce((B||n).errors,O),isDirty:!!ce((B||n).dirtyFields,O),error:ce((B||n).errors,O),isValidating:!!ce(n.validatingFields,O),isTouched:!!ce((B||n).touchedFields,O)}),De=O=>{O&&xb(O).forEach(B=>Xn(n.errors,B)),d.state.next({errors:O?n.errors:{}})},we=(O,B,$)=>{let ue=(ce(r,O,{_f:{}})._f||{}).ref,oe=ce(n.errors,O)||{},{ref:re,message:Re,type:Ct,...Tt}=oe;Pt(n.errors,O,{...Tt,...B,ref:ue}),d.state.next({name:O,errors:n.errors,isValid:!1}),$&&$.shouldFocus&&ue&&ue.focus&&ue.focus()},qe=(O,B)=>bi(O)?d.state.subscribe({next:$=>"values"in $&&O(N(void 0,B),$)}):N(O,B,!0),Fe=O=>d.state.subscribe({next:B=>{Uue(O.name,B.name,O.exact)&&Hue(B,O.formState||f,Dt,O.reRenderRoot)&&O.callback({values:{...o},...n,...B,defaultValues:i})}}).unsubscribe,pe=O=>(s.mount=!0,p={...p,...O.formState},Fe({...O,formState:{...u,...O.formState}})),V=(O,B={})=>{for(let $ of O?xb(O):a.mount)a.mount.delete($),a.array.delete($),B.keepValue||(Xn(r,$),Xn(o,$)),!B.keepError&&Xn(n.errors,$),!B.keepDirty&&Xn(n.dirtyFields,$),!B.keepTouched&&Xn(n.touchedFields,$),!B.keepIsValidating&&Xn(n.validatingFields,$),!t.shouldUnregister&&!B.keepDefaultValue&&Xn(i,$);d.state.next({values:Qn(o)}),d.state.next({...n,...B.keepDirty?{isDirty:R()}:{}}),!B.keepIsValid&&v()},Q=({disabled:O,name:B})=>{(wo(O)&&s.mount||O||a.disabled.has(B))&&(O?a.disabled.add(B):a.disabled.delete(B))},Y=(O,B={})=>{let $=ce(r,O),ue=wo(B.disabled)||wo(t.disabled);return Pt(r,O,{...$||{},_f:{...$&&$._f?$._f:{ref:{name:O}},name:O,mount:!0,...B}}),a.mount.add(O),$?Q({disabled:wo(B.disabled)?B.disabled:t.disabled,name:O}):S(O,!0,B.value),{...ue?{disabled:B.disabled||t.disabled}:{},...t.progressive?{required:!!B.required,min:wb(B.min),max:wb(B.max),minLength:wb(B.minLength),maxLength:wb(B.maxLength),pattern:wb(B.pattern)}:{},name:O,onChange:L,onBlur:L,ref:oe=>{if(oe){Y(O,B),$=ce(r,O);let re=Sn(oe.value)&&oe.querySelectorAll&&oe.querySelectorAll("input,select,textarea")[0]||oe,Re=kue(re),Ct=$._f.refs||[];if(Re?Ct.find(Tt=>Tt===re):re===$._f.ref)return;Pt(r,O,{_f:{...$._f,...Re?{refs:[...Ct.filter(d1),re,...Array.isArray(ce(i,O))?[{}]:[]],ref:{type:re.type,name:O}}:{ref:re}}}),S(O,!1,void 0,re)}else $=ce(r,O,{}),$._f&&($._f.mount=!1),(t.shouldUnregister||B.shouldUnregister)&&!(qY(a.array,O)&&s.action)&&a.unMount.add(O)}}},Ie=()=>t.shouldFocusError&&Eb(r,k,a.mount),yt=O=>{wo(O)&&(d.state.next({disabled:O}),Eb(r,(B,$)=>{let ue=ce(r,$);ue&&(B.disabled=ue._f.disabled||O,Array.isArray(ue._f.refs)&&ue._f.refs.forEach(oe=>{oe.disabled=ue._f.disabled||O}))},0,!1))},mt=(O,B)=>async $=>{let ue;$&&($.preventDefault&&$.preventDefault(),$.persist&&$.persist());let oe=Qn(o);if(d.state.next({isSubmitting:!0}),t.resolver){let{errors:re,values:Re}=await E();g(),n.errors=re,oe=Qn(Re)}else await A(r);if(a.disabled.size)for(let re of a.disabled)Xn(oe,re);if(Xn(n.errors,"root"),vi(n.errors)){d.state.next({errors:{}});try{await O(oe,$)}catch(re){ue=re}}else B&&await B({...n.errors},$),Ie(),setTimeout(Ie);if(d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:vi(n.errors)&&!ue,submitCount:n.submitCount+1,errors:n.errors}),ue)throw ue},st=(O,B={})=>{ce(r,O)&&(Sn(B.defaultValue)?F(O,Qn(ce(i,O))):(F(O,B.defaultValue),Pt(i,O,Qn(B.defaultValue))),B.keepTouched||Xn(n.touchedFields,O),B.keepDirty||(Xn(n.dirtyFields,O),n.isDirty=B.defaultValue?R(O,Qn(ce(i,O))):R()),B.keepError||(Xn(n.errors,O),f.isValid&&v()),d.state.next({...n}))},xt=(O,B={})=>{let $=O?Qn(O):i,ue=Qn($),oe=vi(O),re=oe?i:ue;if(B.keepDefaultValues||(i=$),!B.keepValues){if(B.keepDirtyValues){let Re=new Set([...a.mount,...Object.keys(Qm(i,o))]);for(let Ct of Array.from(Re)){let Tt=ce(n.dirtyFields,Ct),Er=ce(o,Ct),ta=ce(re,Ct);Tt&&!Sn(Er)?Pt(re,Ct,Er):!Tt&&!Sn(ta)&&F(Ct,ta)}}else{if(y1&&Sn(O))for(let Re of a.mount){let Ct=ce(r,Re);if(Ct&&Ct._f){let Tt=Array.isArray(Ct._f.refs)?Ct._f.refs[0]:Ct._f.ref;if(KT(Tt)){let Er=Tt.closest("form");if(Er){Er.reset();break}}}}if(B.keepFieldsRef)for(let Re of a.mount)F(Re,ce(re,Re));else r={}}o=t.shouldUnregister?B.keepDefaultValues?Qn(i):{}:Qn(re),d.array.next({values:{...re}}),d.state.next({values:{...re}})}a={mount:B.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},s.mount=!f.isValid||!!B.keepIsValid||!!B.keepDirtyValues||!t.shouldUnregister&&!vi(re),s.watch=!!t.shouldUnregister,s.keepIsValid=!!B.keepIsValid,s.action=!1,B.keepErrors||(n.errors={}),d.state.next({submitCount:B.keepSubmitCount?n.submitCount:0,isDirty:oe?!1:B.keepDirty?n.isDirty:!!(B.keepDefaultValues&&!Zs(O,i)),isSubmitted:B.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:oe?{}:B.keepDirtyValues?B.keepDefaultValues&&o?Qm(i,o):n.dirtyFields:B.keepDefaultValues&&O?Qm(i,O):B.keepDirty?n.dirtyFields:{},touchedFields:B.keepTouched?n.touchedFields:{},errors:B.keepErrors?n.errors:{},isSubmitSuccessful:B.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},Et=(O,B)=>xt(bi(O)?O(o):O,{...t.resetOptions,...B}),at=(O,B={})=>{let $=ce(r,O),ue=$&&$._f;if(ue){let oe=ue.refs?ue.refs[0]:ue.ref;oe.focus&&setTimeout(()=>{oe.focus(),B.shouldSelect&&bi(oe.select)&&oe.select()})}},Dt=O=>{n={...n,...O}},wn={control:{register:Y,unregister:V,getFieldState:Se,handleSubmit:mt,setError:we,_subscribe:Fe,_runSchema:E,_updateIsValidating:g,_focusError:Ie,_getWatch:N,_getDirty:R,_setValid:v,_setFieldArray:y,_setDisabledField:Q,_setErrors:w,_getFieldArray:I,_reset:xt,_resetDefaultValues:()=>bi(t.defaultValues)&&t.defaultValues().then(O=>{Et(O,t.resetOptions),d.state.next({isLoading:!1})}),_removeUnmounted:M,_disableForm:yt,_subjects:d,_proxyFormState:f,get _fields(){return r},get _formValues(){return o},get _state(){return s},set _state(O){s=O},get _defaultValues(){return i},get _names(){return a},set _names(O){a=O},get _formState(){return n},get _options(){return t},set _options(O){t={...t,...O}}},subscribe:pe,trigger:K,register:Y,handleSubmit:mt,watch:qe,setValue:F,getValues:ee,reset:Et,resetField:st,clearErrors:De,unregister:V,setError:we,setFocus:at,getFieldState:Se};return{...wn,formControl:wn}}function gu(e={}){let t=et.default.useRef(void 0),n=et.default.useRef(void 0),[r,i]=et.default.useState({isDirty:!1,isValidating:!1,isLoading:bi(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:bi(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:r},e.defaultValues&&!bi(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{let{formControl:s,...a}=Kue(e);t.current={...a,formState:r}}let o=t.current.control;return o._options=e,w1(()=>{let s=o._subscribe({formState:o._proxyFormState,callback:()=>i({...o._formState}),reRenderRoot:!0});return i(a=>({...a,isReady:!0})),o._formState.isReady=!0,s},[o]),et.default.useEffect(()=>o._disableForm(e.disabled),[o,e.disabled]),et.default.useEffect(()=>{e.mode&&(o._options.mode=e.mode),e.reValidateMode&&(o._options.reValidateMode=e.reValidateMode)},[o,e.mode,e.reValidateMode]),et.default.useEffect(()=>{e.errors&&(o._setErrors(e.errors),o._focusError())},[o,e.errors]),et.default.useEffect(()=>{e.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,e.shouldUnregister]),et.default.useEffect(()=>{if(o._proxyFormState.isDirty){let s=o._getDirty();s!==r.isDirty&&o._subjects.state.next({isDirty:s})}},[o,r.isDirty]),et.default.useEffect(()=>{var s;e.values&&!Zs(e.values,n.current)?(o._reset(e.values,{keepFieldsRef:!0,...o._options.resetOptions}),!((s=o._options.resetOptions)===null||s===void 0)&&s.keepIsValid||o._setValid(),n.current=e.values,i(a=>({...a}))):o._resetDefaultValues()},[o,e.values]),et.default.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),t.current.formState=KY(r,o),t.current}var e6=(e,t,n)=>{if(e&&"reportValidity"in e){let r=ce(n,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},Wue=(e,t)=>{for(let n in t.fields){let r=t.fields[n];r&&r.ref&&"reportValidity"in r.ref?e6(r.ref,n,e):r&&r.refs&&r.refs.forEach(i=>e6(i,n,e))}},n6=(e,t)=>{t.shouldUseNativeValidation&&Wue(e,t);let n={};for(let r in e){let i=ce(t.fields,r),o=Object.assign(e[r]||{},{ref:i&&i.ref});if(Yue(t.names||Object.keys(e),r)){let s=Object.assign({},ce(n,r));Pt(s,"root",o),Pt(n,r,s)}else Pt(n,r,o)}return n},Yue=(e,t)=>{let n=t6(t);return e.some(r=>t6(r).match(`^${n}\\.\\d+`))};function t6(e){return e.replace(/\]|\[/g,"")}function yu(e,t,n){return n===void 0&&(n={}),function(r,i,o){try{var s=!o.shouldUseNativeValidation&&o.criteriaMode==="all";return Promise.resolve(OV(e,r,Object.assign({},t,{abortPipeEarly:!s}))).then(function(a){if(a.issues){for(var l={};a.issues.length;){var c=a.issues[0],u=sM(c);if(u&&(l[u]||(l[u]={message:c.message,type:c.type}),s)){var f=l[u].types,p=f&&f[c.type];l[u]=E1(u,s,l,c.type,p?[].concat(p,c.message):c.message)}a.issues.shift()}return{values:{},errors:n6(l,o)}}return{values:n.raw?Object.assign({},r):a.output,errors:{}}})}catch(a){return Promise.reject(a)}}}var r6=D(U(),1);var Xl=D(j(),1),A1=(0,r6.memo)(({message:e})=>e?(0,Xl.jsx)("div",{className:"v-validation-tooltip",role:"alert",children:e}):null);A1.displayName="ValidationTooltip";var fp=({name:e,control:t,placeholder:n,type:r="text",maxLength:i,disabled:o,className:s})=>{let{field:a,fieldState:{invalid:l,isTouched:c,error:u}}=x1({name:e,control:t}),f=c&&!l,p=l;return(0,Xl.jsxs)("div",{className:ge("v-input-validation-wrapper",{"is-valid":f,"is-invalid":p}),children:[p&&u?.message&&(0,Xl.jsx)(A1,{message:u.message}),(0,Xl.jsx)("input",{...a,type:r,placeholder:n,maxLength:i,disabled:o,className:s,"aria-invalid":p,value:a.value??""})]})},i6=({name:e,control:t,placeholder:n,rows:r=3,maxLength:i,disabled:o,className:s})=>{let{field:a,fieldState:{invalid:l,isTouched:c,error:u}}=x1({name:e,control:t}),f=c&&!l,p=l;return(0,Xl.jsxs)("div",{className:ge("v-input-validation-wrapper",{"is-valid":f,"is-invalid":p}),children:[p&&u?.message&&(0,Xl.jsx)(A1,{message:u.message}),(0,Xl.jsx)("textarea",{...a,rows:r,placeholder:n,maxLength:i,disabled:o,className:ge("v-settings-textarea",s),"aria-invalid":p,value:a.value??""})]})};var pp=class extends Error{constructor(n,r){super(n);this.issues=r;this.name="ValidationError"}};var o6=Object.freeze(["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"]),Que=Object.freeze(["tags","aliases","cssclass","publish","date","title","creation date","modification date","template"]),Si=Object.freeze({INVALID_FILENAME_CHARS:/[<>:"|?*\\/^\x00-\x1F\x7F]/,PATH_TRAVERSAL:/(?:^|[\\/])\.\.(?:[\\/]|$)/,CONTROL_CHARS:/[\x00-\x1F\x7F]/,SAFE_KEY:/^[a-z0-9_-]+$/i,TIME_FORMAT:/^(\d+):(\d{1,2})$/,DIGITS_ONLY:/^\d+$/,VARIABLE_EXTRACTION:/{([^}]+)}/g}),s6=new Set(o6.map(e=>e.toLowerCase())),M1=new Set(Que.map(e=>e.toLowerCase()));var Zl=class Zl{constructor(){P(this,"cache",new Map)}static getInstance(){return Zl.instance||(Zl.instance=new Zl),Zl.instance}get(t){let n=this.cache.get(t);if(n)return n.lastAccess=Date.now(),this.cache.set(t,n),n.schema}set(t,n){if(this.cache.size>=Zl.MAX_SIZE){let r="",i=1/0;for(let[o,s]of this.cache.entries())s.lastAccess<i&&(i=s.lastAccess,r=o);r&&this.cache.delete(r)}this.cache.set(t,{schema:n,lastAccess:Date.now()})}clear(){this.cache.clear()}size(){return this.cache.size}};P(Zl,"MAX_SIZE",100),P(Zl,"instance");var QT=Zl;function a6(e){return e==null}function l6(e,t){if(!Number.isFinite(e)||!Number.isFinite(t))throw new TypeError("Min and max must be finite numbers");if(e>t)throw new RangeError(`Min (${e}) cannot be greater than max (${t})`)}var c6=e=>{if(typeof e!="string")return null;let t=e.trim();if(t.length===0||t.length>20)return null;let n=Si.TIME_FORMAT.exec(t);if(n&&n[1]&&n[2]){let r=parseInt(n[1],10),i=parseInt(n[2],10);if(i>=60)return null;let o=r*60+i;return o<=Number.MAX_SAFE_INTEGER?o:null}if(Si.DIGITS_ONLY.test(t)){let r=parseInt(t,10);if(r<=Number.MAX_SAFE_INTEGER)return r}return null},XT=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return"Invalid";let t=Math.floor(e);if(t===0)return"0 sec";if(t<60)return`${t} sec`;let n=Math.floor(t/60),r=t%60;return r===0?`${n} min`:`${n} min ${r} sec`},u6=e=>{if(typeof e!="number"||!Number.isFinite(e)||e<0)return"0";let t=Math.round(e);if(t<60)return t.toString();let n=Math.floor(t/60),r=t%60;return`${n}:${r.toString().padStart(2,"0")}`};var f6=(e,t)=>{l6(e,t);let n=`number:${e}:${t}`,r=QT.getInstance(),i=r.get(n);if(i)return i;let o=ae(de(),Ur(e,`Must be at least ${e}`),ms(t,`Must be at most ${t}`),lM("Must be a finite number"));return r.set(n,o),o};var R1=(e,t)=>{let n=new Set(e);return ae(te(),Mo(r=>r.trim()),xn(r=>r.length>0,`${t} format cannot be empty`),xn(r=>r.length<=100,`${t} format is too long (max 100 chars)`),xn(r=>!Si.CONTROL_CHARS.test(r),`${t} format contains control characters`),xn(r=>{let i=0,o=-1,s=new Set;for(let l=0;l<r.length;l++){let c=r[l];if(c==="{"){if(i>0)return!1;i++,o=l}else if(c==="}"){if(i===0)return!1;i--;let u=r.slice(o+1,l);if(u.length===0)return!1;s.add(u)}}if(i!==0)return!1;for(let l of s)if(!n.has(l))return!1;let a=r.replace(Si.VARIABLE_EXTRACTION,"");return!Si.INVALID_FILENAME_CHARS.test(a)},`${t} format contains invalid variables or characters`))};function p6(e){let t=e.split("/");for(let n=0;n<t.length;n++){let r=t[n]?.trim()??"";if(r===""&&n>0)return{isValid:!1,invalidSegment:"empty segment"};if(s6.has(r.toLowerCase()))return{isValid:!1,invalidSegment:r};if(Si.INVALID_FILENAME_CHARS.test(r))return{isValid:!1,invalidSegment:r};if(r.endsWith(".")||r.endsWith(" "))return{isValid:!1,invalidSegment:r};if(Si.CONTROL_CHARS.test(r))return{isValid:!1,invalidSegment:r}}return{isValid:!0}}var ZT=(e,t,n)=>{if(a6(e))throw new pp("Value cannot be null or undefined",[{kind:"validation",type:"custom",input:e,expected:"number",received:String(e),message:"Value cannot be null or undefined",issues:void 0,lang:void 0,abortEarly:void 0,abortPipeEarly:void 0}]);if(typeof e!="number"&&typeof e!="string")throw new pp("Value must be a number or numeric string",[{kind:"validation",type:"custom",input:e,expected:"number",received:typeof e,message:"Value must be a number or numeric string",issues:void 0,lang:void 0,abortEarly:void 0,abortPipeEarly:void 0}]);let r=typeof e=="string"?Number(e):e;if(!Number.isFinite(r))throw new pp("Value must be a finite number",[{kind:"validation",type:"custom",input:e,expected:"finite number",received:String(r),message:"Value must be a finite number",issues:void 0,lang:void 0,abortEarly:void 0,abortPipeEarly:void 0}]);try{let i=f6(t,n);return Ue(i,r)}catch(i){throw i instanceof aM?new pp(i.message,i.issues):i}};var d6=ae(te(),Mo(e=>e.trim()),xn(e=>e.length>0,"Database path cannot be empty"),xn(e=>e.length<=255,"Path is too long (max 255 chars)"),xn(e=>!e.startsWith("/"),"Path must be relative (cannot start with /)"),xn(e=>!e.endsWith("/"),"Path cannot end with a slash"),xn(e=>!Si.PATH_TRAVERSAL.test(e),"Path traversal (..) is not allowed"),xn(e=>{let t=e.replace(/\//g,"");return!Si.INVALID_FILENAME_CHARS.test(t)},'Path contains invalid characters (<>:"|?*\\)'),xn(e=>p6(e).isValid,"Path contains invalid segments or reserved names")),m6=ae(te(),Mo(e=>e.trim()),xn(e=>e.length>0,"Key cannot be empty"),xn(e=>e.length<=50,"Key is too long (max 50 chars)"),xn(e=>Si.SAFE_KEY.test(e),"Key can only contain letters, numbers, underscores, and hyphens"),xn(e=>!M1.has(e.toLowerCase()),"This is a reserved Obsidian frontmatter key")),h6=ae(te(),xn(e=>{let t=e.split(`
`);for(let n=0;n<t.length;n++){let r=t[n]?.trim()??"";if(r.length!==0){if(r.length>500||/(?:.*){2,}\?/.test(r)||/\|.*\|/.test(r))return!1;try{new RegExp(r)}catch{return!1}}}return!0},"Contains invalid or potentially unsafe regex patterns")),g6=R1(["path","uuid","timestamp"],"Note ID"),y6=R1(["timestamp","version","name"],"Version ID");var Jl=D(U(),1);var os=D(U(),1),v6=require("obsidian");var Xm=D(j(),1),Tb=(e,t)=>{switch(t){case"seconds":return u6(e);case"days":case"lines":return String(Math.round(e));default:return String(e)}},N1=(e,t)=>{switch(t){case"seconds":return c6(e);case"days":case"lines":{let n=parseInt(e,10);return isNaN(n)?null:n}default:return null}},Zm=(0,os.memo)(({min:e,max:t,step:n,value:r,disabled:i,onFinalChange:o,unit:s,placeholder:a})=>{let[l,c]=(0,os.useState)(()=>Tb(r,s)),[u,f]=(0,os.useState)(!0),p=(0,os.useRef)(r),d=(0,os.useMemo)(()=>(0,v6.debounce)(b=>{b!==p.current&&(o(b),p.current=b)},800),[o]);(0,os.useEffect)(()=>{r!==p.current&&(c(Tb(r,s)),p.current=r,f(!0))},[r,s]);let h=y=>{let b=y.target.value;c(b);let w=N1(b,s);if(w!==null){let S=En(w,e,t);S!==r&&d(S),f(!0)}else f(b.trim()==="")},m=y=>{let b=parseFloat(y.target.value);c(Tb(b,s)),d(b),f(!0)},v=()=>{d.cancel?.();let y=N1(l,s);if(y!==null){let b=En(y,e,t);b!==p.current&&(o(b),p.current=b),c(Tb(b,s))}else c(Tb(r,s));f(!0)},g=(0,os.useMemo)(()=>{let y=N1(l,s);return y!==null?En(y,e,t):r},[l,s,e,t,r]);return(0,Xm.jsxs)("div",{className:"v-slider-with-input-container",children:[(0,Xm.jsx)("div",{className:"v-slider-container",children:(0,Xm.jsx)("input",{type:"range",min:e,max:t,step:n,value:g,disabled:i,onInput:m,onBlur:v,className:"v-slider-input","aria-valuemin":e,"aria-valuemax":t,"aria-valuenow":g,"aria-label":"Slider control"})}),(0,Xm.jsx)("input",{type:"text",value:l,disabled:i,onChange:h,onBlur:v,className:ge("v-slider-input-field",{"is-invalid":!u}),placeholder:a,"aria-label":"Slider value input"})]})});Zm.displayName="SliderWithInputControl";var Js=D(j(),1),Xue=ke({filters:h6}),dp=(0,Jl.memo)(({settingKey:e,disabled:t})=>{let n=Pe(),r=me(p=>p.app.settings[e]),i=r.autoRegisterNotes,o=r.pathFilters,s=(0,Jl.useCallback)(p=>{n(Z.updateGlobalSettings({[e]:{...r,autoRegisterNotes:p}}))},[n,e,r]),{control:a,watch:l,reset:c,formState:{isValid:u}}=gu({mode:"onChange",resolver:yu(Xue),defaultValues:{filters:o.join(`
`)}}),f=(0,Jl.useMemo)(()=>Oh(p=>{let d=p.split(`
`).map(h=>h.trim()).filter(Boolean);n(Z.updateGlobalSettings({[e]:{...r,pathFilters:d}}))},1e3),[n,e,r]);return(0,Jl.useEffect)(()=>{c({filters:o.join(`
`)})},[o,c]),(0,Jl.useEffect)(()=>{let p=l(d=>{u&&d.filters!==void 0&&f(d.filters)});return()=>{p.unsubscribe(),f.flush()}},[l,u,f]),(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)(bn,{name:"Automatically track new notes",desc:"When enabled, any opened note not currently under version control will be automatically added.",children:(0,Js.jsx)("input",{type:"checkbox",checked:i,onChange:p=>s(p.target.checked),disabled:t,"aria-label":"Toggle automatic note tracking"})}),i&&(0,Js.jsxs)(Js.Fragment,{children:[(0,Js.jsx)("p",{className:"v-settings-info v-meta-label",children:"Enter one case-sensitive regular expression per line. Notes with paths matching any of these patterns will be excluded from auto-tracking."}),(0,Js.jsx)(i6,{name:"filters",control:a,rows:3,placeholder:`^Private/.*
_templates/.*`,maxLength:1e3,disabled:t??!1})]})]})});dp.displayName="AutoRegisterSettings";var tt=D(j(),1),Zue=ke({databasePath:d6}),b6=(0,Fa.memo)(()=>{let e=Pe(),t=me(l=>l.app.settings.databasePath),{control:n,handleSubmit:r,reset:i,formState:{isValid:o,isDirty:s}}=gu({mode:"onChange",resolver:yu(Zue),defaultValues:{databasePath:t}});(0,Fa.useEffect)(()=>{i({databasePath:t})},[t,i]);let a=l=>{l.databasePath!==t&&e(Z.renameDatabasePath(l.databasePath))};return(0,tt.jsx)(bn,{name:"Database path",desc:`The vault-relative path for the version history database. Current: ${t}`,children:(0,tt.jsxs)("form",{onSubmit:r(a),className:"v-setting-form",children:[(0,tt.jsx)(fp,{name:"databasePath",control:n,placeholder:"e.g., .versiondb",maxLength:255}),(0,tt.jsx)("div",{className:"v-settings-action-row",children:(0,tt.jsx)("button",{type:"submit","aria-label":"Apply database path change",disabled:!o||!s,children:"Apply"})})]})})});b6.displayName="DatabasePathSetting";var Jue=ke({key:m6}),S6=(0,Fa.memo)(()=>{let e=Pe(),t=me(l=>l.app.settings.noteIdFrontmatterKey),{control:n,handleSubmit:r,reset:i,formState:{isValid:o,isDirty:s}}=gu({mode:"onChange",resolver:yu(Jue),defaultValues:{key:t}});(0,Fa.useEffect)(()=>{i({key:t})},[t,i]);let a=l=>{l.key!==t&&e(Z.requestKeyUpdate(l.key))};return(0,tt.jsx)(bn,{name:"Frontmatter key",desc:`The key used in note frontmatter to store the version control ID. Current: ${t}`,children:(0,tt.jsxs)("form",{onSubmit:r(a),className:"v-setting-form",children:[(0,tt.jsx)(fp,{name:"key",control:n,placeholder:"e.g., vc-id",maxLength:50}),(0,tt.jsx)("div",{className:"v-settings-action-row",children:(0,tt.jsx)("button",{type:"submit","aria-label":"Apply frontmatter key change",disabled:!o||!s,children:"Apply"})})]})})});S6.displayName="FrontmatterKeySetting";var w6=(0,Fa.memo)(()=>{let e=Pe(),t=me(r=>r.app.settings.enableCompression??!0),n=r=>{e(Z.updateGlobalSettings({enableCompression:r}))};return(0,tt.jsx)(bn,{name:"Enable compression",desc:"Compress version files using GZIP to save space. Existing files will be migrated automatically when accessed.",children:(0,tt.jsx)("input",{type:"checkbox",checked:t,onChange:r=>n(r.target.checked),"aria-label":"Toggle compression"})})});w6.displayName="CompressionSetting";var efe=ke({noteIdFormat:g6,versionIdFormat:y6}),x6=(0,Fa.memo)(()=>{let e=Pe(),t=me(c=>c.app.settings.noteIdFormat),n=me(c=>c.app.settings.versionIdFormat),{control:r,handleSubmit:i,reset:o,formState:{isValid:s,isDirty:a}}=gu({mode:"onChange",resolver:yu(efe),defaultValues:{noteIdFormat:t,versionIdFormat:n}});return(0,Fa.useEffect)(()=>{o({noteIdFormat:t,versionIdFormat:n})},[t,n,o]),(0,tt.jsxs)("form",{onSubmit:i(c=>{e(Z.requestUpdateIdFormats(c.noteIdFormat,c.versionIdFormat))}),className:"v-setting-form",children:[(0,tt.jsx)(bn,{name:"Note ID format",desc:"Format for generating note IDs. Available variables: {path}, {uuid}, {timestamp}. Default: {uuid}",children:(0,tt.jsx)(fp,{name:"noteIdFormat",control:r,placeholder:"{uuid}",maxLength:100})}),(0,tt.jsx)(bn,{name:"Version ID format",desc:"Format for generating version IDs. Available variables: {timestamp}, {version}, {name}. Default: {timestamp}_{version}",children:(0,tt.jsx)(fp,{name:"versionIdFormat",control:r,placeholder:"{timestamp}_{version}",maxLength:100})}),a&&(0,tt.jsx)("div",{className:"v-settings-action-row",children:(0,tt.jsx)("button",{type:"submit","aria-label":"Apply ID format changes",className:"mod-cta",disabled:!s,children:"Apply ID format changes"})})]})});x6.displayName="IdFormatSettings";var Jm=(0,Fa.memo)(({showTitle:e=!0,showPluginSettings:t=!0,showDefaults:n=!0,activeViewMode:r,headerAction:i})=>(0,tt.jsxs)("div",{className:"v-settings-section",role:"region","aria-labelledby":"global-settings-title",children:[e&&(0,tt.jsxs)("div",{className:"v-settings-section-header-row",children:[(0,tt.jsx)("h2",{id:"global-settings-title",children:"Global plugin settings"}),i]}),t&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(b6,{}),(0,tt.jsx)(S6,{}),(0,tt.jsx)(w6,{}),(0,tt.jsx)(x6,{})]}),n&&(0,tt.jsxs)(tt.Fragment,{children:[(!r||r==="versions")&&(0,tt.jsxs)("div",{style:{marginTop:"20px",borderTop:t?"1px solid var(--background-modifier-border)":"none",paddingTop:"10px"},children:[(0,tt.jsx)("h3",{id:"global-version-defaults-title",children:"Global version history defaults"}),(0,tt.jsx)("p",{className:"setting-item-description",children:"These settings apply to all notes using version history unless overridden."}),(0,tt.jsx)(dp,{settingKey:"versionHistorySettings"})]}),(!r||r==="edits")&&(0,tt.jsxs)("div",{style:{marginTop:"20px",borderTop:t||!r?"1px solid var(--background-modifier-border)":"none",paddingTop:"10px"},children:[(0,tt.jsx)("h3",{id:"global-edit-defaults-title",children:"Global edit history defaults"}),(0,tt.jsx)("p",{className:"setting-item-description",children:"These settings apply to all notes using edit history unless overridden."}),(0,tt.jsx)(dp,{settingKey:"editHistorySettings"})]})]})]}));Jm.displayName="GlobalSettings";var T6=D(U(),1);var JT=D(U(),1);var D1=D(j(),1),I1=(0,JT.memo)(({disabled:e})=>{let t=Pe(),n=me(i=>i.app.effectiveSettings.isGlobal??!0),r=(0,JT.useCallback)(i=>{t(Z.toggleGlobalSettings(i))},[t]);return(0,D1.jsx)(bn,{name:"Follow global settings",desc:"When on, this note uses the global plugin settings. When off, it has its own independent settings.",children:(0,D1.jsx)("input",{type:"checkbox",checked:n,onChange:i=>r(i.target.checked),disabled:e,"aria-label":"Toggle global settings"})})});I1.displayName="IsGlobalSetting";var C6=D(U(),1);var Ab=D(U(),1);var ec=D(j(),1),O1=(e,t)=>typeof e=="function"?e(t):e,eA=e=>(0,Ab.memo)(({disabled:n})=>{let r=Pe(),{enabled:i,value:o,viewMode:s}=me(d=>({enabled:!!d.app.effectiveSettings[e.toggleKey],value:d.app.effectiveSettings[e.sliderKey],viewMode:d.app.viewMode}),Wa),a=(0,Ab.useCallback)(d=>{r(Z.updateSettings({[e.toggleKey]:d}))},[r]),l=(0,Ab.useCallback)(d=>{try{let h=ZT(d,e.min,e.max);r(Z.updateSettings({[e.sliderKey]:h}))}catch(h){console.error("Invalid value:",h)}},[r]),c=O1(e.toggleName,s),u=O1(e.toggleDesc,s),f=O1(e.sliderName,s),p=e.sliderDesc(o,s);return(0,ec.jsxs)(ec.Fragment,{children:[(0,ec.jsx)(bn,{name:c,desc:u,children:(0,ec.jsx)("input",{type:"checkbox",checked:i,onChange:d=>a(d.target.checked),disabled:n,"aria-label":`Toggle ${c.toLowerCase()}`})}),i&&(0,ec.jsx)(bn,{name:f,desc:p,children:(0,ec.jsx)(Zm,{min:e.min,max:e.max,step:e.step,value:o,onFinalChange:l,disabled:n,unit:e.unit,placeholder:e.placeholder})})]})});var P1=eA({toggleName:e=>`Auto-cleanup old ${e==="versions"?"versions":"edits"} by age`,toggleDesc:e=>`Automatically delete ${e==="versions"?"versions":"edits"} older than a specified number of days. Keeps at least one ${e==="versions"?"version":"edit"}.`,toggleKey:"autoCleanupOldVersions",sliderName:e=>`Delete ${e==="versions"?"versions":"edits"} older than (days)`,sliderDesc:e=>`Applies if "auto-cleanup by age" is on. Min 7, max 365. Current: ${e} days.`,sliderKey:"autoCleanupDays",min:7,max:365,step:1,unit:"days",placeholder:"e.g., 30"});P1.displayName="AutoCleanupSettings";var Mb=D(U(),1);var k1=eA({toggleName:"Only save if lines changed",toggleDesc:"If enabled, auto-save will only trigger if a minimum number of lines have changed.",toggleKey:"enableMinLinesChangedCheck",sliderName:"Minimum lines changed",sliderDesc:e=>`The total number of added/removed lines required to trigger an auto-save. Current: ${e}.`,sliderKey:"minLinesChanged",min:1,max:50,step:1,unit:"lines",placeholder:"e.g., 5"});k1.displayName="MinLinesControl";var ss=D(j(),1),_1=(e,t)=>typeof e=="function"?e(t):e,tA=e=>{let t=(0,Mb.memo)(({disabled:n})=>{let r=Pe(),{enabled:i,value:o,viewMode:s}=me(d=>({enabled:!!d.app.effectiveSettings[e.toggleKey],value:d.app.effectiveSettings[e.sliderKey],viewMode:d.app.viewMode}),Wa),a=(0,Mb.useCallback)(d=>{r(Z.updateSettings({[e.toggleKey]:d}))},[r]),l=(0,Mb.useCallback)(d=>{try{let h=ZT(d,e.min,e.max);r(Z.updateSettings({[e.sliderKey]:h}))}catch(h){console.error("Invalid value:",h)}},[r]),c=_1(e.toggleName,s),u=_1(e.toggleDesc,s),f=_1(e.sliderName,s),p=e.sliderDesc(o,s);return(0,ss.jsxs)(ss.Fragment,{children:[(0,ss.jsx)(bn,{name:c,desc:u,children:(0,ss.jsx)("input",{type:"checkbox",checked:i,onChange:d=>a(d.target.checked),disabled:n,"aria-label":`Toggle ${c.toLowerCase()}`})}),i&&(0,ss.jsxs)(ss.Fragment,{children:[(0,ss.jsx)(bn,{name:f,desc:p,children:(0,ss.jsx)(Zm,{min:e.min,max:e.max,step:e.step,value:o,onFinalChange:l,disabled:n,unit:e.unit,placeholder:e.placeholder})}),(0,ss.jsx)(k1,{disabled:n})]})]})});return t.displayName=`ToggleSliderWithMinLines(${e.toggleKey})`,t};var V1=tA({toggleName:"Auto-save on file save",toggleDesc:e=>`Automatically save a new ${e==="versions"?"version":"edit"} whenever the note file is saved (e.g., via ctrl+s).`,toggleKey:"autoSaveOnSave",sliderName:"Auto-save delay",sliderDesc:e=>`Time to wait after last change before auto-saving. Current: ${XT(e)}.`,sliderKey:"autoSaveOnSaveInterval",min:1,max:300,step:1,unit:"seconds",placeholder:"e.g., 2:30 or 150"});V1.displayName="AutoSaveSettings";var rA=D(U(),1);var nA=D(j(),1),tfe=ke({maxVersions:ae(Ih([te(),de()]),Mo(e=>e===""?NaN:Number(e)),de("Must be a number"),vt("Must be an integer"),Ur(1,"Minimum is 1 version"),ms(1e3,"Maximum is 1000 versions"))}),L1=(0,rA.memo)(({disabled:e})=>{let t=Pe(),{maxVersions:n,viewMode:r}=me(f=>({maxVersions:f.app.effectiveSettings.maxVersionsPerNote,viewMode:f.app.viewMode})),{control:i,handleSubmit:o,reset:s}=gu({mode:"onChange",resolver:yu(tfe),defaultValues:{maxVersions:n??50}});(0,rA.useEffect)(()=>{s({maxVersions:n??50})},[n,s]);let a=f=>{let p=f;t(Z.updateSettings({maxVersionsPerNote:p.maxVersions}))},l=r==="versions"?"versions":"edits",c=`Max ${l} per note`,u=`Maximum number of ${l} to keep per note. Oldest ${l} are deleted first. Minimum 1, maximum 1000. Current: ${n}`;return(0,nA.jsx)(bn,{name:c,desc:u,children:(0,nA.jsx)("form",{onSubmit:o(a),className:"v-setting-form",onBlur:o(a),children:(0,nA.jsx)(fp,{name:"maxVersions",control:i,type:"number",placeholder:"50",disabled:e,className:"v-settings-input-number"})})})});L1.displayName="MaxVersionsSetting";var iA=D(U(),1);var F1=D(j(),1),E6=(e,t)=>typeof e=="function"?e(t):e,vu=(e,t,n)=>(0,iA.memo)(({disabled:r})=>{let i=Pe(),{isEnabled:o,viewMode:s}=me(u=>({isEnabled:!!u.app.effectiveSettings[n],viewMode:u.app.viewMode})),a=(0,iA.useCallback)(u=>{i(Z.updateSettings({[n]:u}))},[i,n]),l=E6(e,s),c=E6(t,s);return(0,F1.jsx)(bn,{name:l,desc:c,children:(0,F1.jsx)("input",{type:"checkbox",checked:o,onChange:u=>a(u.target.checked),disabled:r,"aria-label":`Toggle ${l.toLowerCase()}`})})}),B1=vu(e=>`Enable ${e==="versions"?"version":"edit"} naming`,e=>`If enabled, prompts for a ${e==="versions"?"version":"edit"} name when saving a new ${e==="versions"?"version":"edit"}.`,"enableVersionNaming");B1.displayName="EnableNamingSetting";var z1=vu(e=>`Enable ${e==="versions"?"version":"edit"} description`,e=>`If enabled, prompts for a description when saving a new ${e==="versions"?"version":"edit"}.`,"enableVersionDescription");z1.displayName="EnableDescriptionSetting";var H1=vu("Show description in list",e=>`If enabled, displays the ${e==="versions"?"version":"edit"} description in the history list instead of action buttons.`,"showDescriptionInList");H1.displayName="ShowDescriptionInListSetting";var U1=vu("Compact list view",e=>`Display ${e==="versions"?"version":"edit"} history as a compact list. Otherwise, shows as cards.`,"isListView");U1.displayName="ListViewSetting";var $1=vu("Use relative timestamps","On: show relative times (e.g., '2 hours ago'). Off: show full date and time.","useRelativeTimestamps");$1.displayName="RelativeTimestampSetting";var j1=vu("Render markdown in preview",e=>`If enabled, ${e==="versions"?"version":"edit"} previews will render markdown. Otherwise, plain text.`,"renderMarkdownInPreview");j1.displayName="RenderMarkdownSetting";var q1=tA({toggleName:"Enable watch mode",toggleDesc:e=>`Automatically save a new ${e==="versions"?"version":"edit"} if the note has changed after a set interval.`,toggleKey:"enableWatchMode",sliderName:"Watch mode interval",sliderDesc:e=>`Time to wait before auto-saving. Current: ${XT(e)}.`,sliderKey:"watchModeInterval",min:5,max:300,step:5,unit:"seconds",placeholder:"e.g., 1:30 or 90"});q1.displayName="WatchModeSettings";var Rb=D(U(),1);var Ba=D(j(),1),oA=(e,t)=>typeof e=="function"?e(t):e,G1=e=>(0,Rb.memo)(({disabled:t})=>{let n=Pe(),{isEnabled:r,includeSyntax:i,viewMode:o}=me(p=>({isEnabled:!!p.app.effectiveSettings[e.enableKey],includeSyntax:!!p.app.effectiveSettings[e.includeSyntaxKey],viewMode:p.app.viewMode}),Wa),s=(0,Rb.useCallback)(p=>{n(Z.updateSettings({[e.enableKey]:p}))},[n,e.enableKey]),a=(0,Rb.useCallback)(p=>{n(Z.updateSettings({[e.includeSyntaxKey]:p}))},[n,e.includeSyntaxKey]),l=oA(e.enableName,o),c=oA(e.enableDesc,o),u=oA(e.includeSyntaxName,o),f=oA(e.includeSyntaxDesc,o);return(0,Ba.jsxs)(Ba.Fragment,{children:[(0,Ba.jsx)(bn,{name:l,desc:c,children:(0,Ba.jsx)("input",{type:"checkbox",checked:r,onChange:p=>s(p.target.checked),disabled:t,"aria-label":`Toggle ${l.toLowerCase()}`})}),r&&(0,Ba.jsx)("div",{className:"v-setting-item-sub-setting",children:(0,Ba.jsx)(bn,{name:u,desc:f,children:(0,Ba.jsx)("input",{type:"checkbox",checked:i,onChange:p=>a(p.target.checked),disabled:t,"aria-label":`Toggle ${u.toLowerCase()}`})})})]})}),K1=G1({enableKey:"enableWordCount",includeSyntaxKey:"includeMdSyntaxInWordCount",enableName:"Enable word count",enableDesc:e=>`Display the word count for each ${e==="versions"?"version":"edit"}.`,includeSyntaxName:"Include markdown syntax",includeSyntaxDesc:'If enabled, the word count will include markdown characters (e.g., "**", "#").'});K1.displayName="WordCountSettings";var W1=G1({enableKey:"enableCharacterCount",includeSyntaxKey:"includeMdSyntaxInCharacterCount",enableName:"Enable character count",enableDesc:e=>`Display the character count for each ${e==="versions"?"version":"edit"}.`,includeSyntaxName:"Include markdown syntax",includeSyntaxDesc:"If enabled, the character count will include markdown characters."});W1.displayName="CharacterCountSettings";var Y1=G1({enableKey:"enableLineCount",includeSyntaxKey:"includeMdSyntaxInLineCount",enableName:"Enable line count",enableDesc:e=>`Display the line count for each ${e==="versions"?"version":"edit"}.`,includeSyntaxName:"Include empty lines",includeSyntaxDesc:"If enabled, the line count will be based on the raw text. If disabled, it will count lines in a markdown-stripped version, which may be fewer."});Y1.displayName="LineCountSettings";var Q1=vu("Enable disk persistence","If enabled, edit history data is automatically exported to .vctrl files in the vault. If disabled, data is stored only in the internal database (and imported from disk if newer).","enableDiskPersistence");Q1.displayName="DiskPersistenceSettings";var fr=D(j(),1),eh=(0,C6.memo)(({disabled:e})=>{let t=me(n=>n.app.viewMode);return(0,fr.jsxs)(fr.Fragment,{children:[(0,fr.jsx)(B1,{disabled:e}),(0,fr.jsx)(z1,{disabled:e}),(0,fr.jsx)(H1,{disabled:e}),(0,fr.jsx)(U1,{disabled:e}),(0,fr.jsx)($1,{disabled:e}),(0,fr.jsx)(j1,{disabled:e}),(0,fr.jsx)(K1,{disabled:e}),(0,fr.jsx)(W1,{disabled:e}),(0,fr.jsx)(Y1,{disabled:e}),(0,fr.jsx)(V1,{disabled:e}),(0,fr.jsx)(q1,{disabled:e}),(0,fr.jsx)(P1,{disabled:e}),(0,fr.jsx)(L1,{disabled:e}),t==="edits"&&(0,fr.jsx)(Q1,{disabled:e})]})});eh.displayName="NoteSettingsControls";var bu=D(j(),1),X1=(0,T6.memo)(({headerAction:e})=>{let{status:t,file:n,noteId:r,isGlobal:i,viewMode:o}=me(l=>({status:l.app.status,file:l.app.file,noteId:l.app.noteId,isGlobal:l.app.effectiveSettings.isGlobal,viewMode:l.app.viewMode}),Wa);if(t!=="READY"||!n)return null;let s=!r,a=o==="versions"?"Version History":"Edit History";return(0,bu.jsxs)("div",{className:"v-settings-section",role:"region","aria-labelledby":"note-settings-title",children:[(0,bu.jsxs)("div",{className:"v-settings-section-header-row",children:[(0,bu.jsx)("h4",{id:"note-settings-title",children:r?`${a} Settings (Current Branch)`:"Default settings"}),e]}),r&&(0,bu.jsx)(I1,{disabled:s}),(0,bu.jsx)("p",{className:"v-settings-info",children:r?i?`This note follows the global ${a.toLowerCase()} settings. Changes made here will affect all other notes that follow global settings.`:`This note has its own ${a.toLowerCase()} settings for the current branch. Changes made here only affect this note.`:"This note is not under version control. These are the default settings that will be applied."}),(0,bu.jsx)(eh,{disabled:s})]})});X1.displayName="NoteSpecificSettings";var th=D(U());var A6=()=>{let e=Pe(),{file:t,noteId:n,viewMode:r}=me(m=>({file:m.app.file,noteId:m.app.noteId,viewMode:m.app.viewMode})),{data:i}=vc(n,{skip:!n}),{data:o}=bc(n,{skip:!n}),s=i?.length??0,a=o?.length??0,l=(0,th.useCallback)(()=>{t&&(e(Z.loadHistory(t)),e(Z.closeSettingsPanelWithNotice("History refreshed.",1500)))},[e,t]),c=(0,th.useCallback)(()=>{if(!n){e(Z.showNotice("This note is not under version control yet. Cannot export history.",3e3));return}e(Z.requestExportAllVersions())},[e,n]),u=(0,th.useCallback)(()=>{let m=r==="versions"?s>0:a>0;n&&m&&e(Z.requestDeleteAll())},[e,n,s,a,r]),f=(0,th.useCallback)(()=>{e(Z.showChangelogPanel({forceRefresh:!0}))},[e]),p=(0,th.useCallback)(()=>{try{window.open("https://github.com/Yuichi-Aragi/Version-Control/issues","_blank","noopener,noreferrer")}catch(m){console.error("Error opening issue tracker:",m)}},[]),d=r==="versions"?s>0:a>0;return{handleRefresh:l,handleExport:c,handleDeleteAll:u,handleViewChangelog:f,handleReportIssue:p,hasItems:d,deleteLabel:r==="versions"?"Delete all versions":"Delete all edits",noteId:n,file:t}};var Ke=D(j(),1),wi=e=>{e.stopPropagation(),e.nativeEvent?.stopImmediatePropagation?.()},nfe=()=>{let e=Pe(),t=me(S=>S.app.panel?.type==="settings"),n=me(S=>S.app.viewMode),[r,i]=(0,za.useState)(null),[o,s]=(0,za.useState)(!1),[a,l]=(0,za.useState)(!1),[c,u]=(0,za.useState)(navigator.onLine),f=Il(),{handleRefresh:p,handleExport:d,handleDeleteAll:h,handleViewChangelog:m,handleReportIssue:v,hasItems:g,deleteLabel:y,noteId:b}=A6();(0,za.useEffect)(()=>{let S=()=>u(!0),C=()=>u(!1);f.registerDomEvent(window,"online",S),f.registerDomEvent(window,"offline",C)},[f]),(0,za.useEffect)(()=>{t||l(!1)},[t]);let w=(0,Ke.jsxs)(mi,{open:a,onOpenChange:l,children:[(0,Ke.jsx)(hi,{asChild:!0,children:(0,Ke.jsx)("button",{className:"clickable-icon","aria-label":"Settings options",onPointerDown:S=>S.stopPropagation(),onMouseDown:S=>S.stopPropagation(),onClick:S=>S.stopPropagation(),children:(0,Ke.jsx)(J,{name:"more-horizontal"})})}),(0,Ke.jsx)(Vr,{children:(0,Ke.jsxs)(gi,{className:"v-dropdown-content",align:"end",sideOffset:5,collisionBoundary:r,collisionPadding:8,onPointerDown:wi,onMouseDown:wi,onClick:wi,style:{zIndex:100},children:[(0,Ke.jsxs)(uC,{children:[(0,Ke.jsxs)(fC,{className:"v-dropdown-item v-dropdown-sub-trigger",children:[(0,Ke.jsx)("span",{children:"Actions"}),(0,Ke.jsx)("div",{className:"v-dropdown-right-slot",children:(0,Ke.jsx)(J,{name:"chevron-right"})})]}),(0,Ke.jsx)(Vr,{children:(0,Ke.jsxs)(pC,{className:"v-dropdown-content",sideOffset:2,alignOffset:-5,collisionPadding:8,style:{zIndex:105},onPointerDown:wi,onMouseDown:wi,onClick:wi,children:[(0,Ke.jsxs)(ut,{className:"v-dropdown-item",onSelect:p,children:[(0,Ke.jsx)(J,{name:"refresh-cw",className:"v-dropdown-item-icon"}),"Refresh history"]}),(0,Ke.jsxs)(ut,{className:"v-dropdown-item",onSelect:d,disabled:!b,children:[(0,Ke.jsx)(J,{name:"download-cloud",className:"v-dropdown-item-icon"}),"Export history"]}),(0,Ke.jsx)(yv,{className:"v-dropdown-separator"}),(0,Ke.jsxs)(ut,{className:"v-dropdown-item",onSelect:m,children:[(0,Ke.jsx)(J,{name:"file-text",className:"v-dropdown-item-icon"}),"View changelog"]}),(0,Ke.jsxs)(ut,{className:"v-dropdown-item",onSelect:v,children:[(0,Ke.jsx)(J,{name:"bug",className:"v-dropdown-item-icon"}),"Report issue"]}),(0,Ke.jsx)(yv,{className:"v-dropdown-separator"}),(0,Ke.jsxs)(ut,{className:"v-dropdown-item mod-warning",onSelect:h,disabled:!b||!g,children:[(0,Ke.jsx)(J,{name:"trash-2",className:"v-dropdown-item-icon"}),y]})]})})]}),(0,Ke.jsx)(ut,{className:"v-dropdown-item",onSelect:()=>s(!o),children:o?"Basic settings":"Advanced settings"})]})})]});return(0,Ke.jsxs)("div",{ref:i,className:ge("v-settings-panel",{"is-active":t}),role:"dialog","aria-modal":t,onPointerDown:wi,onMouseDown:wi,onMouseUp:wi,onClick:wi,children:[(0,Ke.jsxs)("div",{className:"v-settings-panel-header",onPointerDown:wi,onMouseDown:wi,onClick:wi,children:[(0,Ke.jsxs)("div",{className:"v-settings-header-title-group",children:[(0,Ke.jsx)("h3",{children:"Settings"}),c&&(0,Ke.jsx)("img",{src:"https://img.shields.io/github/v/release/Yuichi-Aragi/Version-Control",alt:"GitHub Release",className:"v-settings-badge"})]}),(0,Ke.jsx)("div",{className:"v-panel-header-actions",children:(0,Ke.jsx)("button",{className:"clickable-icon v-panel-close","aria-label":"Close settings",onClick:S=>{wi(S),l(!1),e(H.actions.closePanel())},onMouseDown:wi,children:(0,Ke.jsx)(J,{name:"x"})})})]}),(0,Ke.jsx)("div",{className:"v-settings-panel-content-wrapper",children:o?(0,Ke.jsx)(Jm,{showTitle:!0,showPluginSettings:!0,showDefaults:!1,headerAction:w}):(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsx)(X1,{headerAction:w}),(0,Ke.jsx)(Jm,{showTitle:!1,showPluginSettings:!1,showDefaults:!0,activeViewMode:n})]})})]})},Z1=(0,za.memo)(nfe);Z1.displayName="SettingsPanel";var M6=require("obsidian");var Jn=D(U(),1);var Mt=D(j(),1),rfe=52,J1=(0,Jn.memo)(({item:e,isFocused:t,isDrawer:n,contextActions:r,onChoose:i,onFocus:o,onContextAction:s})=>{let a=(0,Jn.useRef)(null),[l,c]=(0,Jn.useState)(!1);(0,Jn.useEffect)(()=>{t&&a.current?.focus({preventScroll:!0})},[t]);let u=e.isSelected?"check":e.icon,f=(0,Jn.useCallback)(h=>{r&&r.length>0&&(h.preventDefault(),c(!0))},[r]),p=()=>!r||r.length===0?null:(0,Mt.jsx)(hi,{asChild:!0,children:(0,Mt.jsx)("div",{className:"v-action-item-more",onClick:h=>{h.stopPropagation()},children:(0,Mt.jsx)(J,{name:"more-vertical"})})}),d=(0,Mt.jsxs)("div",{ref:a,className:ge("v-action-panel-item",{"is-selected":e.isSelected}),tabIndex:-1,onClick:h=>{h.stopPropagation(),i()},onFocus:o,onContextMenu:f,children:[u&&(0,Mt.jsx)("span",{className:"v-action-item-icon",children:(0,Mt.jsx)(J,{name:u})}),(0,Mt.jsxs)("div",{className:"v-action-item-text-wrapper",children:[(0,Mt.jsx)("div",{className:"v-action-item-text",children:e.text}),e.subtext&&(0,Mt.jsx)("div",{className:"v-action-item-subtext",children:e.subtext})]}),p()]});return r&&r.length>0?(0,Mt.jsxs)(mi,{open:l,onOpenChange:c,children:[n?(0,Mt.jsx)("div",{className:"v-action-panel-list-item-wrapper",children:d}):d,(0,Mt.jsx)(Vr,{children:(0,Mt.jsx)(gi,{className:"v-actionbar-dropdown-content",sideOffset:5,collisionPadding:10,align:"end",children:r.map(h=>(0,Mt.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:m=>{m.preventDefault(),c(!1),s?.(h.id)},children:[(0,Mt.jsx)("span",{children:h.text}),h.icon&&(0,Mt.jsx)(J,{name:h.icon})]},h.id))})})]}):n?(0,Mt.jsx)("div",{className:"v-action-panel-list-item-wrapper",children:d}):d});J1.displayName="ActionPanelItem";var R6=({panelState:e})=>{let t=Pe(),[n,r]=(0,Jn.useState)(""),[i,o]=(0,Jn.useState)(-1),s=(0,Jn.useRef)(null),a=(0,Jn.useRef)(null),{items:l,onCreateAction:c,contextActions:u,onContextAction:f}=e,p=e.title?.trim()==="Switch or create branch",d=(0,Jn.useMemo)(()=>{let S=n.trim(),C=S.toLowerCase(),x=l.filter(E=>E.text.toLowerCase().includes(C)||E.subtext&&E.subtext.toLowerCase().includes(C));return c&&S&&!l.some(E=>E.text.toLowerCase()===C)&&x.push({id:"__create__",data:S,text:`Create new "${S}"`,icon:"plus-circle"}),x},[l,n,c]),h=yo(),m=xf(h),v=(0,Jn.useCallback)(S=>{S.id==="__create__"&&c?t(c(S.data)):t(e.onChooseAction(S.data))},[t,e.onChooseAction,c]),g=(0,Jn.useCallback)((S,C)=>{f&&t(f(S,C))},[t,f]),y=(0,Jn.useMemo)(()=>(0,M6.debounce)(r,150,!0),[]);Ef(s);let b=(0,Jn.useCallback)(S=>{if(d.length===0)return;let C=i,x=!0;if(S.key==="ArrowDown")C=i<0?0:(i+1)%d.length;else if(S.key==="ArrowUp")document.activeElement===s.current?x=!1:C=i<=0?d.length-1:i-1;else if(S.key==="Escape")h();else if(S.key==="Enter"||S.key===" "){let E=d[i];E&&v(E)}else x=!1;x&&S.preventDefault(),C!==i&&C>=0&&(o(C),a.current?.scrollToIndex({index:C,align:"center",behavior:"smooth"}))},[i,d,v,h]),w=()=>d.length===0?(0,Mt.jsx)("div",{className:"v-action-panel-empty",children:"No matching options."}):p?(0,Mt.jsx)(Qs,{ref:a,className:"v-virtuoso-container",data:d,fixedItemHeight:rfe,itemContent:(S,C)=>(0,Mt.jsx)(J1,{item:C,isFocused:S===i,isDrawer:p,contextActions:u?u(C):void 0,onChoose:()=>v(C),onFocus:()=>o(S),onContextAction:x=>g(x,C.data)})}):d.map((S,C)=>(0,Mt.jsx)(J1,{item:S,isFocused:C===i,isDrawer:p,contextActions:u?u(S):void 0,onChoose:()=>v(S),onFocus:()=>o(C),onContextAction:x=>g(x,S.data)},S.id));return(0,Mt.jsx)("div",{className:ge("v-panel-container is-active",{"is-modal-like":!p,"is-drawer-like":p}),onClick:m,children:(0,Mt.jsxs)("div",{className:ge("v-inline-panel v-action-panel",{"is-drawer":p}),onKeyDown:b,children:[(0,Mt.jsxs)("div",{className:"v-panel-header",children:[(0,Mt.jsx)("h3",{children:e.title}),!p&&(0,Mt.jsx)("button",{className:"clickable-icon v-panel-close","aria-label":"Close",onClick:h,children:(0,Mt.jsx)(J,{name:"x"})})]}),e.showFilter&&(0,Mt.jsx)("div",{className:"v-action-panel-filter",children:(0,Mt.jsx)("input",{ref:s,type:"text",placeholder:"Filter or create...",onChange:S=>y(S.target.value)})}),(0,Mt.jsx)("div",{className:"v-action-panel-list",children:w()})]})})};var N6=require("obsidian"),lA=D(U(),1);var sA=D(U(),1),Nb=(0,sA.createContext)(null),aA=()=>{let e=(0,sA.useContext)(Nb);if(!e)throw new Error("useApp must be used within an AppContext.Provider");return e};var Br=D(j(),1),D6=({panelState:e})=>{let t=aA(),n=(0,lA.useRef)(null),r=yo(),i=Il(),{data:o,isLoading:s,error:a}=Oz();return(0,lA.useLayoutEffect)(()=>{if(o&&n.current){let l=n.current;l.empty();try{N6.MarkdownRenderer.render(t,o,l,"",i)}catch(c){console.error("VC: Failed to render changelog Markdown.",c),l.setText("Failed to render changelog. See console for details.")}}},[o,t,i]),(0,Br.jsx)("div",{className:"v-panel-container is-active",children:(0,Br.jsx)("div",{className:"v-inline-panel v-preview-panel",children:(0,Br.jsxs)("div",{className:"v-preview-panel-content",children:[(0,Br.jsxs)("div",{className:"v-panel-header",children:[(0,Br.jsx)("h3",{children:"Plugin Changelog"}),(0,Br.jsx)("div",{className:"v-panel-header-actions",children:(0,Br.jsx)("button",{className:"clickable-icon v-panel-close","aria-label":"Close changelog",onClick:r,children:(0,Br.jsx)(J,{name:"x"})})})]}),(0,Br.jsx)("div",{className:"v-version-content-preview",children:s?(0,Br.jsxs)("div",{className:"is-loading",children:[(0,Br.jsx)("div",{className:"loading-spinner"}),(0,Br.jsx)("p",{children:"Loading changelog..."})]}):a?(0,Br.jsx)("div",{className:"v-error-message",children:(0,Br.jsx)("p",{children:"Failed to load changelog."})}):(0,Br.jsx)("div",{ref:n})})]})})})};var I6=D(U(),1);var O6=D(U(),1),tc=D(j(),1),P6=({panelState:e})=>{let t=Pe(),{status:n,isProcessing:r}=me(l=>({status:l.app.status,isProcessing:l.app.isProcessing})),i=(0,I6.useRef)(null),o=yo(),s=xf(o),a=(0,O6.useCallback)(()=>{n==="READY"&&!r?t(e.onConfirmAction):o()},[t,n,r,e.onConfirmAction,o]);return Ef(i),(0,tc.jsx)("div",{className:"v-panel-container is-active is-modal-like",onClick:s,children:(0,tc.jsxs)("div",{className:"v-inline-panel v-confirmation-panel","data-confirmation-title":e.title,children:[(0,tc.jsx)("h3",{children:e.title}),(0,tc.jsx)("p",{children:e.message}),(0,tc.jsxs)("div",{className:"modal-buttons",children:[(0,tc.jsx)("button",{ref:i,className:"mod-warning","aria-label":`Confirm: ${e.title}`,onClick:a,children:"Confirm"}),(0,tc.jsx)("button",{"aria-label":"Cancel action",onClick:o,children:"Cancel"})]})]})})};var Lt=D(U(),1);var k6="100%",_6="100%",V6={add:"diff-add",remove:"diff-remove",context:"diff-context",collapsed:"diff-collapsed"};var L6=e=>sa(e)?e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):"";function Xi(e,t){if(!e)throw new Error(t||"Invariant violation")}function e_(e){Xi(e!==null&&typeof e=="object","Change must be a non-null object"),Xi(sa(e.value),"Change value must be a string"),Xi(!(e.added&&e.removed),"Change cannot be both added and removed")}function nh(e){Xi(Array.isArray(e),"Changes must be an array"),e.forEach(e_)}function rh(e){let t=["lines","words","chars","smart"];Xi(t.includes(e),`Invalid diffType: ${e}. Must be one of: ${t.join(", ")}`)}function n_(e,t){let n=new Map;return((...r)=>{let i=t(...r);if(n.has(i))return n.get(i);let o=e(...r);return n.set(i,o),o})}var ife=n_((e,t)=>{Xi(Array.isArray(e),"Parts must be an array");let n=[],r=[];for(let i of e){if(e_(i),t==="add"&&i.removed||t==="remove"&&i.added)continue;let o=i.added?"add":i.removed?"remove":"unchanged",s=i.value.split(`
`);for(let a=0;a<s.length;a++){let l=s[a];sa(l)&&l!==""&&r.push({text:l,type:o}),a<s.length-1&&r.length>0&&(n.push(r),r=[])}}return r.length>0&&n.push(r),n},(e,t)=>`${JSON.stringify(e)}-${t}`),Su=n_((e,t="lines")=>{nh(e),rh(t);let n=[],r=1,i=1,o=0,s=0,a=(l,c,u,f,p=!1)=>{let d,h;switch(c){case"add":h=i++;break;case"remove":d=r++;break;case"context":d=r++,h=i++;break;case"collapsed":break}let m={key:`line-${o++}`,index:s++,type:c,content:l,originalChangeIndex:u,segments:f,...p?{isModified:!0}:{},oldLineNum:d,newLineNum:h};n.push(m)};for(let[l,c]of e.entries()){let u=c.added?"add":c.removed?"remove":"context";if(t==="smart"&&u==="context"&&typeof c.count=="number"&&c.count>6){let m=c.value.split(`
`).filter(b=>sa(b)&&b!=="");if(m.length===0)continue;let v=m.slice(0,3),g=m.slice(-3);v.forEach(b=>{a(b,"context",l)}),a("","collapsed",l);let y=m.length-6;r+=En(y,0,1/0),i+=En(y,0,1/0),g.forEach(b=>{a(b,"context",l)});continue}let f=null,p=c;Array.isArray(p.parts)&&(u==="add"||u==="remove")&&(f=ife(p.parts,u));let d=c.value.split(`
`),h=d.length-1;d.forEach((m,v)=>{if(v===h&&m===""&&d.length>1)return;let g=f&&f[v]?f[v]:void 0,y=!1;if(Array.isArray(g)){let b=g.some(S=>S.type==="add"),w=g.some(S=>S.type==="remove");y=b&&w}a(m,u,l,g,y)})}return n},(e,t)=>`${JSON.stringify(e)}-${t??"lines"}`),cA=n_(e=>{Xi(Array.isArray(e),"linearLines must be an array");let t=[],n=0,r=0,i=[],o=[],s=()=>{if(i.length===0&&o.length===0)return;let a=Math.max(i.length,o.length);for(let l=0;l<a;l++)t.push({key:`sbs-${r++}`,left:i[l],right:o[l],rowIndex:n++});i=[],o=[]};for(let a of e)a.type==="context"||a.type==="collapsed"||In(a.isModified)&&a.isModified===!0?(s(),t.push({key:`sbs-${r++}`,left:a,right:a,rowIndex:n++})):a.type==="remove"?i.push(a):a.type==="add"?o.push(a):(s(),t.push({key:`sbs-${r++}`,left:a,right:a,rowIndex:n++}));return s(),t},e=>JSON.stringify(e)),uA=(e,t,n,r)=>{Xi(!(In(e)&&In(t)),"Cannot provide both changes and lines. Use one or the other."),Xi(In(e)||In(t),"Must provide either changes or lines");let i=Array.isArray(t)?t:Array.isArray(e)?Su(e,n):[],o=r==="split"?cA(i):[];return{linearLines:i,splitRows:o,totalLines:i.length,totalRows:r==="split"?o.length:i.length}};var xu=D(U(),1);var wu=D(U(),1);var ti=D(j(),1),ofe=({data:e,isHighlighted:t,searchQuery:n,isCaseSensitive:r=!1,isTargetLine:i,targetMatchIndexInLine:o,onClick:s,diffType:a="lines",displayMode:l="unified",className:c})=>{let u=(0,wu.useCallback)(()=>{In(s)&&e.type!=="collapsed"&&s(e)},[s,e]),f=(0,wu.useMemo)(()=>{let y=sa(n)?n.trim():"";if(!y)return null;try{return new RegExp(L6(y),r?"g":"gi")}catch{return null}},[n,r]),p=(0,wu.useCallback)(y=>y==="unchanged"?"":a==="chars"?y==="add"?"diff-char-add":"diff-char-remove":a==="words"?y==="add"?"diff-word-add":"diff-word-remove":y==="add"?"diff-segment-add":"diff-segment-remove",[a]),d=(0,wu.useCallback)(()=>{if(!Array.isArray(e.segments))return[];let y=0;return e.segments.map((b,w)=>{let S=-1;if(f&&sa(b.text)){let x=b.text.match(f),E=Array.isArray(x)?x.length:0;i&&E>0&&o>=y&&o<y+E&&(S=o-y),y+=E}return l==="unified"||l==="left"&&b.type!=="add"||l==="right"&&b.type!=="remove"?(0,ti.jsx)("span",{className:ge(p(b.type),{"diff-segment-modified":e.isModified&&b.type!=="unchanged"}),children:(0,ti.jsx)(Gt,{text:b.text,query:n??"",caseSensitive:r,activeMatchIndex:S,ariaLabel:`${b.type} text segment`})},`segment-${w}`):null}).filter(In)},[e.segments,e.isModified,f,n,r,i,o,l,p]);if(e.type==="collapsed")return(0,ti.jsxs)("div",{className:ge("diff-line diff-collapsed",c),role:"row","aria-label":"Collapsed context lines","data-display-mode":l,children:[(0,ti.jsx)("div",{className:"diff-line-gutter","aria-hidden":"true"}),(0,ti.jsx)("div",{className:"diff-line-content",children:(0,ti.jsx)("span",{className:"diff-collapsed-marker",children:"\u22EF"})})]});let h=Array.isArray(e.segments)?d():null,m=typeof e.oldLineNum=="number"?e.oldLineNum.toString():"",v=typeof e.newLineNum=="number"?e.newLineNum.toString():"",g=e.type==="add"?"+":e.type==="remove"?"-":"";return(0,ti.jsxs)("div",{className:ge("diff-line",V6[e.type],c,{"is-scrolled-to":t,"is-clickable":In(s),"is-modified-line":e.isModified}),onClick:u,role:"row","aria-label":`${e.type} line${m?`, old line ${m}`:""}${v?`, new line ${v}`:""}`,"data-display-mode":l,children:[(0,ti.jsxs)("div",{className:"diff-line-gutter","aria-hidden":"true",children:[(0,ti.jsx)("span",{className:"diff-line-num old","aria-label":`Old line number: ${m||"Not applicable"}`,children:m}),(0,ti.jsx)("span",{className:"diff-line-num new","aria-label":`New line number: ${v||"Not applicable"}`,children:v})]}),(0,ti.jsxs)("div",{className:"diff-line-content",children:[(0,ti.jsx)("span",{className:"diff-line-marker","aria-hidden":"true",children:g}),(0,ti.jsx)("span",{className:"diff-line-text",children:h||(0,ti.jsx)(Gt,{text:e.content||"\xA0",query:n??"",caseSensitive:r,activeMatchIndex:i?o:-1})})]})]})},nc=(0,wu.memo)(ofe);nc.displayName="DiffLine";var as=D(j(),1),mp=({changes:e,lines:t,diffType:n,viewLayout:r="unified",virtuosoHandleRef:i,setVirtuosoScrollerRef:o,highlightedIndex:s,searchQuery:a,isCaseSensitive:l=!1,activeMatchInfo:c,onLineClick:u,onRangeChanged:f,height:p=k6,width:d=_6,overscanCount:h=10,className:m,initialTopMostItemIndex:v,scrollSeekConfiguration:g})=>{(0,xu.useEffect)(()=>{rh(n),Array.isArray(e)&&nh(e),Array.isArray(t)&&Xi(Array.isArray(t),"lines must be an array")},[e,t,n]);let y=(0,xu.useMemo)(()=>uA(e,t,n,r),[e,t,n,r]),b=(0,xu.useCallback)(E=>{In(f)&&f(E)},[f]),w=(0,xu.useCallback)(E=>{In(u)&&u(E)},[u]),S=ge("v-virtuoso-container",m,{"v-diff-split-view":r==="split","v-diff-unified-view":r==="unified","diff-mode-smart":n==="smart","diff-mode-lines":n==="lines","diff-mode-words":n==="words","diff-mode-chars":n==="chars"}),C=(0,xu.useMemo)(()=>{let E={style:{height:p,width:d},className:S,overscan:h};return o&&(E.scrollerRef=o),In(f)&&(E.rangeChanged=b),v!==void 0&&(E.initialTopMostItemIndex=v),g&&(E.components={ScrollSeekPlaceholder:g}),E},[p,d,S,h,o,f,b,v,g]);if(r==="split"){let{splitRows:E}=y;return(0,as.jsx)(Qs,{ref:i??null,data:E,totalCount:E.length,itemContent:(T,A)=>(0,as.jsxs)("div",{className:"diff-split-row",role:"row",children:[(0,as.jsx)("div",{className:"diff-split-cell",role:"cell",children:In(A.left)?(0,as.jsx)(nc,{data:A.left,isHighlighted:A.left.index===s,searchQuery:a,isCaseSensitive:l,isTargetLine:c?.lineIndex===A.left.index,targetMatchIndexInLine:c?.lineIndex===A.left.index?c.matchIndexInLine:-1,onClick:w,diffType:n,displayMode:"left"}):(0,as.jsx)("div",{className:"diff-empty-cell","aria-hidden":"true"})}),(0,as.jsx)("div",{className:"diff-split-cell",role:"cell",children:In(A.right)?(0,as.jsx)(nc,{data:A.right,isHighlighted:A.right.index===s,searchQuery:a,isCaseSensitive:l,isTargetLine:c?.lineIndex===A.right.index,targetMatchIndexInLine:c?.lineIndex===A.right.index?c.matchIndexInLine:-1,onClick:w,diffType:n,displayMode:"right"}):(0,as.jsx)("div",{className:"diff-empty-cell","aria-hidden":"true"})})]}),...C},"virtuoso-split-view")}let{linearLines:x}=y;return(0,as.jsx)(Qs,{ref:i??null,data:x,totalCount:x.length,itemContent:(E,T)=>(0,as.jsx)(nc,{data:T,isHighlighted:T.index===s,searchQuery:a,isCaseSensitive:l,isTargetLine:c?.lineIndex===T.index,targetMatchIndexInLine:c?.lineIndex===T.index?c.matchIndexInLine:-1,onClick:w,diffType:n,displayMode:"unified"}),...C},"virtuoso-unified-view")};mp.displayName="VirtualizedDiff";var Co=D(U(),1);var Eo=D(j(),1),Db=({changes:e,lines:t,diffType:n,viewLayout:r="unified",searchQuery:i,isCaseSensitive:o=!1,activeMatchInfo:s,onLineClick:a,className:l,style:c})=>{let u=(0,Co.useRef)(null),[f,p]=(0,Co.useState)(!1);(0,Co.useEffect)(()=>{rh(n),Array.isArray(e)&&nh(e),Array.isArray(t)&&Xi(Array.isArray(t),"lines must be an array")},[e,t,n]);let d=(0,Co.useMemo)(()=>uA(e,t,n,r),[e,t,n,r]);(0,Co.useLayoutEffect)(()=>{if(sc(s)||f||sc(u.current)||typeof s.lineIndex!="number")return;let g=u.current.children[s.lineIndex];In(g)&&(g.scrollIntoView({block:"center",behavior:"auto"}),p(!0))},[s,f]),(0,Co.useEffect)(()=>{p(!1)},[s?.lineIndex,s?.matchIndexInLine]);let h=(0,Co.useCallback)(g=>{In(a)&&a(g)},[a]),m=ge("v-static-diff-container",l,{"v-diff-split-view":r==="split","v-diff-unified-view":r==="unified","diff-mode-smart":n==="smart","diff-mode-lines":n==="lines","diff-mode-words":n==="words","diff-mode-chars":n==="chars"});if(r==="split"){let{splitRows:g}=d;return(0,Eo.jsx)("div",{ref:u,className:m,style:{height:"100%",overflowY:"auto",...c},role:"table","aria-label":"Side by side diff view",children:g.map(y=>(0,Eo.jsxs)("div",{className:"diff-split-row",role:"row",children:[(0,Eo.jsx)("div",{className:"diff-split-cell",role:"cell",children:In(y.left)?(0,Eo.jsx)(nc,{data:y.left,isHighlighted:!1,searchQuery:i,isCaseSensitive:o,isTargetLine:s?.lineIndex===y.left.index,targetMatchIndexInLine:s?.lineIndex===y.left.index?s.matchIndexInLine:-1,onClick:h,diffType:n,displayMode:"left"}):(0,Eo.jsx)("div",{className:"diff-empty-cell","aria-hidden":"true"})}),(0,Eo.jsx)("div",{className:"diff-empty-gutter","aria-hidden":"true"}),(0,Eo.jsx)("div",{className:"diff-split-cell",role:"cell",children:In(y.right)?(0,Eo.jsx)(nc,{data:y.right,isHighlighted:!1,searchQuery:i,isCaseSensitive:o,isTargetLine:s?.lineIndex===y.right.index,targetMatchIndexInLine:s?.lineIndex===y.right.index?s.matchIndexInLine:-1,onClick:h,diffType:n,displayMode:"right"}):(0,Eo.jsx)("div",{className:"diff-empty-cell","aria-hidden":"true"})})]},y.key))})}let{linearLines:v}=d;return(0,Eo.jsx)("div",{ref:u,className:m,style:{height:"100%",overflowY:"auto",...c},role:"table","aria-label":"Unified diff view",children:v.map(g=>(0,Eo.jsx)(nc,{data:g,isHighlighted:s?.lineIndex===g.index,searchQuery:i,isCaseSensitive:o,isTargetLine:s?.lineIndex===g.index,targetMatchIndexInLine:s?.lineIndex===g.index?s.matchIndexInLine:-1,onClick:h,diffType:n,displayMode:"unified"},g.key))})};Db.displayName="StaticDiff";var F6=D(U(),1);var fA=D(j(),1),pA=({content:e,searchQuery:t,isCaseSensitive:n,scrollerRef:r,activeMatchInfo:i})=>{let o=(0,F6.useMemo)(()=>e.split(`
`),[e]);return(0,fA.jsx)(Qs,{...r&&{ref:r},className:"v-virtuoso-container",data:o,itemContent:(s,a)=>{let c=i?.lineIndex===s?i.matchIndexInLine:-1;return(0,fA.jsx)("div",{className:"v-plaintext-line",children:(0,fA.jsx)(Gt,{text:a||"\xA0",...t&&{query:t},...n!==void 0&&{caseSensitive:n},activeMatchIndex:c})})}})};pA.displayName="VirtualizedPlaintext";var se=D(j(),1),afe=({currentType:e,currentLayout:t,onSelectType:n,onSelectLayout:r,children:i})=>(0,se.jsxs)(mi,{children:[(0,se.jsx)(hi,{asChild:!0,children:i}),(0,se.jsx)(Vr,{children:(0,se.jsxs)(gi,{className:"v-diff-dropdown-content",sideOffset:5,collisionPadding:10,children:[(0,se.jsxs)(ut,{className:"v-diff-dropdown-item",onSelect:()=>r("unified"),children:[(0,se.jsx)("span",{children:"Unified View"}),t==="unified"&&(0,se.jsx)(J,{name:"check"})]}),(0,se.jsxs)(ut,{className:"v-diff-dropdown-item",onSelect:()=>r("split"),children:[(0,se.jsx)("span",{children:"Side-by-Side View"}),t==="split"&&(0,se.jsx)(J,{name:"check"})]}),(0,se.jsx)(yv,{className:"v-diff-separator"}),(0,se.jsxs)(uC,{children:[(0,se.jsxs)(fC,{className:"v-diff-dropdown-sub-trigger",children:[(0,se.jsx)("span",{children:"Diff Mode"}),(0,se.jsx)(J,{name:"chevron-right"})]}),(0,se.jsx)(Vr,{children:(0,se.jsxs)(pC,{className:"v-diff-dropdown-sub-content",sideOffset:2,alignOffset:-5,children:[(0,se.jsxs)(ut,{className:"v-diff-dropdown-item",onSelect:()=>n("smart"),children:[(0,se.jsx)("span",{children:"Smart Diff"}),e==="smart"&&(0,se.jsx)(J,{name:"check"})]}),(0,se.jsxs)(ut,{className:"v-diff-dropdown-item",onSelect:()=>n("lines"),children:[(0,se.jsx)("span",{children:"Line Diff"}),e==="lines"&&(0,se.jsx)(J,{name:"check"})]}),(0,se.jsxs)(ut,{className:"v-diff-dropdown-item",onSelect:()=>n("words"),children:[(0,se.jsx)("span",{children:"Word Diff"}),e==="words"&&(0,se.jsx)(J,{name:"check"})]}),(0,se.jsxs)(ut,{className:"v-diff-dropdown-item",onSelect:()=>n("chars"),children:[(0,se.jsx)("span",{children:"Character Diff"}),e==="chars"&&(0,se.jsx)(J,{name:"check"})]})]})})]})]})})]}),lfe=e=>e.map(t=>({value:t.value,added:t.added,removed:t.removed,count:t.count,parts:t.parts})),dA=({panelState:e})=>{let t=Pe(),{version1:n,version2:r,diffType:i,renderMode:o}=e,{noteId:s,viewMode:a}=me(V=>({noteId:V.app.noteId,viewMode:V.app.viewMode})),{data:l,isLoading:c,isFetching:u,isError:f}=JB({noteId:s,v1:n,v2:r,diffType:i,viewMode:a},{skip:!s}),p=(0,Lt.useRef)(null),d=(0,Lt.useRef)(null),h=(0,Lt.useRef)(null),m=(0,Lt.useRef)(null),v=(0,Lt.useRef)(null),g=(0,Lt.useRef)(!0),[y,b]=(0,Lt.useState)(!0),[w,S]=(0,Lt.useState)("unified"),[C,x]=(0,Lt.useState)([]);(0,Lt.useEffect)(()=>{if(l){let V=lfe(l);x(Su(V,i))}else x([])},[l,i]);let E=(0,Lt.useMemo)(()=>w==="split"?cA(C):[],[C,w]),T=(0,Lt.useCallback)(V=>w==="unified"?V:E.findIndex(Q=>Q.left&&Q.left.index===V||Q.right&&Q.right.index===V),[w,E]);(0,Lt.useEffect)(()=>{g.current=!0},[n.id,r.id]);let A=(0,Lt.useCallback)(V=>{let Q;if(V.newLineNum!==void 0)Q=V.newLineNum;else if(V.type==="remove"){let Y=C.findIndex(Ie=>Ie.key===V.key);if(Y!==-1)for(let Ie=Y-1;Ie>=0;Ie--){let yt=C[Ie];if(yt?.newLineNum!==void 0){Q=yt.newLineNum+1;break}}Q===void 0&&(Q=1)}Q!==void 0&&t(Z.scrollToLineInEditor(Q))},[t,C]),M=Cf(),R=(0,Lt.useMemo)(()=>{if(!M.searchQuery||!l)return[];let V=new RegExp(pu(M.searchQuery),M.isCaseSensitive?"g":"gi"),Q=[];return C.forEach((Y,Ie)=>{if(Y.type==="collapsed")return;[...Y.content.matchAll(V)].forEach((mt,st)=>{Q.push({lineIndex:Ie,matchIndexInLine:st})})}),Q},[M.searchQuery,M.isCaseSensitive,l,C]),N=R.length,I=(0,Lt.useCallback)(V=>{N!==0&&M.setActiveMatchIndex(Q=>V==="next"?(Q+1)%N:(Q-1+N)%N)},[N,M.setActiveMatchIndex]);(0,Lt.useEffect)(()=>{if(M.activeMatchIndex===-1)return;let V=R[M.activeMatchIndex];if(V&&p.current){let Q=T(V.lineIndex);Q!==-1&&p.current.scrollToIndex({index:Q,align:"center",behavior:"smooth"})}},[M.activeMatchIndex,R,T]);let[_,z]=(0,Lt.useState)(-1),[F,L]=(0,Lt.useState)(null),k=(0,Lt.useMemo)(()=>l?C.reduce((V,Q,Y)=>((Q.type==="add"||Q.type==="remove")&&V.push(Y),V),[]):[],[l,C]);(0,Lt.useEffect)(()=>{z(-1),L(null),m.current&&clearTimeout(m.current)},[l]);let K=(0,Lt.useCallback)(V=>{if(!p.current||k.length===0)return;m.current&&clearTimeout(m.current);let Q=V==="next"?(_+1)%k.length:(_-1+k.length)%k.length;z(Q);let Y=k[Q];if(Y===void 0)return;let Ie=T(Y);if(Ie===-1)return;let st=-((h.current?.offsetHeight??60)+3*20);p.current.scrollToIndex({index:Ie,align:"start",behavior:"smooth",offset:st}),L(Y),m.current=window.setTimeout(()=>L(null),1500)},[k,_,T]),ee=yo(),Se=(0,Lt.useCallback)(V=>{V.stopPropagation(),ee()},[ee]),De=(0,Lt.useCallback)(V=>{V!==i&&(g.current=!1,t(H.actions.updateDiffPanelParams({diffType:V})))},[t,i]),we=n.name?`"${n.name}" (V${n.versionNumber})`:`Version ${n.versionNumber}`,qe=r.id==="current"?"Current note state":`Version ${r.versionNumber}`,Fe=o==="window",pe=c||u;return(0,se.jsx)("div",{className:ge("v-panel-container is-active",{"v-panel-window-mode":Fe}),children:(0,se.jsxs)("div",{className:"v-inline-panel v-diff-panel",children:[(0,se.jsxs)("div",{className:ge("v-panel-header",{"is-searching":M.isSearchActive}),ref:h,children:[(0,se.jsxs)("div",{className:"v-panel-header-content",children:[(0,se.jsxs)("div",{className:"v-diff-panel-title",onClick:()=>b(V=>!V),children:[(0,se.jsx)(J,{name:y?"chevron-right":"chevron-down"}),(0,se.jsx)("h3",{children:"Comparing"}),k.length>0&&(0,se.jsxs)("div",{className:"v-diff-nav-actions",children:[(0,se.jsx)("button",{className:"clickable-icon",onClick:V=>{V.stopPropagation(),K("prev")},children:(0,se.jsx)(J,{name:"chevron-up"})}),(0,se.jsx)("button",{className:"clickable-icon",onClick:V=>{V.stopPropagation(),K("next")},children:(0,se.jsx)(J,{name:"chevron-down"})})]})]}),(0,se.jsxs)("div",{className:"v-panel-header-actions",children:[(0,se.jsx)("button",{className:"clickable-icon",onClick:M.handleToggleSearch,disabled:pe,children:(0,se.jsx)(J,{name:"search"})}),(0,se.jsx)(afe,{currentType:i,currentLayout:w,onSelectType:De,onSelectLayout:S,children:(0,se.jsx)("button",{className:"clickable-icon v-diff-dropdown-trigger",onClick:V=>V.stopPropagation(),disabled:pe,children:(0,se.jsx)(J,{name:"git-commit-horizontal"})})}),!Fe&&(0,se.jsx)("button",{className:"clickable-icon v-panel-close",onClick:Se,children:(0,se.jsx)(J,{name:"x"})})]})]}),(0,se.jsx)("div",{className:"v-panel-search-bar-container",onClick:V=>V.stopPropagation(),children:(0,se.jsxs)("div",{className:"v-search-input-wrapper",children:[(0,se.jsx)("div",{className:"v-search-icon",role:"button",onClick:M.handleToggleSearch,children:(0,se.jsx)(J,{name:"x-circle"})}),(0,se.jsx)("input",{ref:M.searchInputRef,type:"search",placeholder:"Search diff...",value:M.localSearchQuery,onChange:M.handleSearchInputChange,onKeyDown:V=>{V.key==="Enter"&&(V.preventDefault(),I(V.shiftKey?"prev":"next")),V.key==="Escape"&&M.handleToggleSearch()}}),(0,se.jsxs)("div",{className:"v-search-input-buttons",children:[M.searchQuery&&N>0&&(0,se.jsxs)("span",{className:"v-search-match-count",children:[M.activeMatchIndex+1," / ",N]}),(0,se.jsx)("button",{className:"clickable-icon",disabled:N===0,onClick:()=>I("prev"),children:(0,se.jsx)(J,{name:"chevron-up"})}),(0,se.jsx)("button",{className:"clickable-icon",disabled:N===0,onClick:()=>I("next"),children:(0,se.jsx)(J,{name:"chevron-down"})}),(0,se.jsx)("button",{className:ge("clickable-icon",{"is-active":M.isCaseSensitive}),onClick:M.toggleCaseSensitivity,children:(0,se.jsx)(J,{name:"case-sensitive"})}),(0,se.jsx)("button",{className:ge("clickable-icon",{"is-hidden":!M.localSearchQuery}),onClick:M.handleClearSearch,children:(0,se.jsx)(J,{name:"x"})})]})]})})]}),(0,se.jsx)("div",{className:"v-diff-panel-content",children:pe&&!l?(0,se.jsxs)("div",{className:"is-loading",children:[(0,se.jsx)("div",{className:"loading-spinner"}),(0,se.jsx)("p",{children:"Calculating diff..."})]}):f?(0,se.jsx)("div",{className:"v-error-message",children:"Failed to compute diff."}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("div",{className:ge("v-diff-meta-container",{"is-open":!y}),children:(0,se.jsxs)("div",{className:"v-diff-meta-content-wrapper",children:[(0,se.jsxs)("div",{className:"v-meta-label",children:["Base: ",we]}),(0,se.jsxs)("div",{className:"v-meta-label",children:["Compared: ",qe]})]})}),(0,se.jsxs)("div",{className:"v-diff-content-wrapper",ref:v,children:[u&&(0,se.jsx)("div",{className:"v-diff-progress-overlay",children:(0,se.jsx)("p",{children:"Updating..."})}),(0,se.jsx)(mp,{lines:C,diffType:i,viewLayout:w,virtuosoHandleRef:p,highlightedIndex:F,searchQuery:M.searchQuery,isCaseSensitive:M.isCaseSensitive,activeMatchInfo:R[M.activeMatchIndex]??null,onLineClick:A,onRangeChanged:V=>{d.current=V}})]})]})})]})})};var kt=D(U(),1),H6=D(ef(),1);Ti();var xr=D(j(),1),cfe=ke({x:de(),y:de(),width:de(),height:de()}),ufe=ke({x:ae(de(),vt(),Ur(-1),ms(1)),y:ae(de(),vt(),Ur(-1),ms(1))}),ih=300,oh=200,U6=.95,$6=.9,ffe=768,pfe=800,dfe=600,mfe=16,hfe=16,gfe=9999,yfe=1e4,r_=e=>{try{return Ue(cfe,e)}catch{return{x:0,y:0,width:ih,height:oh}}},vfe=e=>{try{return Ue(ufe,e)}catch{return{x:1,y:1}}},mA=()=>({width:window.innerWidth,height:window.innerHeight}),bfe=(e,t)=>({width:Math.min(ih,e*.8),height:Math.min(oh,t*.8)}),Sfe=(e,t)=>({width:e*U6,height:t*$6}),wfe=e=>{let t=mA(),n=bfe(t.width,t.height),r=Sfe(t.width,t.height);return Wt(e,i=>{i.width=En(i.width,n.width,r.width),i.height=En(i.height,n.height,r.height);let o=t.width-i.width,s=t.height-i.height;i.x=En(i.x,0,o),i.y=En(i.y,0,s)})},B6=()=>{let e=mA(),t=e.width<ffe,n=t?e.width*.95:Math.min(pfe,e.width*.9),r=t?e.height*.85:Math.min(dfe,e.height*.85),i=En(n,ih,e.width*U6),o=En(r,oh,e.height*$6),s=Math.max(0,(e.width-i)/2),a=Math.max(0,(e.height-o)/2);return r_({x:s,y:a,width:i,height:o})},xfe=(e,t,n,r)=>{let i=n/3,o=n*2/3,s=r/3,a=r*2/3,l=0;e<i?l=-1:e>o&&(l=1);let c=0;return t<s?c=-1:t>a&&(c=1),l===0&&c===0&&(l=1,c=1),vfe({x:l,y:c})},Efe=(e,t)=>{(0,kt.useEffect)(()=>{let r=Ph(()=>{t(wfe(e))},100);return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r),r.cancel()}},[e,t])},z6=(e,t,n,r)=>{let i=(0,kt.useCallback)(s=>{t(s)&&e.current?.setPointerCapture(s.pointerId)},[e,t]),o=(0,kt.useCallback)(s=>{e.current?.hasPointerCapture(s.pointerId)&&e.current?.releasePointerCapture(s.pointerId),r(s)},[e,r]);return{onPointerDown:i,onPointerMove:n,onPointerUp:o}},j6=({panelState:e})=>{let t=Pe(),n=(0,kt.useRef)(null),r=(0,kt.useRef)(null),i=(0,kt.useRef)(null),[o,s]=(0,kt.useState)(()=>B6()),[a,l]=(0,kt.useState)(!1),[c,u]=(0,kt.useState)(!1),[f,p]=(0,kt.useState)(!1),[d,h]=(0,kt.useState)(null),m=(0,kt.useRef)(null),v=(0,kt.useRef)(null),g=(0,kt.useRef)({x:1,y:1});Efe(o,s),(0,kt.useLayoutEffect)(()=>{s(B6())},[]),(0,kt.useEffect)(()=>()=>{i.current&&cancelAnimationFrame(i.current)},[]);let y=(0,kt.useCallback)(()=>{t(H.actions.closePanel())},[t]),b=(0,kt.useCallback)(()=>{l(R=>!R),a&&(u(!1),p(!1),h(null))},[a]),w=(0,kt.useCallback)(R=>a||R.target.closest("button")?!1:(R.preventDefault(),R.stopPropagation(),u(!0),m.current={x:R.clientX,y:R.clientY},v.current={...o},!0),[a,o]),S=(0,kt.useMemo)(()=>Ph(R=>{!c||!m.current||!v.current||(i.current&&cancelAnimationFrame(i.current),i.current=requestAnimationFrame(()=>{let N=mA(),I=R.clientX-m.current.x,_=R.clientY-m.current.y,z=En(v.current.x+I,0,N.width-v.current.width),F=En(v.current.y+_,0,N.height-v.current.height);s(L=>r_({...L,x:z,y:F}))}))},mfe),[c]),C=(0,kt.useCallback)(()=>{c&&(u(!1),m.current=null,v.current=null)},[c]),x=(0,kt.useCallback)(R=>{if(!a)return!1;R.preventDefault(),R.stopPropagation();let N=R.clientX-o.x,I=R.clientY-o.y,_=xfe(N,I,o.width,o.height);return g.current=_,p(!0),m.current={x:R.clientX,y:R.clientY},v.current={...o},h({...o}),!0},[a,o]),E=(0,kt.useMemo)(()=>Ph(R=>{!f||!m.current||!v.current||(i.current&&cancelAnimationFrame(i.current),i.current=requestAnimationFrame(()=>{let N=mA(),I=R.clientX-m.current.x,_=R.clientY-m.current.y,z=g.current,F=v.current,L=F.x,k=F.y,K=F.width,ee=F.height;if(z.x===1)K=En(F.width+I,ih,N.width-F.x);else if(z.x===-1){let De=F.x,we=En(I,-De,F.width-ih);K=F.width-we,L=F.x+we}if(z.y===1)ee=En(F.height+_,oh,N.height-F.y);else if(z.y===-1){let De=F.y,we=En(_,-De,F.height-oh);ee=F.height-we,k=F.y+we}L<0&&(K+=L,L=0),k<0&&(ee+=k,k=0),L+K>N.width&&(K=N.width-L),k+ee>N.height&&(ee=N.height-k),K=En(K,ih,N.width),ee=En(ee,oh,N.height);let Se=r_({x:L,y:k,width:K,height:ee});h(Se)}))},hfe),[f]),T=(0,kt.useCallback)(()=>{f&&(p(!1),m.current=null,v.current=null,d&&(s(d),h(null)))},[f,d]),A=z6(r,w,S,C),M=z6(n,x,E,T);return(0,H6.createPortal)((0,xr.jsxs)(xr.Fragment,{children:[(0,xr.jsxs)("div",{ref:n,className:ge("v-diff-window",{"is-resize-mode":a,"is-dragging":c,"is-resizing":f}),style:{transform:`translate(${o.x}px, ${o.y}px)`,width:o.width,height:o.height,zIndex:gfe},...M,role:"dialog","aria-modal":"true","aria-label":"Diff View Window",children:[(0,xr.jsxs)("div",{ref:r,className:"v-diff-window-header",...A,"aria-label":"Window header, drag to move",children:[(0,xr.jsx)("div",{className:"v-diff-window-title",children:"Diff View"}),(0,xr.jsxs)("div",{className:"v-diff-window-controls",children:[(0,xr.jsx)("button",{className:ge("clickable-icon",{"is-active":a}),onClick:b,title:a?"Finish resizing":"Resize window",onPointerDown:R=>R.stopPropagation(),"aria-label":a?"Exit resize mode":"Enter resize mode","aria-pressed":a,type:"button",children:(0,xr.jsx)(J,{name:a?"check":"move-diagonal"})}),(0,xr.jsx)("button",{className:"clickable-icon",onClick:y,title:"Close window",onPointerDown:R=>R.stopPropagation(),"aria-label":"Close window",type:"button",children:(0,xr.jsx)(J,{name:"x"})})]})]}),(0,xr.jsx)("div",{className:"v-diff-window-gap"}),(0,xr.jsx)("div",{className:"v-diff-window-content",children:(0,xr.jsx)(dA,{panelState:e})}),a&&(0,xr.jsx)("div",{className:"v-resize-overlay",role:"region","aria-label":"Resize overlay - click and drag edges to resize"})]}),d&&(0,xr.jsx)("div",{className:"v-diff-window-ghost",style:{transform:`translate(${d.x}px, ${d.y}px)`,width:d.width,height:d.height,zIndex:yfe},"aria-hidden":"true"})]}),document.body)};var hA=require("obsidian"),xi=D(U(),1);var pt=D(j(),1),q6=({panelState:e})=>{let t=aA(),{settings:n,notePath:r,noteId:i,viewMode:o}=me(x=>({settings:x.app.effectiveSettings,notePath:x.app.file?.path??"",noteId:x.app.noteId,viewMode:x.app.viewMode})),[s,a]=(0,xi.useState)(!1),l=(0,xi.useRef)(null),c=(0,xi.useRef)(null),{version:u}=e,f=Il(),{data:p,isLoading:d,isError:h}=ZB({noteId:i,versionId:u.id,viewMode:o},{skip:!i}),m=Cf(),v=(0,xi.useMemo)(()=>{if(!m.searchQuery||!p)return[];let x=new RegExp(pu(m.searchQuery),m.isCaseSensitive?"g":"gi"),E=p.split(`
`),T=[];return E.forEach((A,M)=>{[...A.matchAll(x)].forEach((N,I)=>{T.push({lineIndex:M,matchIndexInLine:I})})}),T},[m.searchQuery,m.isCaseSensitive,p]),g=(0,xi.useCallback)(x=>{v.length!==0&&m.setActiveMatchIndex(E=>x==="next"?(E+1)%v.length:(E-1+v.length)%v.length)},[v.length,m.setActiveMatchIndex]);(0,xi.useEffect)(()=>{if(m.activeMatchIndex>-1&&c.current){let x=v[m.activeMatchIndex];x&&c.current.scrollToIndex({index:x.lineIndex,align:"center",behavior:"smooth"})}},[m.activeMatchIndex,v]);let y=r.endsWith(".md")&&(n.renderMarkdownInPreview||s)&&!m.isSearchActive,b=yo(),w=(0,xi.useCallback)(x=>{x.stopPropagation(),b()},[b]),S=(0,xi.useCallback)(x=>{x.stopPropagation(),a(E=>!E)},[]);(0,xi.useLayoutEffect)(()=>{if(y&&l.current&&p){let x=l.current;x.empty();try{hA.MarkdownRenderer.render(t,p,x,r,f)}catch(E){console.error("VC: Failed to render Markdown preview.",E),x.setText(p)}}},[y,p,r,t,f]);let C=u.name?`V${u.versionNumber}: ${u.name}`:`Version ${u.versionNumber}`;return(0,pt.jsx)("div",{className:"v-panel-container is-active",children:(0,pt.jsx)("div",{className:"v-inline-panel v-preview-panel",children:(0,pt.jsxs)("div",{className:"v-preview-panel-content",children:[(0,pt.jsxs)("div",{className:ge("v-panel-header",{"is-searching":m.isSearchActive}),children:[(0,pt.jsxs)("div",{className:"v-panel-header-content",children:[(0,pt.jsx)("h3",{title:`Timestamp: ${(0,hA.moment)(u.timestamp).format("LLLL")} | Size: ${u.size} bytes`,children:C}),(0,pt.jsxs)("div",{className:"v-panel-header-actions",children:[(0,pt.jsx)("button",{className:"clickable-icon","aria-label":"Search content",onClick:m.handleToggleSearch,disabled:!p,children:(0,pt.jsx)(J,{name:"search"})}),r.endsWith(".md")&&!n.renderMarkdownInPreview&&(0,pt.jsx)("button",{className:"v-action-btn v-preview-toggle-btn","aria-label":"Toggle markdown rendering",onClick:S,disabled:!p,children:(0,pt.jsx)(J,{name:s?"code":"book-open"})}),(0,pt.jsx)("button",{className:"clickable-icon v-panel-close","aria-label":"Close preview",onClick:w,children:(0,pt.jsx)(J,{name:"x"})})]})]}),(0,pt.jsx)("div",{className:"v-panel-search-bar-container",children:(0,pt.jsxs)("div",{className:"v-search-input-wrapper",children:[(0,pt.jsx)("div",{className:"v-search-icon",role:"button","aria-label":"Close search",onClick:m.handleToggleSearch,children:(0,pt.jsx)(J,{name:"x-circle"})}),(0,pt.jsx)("input",{ref:m.searchInputRef,type:"search",placeholder:"Search content...",value:m.localSearchQuery,onChange:m.handleSearchInputChange,onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),g(x.shiftKey?"prev":"next")),x.key==="Escape"&&m.handleToggleSearch()}}),(0,pt.jsxs)("div",{className:"v-search-input-buttons",children:[m.searchQuery&&v.length>0&&(0,pt.jsxs)("span",{className:"v-search-match-count",children:[m.activeMatchIndex+1," / ",v.length]}),(0,pt.jsx)("button",{className:"clickable-icon v-search-nav-button","aria-label":"Previous match",disabled:v.length===0,onClick:()=>g("prev"),children:(0,pt.jsx)(J,{name:"chevron-up"})}),(0,pt.jsx)("button",{className:"clickable-icon v-search-nav-button","aria-label":"Next match",disabled:v.length===0,onClick:()=>g("next"),children:(0,pt.jsx)(J,{name:"chevron-down"})}),(0,pt.jsx)("button",{className:ge("clickable-icon",{"is-active":m.isCaseSensitive}),"aria-label":"Toggle case sensitivity",onClick:m.toggleCaseSensitivity,children:(0,pt.jsx)(J,{name:"case-sensitive"})}),(0,pt.jsx)("button",{className:ge("clickable-icon",{"is-hidden":!m.localSearchQuery}),"aria-label":"Clear search",onClick:m.handleClearSearch,children:(0,pt.jsx)(J,{name:"x"})})]})]})})]}),(0,pt.jsxs)("div",{className:ge("v-version-content-preview",{"is-plaintext":!y}),children:[d&&(0,pt.jsxs)("div",{className:"is-loading",children:[(0,pt.jsx)("div",{className:"loading-spinner"}),(0,pt.jsx)("p",{children:"Loading content..."})]}),h&&(0,pt.jsx)("div",{className:"v-error-message",children:"Failed to load content."}),!d&&!h&&p&&(y?(0,pt.jsx)("div",{ref:l}):(0,pt.jsx)(pA,{content:p,searchQuery:m.searchQuery,isCaseSensitive:m.isCaseSensitive,scrollerRef:c,activeMatchInfo:v[m.activeMatchIndex]??null}))]})]})})})};var hp=D(U(),1);var Nn=D(j()),i_=({settings:e})=>{let t=me(s=>s.app.noteId),n=me(s=>s.app.currentBranch),r=me(s=>s.app.viewMode),[i]=nz(),o=s=>{!t||!n||i({noteId:t,branchName:n,viewMode:r,settings:{[s]:!e[s]}})};return(0,Nn.jsxs)(mi,{children:[(0,Nn.jsx)(hi,{asChild:!0,children:(0,Nn.jsx)("button",{className:"clickable-icon","aria-label":"Timeline Settings",children:(0,Nn.jsx)(J,{name:"settings-2"})})}),(0,Nn.jsx)(Vr,{children:(0,Nn.jsxs)(gi,{className:"v-actionbar-dropdown-content",sideOffset:5,collisionPadding:10,children:[(0,Nn.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:s=>{s.preventDefault(),o("showName")},children:[(0,Nn.jsx)("span",{children:"Show Name"}),e.showName&&(0,Nn.jsx)(J,{name:"check"})]}),(0,Nn.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:s=>{s.preventDefault(),o("showVersionNumber")},children:[(0,Nn.jsx)("span",{children:"Show Version Number"}),e.showVersionNumber&&(0,Nn.jsx)(J,{name:"check"})]}),(0,Nn.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:s=>{s.preventDefault(),o("showDescription")},children:[(0,Nn.jsx)("span",{children:"Show Description"}),e.showDescription&&(0,Nn.jsx)(J,{name:"check"})]}),(0,Nn.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:s=>{s.preventDefault(),o("showPreview")},children:[(0,Nn.jsx)("span",{children:"Show Preview"}),e.showPreview&&(0,Nn.jsx)(J,{name:"check"})]}),(0,Nn.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:s=>{s.preventDefault(),o("expandByDefault")},children:[(0,Nn.jsx)("span",{children:"Expand Cards by Default"}),e.expandByDefault&&(0,Nn.jsx)(J,{name:"check"})]})]})})]})};var Qe=D(j()),o_=({viewMode:e,settings:t,searchState:n,matchController:r,onNavigateMatch:i})=>{let o=Pe(),{isProcessing:s,isRenaming:a}=me(h=>({isProcessing:h.app.isProcessing,isRenaming:h.app.isRenaming})),l=s||a,c=e==="versions"?"Version Timeline":"Edit Timeline",u=e==="versions"?"Switch to Edit History":"Switch to Version History",f=()=>o(Z.toggleViewMode()),p=()=>o(Z.showBranchSwitcher()),d=()=>o(Z.openDashboard());return(0,Qe.jsxs)("div",{className:"v-timeline-header-container",children:[(0,Qe.jsxs)("div",{className:ge("v-timeline-toolbar",{"is-searching":n.isSearchActive}),children:[(0,Qe.jsxs)("div",{className:"v-timeline-toolbar-content",children:[(0,Qe.jsxs)(mi,{children:[(0,Qe.jsx)(hi,{asChild:!0,children:(0,Qe.jsx)("button",{className:"clickable-icon","aria-label":"Menu",disabled:l,children:(0,Qe.jsx)(J,{name:"menu"})})}),(0,Qe.jsx)(Vr,{children:(0,Qe.jsxs)(gi,{className:"v-actionbar-dropdown-content",sideOffset:5,collisionPadding:10,align:"start",children:[(0,Qe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:f,children:[(0,Qe.jsx)("span",{children:u}),(0,Qe.jsx)(J,{name:e==="versions"?"file-edit":"history"})]}),(0,Qe.jsx)("div",{className:"v-diff-separator"}),(0,Qe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:p,children:[(0,Qe.jsx)("span",{children:"Branches"}),(0,Qe.jsx)(J,{name:"git-branch"})]}),(0,Qe.jsxs)(ut,{className:"v-actionbar-dropdown-item",onSelect:d,children:[(0,Qe.jsx)("span",{children:"Dashboard"}),(0,Qe.jsx)(J,{name:"layout-dashboard"})]})]})})]}),(0,Qe.jsxs)("div",{className:"v-timeline-header-actions",children:[(0,Qe.jsx)("button",{className:"clickable-icon",onClick:n.handleToggleSearch,"aria-label":"Search",children:(0,Qe.jsx)(J,{name:"search"})}),(0,Qe.jsx)(i_,{settings:t})]})]}),(0,Qe.jsx)("div",{className:ge("v-search-bar-container",{"is-query-active":n.localSearchQuery.trim().length>0}),children:(0,Qe.jsxs)("div",{className:"v-search-input-wrapper",children:[(0,Qe.jsx)("div",{className:"v-search-icon",role:"button",onClick:n.handleToggleSearch,children:(0,Qe.jsx)(J,{name:"arrow-left"})}),(0,Qe.jsx)("input",{ref:n.searchInputRef,type:"search",placeholder:"Search timeline...",value:n.localSearchQuery,onChange:n.handleSearchInputChange,onKeyDown:h=>{h.key==="Enter"&&(h.preventDefault(),i(h.shiftKey?"prev":"next")),h.key==="Escape"&&n.handleToggleSearch()}}),(0,Qe.jsxs)("div",{className:"v-search-input-buttons",children:[n.searchQuery&&r.totalMatches>0&&(0,Qe.jsxs)("span",{className:"v-search-match-count",children:[r.activeIndex+1," / ",r.totalMatches]}),(0,Qe.jsx)("button",{className:"clickable-icon",disabled:r.totalMatches===0,onClick:()=>i("prev"),children:(0,Qe.jsx)(J,{name:"chevron-up"})}),(0,Qe.jsx)("button",{className:"clickable-icon",disabled:r.totalMatches===0,onClick:()=>i("next"),children:(0,Qe.jsx)(J,{name:"chevron-down"})}),(0,Qe.jsx)("button",{className:ge("clickable-icon",{"is-active":n.isCaseSensitive}),onClick:n.toggleCaseSensitivity,children:(0,Qe.jsx)(J,{name:"case-sensitive"})}),(0,Qe.jsx)("button",{className:ge("clickable-icon",{"is-hidden":!n.localSearchQuery}),onClick:n.handleClearSearch,children:(0,Qe.jsx)(J,{name:"x"})})]})]})})]}),(0,Qe.jsx)("div",{className:"v-timeline-header-title-row",children:(0,Qe.jsx)("h3",{children:c})})]})};var Zi=D(U());var G6=require("obsidian");var dt=D(j()),gA=(0,Zi.memo)(({event:e,settings:t,index:n,searchQuery:r,isCaseSensitive:i,activeMatch:o,isAutoExpanded:s,viewMode:a})=>{let[l,c]=(0,Zi.useState)(!1),[u,f]=(0,Zi.useState)("virtual"),p=(0,Zi.useRef)(null),d=(0,Zi.useRef)(void 0);(0,Zi.useEffect)(()=>{if(!t.expandByDefault){c(!1);return}let E=n%15*40;return d.current=setTimeout(()=>{c(!0)},E),()=>{d.current&&clearTimeout(d.current)}},[t.expandByDefault,n]),(0,Zi.useEffect)(()=>{s?(c(!0),f("static")):u==="static"&&(c(!1),f("virtual"))},[s,u]);let h=(0,Zi.useMemo)(()=>(0,G6.moment)(e.timestamp).format("MMM D, YYYY h:mm A"),[e.timestamp]),m=E=>{E.stopPropagation(),c(T=>{let A=!T;return u==="static"&&f("virtual"),A})},v=t.showVersionNumber,g=t.showName&&!!e.toVersionName,y=t.showDescription,b=!g&&!v,w={query:r,caseSensitive:i},S=a==="edits"?"E":"V",C=!l&&t.showPreview&&(!y||!e.toVersionDescription),x=(0,Zi.useMemo)(()=>{if(!C)return null;let A=Su(e.diffData,"smart").filter(M=>M.type==="add"||M.type==="remove").slice(0,3);return A.length===0?null:A.map(M=>({key:M.key,content:M.content,type:M.type}))},[e.diffData,C]);return(0,dt.jsxs)("div",{className:ge("v-timeline-card",{"is-expanded":l,"has-active-match":!!o}),onClick:m,children:[(0,dt.jsx)("div",{className:"v-timeline-card-header",children:(0,dt.jsxs)("div",{className:"v-timeline-content-column",children:[(0,dt.jsxs)("div",{className:"v-timeline-header-row",children:[(0,dt.jsxs)("div",{className:ge("v-timeline-header-left",{"is-collapsed":b}),children:[v&&(0,dt.jsxs)("span",{className:"v-timeline-version-badge",children:[S,e.toVersionNumber]}),g&&(0,dt.jsx)("span",{className:"v-timeline-title",children:(0,dt.jsx)(Gt,{text:e.toVersionName||"",...w})})]}),(0,dt.jsx)("div",{className:ge("v-timeline-spacer",{"is-collapsed":b})}),(0,dt.jsx)("span",{className:ge("v-timeline-time",{"is-focused":b}),children:(0,dt.jsx)(Gt,{text:h,...w})})]}),(0,dt.jsx)("div",{className:"v-timeline-stats-row",children:(0,dt.jsxs)("div",{className:"v-timeline-stats",children:[(0,dt.jsxs)("span",{className:"v-stat-add",title:"Additions",children:["+",(0,dt.jsx)(Gt,{text:String(e.stats.additions),...w})]}),(0,dt.jsxs)("span",{className:"v-stat-del",title:"Deletions",children:["-",(0,dt.jsx)(Gt,{text:String(e.stats.deletions),...w})]})]})}),!l&&(0,dt.jsxs)(dt.Fragment,{children:[y&&e.toVersionDescription&&(0,dt.jsx)("div",{className:"v-timeline-description",children:(0,dt.jsx)(Gt,{text:e.toVersionDescription,...w})}),C&&x&&x.length>0&&(0,dt.jsx)("div",{className:"v-timeline-diff-preview",children:x.map(E=>(0,dt.jsxs)("div",{className:ge("v-timeline-preview-line",{"v-preview-add":E.type==="add","v-preview-remove":E.type==="remove"}),children:[(0,dt.jsx)("span",{className:"v-timeline-preview-marker",children:E.type==="add"?"+":E.type==="remove"?"-":""}),(0,dt.jsx)("span",{className:"v-timeline-preview-text",children:(0,dt.jsx)(Gt,{text:E.content,...w})})]},E.key))})]})]})}),(0,dt.jsx)(Xv,{initial:!1,children:l&&(0,dt.jsx)(Fr.div,{className:"v-timeline-card-diff-container",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:[.04,.62,.23,.98]},onClick:E=>E.stopPropagation(),children:(0,dt.jsxs)("div",{className:"v-timeline-diff-inner",children:[y&&e.toVersionDescription&&(0,dt.jsx)("div",{className:"v-timeline-description",style:{marginBottom:"var(--size-4-2)"},children:(0,dt.jsx)(Gt,{text:e.toVersionDescription,...w})}),(0,dt.jsx)("div",{className:"v-timeline-diff-content",children:u==="static"?(0,dt.jsx)(Db,{changes:e.diffData,diffType:"smart",activeMatchInfo:o?.type==="diff"?{lineIndex:o.lineIndex??0,matchIndexInLine:o.matchIndexInLine??0}:null,searchQuery:r,isCaseSensitive:i}):(0,dt.jsx)(mp,{changes:e.diffData,diffType:"smart",virtuosoHandleRef:p,activeMatchInfo:o?.type==="diff"?{lineIndex:o.lineIndex??0,matchIndexInLine:o.matchIndexInLine??0}:null,activeUnifiedMatchIndex:-1,searchQuery:r,isCaseSensitive:i,highlightedIndex:o?.type==="diff"?o.lineIndex??null:null})})]})})})]})});gA.displayName="TimelineEvent";var sh=D(j()),s_=({isLoading:e})=>e?(0,sh.jsxs)(Fr.div,{className:"v-timeline-loading",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,sh.jsx)("div",{className:"loading-spinner"}),(0,sh.jsx)("p",{children:"Loading timeline..."})]}):(0,sh.jsx)(Fr.div,{className:"v-timeline-empty",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},children:"No history events found."});var Eu=D(U());var a_=e=>e?[...e].reverse():[];var K6=require("obsidian");var l_=(e,t,n)=>{if(!t||!e.length)return[];let r=[],i=new RegExp(pu(t),n?"g":"gi");return e.forEach((o,s)=>{let a=[o.toVersionName,`V${o.toVersionNumber}`,o.toVersionDescription,(0,K6.moment)(o.timestamp).format("MMM D, YYYY h:mm A"),String(o.stats.additions),String(o.stats.deletions)],l=!1;for(let u of a)if(u&&i.test(u)){l=!0;break}l&&r.push({eventIndex:s,type:"metadata"}),Su(o.diffData,"smart").forEach((u,f)=>{if(u.type==="collapsed")return;i.lastIndex=0,[...u.content.matchAll(i)].forEach((d,h)=>{r.push({eventIndex:s,type:"diff",lineIndex:f,matchIndexInLine:h})})})}),r};var c_=(e,t,n)=>{let[r,i]=(0,Eu.useState)({matches:[],activeIndex:-1,isLoading:!1}),o=(0,Eu.useRef)(0);(0,Eu.useEffect)(()=>{if(!t||!e.length){i({matches:[],activeIndex:-1,isLoading:!1});return}i(u=>({...u,isLoading:!0}));let a=++o.current,l=!1,c=requestAnimationFrame(()=>{if(l||a!==o.current)return;let u=l_(e,t,n);i({matches:u,activeIndex:u.length>0?0:-1,isLoading:!1})});return()=>{l=!0,cancelAnimationFrame(c),a===o.current&&(o.current=0)}},[e,t,n]);let s=(0,Eu.useCallback)((a,l)=>{i(c=>{if(c.matches.length===0)return c;let u;if(a==="specific"&&l!==void 0)u=Math.max(0,Math.min(l,c.matches.length-1));else{let f=a==="next"?1:-1;u=(c.activeIndex+f+c.matches.length)%c.matches.length}return{...c,activeIndex:u}})},[]);return{matches:r.matches,activeMatch:r.matches[r.activeIndex]||null,activeIndex:r.activeIndex,isLoading:r.isLoading,navigateToMatch:s,totalMatches:r.matches.length}};var yA=D(U()),u_=e=>{let t=(0,yA.useRef)(null);return(0,yA.useEffect)(()=>{if(e&&t.current){let r=setTimeout(()=>{t.current?.scrollToIndex({index:e.eventIndex,align:"start",behavior:"auto",offset:-20})},0);return()=>clearTimeout(r)}},[e]),{virtuosoRef:t,scrollToIndex:r=>{t.current?.scrollToIndex({index:r,align:"start",behavior:"auto"})}}};var ea=D(j(),1),W6=({panelState:e})=>{let t=me(m=>m.app.noteId),n=me(m=>m.app.currentBranch),r=me(m=>m.app.viewMode),{data:i,isLoading:o}=tz({noteId:t,branchName:n,viewMode:r},{skip:!t||!n}),s=i?.events??null,a=i?.settings??{showDescription:!1,showName:!0,showVersionNumber:!0,showPreview:!0,expandByDefault:!1},l=yo(),c=xf(l),u=Cf(),f=(0,hp.useMemo)(()=>a_(s),[s]),p=c_(f,u.searchQuery,u.isCaseSensitive),{virtuosoRef:d}=u_(p.activeMatch);(0,hp.useEffect)(()=>{p.activeIndex>=0&&u.setActiveMatchIndex(p.activeIndex)},[p.activeIndex,u]);let h=(0,hp.useCallback)(m=>{p.navigateToMatch(m)},[p]);return(0,hp.useEffect)(()=>{let m=v=>{u.isSearchActive&&(v.key==="Enter"&&!v.shiftKey?(v.preventDefault(),h("next")):v.key==="Enter"&&v.shiftKey&&(v.preventDefault(),h("prev")))};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[u.isSearchActive,h]),(0,ea.jsx)("div",{className:"v-panel-container is-active is-timeline-container",onClick:c,children:(0,ea.jsxs)(Fr.div,{className:"v-inline-panel v-timeline-panel",initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},transition:{duration:.2},children:[(0,ea.jsx)(o_,{viewMode:r,settings:a,searchState:{isSearchActive:u.isSearchActive,searchQuery:u.searchQuery,localSearchQuery:u.localSearchQuery,isCaseSensitive:u.isCaseSensitive,searchInputRef:u.searchInputRef,handleToggleSearch:u.handleToggleSearch,handleSearchInputChange:u.handleSearchInputChange,handleClearSearch:u.handleClearSearch,toggleCaseSensitivity:u.toggleCaseSensitivity},matchController:{activeIndex:p.activeIndex,totalMatches:p.totalMatches},onNavigateMatch:h}),(0,ea.jsx)("div",{className:"v-timeline-content",children:s===null||f.length===0&&!o?(0,ea.jsx)(s_,{isLoading:o}):(0,ea.jsx)("div",{className:"v-timeline-list-container",children:(0,ea.jsx)(Qs,{ref:d,className:"v-virtuoso-container",data:f,itemContent:(m,v)=>(0,ea.jsx)(Fr.div,{className:"v-timeline-item-wrapper",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.15,ease:"easeOut"},children:(0,ea.jsx)(gA,{event:v,settings:a,index:m,searchQuery:u.searchQuery,isCaseSensitive:u.isCaseSensitive,activeMatch:p.activeMatch&&p.activeMatch.eventIndex===m?p.activeMatch:null,isAutoExpanded:u.isSearchActive&&p.activeMatch?.eventIndex===m&&p.activeMatch?.type==="diff",viewMode:r},`${v.timestamp}-${m}`)}),increaseViewportBy:300})})})]})})};var cs=D(U(),1);function pr(){return pr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pr.apply(null,arguments)}function Cu(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var sZe=D(U());var ls=D(U());var vA=D(U()),f_=D(j()),p_={textAnchor:"middle",fontSize:"inherit",fill:"currentColor"},Y6=e=>{var{weekLabels:t=[],rectSize:n=0,topPad:r=0,space:i=0}=e;return(0,vA.useMemo)(()=>(0,f_.jsx)(vA.Fragment,{children:[...Array(7)].map((o,s)=>t&&t[s]?(0,f_.jsx)("text",{className:"w-heatmap-week",x:15,y:r,dy:(s+1)*(n+i)-5,style:p_,children:t[s]},s):null)}),[n,i,r,t])};var bA=D(U());var gp=864e5;function d_(e){return e instanceof Date&&!isNaN(e.getTime())}function m_(e){return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()}function Q6(e){e===void 0&&(e=[]);var t={};return e.forEach(n=>{n.date&&d_(new Date(n.date))&&(n.date=m_(new Date(n.date)),t[n.date]=n)}),t}function X6(e){return e===void 0&&(e=[]),e.sort((t,n)=>t<n?-1:t>n?1:0)}function Z6(e,t,n){e===void 0&&(e=0),n===void 0&&(n={});for(var r="",i=0;i<t.length;i+=1){if(t[i]>e){r=n[t[i]];break}r=n[t[i]]}return r}var J6=(e,t)=>{var n=Math.ceil(t/(e.length-1)),r={};return e.forEach((i,o)=>{r[o*n]=i}),r};var h_=D(j()),Cfe=(e,t,n,r)=>t===!1||e<1?[]:Array.from({length:e*7}).map((i,o)=>{if(o/7%1===0){var s=new Date(n.getTime()+o*gp),a=s.getMonth();return r&&s>r?null:{col:o/7,index:o,month:a,day:s.getDate(),monthStr:t[a],date:s}}return null}).filter(Boolean).filter((i,o,s)=>s[o-1]&&s[o-1].month!==i.month),eQ=e=>{var{monthLabels:t=[],rectSize:n=0,space:r=0,leftPad:i=0,colNum:o=0,rectY:s=15,startDate:a,endDate:l}=e,c=(0,bA.useMemo)(()=>Cfe(o,t,a,l),[o,t,a,l]);return(0,h_.jsx)(bA.Fragment,{children:c.map((u,f)=>(0,h_.jsx)("text",{"data-size":n,x:i+r+r,y:s,dx:u.col*(n+r),textAnchor:"start",style:p_,children:u.monthStr},f))})};var ah=D(U());var tQ=D(U()),nQ=D(j()),Tfe=["style","value","render","key"];var SA=e=>{var{style:t,value:n,render:r}=e,i=Cu(e,Tfe),o=pr({},i,{style:pr({display:"block",cursor:"pointer"},t)});if(r&&typeof r=="function"){var s=r(pr({},o),n);if(s&&tQ.default.isValidElement(s))return s}return(0,nQ.jsx)("rect",pr({},o))};var rQ=D(j()),Afe=["panelColors","leftPad","topPad","rectY","space","rectSize","legendCellSize","legendRender"];function g_(e){var{panelColors:t,leftPad:n=0,topPad:r=0,rectY:i=15,space:o=0,rectSize:s=0,legendCellSize:a=0,legendRender:l}=e,c=Cu(e,Afe),u=a||s;return(0,ah.useMemo)(()=>(0,rQ.jsx)(ah.Fragment,{children:Object.keys(t||{}).map((f,p)=>{var d=pr({},c,{key:p,x:(u+1)*p+n,y:i,fill:t[Number(f)],width:u,height:u});return l?l(d):(0,ah.createElement)(SA,pr({},d,{key:p}))})}),[t,c,u,i,n,s,l])}var Ib=D(U());var y_=D(j()),iQ=e=>{var{transform:t,gridNum:n=0,startY:r=0,panelColors:i={},initStartDate:o,space:s=2,value:a=[],rectSize:l=11,endDate:c,rectProps:u,rectRender:f}=e,p=(0,Ib.useMemo)(()=>Q6(a),[a]),d=(0,Ib.useMemo)(()=>X6(Object.keys(i).map(h=>parseInt(h,10))),[i]);return(0,y_.jsx)("g",{transform:t,children:n>0&&[...Array(n)].map((h,m)=>(0,y_.jsx)("g",{"data-column":m,children:[...Array(7)].map((v,g)=>{var y=new Date(o.getTime()+gp*(m*7+g)),b=m_(y),w=pr({},p[b],{date:b,row:g,column:m,index:m*7+g}),S=pr({},u,{fill:"var(--rhm-rect, #EBEDF0)",width:l,height:l,x:m*(l+s),y:(l+s)*g,render:f,value:w});return c instanceof Date&&y.getTime()>c.getTime()?null:(b&&p[b]&&i&&Object.keys(i).length>0?S.fill=Z6(p[b].count||0,d,i):i&&i[0]&&(S.fill=i[0]),(0,Ib.createElement)(SA,pr({},S,{key:g,value:w,"data-date":b,"data-index":w.index,"data-row":w.row,"data-column":w.column})))})},m))})};var yp=D(j()),Mfe=["rectSize","legendCellSize","space","monthPlacement","startDate","endDate","rectProps","rectRender","legendRender","value","weekLabels","monthLabels","panelColors","style"];function v_(e){var t=e||{},{rectSize:n=11,legendCellSize:r=11,space:i=2,monthPlacement:o="top",startDate:s=new Date,endDate:a,rectProps:l,rectRender:c,legendRender:u,value:f=[],weekLabels:p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthLabels:d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],panelColors:h=["var(--rhm-rect, #EBEDF0)","#C6E48B","#7BC96F","#239A3B","#196127"],style:m}=t,v=Cu(t,Mfe),g=Math.max(...f.map(_=>_.count),0),y=Array.isArray(h)?J6(h,g):h,[b,w]=(0,ls.useState)(0),[S,C]=(0,ls.useState)(p?28:5),x=o==="top"?20:5,[E,T]=(0,ls.useState)(d?x:5),A=ls.default.createRef();(0,ls.useEffect)(()=>C(p?28:5),[p]),(0,ls.useEffect)(()=>{if(A.current){var _=A.current.clientWidth-S||0;w(Math.floor(_/(n+i))||0)}},[n,A,i,S]),(0,ls.useEffect)(()=>{T(d?x:5)},[d]);var M=(0,ls.useMemo)(()=>{if(d_(s))return s.getDay()?new Date(s.getTime()-s.getDay()*gp):s;var _=new Date;return new Date(_.getTime()-_.getDay()*gp)},[s]),R={color:"var(--rhm-text-color, #24292e)",userSelect:"none",display:"block",fontSize:10},N=o==="top"?15:105+i,I=o==="top"?E+n*8+6:(d?E+n+i:E)+n*8+6;return(0,yp.jsxs)("svg",pr({ref:A,style:pr({},R,m)},v,{children:[r!==0&&(0,yp.jsx)(g_,{legendRender:u,panelColors:y,rectSize:n,rectY:I,legendCellSize:r,leftPad:S,topPad:E,space:i}),(0,yp.jsx)(Y6,{weekLabels:p,rectSize:n,space:i,topPad:E}),(0,yp.jsx)(eQ,{monthLabels:d,rectSize:n,space:i,leftPad:S,colNum:b,rectY:N,startDate:M,endDate:a}),(0,yp.jsx)(iQ,{transform:"translate("+S+", "+E+")",gridNum:b,initStartDate:M,endDate:a,rectProps:l,rectSize:n,rectRender:c,panelColors:y,value:f,space:i})]}))}var oQ=D(j()),Rfe=["prefixCls","className"];function b_(e){var{prefixCls:t="w-heatmap",className:n}=e,r=Cu(e,Rfe),i=[n,t].filter(Boolean).join(" ");return(0,oQ.jsx)(v_,pr({className:i},r))}var wA=require("obsidian"),ni=D(j(),1),S_={0:"var(--background-modifier-border)",1:"rgba(108, 92, 231, 0.15)",3:"rgba(108, 92, 231, 0.25)",6:"rgba(108, 92, 231, 0.35)",9:"rgba(108, 92, 231, 0.45)",12:"rgba(108, 92, 231, 0.55)",15:"rgba(108, 92, 231, 0.65)",20:"rgba(108, 92, 231, 0.75)",30:"rgba(108, 92, 231, 0.85)",40:"rgba(108, 92, 231, 0.95)",50:"var(--interactive-accent)"},sQ=()=>{let e=Pe(),t=me(h=>h.app.noteId),n=me(h=>h.app.viewMode),r=Il(),{data:i=[]}=vc(t??"",{skip:!t||n!=="versions"}),{data:o=[]}=bc(t??"",{skip:!t||n!=="edits"}),s=(0,cs.useRef)(null),a=(0,cs.useRef)(null),l=(0,cs.useMemo)(()=>{let h=n==="versions"?i:o,m={};return h.forEach(v=>{let g=(0,wA.moment)(v.timestamp).format("YYYY/MM/DD");m[g]=(m[g]||0)+1}),Object.entries(m).map(([v,g])=>({date:v,count:g}))},[i,o,n]),c=(0,cs.useMemo)(()=>(0,wA.moment)().subtract(2,"months").startOf("month").toDate(),[]),u=(0,cs.useMemo)(()=>(0,wA.moment)().endOf("day").toDate(),[]);(0,cs.useEffect)(()=>{let h=m=>{a.current&&!a.current.contains(m.target)&&e(H.actions.closePanel())};r.registerDomEvent(document,"mousedown",h)},[e,r]),(0,cs.useLayoutEffect)(()=>{s.current&&(s.current.scrollLeft=s.current.scrollWidth)},[l,n]);let f=n==="versions"?"Version History Dashboard":"Edit History Dashboard",p=(0,cs.useMemo)(()=>{let h=Object.keys(S_).map(Number).sort((m,v)=>m-v);return h.map((m,v)=>{let g=`${m}`;return v===h.length-1&&(g=`>= ${m}`),{color:S_[m],label:g,key:m}})},[]);return(0,ni.jsx)("div",{className:"v-panel-container is-dashboard-like is-active",children:(0,ni.jsx)("div",{className:"v-inline-panel is-dashboard",ref:a,children:(0,ni.jsxs)("div",{className:"v-dashboard-card",children:[(0,ni.jsx)("div",{className:"v-dashboard-header",children:(0,ni.jsx)("h3",{children:f})}),(0,ni.jsxs)("div",{className:"v-dashboard-body",children:[(0,ni.jsx)("div",{className:"v-dashboard-labels",children:[{label:"",key:"sun"},{label:"Mon",key:"mon"},{label:"",key:"tue"},{label:"Wed",key:"wed"},{label:"",key:"thu"},{label:"Fri",key:"fri"},{label:"",key:"sat"}].map(h=>(0,ni.jsx)("div",{className:"v-dashboard-label-item",children:h.label},h.key))}),(0,ni.jsx)("div",{className:"v-dashboard-heatmap-wrapper",ref:s,style:{overflowX:"auto"},children:(0,ni.jsx)(b_,{value:l,startDate:c,endDate:u,monthLabels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],rectSize:14,space:4,legendCellSize:0,rectProps:{rx:2.5},panelColors:S_,weekLabels:["","","","","","",""],style:{color:"var(--text-muted)"}})})]}),(0,ni.jsx)("div",{className:"v-dashboard-legend",children:p.map(h=>(0,ni.jsxs)("div",{className:"v-legend-item",children:[(0,ni.jsx)("div",{className:"v-legend-color",style:{backgroundColor:h.color}}),(0,ni.jsx)("span",{children:h.label})]},h.key))})]})})})};var us=D(j(),1),w_=e=>{switch(e.type){case"preview":return(0,us.jsx)(q6,{panelState:e});case"diff":return e.renderMode==="window"?null:(0,us.jsx)(dA,{panelState:e});case"confirmation":return(0,us.jsx)(P6,{panelState:e});case"action":return(0,us.jsx)(R6,{panelState:e});case"changelog":return(0,us.jsx)(D6,{panelState:e});case"timeline":return(0,us.jsx)(W6,{panelState:e});case"dashboard":return(0,us.jsx)(sQ,{});default:return null}},aQ=()=>{let e=me(t=>t.app.panel);return!e||e.type==="settings"?null:e.type==="stacked"?(0,us.jsxs)(us.Fragment,{children:[w_(e.base),w_(e.overlay)]}):w_(e)};var xA=D(U(),1);var Ht=D(j(),1),lQ=()=>{let e=Pe(),[t,n]=(0,xA.useState)("general"),r=me(a=>a.app.settings.versionHistorySettings),i=me(a=>a.app.settings.editHistorySettings),o=(0,xA.useCallback)(a=>{n(a),a==="versions"?(e(H.actions.setViewMode("versions")),e(H.actions.updateEffectiveSettings({...r,isGlobal:!0}))):a==="edits"&&(e(H.actions.setViewMode("edits")),e(H.actions.updateEffectiveSettings({...i,isGlobal:!0})))},[e,r,i]);return(0,Ht.jsxs)("div",{className:"v-settings-tab-content",children:[(0,Ht.jsx)("div",{className:"v-settings-tab-header",children:(0,Ht.jsxs)(mi,{children:[(0,Ht.jsx)(hi,{asChild:!0,children:(0,Ht.jsxs)("button",{className:"v-settings-nav-button",children:[(0,Ht.jsx)("span",{children:(a=>{switch(a){case"general":return"General";case"versions":return"Version History";case"edits":return"Edit History"}})(t)}),(0,Ht.jsx)(J,{name:"chevron-down"})]})}),(0,Ht.jsx)(Vr,{children:(0,Ht.jsxs)(gi,{className:"v-dropdown-content",align:"start",sideOffset:5,children:[(0,Ht.jsx)(ut,{className:"v-dropdown-item",onClick:()=>o("general"),children:"General"}),(0,Ht.jsx)(ut,{className:"v-dropdown-item",onClick:()=>o("versions"),children:"Version History"}),(0,Ht.jsx)(ut,{className:"v-dropdown-item",onClick:()=>o("edits"),children:"Edit History"})]})})]})}),t==="general"&&(0,Ht.jsx)("div",{role:"tabpanel",id:"tab-panel-general",children:(0,Ht.jsx)(Jm,{showTitle:!1,showDefaults:!1})}),t==="versions"&&(0,Ht.jsxs)("div",{role:"tabpanel",id:"tab-panel-versions",className:"v-settings-section",children:[(0,Ht.jsx)("h2",{children:"Global Version History Defaults"}),(0,Ht.jsx)("p",{className:"setting-item-description",children:"These settings apply to all notes using Version History unless overridden by specific note settings."}),(0,Ht.jsx)("div",{style:{marginBottom:"var(--size-4-4)"},children:(0,Ht.jsx)(dp,{settingKey:"versionHistorySettings"})}),(0,Ht.jsx)(eh,{disabled:!1})]}),t==="edits"&&(0,Ht.jsxs)("div",{role:"tabpanel",id:"tab-panel-edits",className:"v-settings-section",children:[(0,Ht.jsx)("h2",{children:"Global Edit History Defaults"}),(0,Ht.jsx)("p",{className:"setting-item-description",children:"These settings apply to all notes using Edit History unless overridden by specific note settings."}),(0,Ht.jsx)("div",{style:{marginBottom:"var(--size-4-4)"},children:(0,Ht.jsx)(dp,{settingKey:"editHistorySettings"})}),(0,Ht.jsx)(eh,{disabled:!1})]})]})};var Dn=D(j(),1),cQ=()=>{let e=Pe(),{status:t,error:n,panel:r,isProcessing:i,isRenaming:o,viewMode:s,noteId:a,currentBranch:l}=me(R=>({status:R.app.status,error:R.app.error,panel:R.app.panel,isProcessing:R.app.isProcessing,isRenaming:R.app.isRenaming,viewMode:R.app.viewMode,noteId:R.app.noteId,currentBranch:R.app.currentBranch})),[c,u]=(0,fs.useState)({filtered:0,total:0}),f=(0,fs.useRef)(null),p=(0,fs.useRef)(null),d=!!a&&(t==="READY"||t==="LOADING"),{data:h,isLoading:m}=$x(a,{skip:!d}),g=a&&(a?h:void 0)?.currentBranch||l||"main",{data:y,isLoading:b,isError:w}=ez({noteId:a,viewMode:s,branchName:g},{skip:!d});(0,fs.useEffect)(()=>{y?e(H.actions.updateEffectiveSettings(y)):w&&e(H.actions.setStatus("READY"))},[y,w,e]);let S=d&&(m||b||!y&&!w),C=(0,fs.useCallback)(()=>{t!=="READY"||i||o||S||e(s==="versions"?Z.saveNewVersion({}):Z.saveNewEdit())},[e,t,i,o,s,S]),x=(0,fs.useCallback)((R,N)=>{u({filtered:R,total:N})},[]);(0,fs.useLayoutEffect)(()=>{let R=f.current,N=p.current;if(R&&N){let I=()=>{N.style.paddingTop=`${R.offsetHeight}px`},_=new ResizeObserver(I);return _.observe(R),I(),()=>_.disconnect()}return()=>{}},[t,S]);let E=r!==null&&!(r.type==="diff"&&r.renderMode==="window"),T=ge("version-control-content",{"is-overlay-active":E},{"is-processing":i||o}),A=s==="versions"?"Save a new version":"Save a new edit";return(0,Dn.jsxs)("div",{className:T,children:[(()=>{switch(t){case"INITIALIZING":return(0,Dn.jsx)(lp,{title:"Initializing version control...",iconName:"sync"});case"PLACEHOLDER":return(0,Dn.jsx)(lp,{});case"ERROR":return n?(0,Dn.jsx)(K3,{error:n}):(0,Dn.jsx)(lp,{title:"An unknown error occurred.",iconName:"alert-circle"});case"LOADING":case"READY":return S?(0,Dn.jsx)(lp,{title:"Loading settings...",iconName:"loader"}):(0,Dn.jsxs)(Dn.Fragment,{children:[(0,Dn.jsxs)("div",{ref:f,className:"v-header-wrapper",children:[(0,Dn.jsx)(q3,{}),(0,Dn.jsx)(p1,{status:t,filteredCount:c.filtered,totalCount:c.total})]}),(0,Dn.jsxs)("div",{ref:p,className:"v-main",children:[(0,Dn.jsx)("div",{className:"v-ready-state-container",children:(0,Dn.jsx)(AY,{onCountChange:x},s)}),(0,Dn.jsx)("button",{className:"v-fab-save-button","aria-label":A,onClick:C,disabled:i||o,title:A,children:(0,Dn.jsx)(J,{name:"plus"})})]}),(0,Dn.jsx)(Z1,{})]});default:return(0,Dn.jsx)(lp,{title:"An unexpected error occurred in the view.",iconName:"alert-circle"})}})(),(0,Dn.jsx)(aQ,{}),r?.type==="diff"&&r.renderMode==="window"&&(0,Dn.jsx)(j6,{panelState:r})]})};var lh=D(j()),EA=class extends uQ.ItemView{constructor(n,r){super(n);this.store=r;P(this,"reactRoot",null);this.icon="history",this.register(()=>this.cleanup())}getViewType(){return Ep}getDisplayText(){return"Version control"}async onOpen(){this.contentEl.empty(),this.contentEl.addClass("version-control-view");let n=this.contentEl.createDiv({cls:"version-control-react-root"});this.app.workspace.onLayoutReady(()=>{queueMicrotask(()=>this.mountReact(n))})}mountReact(n){if(!(this.reactRoot||!this.contentEl.isConnected||!this.contentEl.contains(n)))try{this.reactRoot=(0,fQ.createRoot)(n),this.reactRoot.render((0,lh.jsx)(pQ.StrictMode,{children:(0,lh.jsx)(Gh,{store:this.store,children:(0,lh.jsx)(Nb.Provider,{value:this.app,children:(0,lh.jsx)(Ak,{children:(0,lh.jsx)(cQ,{})})})})}))}catch(r){console.error("Version Control: React Mount Error",r),n.createEl("div",{text:"Failed to load version control view. Check console.",cls:"version-control-error"})}}async onClose(){return await this.cleanup(),this.contentEl.empty(),super.onClose()}async cleanup(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=null),this.store&&(this.store.getState().app.panel?.type!=="changelog"&&this.store.dispatch(H.actions.closePanel()),this.store.dispatch(H.actions.clearDiffRequest()),this.store.dispatch(H.actions.toggleSearch(!1)))}};function E_(e,t){e.registerView(Ep,n=>new EA(n,t))}function C_(e,t){e.addRibbonIcon("history","Open version control",n=>{mQ(e,t)})}function CA(e,t){e.addCommand({id:"open-version-control-view",name:"Open version control view",callback:()=>mQ(e,t)}),e.addCommand({id:"save-new-version",name:"Save a new version of the current note",checkCallback:n=>{let r=e.app.workspace.getActiveFile();return dQ(r)?(n||t.dispatch(Z.saveNewVersion({})),!0):!1}}),e.addCommand({id:"save-new-edit",name:"Save a new edit of the current note",checkCallback:n=>{let r=e.app.workspace.getActiveFile();return dQ(r)?(n||t.dispatch(Z.saveNewEdit()),!0):!1}}),e.addCommand({id:"cleanup-orphaned-versions",name:"Clean up orphaned version data",callback:()=>t.dispatch(Z.cleanupOrphanedVersions())})}function dQ(e){return!!(e&&(e.extension==="md"||e.extension==="base"))}async function mQ(e,t){let n=Nfe(e.app.workspace);e.app.workspace.onLayoutReady(()=>{t.dispatch(Z.initializeView(n||void 0))});let r=Dfe(e.app.workspace),o=e.app.workspace.getLeavesOfType(Ep).find(a=>a.view?.containerEl?.ownerDocument===r);if(o){await e.app.workspace.revealLeaf(o);return}let s=await Ife(e.app.workspace,r);s?(await s.setViewState({type:Ep,active:!0}),e.app.workspace.revealLeaf(s)):(console.error("Version Control: Failed to create leaf"),t.dispatch(Z.showNotice("Error: Could not open version control view. Please try again.",5e3)))}function Nfe(e){let t=e.getMostRecentLeaf();return t?.view instanceof x_.FileView?t:e.getActiveViewOfType(x_.FileView)?.leaf??null}function Dfe(e){return e.getLeaf(!1)?.view?.containerEl?.ownerDocument??document}async function Ife(e,t){if(t===document){let n=e.getRightLeaf(!1);if(n)return n}else{let n=e.getLeaf("split","vertical");if(n)return n}return e.getLeaf(!0)}var hQ=require("obsidian"),gQ=D(RE());var yQ=D(U());var Ob=D(j()),TA=class extends hQ.PluginSettingTab{constructor(n,r,i){super(n,r);P(this,"store");P(this,"reactRoot",null);this.store=i}display(){let{containerEl:n}=this;n.empty(),n.addClass("version-control-settings-tab"),this.reactRoot=(0,gQ.createRoot)(n),this.reactRoot.render((0,Ob.jsx)(yQ.StrictMode,{children:(0,Ob.jsx)(Gh,{store:this.store,children:(0,Ob.jsx)(Nb.Provider,{value:this.app,children:(0,Ob.jsx)(lQ,{})})})}))}hide(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=null)}};var a9=D(s9()),l9=(e,t)=>(0,a9.compare)(e,t);var zb=class{constructor(t,n){this.plugin=t;this.store=n}registerUIComponents(){try{this.plugin.addSettingTab(new TA(this.plugin.app,this.plugin,this.store)),E_(this.plugin,this.store),C_(this.plugin,this.store),CA(this.plugin,this.store)}catch(t){let n=t instanceof Error?t.message:"Unknown error";throw console.error("Version Control: UI component registration failed",t),new Error(`UI component registration failed: ${n}`)}}initializeView(){try{this.store.dispatch(Z.initializeView())}catch(t){console.error("Version Control: View initialization failed",t),new c9.Notice("Failed to initialize view. Please check the console for details.")}}async checkForUpdates(){try{let t=this.plugin.manifest.version,n=this.plugin.settings.version||"0.0.0";l9(t,n)>0&&this.store.dispatch(Z.showChangelogPanel({forceRefresh:!0,isManualRequest:!1}))}catch(t){console.error("Version Control: Update check failed",t)}}};var u9=require("obsidian");var Hb=class{constructor(t,n,r){this.plugin=t;this.store=n;this.eventBus=r}setupEventListeners(){try{jN(this.plugin,this.store);let t=n=>{if(!this.plugin.isUnloading)try{let r=this.store.getState();r.app.status==="READY"&&r.app.noteId===n&&r.app.file&&this.store.dispatch(Z.loadHistory(r.app.file))}catch(r){console.error("Version Control: Error in version deleted handler",r)}};this.eventBus.on("version-deleted",t),this.plugin.register(()=>this.eventBus.off("version-deleted",t))}catch(t){let n=t instanceof Error?t.message:"Unknown error";throw console.error("Version Control: Event listener setup failed",t),new Error(`Event listener setup failed: ${n}`)}}};var Ub=class{constructor(t){this.plugin=t}async load(){if(this.plugin.initialized){console.warn("Version Control: Plugin already initialized, skipping onload");return}this.plugin.isUnloading=!1,this.plugin.queuedChangelogRequest=null;try{if(await new Ju(this.plugin).loadSettings(),this.plugin.isUnloading)return;let n=new Jg(this.plugin),r=n.initializeServices();this.plugin.services=r;let i=vS(this.plugin.settings);r.store=SN(i,r),r.finalizeInitialization(),this.plugin.store=r.store,this.plugin.cleanupManager=r.cleanupManager,this.plugin.backgroundTaskManager=r.backgroundTaskManager,this.plugin.register(this.plugin.store.subscribe(this.plugin.handleStoreChange.bind(this.plugin)));let o=new zb(this.plugin,r.store);o.registerUIComponents();try{r.cleanupManager.initialize()}catch(a){console.error("Version Control: Cleanup manager failed to initialize (non-fatal)",a)}this.plugin.addChild(r.cleanupManager),this.plugin.addChild(r.uiService),this.plugin.addChild(r.diffManager),this.plugin.addChild(r.backgroundTaskManager),await n.initializeDatabase(r),new Hb(this.plugin,r.store,r.eventBus).setupEventListeners(),this.plugin.app.workspace.onLayoutReady(()=>{if(this.plugin.isUnloading)return;(window.requestIdleCallback||(l=>setTimeout(l,1)))(async()=>{if(!this.plugin.isUnloading){try{await r.initializeWorkers()}catch(l){console.error("Version Control: Worker initialization failed (partial)",l)}if(!this.plugin.isUnloading){try{o.initializeView()}catch(l){console.warn("Version Control: View initialization deferred/failed (non-fatal)",l)}o.checkForUpdates()}}},{timeout:2e3})}),this.plugin.setInitialized(!0)}catch(t){console.error("Version Control: CRITICAL: Plugin failed to load.",t);let n=t instanceof Error?t.message:"Unknown error during loading";if(new u9.Notice(`Version control plugin failed to load. Please check the console for details.
Error: ${n}`,0),this.plugin.store)try{this.plugin.store.dispatch(H.actions.reportError({title:"Plugin load failed",message:"The version control plugin encountered a critical error during loading.",details:n}))}catch{}await this.performEmergencyCleanup()}}async performEmergencyCleanup(){try{this.plugin.cancelDebouncedOperations(),await this.plugin.completePendingOperations(),await this.plugin.cleanupServices()}catch(t){console.error("Version Control: Emergency cleanup failed",t)}}};var $b=class{constructor(t){this.plugin=t}async unload(){this.plugin.isUnloading=!0;try{try{this.plugin.cancelDebouncedOperations(),this.plugin.queuedChangelogRequest=null}catch(t){console.warn("Version Control: Error cancelling debouncers",t)}try{await this.plugin.completePendingOperations()}catch(t){console.warn("Version Control: Error completing pending operations",t)}if(this.plugin.services)try{let t=this.plugin.services.compressionManager;t&&t.terminate()}catch(t){console.warn("Version Control: Error terminating compression manager",t)}try{await this.plugin.cleanupServices()}catch(t){console.warn("Version Control: Error cleaning up services",t)}if(this.plugin.services)try{await this.plugin.services.cleanupAll()}catch(t){console.warn("Version Control: Error cleaning up registry",t)}gr.resetInstance(),this.plugin.store&&(this.plugin.store.dispatch(Ne.util.resetApiState()),this.plugin.store.dispatch(Zu.util.resetApiState()),this.plugin.store=null),this.plugin.services=null,this.plugin.setInitialized(!1)}catch(t){console.error("Version Control: Unexpected error during unload process.",t)}}};var jb=class extends f9.Plugin{constructor(){super(...arguments);P(this,"services");P(this,"store");P(this,"cleanupManager");P(this,"backgroundTaskManager");P(this,"debouncedLeafChangeHandler");P(this,"autoSaveDebouncers",new Map);P(this,"_isUnloading",!1);P(this,"_initialized",!1);P(this,"_unloadPromise",null);P(this,"settings");P(this,"queuedChangelogRequest",null)}get isUnloading(){return this._isUnloading}set isUnloading(n){if(typeof n!="boolean"){console.warn("Version Control: Invalid value passed to isUnloading setter",n);return}this._isUnloading=n}get initialized(){return this._initialized}setInitialized(n){this._initialized=n}async onload(){this._isUnloading=!1,this._unloadPromise=null,await new Ub(this).load()}async onunload(){if(this._unloadPromise)return this._unloadPromise;this._isUnloading=!0,this._unloadPromise=this.performUnload();try{await this._unloadPromise}catch(n){console.error("Version Control: Unload promise rejected (unexpected)",n)}}async performUnload(){await new $b(this).unload()}async saveSettings(){if(!this.isUnloading)try{await new Ju(this).saveSettings()}catch(n){console.error("Version Control: Failed to save settings",n)}}handleStoreChange(){if(!this.isUnloading&&this.queuedChangelogRequest)try{let n=this.store.getState();(i=>{if(!i)return!1;let o=i.status==="INITIALIZING"||i.status==="READY"||i.status==="PLACEHOLDER"||i.status==="LOADING",s=!i.panel||i.panel.type==="changelog";return o&&s})(n.app)&&window.setTimeout(()=>{this.isUnloading||this.store.dispatch(Z.processQueuedChangelogRequest())},0)}catch(n){console.error("Version Control: Error handling store change",n)}}cancelDebouncedOperations(){try{this.debouncedLeafChangeHandler?.cancel(),this.autoSaveDebouncers&&(this.autoSaveDebouncers.forEach(n=>{try{n.debouncer?.cancel()}catch{}}),this.autoSaveDebouncers.clear())}catch(n){console.error("Version Control: Error cancelling debounced operations",n)}}async completePendingOperations(){try{this.cleanupManager&&await this.cleanupManager.completePendingCleanups(),this.services?.editHistoryManager&&await this.services.editHistoryManager.flushAllPendingWrites()}catch(n){console.error("Version Control: Error while completing pending operations on unload.",n)}}async cleanupServices(){try{if(this.services){let n=this.services.centralManifestRepo,r=this.services.noteManifestRepo,i=this.services.queueService,o=this.services.editHistoryManager;if(n&&n.invalidateCache(),r&&r.clearCache(),i&&i.clearAll(),o)try{await o.terminate()}catch(s){console.warn("Version Control: EditHistoryManager termination warning",s)}}}catch(n){console.error("Version Control: Error during services cleanup on unload.",n)}}};var Mme=jb;

/* nosourcemap */